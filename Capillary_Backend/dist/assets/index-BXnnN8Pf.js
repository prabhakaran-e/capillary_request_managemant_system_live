function Y7(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var Fwe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function M5(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var hT={exports:{}},By={},mT={exports:{}},Fr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qm=Symbol.for("react.element"),J7=Symbol.for("react.portal"),Z7=Symbol.for("react.fragment"),eR=Symbol.for("react.strict_mode"),tR=Symbol.for("react.profiler"),rR=Symbol.for("react.provider"),nR=Symbol.for("react.context"),sR=Symbol.for("react.forward_ref"),aR=Symbol.for("react.suspense"),iR=Symbol.for("react.memo"),oR=Symbol.for("react.lazy"),vB=Symbol.iterator;function lR(e){return e===null||typeof e!="object"?null:(e=vB&&e[vB]||e["@@iterator"],typeof e=="function"?e:null)}var pT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},xT=Object.assign,gT={};function Vf(e,t,r){this.props=e,this.context=t,this.refs=gT,this.updater=r||pT}Vf.prototype.isReactComponent={};Vf.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Vf.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function yT(){}yT.prototype=Vf.prototype;function H5(e,t,r){this.props=e,this.context=t,this.refs=gT,this.updater=r||pT}var V5=H5.prototype=new yT;V5.constructor=H5;xT(V5,Vf.prototype);V5.isPureReactComponent=!0;var wB=Array.isArray,vT=Object.prototype.hasOwnProperty,$5={current:null},wT={key:!0,ref:!0,__self:!0,__source:!0};function bT(e,t,r){var n,s={},i=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)vT.call(t,n)&&!wT.hasOwnProperty(n)&&(s[n]=t[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),A=0;A<l;A++)c[A]=arguments[A+2];s.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:Qm,type:e,key:i,ref:o,props:s,_owner:$5.current}}function cR(e,t){return{$$typeof:Qm,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function q5(e){return typeof e=="object"&&e!==null&&e.$$typeof===Qm}function AR(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var bB=/\/+/g;function D2(e,t){return typeof e=="object"&&e!==null&&e.key!=null?AR(""+e.key):t.toString(36)}function vg(e,t,r,n,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Qm:case J7:o=!0}}if(o)return o=e,s=s(o),e=n===""?"."+D2(o,0):n,wB(s)?(r="",e!=null&&(r=e.replace(bB,"$&/")+"/"),vg(s,t,r,"",function(A){return A})):s!=null&&(q5(s)&&(s=cR(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(bB,"$&/")+"/")+e)),t.push(s)),1;if(o=0,n=n===""?".":n+":",wB(e))for(var l=0;l<e.length;l++){i=e[l];var c=n+D2(i,l);o+=vg(i,t,r,c,s)}else if(c=lR(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=n+D2(i,l++),o+=vg(i,t,r,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function sx(e,t,r){if(e==null)return e;var n=[],s=0;return vg(e,n,"","",function(i){return t.call(r,i,s++)}),n}function dR(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ua={current:null},wg={transition:null},uR={ReactCurrentDispatcher:Ua,ReactCurrentBatchConfig:wg,ReactCurrentOwner:$5};function NT(){throw Error("act(...) is not supported in production builds of React.")}Fr.Children={map:sx,forEach:function(e,t,r){sx(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return sx(e,function(){t++}),t},toArray:function(e){return sx(e,function(t){return t})||[]},only:function(e){if(!q5(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Fr.Component=Vf;Fr.Fragment=Z7;Fr.Profiler=tR;Fr.PureComponent=H5;Fr.StrictMode=eR;Fr.Suspense=aR;Fr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uR;Fr.act=NT;Fr.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=xT({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=$5.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)vT.call(t,c)&&!wT.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var A=0;A<c;A++)l[A]=arguments[A+2];n.children=l}return{$$typeof:Qm,type:e.type,key:s,ref:i,props:n,_owner:o}};Fr.createContext=function(e){return e={$$typeof:nR,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:rR,_context:e},e.Consumer=e};Fr.createElement=bT;Fr.createFactory=function(e){var t=bT.bind(null,e);return t.type=e,t};Fr.createRef=function(){return{current:null}};Fr.forwardRef=function(e){return{$$typeof:sR,render:e}};Fr.isValidElement=q5;Fr.lazy=function(e){return{$$typeof:oR,_payload:{_status:-1,_result:e},_init:dR}};Fr.memo=function(e,t){return{$$typeof:iR,type:e,compare:t===void 0?null:t}};Fr.startTransition=function(e){var t=wg.transition;wg.transition={};try{e()}finally{wg.transition=t}};Fr.unstable_act=NT;Fr.useCallback=function(e,t){return Ua.current.useCallback(e,t)};Fr.useContext=function(e){return Ua.current.useContext(e)};Fr.useDebugValue=function(){};Fr.useDeferredValue=function(e){return Ua.current.useDeferredValue(e)};Fr.useEffect=function(e,t){return Ua.current.useEffect(e,t)};Fr.useId=function(){return Ua.current.useId()};Fr.useImperativeHandle=function(e,t,r){return Ua.current.useImperativeHandle(e,t,r)};Fr.useInsertionEffect=function(e,t){return Ua.current.useInsertionEffect(e,t)};Fr.useLayoutEffect=function(e,t){return Ua.current.useLayoutEffect(e,t)};Fr.useMemo=function(e,t){return Ua.current.useMemo(e,t)};Fr.useReducer=function(e,t,r){return Ua.current.useReducer(e,t,r)};Fr.useRef=function(e){return Ua.current.useRef(e)};Fr.useState=function(e){return Ua.current.useState(e)};Fr.useSyncExternalStore=function(e,t,r){return Ua.current.useSyncExternalStore(e,t,r)};Fr.useTransition=function(){return Ua.current.useTransition()};Fr.version="18.3.1";mT.exports=Fr;var C=mT.exports;const mr=M5(C),NB=Y7({__proto__:null,default:mr},[C]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fR=C,hR=Symbol.for("react.element"),mR=Symbol.for("react.fragment"),pR=Object.prototype.hasOwnProperty,xR=fR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,gR={key:!0,ref:!0,__self:!0,__source:!0};function CT(e,t,r){var n,s={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)pR.call(t,n)&&!gR.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:hR,type:e,key:i,ref:o,props:s,_owner:xR.current}}By.Fragment=mR;By.jsx=CT;By.jsxs=CT;hT.exports=By;var a=hT.exports,Nb={},jT={exports:{}},_i={},BT={exports:{}},ST={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Y,R){var z=Y.length;Y.push(R);e:for(;0<z;){var ee=z-1>>>1,b=Y[ee];if(0<s(b,R))Y[ee]=R,Y[z]=b,z=ee;else break e}}function r(Y){return Y.length===0?null:Y[0]}function n(Y){if(Y.length===0)return null;var R=Y[0],z=Y.pop();if(z!==R){Y[0]=z;e:for(var ee=0,b=Y.length,O=b>>>1;ee<O;){var S=2*(ee+1)-1,I=Y[S],U=S+1,Q=Y[U];if(0>s(I,z))U<b&&0>s(Q,I)?(Y[ee]=Q,Y[U]=z,ee=U):(Y[ee]=I,Y[S]=z,ee=S);else if(U<b&&0>s(Q,z))Y[ee]=Q,Y[U]=z,ee=U;else break e}}return R}function s(Y,R){var z=Y.sortIndex-R.sortIndex;return z!==0?z:Y.id-R.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],A=[],d=1,u=null,f=3,h=!1,x=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(Y){for(var R=r(A);R!==null;){if(R.callback===null)n(A);else if(R.startTime<=Y)n(A),R.sortIndex=R.expirationTime,t(c,R);else break;R=r(A)}}function B(Y){if(m=!1,w(Y),!x)if(r(c)!==null)x=!0,Z(T);else{var R=r(A);R!==null&&oe(B,R.startTime-Y)}}function T(Y,R){x=!1,m&&(m=!1,p(E),E=-1),h=!0;var z=f;try{for(w(R),u=r(c);u!==null&&(!(u.expirationTime>R)||Y&&!F());){var ee=u.callback;if(typeof ee=="function"){u.callback=null,f=u.priorityLevel;var b=ee(u.expirationTime<=R);R=e.unstable_now(),typeof b=="function"?u.callback=b:u===r(c)&&n(c),w(R)}else n(c);u=r(c)}if(u!==null)var O=!0;else{var S=r(A);S!==null&&oe(B,S.startTime-R),O=!1}return O}finally{u=null,f=z,h=!1}}var _=!1,j=null,E=-1,L=5,M=-1;function F(){return!(e.unstable_now()-M<L)}function D(){if(j!==null){var Y=e.unstable_now();M=Y;var R=!0;try{R=j(!0,Y)}finally{R?G():(_=!1,j=null)}}else _=!1}var G;if(typeof v=="function")G=function(){v(D)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,ae=K.port2;K.port1.onmessage=D,G=function(){ae.postMessage(null)}}else G=function(){g(D,0)};function Z(Y){j=Y,_||(_=!0,G())}function oe(Y,R){E=g(function(){Y(e.unstable_now())},R)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Y){Y.callback=null},e.unstable_continueExecution=function(){x||h||(x=!0,Z(T))},e.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<Y?Math.floor(1e3/Y):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(Y){switch(f){case 1:case 2:case 3:var R=3;break;default:R=f}var z=f;f=R;try{return Y()}finally{f=z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Y,R){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var z=f;f=Y;try{return R()}finally{f=z}},e.unstable_scheduleCallback=function(Y,R,z){var ee=e.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?ee+z:ee):z=ee,Y){case 1:var b=-1;break;case 2:b=250;break;case 5:b=1073741823;break;case 4:b=1e4;break;default:b=5e3}return b=z+b,Y={id:d++,callback:R,priorityLevel:Y,startTime:z,expirationTime:b,sortIndex:-1},z>ee?(Y.sortIndex=z,t(A,Y),r(c)===null&&Y===r(A)&&(m?(p(E),E=-1):m=!0,oe(B,z-ee))):(Y.sortIndex=b,t(c,Y),x||h||(x=!0,Z(T))),Y},e.unstable_shouldYield=F,e.unstable_wrapCallback=function(Y){var R=f;return function(){var z=f;f=R;try{return Y.apply(this,arguments)}finally{f=z}}}})(ST);BT.exports=ST;var yR=BT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vR=C,Si=yR;function bt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var FT=new Set,Wh={};function Od(e,t){Bf(e,t),Bf(e+"Capture",t)}function Bf(e,t){for(Wh[e]=t,e=0;e<t.length;e++)FT.add(t[e])}var ic=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Cb=Object.prototype.hasOwnProperty,wR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,CB={},jB={};function bR(e){return Cb.call(jB,e)?!0:Cb.call(CB,e)?!1:wR.test(e)?jB[e]=!0:(CB[e]=!0,!1)}function NR(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function CR(e,t,r,n){if(t===null||typeof t>"u"||NR(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Da(e,t,r,n,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var Ws={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ws[e]=new Da(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ws[t]=new Da(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ws[e]=new Da(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ws[e]=new Da(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ws[e]=new Da(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ws[e]=new Da(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ws[e]=new Da(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ws[e]=new Da(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ws[e]=new Da(e,5,!1,e.toLowerCase(),null,!1,!1)});var K5=/[\-:]([a-z])/g;function z5(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(K5,z5);Ws[t]=new Da(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(K5,z5);Ws[t]=new Da(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(K5,z5);Ws[t]=new Da(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ws[e]=new Da(e,1,!1,e.toLowerCase(),null,!1,!1)});Ws.xlinkHref=new Da("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ws[e]=new Da(e,1,!1,e.toLowerCase(),null,!0,!0)});function G5(e,t,r,n){var s=Ws.hasOwnProperty(t)?Ws[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(CR(t,r,s,n)&&(r=null),n||s===null?bR(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var hc=vR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ax=Symbol.for("react.element"),Vu=Symbol.for("react.portal"),$u=Symbol.for("react.fragment"),W5=Symbol.for("react.strict_mode"),jb=Symbol.for("react.profiler"),ET=Symbol.for("react.provider"),kT=Symbol.for("react.context"),X5=Symbol.for("react.forward_ref"),Bb=Symbol.for("react.suspense"),Sb=Symbol.for("react.suspense_list"),Y5=Symbol.for("react.memo"),Mc=Symbol.for("react.lazy"),TT=Symbol.for("react.offscreen"),BB=Symbol.iterator;function R0(e){return e===null||typeof e!="object"?null:(e=BB&&e[BB]||e["@@iterator"],typeof e=="function"?e:null)}var Rn=Object.assign,P2;function oh(e){if(P2===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);P2=t&&t[1]||""}return`
`+P2+e}var O2=!1;function R2(e,t){if(!e||O2)return"";O2=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(A){var n=A}Reflect.construct(e,[],t)}else{try{t.call()}catch(A){n=A}e.call(t.prototype)}else{try{throw Error()}catch(A){n=A}e()}}catch(A){if(A&&n&&typeof A.stack=="string"){for(var s=A.stack.split(`
`),i=n.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{O2=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?oh(e):""}function jR(e){switch(e.tag){case 5:return oh(e.type);case 16:return oh("Lazy");case 13:return oh("Suspense");case 19:return oh("SuspenseList");case 0:case 2:case 15:return e=R2(e.type,!1),e;case 11:return e=R2(e.type.render,!1),e;case 1:return e=R2(e.type,!0),e;default:return""}}function Fb(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case $u:return"Fragment";case Vu:return"Portal";case jb:return"Profiler";case W5:return"StrictMode";case Bb:return"Suspense";case Sb:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case kT:return(e.displayName||"Context")+".Consumer";case ET:return(e._context.displayName||"Context")+".Provider";case X5:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Y5:return t=e.displayName||null,t!==null?t:Fb(e.type)||"Memo";case Mc:t=e._payload,e=e._init;try{return Fb(e(t))}catch{}}return null}function BR(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Fb(t);case 8:return t===W5?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function hA(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function _T(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function SR(e){var t=_T(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ix(e){e._valueTracker||(e._valueTracker=SR(e))}function IT(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=_T(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function e1(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Eb(e,t){var r=t.checked;return Rn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function SB(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=hA(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function LT(e,t){t=t.checked,t!=null&&G5(e,"checked",t,!1)}function kb(e,t){LT(e,t);var r=hA(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Tb(e,t.type,r):t.hasOwnProperty("defaultValue")&&Tb(e,t.type,hA(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function FB(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Tb(e,t,r){(t!=="number"||e1(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var lh=Array.isArray;function lf(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+hA(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function _b(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(bt(91));return Rn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function EB(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(bt(92));if(lh(r)){if(1<r.length)throw Error(bt(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:hA(r)}}function UT(e,t){var r=hA(t.value),n=hA(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function kB(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function DT(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ib(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?DT(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ox,PT=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ox=ox||document.createElement("div"),ox.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ox.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Xh(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var bh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},FR=["Webkit","ms","Moz","O"];Object.keys(bh).forEach(function(e){FR.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),bh[t]=bh[e]})});function OT(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||bh.hasOwnProperty(e)&&bh[e]?(""+t).trim():t+"px"}function RT(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=OT(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var ER=Rn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Lb(e,t){if(t){if(ER[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(bt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(bt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(bt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(bt(62))}}function Ub(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Db=null;function J5(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Pb=null,cf=null,Af=null;function TB(e){if(e=Vm(e)){if(typeof Pb!="function")throw Error(bt(280));var t=e.stateNode;t&&(t=Ty(t),Pb(e.stateNode,e.type,t))}}function QT(e){cf?Af?Af.push(e):Af=[e]:cf=e}function MT(){if(cf){var e=cf,t=Af;if(Af=cf=null,TB(e),t)for(e=0;e<t.length;e++)TB(t[e])}}function HT(e,t){return e(t)}function VT(){}var Q2=!1;function $T(e,t,r){if(Q2)return e(t,r);Q2=!0;try{return HT(e,t,r)}finally{Q2=!1,(cf!==null||Af!==null)&&(VT(),MT())}}function Yh(e,t){var r=e.stateNode;if(r===null)return null;var n=Ty(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(bt(231,t,typeof r));return r}var Ob=!1;if(ic)try{var Q0={};Object.defineProperty(Q0,"passive",{get:function(){Ob=!0}}),window.addEventListener("test",Q0,Q0),window.removeEventListener("test",Q0,Q0)}catch{Ob=!1}function kR(e,t,r,n,s,i,o,l,c){var A=Array.prototype.slice.call(arguments,3);try{t.apply(r,A)}catch(d){this.onError(d)}}var Nh=!1,t1=null,r1=!1,Rb=null,TR={onError:function(e){Nh=!0,t1=e}};function _R(e,t,r,n,s,i,o,l,c){Nh=!1,t1=null,kR.apply(TR,arguments)}function IR(e,t,r,n,s,i,o,l,c){if(_R.apply(this,arguments),Nh){if(Nh){var A=t1;Nh=!1,t1=null}else throw Error(bt(198));r1||(r1=!0,Rb=A)}}function Rd(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function qT(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function _B(e){if(Rd(e)!==e)throw Error(bt(188))}function LR(e){var t=e.alternate;if(!t){if(t=Rd(e),t===null)throw Error(bt(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return _B(s),e;if(i===n)return _B(s),t;i=i.sibling}throw Error(bt(188))}if(r.return!==n.return)r=s,n=i;else{for(var o=!1,l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o)throw Error(bt(189))}}if(r.alternate!==n)throw Error(bt(190))}if(r.tag!==3)throw Error(bt(188));return r.stateNode.current===r?e:t}function KT(e){return e=LR(e),e!==null?zT(e):null}function zT(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=zT(e);if(t!==null)return t;e=e.sibling}return null}var GT=Si.unstable_scheduleCallback,IB=Si.unstable_cancelCallback,UR=Si.unstable_shouldYield,DR=Si.unstable_requestPaint,ts=Si.unstable_now,PR=Si.unstable_getCurrentPriorityLevel,Z5=Si.unstable_ImmediatePriority,WT=Si.unstable_UserBlockingPriority,n1=Si.unstable_NormalPriority,OR=Si.unstable_LowPriority,XT=Si.unstable_IdlePriority,Sy=null,pl=null;function RR(e){if(pl&&typeof pl.onCommitFiberRoot=="function")try{pl.onCommitFiberRoot(Sy,e,void 0,(e.current.flags&128)===128)}catch{}}var Qo=Math.clz32?Math.clz32:HR,QR=Math.log,MR=Math.LN2;function HR(e){return e>>>=0,e===0?32:31-(QR(e)/MR|0)|0}var lx=64,cx=4194304;function ch(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function s1(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~s;l!==0?n=ch(l):(i&=o,i!==0&&(n=ch(i)))}else o=r&~s,o!==0?n=ch(o):i!==0&&(n=ch(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Qo(t),s=1<<r,n|=e[r],t&=~s;return n}function VR(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $R(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-Qo(i),l=1<<o,c=s[o];c===-1?(!(l&r)||l&n)&&(s[o]=VR(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function Qb(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function YT(){var e=lx;return lx<<=1,!(lx&4194240)&&(lx=64),e}function M2(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Mm(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Qo(t),e[t]=r}function qR(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Qo(r),i=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~i}}function e4(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Qo(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var sn=0;function JT(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var ZT,t4,e6,t6,r6,Mb=!1,Ax=[],sA=null,aA=null,iA=null,Jh=new Map,Zh=new Map,$c=[],KR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function LB(e,t){switch(e){case"focusin":case"focusout":sA=null;break;case"dragenter":case"dragleave":aA=null;break;case"mouseover":case"mouseout":iA=null;break;case"pointerover":case"pointerout":Jh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zh.delete(t.pointerId)}}function M0(e,t,r,n,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Vm(t),t!==null&&t4(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function zR(e,t,r,n,s){switch(t){case"focusin":return sA=M0(sA,e,t,r,n,s),!0;case"dragenter":return aA=M0(aA,e,t,r,n,s),!0;case"mouseover":return iA=M0(iA,e,t,r,n,s),!0;case"pointerover":var i=s.pointerId;return Jh.set(i,M0(Jh.get(i)||null,e,t,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,Zh.set(i,M0(Zh.get(i)||null,e,t,r,n,s)),!0}return!1}function n6(e){var t=td(e.target);if(t!==null){var r=Rd(t);if(r!==null){if(t=r.tag,t===13){if(t=qT(r),t!==null){e.blockedOn=t,r6(e.priority,function(){e6(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function bg(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Hb(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Db=n,r.target.dispatchEvent(n),Db=null}else return t=Vm(r),t!==null&&t4(t),e.blockedOn=r,!1;t.shift()}return!0}function UB(e,t,r){bg(e)&&r.delete(t)}function GR(){Mb=!1,sA!==null&&bg(sA)&&(sA=null),aA!==null&&bg(aA)&&(aA=null),iA!==null&&bg(iA)&&(iA=null),Jh.forEach(UB),Zh.forEach(UB)}function H0(e,t){e.blockedOn===t&&(e.blockedOn=null,Mb||(Mb=!0,Si.unstable_scheduleCallback(Si.unstable_NormalPriority,GR)))}function em(e){function t(s){return H0(s,e)}if(0<Ax.length){H0(Ax[0],e);for(var r=1;r<Ax.length;r++){var n=Ax[r];n.blockedOn===e&&(n.blockedOn=null)}}for(sA!==null&&H0(sA,e),aA!==null&&H0(aA,e),iA!==null&&H0(iA,e),Jh.forEach(t),Zh.forEach(t),r=0;r<$c.length;r++)n=$c[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<$c.length&&(r=$c[0],r.blockedOn===null);)n6(r),r.blockedOn===null&&$c.shift()}var df=hc.ReactCurrentBatchConfig,a1=!0;function WR(e,t,r,n){var s=sn,i=df.transition;df.transition=null;try{sn=1,r4(e,t,r,n)}finally{sn=s,df.transition=i}}function XR(e,t,r,n){var s=sn,i=df.transition;df.transition=null;try{sn=4,r4(e,t,r,n)}finally{sn=s,df.transition=i}}function r4(e,t,r,n){if(a1){var s=Hb(e,t,r,n);if(s===null)Y2(e,t,n,i1,r),LB(e,n);else if(zR(s,e,t,r,n))n.stopPropagation();else if(LB(e,n),t&4&&-1<KR.indexOf(e)){for(;s!==null;){var i=Vm(s);if(i!==null&&ZT(i),i=Hb(e,t,r,n),i===null&&Y2(e,t,n,i1,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else Y2(e,t,n,null,r)}}var i1=null;function Hb(e,t,r,n){if(i1=null,e=J5(n),e=td(e),e!==null)if(t=Rd(e),t===null)e=null;else if(r=t.tag,r===13){if(e=qT(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return i1=e,null}function s6(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(PR()){case Z5:return 1;case WT:return 4;case n1:case OR:return 16;case XT:return 536870912;default:return 16}default:return 16}}var zc=null,n4=null,Ng=null;function a6(){if(Ng)return Ng;var e,t=n4,r=t.length,n,s="value"in zc?zc.value:zc.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===s[i-n];n++);return Ng=s.slice(e,1<n?1-n:void 0)}function Cg(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function dx(){return!0}function DB(){return!1}function Ii(e){function t(r,n,s,i,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?dx:DB,this.isPropagationStopped=DB,this}return Rn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=dx)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=dx)},persist:function(){},isPersistent:dx}),t}var $f={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},s4=Ii($f),Hm=Rn({},$f,{view:0,detail:0}),YR=Ii(Hm),H2,V2,V0,Fy=Rn({},Hm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:a4,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==V0&&(V0&&e.type==="mousemove"?(H2=e.screenX-V0.screenX,V2=e.screenY-V0.screenY):V2=H2=0,V0=e),H2)},movementY:function(e){return"movementY"in e?e.movementY:V2}}),PB=Ii(Fy),JR=Rn({},Fy,{dataTransfer:0}),ZR=Ii(JR),eQ=Rn({},Hm,{relatedTarget:0}),$2=Ii(eQ),tQ=Rn({},$f,{animationName:0,elapsedTime:0,pseudoElement:0}),rQ=Ii(tQ),nQ=Rn({},$f,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),sQ=Ii(nQ),aQ=Rn({},$f,{data:0}),OB=Ii(aQ),iQ={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},oQ={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lQ={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cQ(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=lQ[e])?!!t[e]:!1}function a4(){return cQ}var AQ=Rn({},Hm,{key:function(e){if(e.key){var t=iQ[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Cg(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?oQ[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:a4,charCode:function(e){return e.type==="keypress"?Cg(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Cg(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),dQ=Ii(AQ),uQ=Rn({},Fy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),RB=Ii(uQ),fQ=Rn({},Hm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:a4}),hQ=Ii(fQ),mQ=Rn({},$f,{propertyName:0,elapsedTime:0,pseudoElement:0}),pQ=Ii(mQ),xQ=Rn({},Fy,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),gQ=Ii(xQ),yQ=[9,13,27,32],i4=ic&&"CompositionEvent"in window,Ch=null;ic&&"documentMode"in document&&(Ch=document.documentMode);var vQ=ic&&"TextEvent"in window&&!Ch,i6=ic&&(!i4||Ch&&8<Ch&&11>=Ch),QB=" ",MB=!1;function o6(e,t){switch(e){case"keyup":return yQ.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function l6(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var qu=!1;function wQ(e,t){switch(e){case"compositionend":return l6(t);case"keypress":return t.which!==32?null:(MB=!0,QB);case"textInput":return e=t.data,e===QB&&MB?null:e;default:return null}}function bQ(e,t){if(qu)return e==="compositionend"||!i4&&o6(e,t)?(e=a6(),Ng=n4=zc=null,qu=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return i6&&t.locale!=="ko"?null:t.data;default:return null}}var NQ={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function HB(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!NQ[e.type]:t==="textarea"}function c6(e,t,r,n){QT(n),t=o1(t,"onChange"),0<t.length&&(r=new s4("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var jh=null,tm=null;function CQ(e){v6(e,0)}function Ey(e){var t=Gu(e);if(IT(t))return e}function jQ(e,t){if(e==="change")return t}var A6=!1;if(ic){var q2;if(ic){var K2="oninput"in document;if(!K2){var VB=document.createElement("div");VB.setAttribute("oninput","return;"),K2=typeof VB.oninput=="function"}q2=K2}else q2=!1;A6=q2&&(!document.documentMode||9<document.documentMode)}function $B(){jh&&(jh.detachEvent("onpropertychange",d6),tm=jh=null)}function d6(e){if(e.propertyName==="value"&&Ey(tm)){var t=[];c6(t,tm,e,J5(e)),$T(CQ,t)}}function BQ(e,t,r){e==="focusin"?($B(),jh=t,tm=r,jh.attachEvent("onpropertychange",d6)):e==="focusout"&&$B()}function SQ(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ey(tm)}function FQ(e,t){if(e==="click")return Ey(t)}function EQ(e,t){if(e==="input"||e==="change")return Ey(t)}function kQ(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var $o=typeof Object.is=="function"?Object.is:kQ;function rm(e,t){if($o(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Cb.call(t,s)||!$o(e[s],t[s]))return!1}return!0}function qB(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function KB(e,t){var r=qB(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=qB(r)}}function u6(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?u6(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function f6(){for(var e=window,t=e1();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=e1(e.document)}return t}function o4(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function TQ(e){var t=f6(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&u6(r.ownerDocument.documentElement,r)){if(n!==null&&o4(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!e.extend&&i>n&&(s=n,n=i,i=s),s=KB(r,i);var o=KB(r,n);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var _Q=ic&&"documentMode"in document&&11>=document.documentMode,Ku=null,Vb=null,Bh=null,$b=!1;function zB(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;$b||Ku==null||Ku!==e1(n)||(n=Ku,"selectionStart"in n&&o4(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Bh&&rm(Bh,n)||(Bh=n,n=o1(Vb,"onSelect"),0<n.length&&(t=new s4("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ku)))}function ux(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var zu={animationend:ux("Animation","AnimationEnd"),animationiteration:ux("Animation","AnimationIteration"),animationstart:ux("Animation","AnimationStart"),transitionend:ux("Transition","TransitionEnd")},z2={},h6={};ic&&(h6=document.createElement("div").style,"AnimationEvent"in window||(delete zu.animationend.animation,delete zu.animationiteration.animation,delete zu.animationstart.animation),"TransitionEvent"in window||delete zu.transitionend.transition);function ky(e){if(z2[e])return z2[e];if(!zu[e])return e;var t=zu[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in h6)return z2[e]=t[r];return e}var m6=ky("animationend"),p6=ky("animationiteration"),x6=ky("animationstart"),g6=ky("transitionend"),y6=new Map,GB="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function BA(e,t){y6.set(e,t),Od(t,[e])}for(var G2=0;G2<GB.length;G2++){var W2=GB[G2],IQ=W2.toLowerCase(),LQ=W2[0].toUpperCase()+W2.slice(1);BA(IQ,"on"+LQ)}BA(m6,"onAnimationEnd");BA(p6,"onAnimationIteration");BA(x6,"onAnimationStart");BA("dblclick","onDoubleClick");BA("focusin","onFocus");BA("focusout","onBlur");BA(g6,"onTransitionEnd");Bf("onMouseEnter",["mouseout","mouseover"]);Bf("onMouseLeave",["mouseout","mouseover"]);Bf("onPointerEnter",["pointerout","pointerover"]);Bf("onPointerLeave",["pointerout","pointerover"]);Od("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Od("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Od("onBeforeInput",["compositionend","keypress","textInput","paste"]);Od("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Od("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Od("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ah="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),UQ=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ah));function WB(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,IR(n,t,void 0,e),e.currentTarget=null}function v6(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,A=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;WB(s,l,A),i=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,A=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;WB(s,l,A),i=c}}}if(r1)throw e=Rb,r1=!1,Rb=null,e}function wn(e,t){var r=t[Wb];r===void 0&&(r=t[Wb]=new Set);var n=e+"__bubble";r.has(n)||(w6(t,e,2,!1),r.add(n))}function X2(e,t,r){var n=0;t&&(n|=4),w6(r,e,n,t)}var fx="_reactListening"+Math.random().toString(36).slice(2);function nm(e){if(!e[fx]){e[fx]=!0,FT.forEach(function(r){r!=="selectionchange"&&(UQ.has(r)||X2(r,!1,e),X2(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[fx]||(t[fx]=!0,X2("selectionchange",!1,t))}}function w6(e,t,r,n){switch(s6(t)){case 1:var s=WR;break;case 4:s=XR;break;default:s=r4}r=s.bind(null,t,r,e),s=void 0,!Ob||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function Y2(e,t,r,n,s){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=td(l),o===null)return;if(c=o.tag,c===5||c===6){n=i=o;continue e}l=l.parentNode}}n=n.return}$T(function(){var A=i,d=J5(r),u=[];e:{var f=y6.get(e);if(f!==void 0){var h=s4,x=e;switch(e){case"keypress":if(Cg(r)===0)break e;case"keydown":case"keyup":h=dQ;break;case"focusin":x="focus",h=$2;break;case"focusout":x="blur",h=$2;break;case"beforeblur":case"afterblur":h=$2;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=PB;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=ZR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=hQ;break;case m6:case p6:case x6:h=rQ;break;case g6:h=pQ;break;case"scroll":h=YR;break;case"wheel":h=gQ;break;case"copy":case"cut":case"paste":h=sQ;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=RB}var m=(t&4)!==0,g=!m&&e==="scroll",p=m?f!==null?f+"Capture":null:f;m=[];for(var v=A,w;v!==null;){w=v;var B=w.stateNode;if(w.tag===5&&B!==null&&(w=B,p!==null&&(B=Yh(v,p),B!=null&&m.push(sm(v,B,w)))),g)break;v=v.return}0<m.length&&(f=new h(f,x,null,r,d),u.push({event:f,listeners:m}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",f&&r!==Db&&(x=r.relatedTarget||r.fromElement)&&(td(x)||x[oc]))break e;if((h||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,h?(x=r.relatedTarget||r.toElement,h=A,x=x?td(x):null,x!==null&&(g=Rd(x),x!==g||x.tag!==5&&x.tag!==6)&&(x=null)):(h=null,x=A),h!==x)){if(m=PB,B="onMouseLeave",p="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(m=RB,B="onPointerLeave",p="onPointerEnter",v="pointer"),g=h==null?f:Gu(h),w=x==null?f:Gu(x),f=new m(B,v+"leave",h,r,d),f.target=g,f.relatedTarget=w,B=null,td(d)===A&&(m=new m(p,v+"enter",x,r,d),m.target=w,m.relatedTarget=g,B=m),g=B,h&&x)t:{for(m=h,p=x,v=0,w=m;w;w=Nu(w))v++;for(w=0,B=p;B;B=Nu(B))w++;for(;0<v-w;)m=Nu(m),v--;for(;0<w-v;)p=Nu(p),w--;for(;v--;){if(m===p||p!==null&&m===p.alternate)break t;m=Nu(m),p=Nu(p)}m=null}else m=null;h!==null&&XB(u,f,h,m,!1),x!==null&&g!==null&&XB(u,g,x,m,!0)}}e:{if(f=A?Gu(A):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var T=jQ;else if(HB(f))if(A6)T=EQ;else{T=SQ;var _=BQ}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(T=FQ);if(T&&(T=T(e,A))){c6(u,T,r,d);break e}_&&_(e,f,A),e==="focusout"&&(_=f._wrapperState)&&_.controlled&&f.type==="number"&&Tb(f,"number",f.value)}switch(_=A?Gu(A):window,e){case"focusin":(HB(_)||_.contentEditable==="true")&&(Ku=_,Vb=A,Bh=null);break;case"focusout":Bh=Vb=Ku=null;break;case"mousedown":$b=!0;break;case"contextmenu":case"mouseup":case"dragend":$b=!1,zB(u,r,d);break;case"selectionchange":if(_Q)break;case"keydown":case"keyup":zB(u,r,d)}var j;if(i4)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else qu?o6(e,r)&&(E="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(i6&&r.locale!=="ko"&&(qu||E!=="onCompositionStart"?E==="onCompositionEnd"&&qu&&(j=a6()):(zc=d,n4="value"in zc?zc.value:zc.textContent,qu=!0)),_=o1(A,E),0<_.length&&(E=new OB(E,e,null,r,d),u.push({event:E,listeners:_}),j?E.data=j:(j=l6(r),j!==null&&(E.data=j)))),(j=vQ?wQ(e,r):bQ(e,r))&&(A=o1(A,"onBeforeInput"),0<A.length&&(d=new OB("onBeforeInput","beforeinput",null,r,d),u.push({event:d,listeners:A}),d.data=j))}v6(u,t)})}function sm(e,t,r){return{instance:e,listener:t,currentTarget:r}}function o1(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Yh(e,r),i!=null&&n.unshift(sm(e,i,s)),i=Yh(e,t),i!=null&&n.push(sm(e,i,s))),e=e.return}return n}function Nu(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function XB(e,t,r,n,s){for(var i=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,A=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&A!==null&&(l=A,s?(c=Yh(r,i),c!=null&&o.unshift(sm(r,c,l))):s||(c=Yh(r,i),c!=null&&o.push(sm(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var DQ=/\r\n?/g,PQ=/\u0000|\uFFFD/g;function YB(e){return(typeof e=="string"?e:""+e).replace(DQ,`
`).replace(PQ,"")}function hx(e,t,r){if(t=YB(t),YB(e)!==t&&r)throw Error(bt(425))}function l1(){}var qb=null,Kb=null;function zb(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Gb=typeof setTimeout=="function"?setTimeout:void 0,OQ=typeof clearTimeout=="function"?clearTimeout:void 0,JB=typeof Promise=="function"?Promise:void 0,RQ=typeof queueMicrotask=="function"?queueMicrotask:typeof JB<"u"?function(e){return JB.resolve(null).then(e).catch(QQ)}:Gb;function QQ(e){setTimeout(function(){throw e})}function J2(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),em(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);em(t)}function oA(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function ZB(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var qf=Math.random().toString(36).slice(2),ul="__reactFiber$"+qf,am="__reactProps$"+qf,oc="__reactContainer$"+qf,Wb="__reactEvents$"+qf,MQ="__reactListeners$"+qf,HQ="__reactHandles$"+qf;function td(e){var t=e[ul];if(t)return t;for(var r=e.parentNode;r;){if(t=r[oc]||r[ul]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=ZB(e);e!==null;){if(r=e[ul])return r;e=ZB(e)}return t}e=r,r=e.parentNode}return null}function Vm(e){return e=e[ul]||e[oc],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Gu(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(bt(33))}function Ty(e){return e[am]||null}var Xb=[],Wu=-1;function SA(e){return{current:e}}function jn(e){0>Wu||(e.current=Xb[Wu],Xb[Wu]=null,Wu--)}function gn(e,t){Wu++,Xb[Wu]=e.current,e.current=t}var mA={},ya=SA(mA),Wa=SA(!1),bd=mA;function Sf(e,t){var r=e.type.contextTypes;if(!r)return mA;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Xa(e){return e=e.childContextTypes,e!=null}function c1(){jn(Wa),jn(ya)}function e3(e,t,r){if(ya.current!==mA)throw Error(bt(168));gn(ya,t),gn(Wa,r)}function b6(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(bt(108,BR(e)||"Unknown",s));return Rn({},r,n)}function A1(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||mA,bd=ya.current,gn(ya,e),gn(Wa,Wa.current),!0}function t3(e,t,r){var n=e.stateNode;if(!n)throw Error(bt(169));r?(e=b6(e,t,bd),n.__reactInternalMemoizedMergedChildContext=e,jn(Wa),jn(ya),gn(ya,e)):jn(Wa),gn(Wa,r)}var Vl=null,_y=!1,Z2=!1;function N6(e){Vl===null?Vl=[e]:Vl.push(e)}function VQ(e){_y=!0,N6(e)}function FA(){if(!Z2&&Vl!==null){Z2=!0;var e=0,t=sn;try{var r=Vl;for(sn=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Vl=null,_y=!1}catch(s){throw Vl!==null&&(Vl=Vl.slice(e+1)),GT(Z5,FA),s}finally{sn=t,Z2=!1}}return null}var Xu=[],Yu=0,d1=null,u1=0,to=[],ro=0,Nd=null,Kl=1,zl="";function zA(e,t){Xu[Yu++]=u1,Xu[Yu++]=d1,d1=e,u1=t}function C6(e,t,r){to[ro++]=Kl,to[ro++]=zl,to[ro++]=Nd,Nd=e;var n=Kl;e=zl;var s=32-Qo(n)-1;n&=~(1<<s),r+=1;var i=32-Qo(t)+s;if(30<i){var o=s-s%5;i=(n&(1<<o)-1).toString(32),n>>=o,s-=o,Kl=1<<32-Qo(t)+s|r<<s|n,zl=i+e}else Kl=1<<i|r<<s|n,zl=e}function l4(e){e.return!==null&&(zA(e,1),C6(e,1,0))}function c4(e){for(;e===d1;)d1=Xu[--Yu],Xu[Yu]=null,u1=Xu[--Yu],Xu[Yu]=null;for(;e===Nd;)Nd=to[--ro],to[ro]=null,zl=to[--ro],to[ro]=null,Kl=to[--ro],to[ro]=null}var Ci=null,wi=null,kn=!1,Do=null;function j6(e,t){var r=ao(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function r3(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ci=e,wi=oA(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ci=e,wi=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Nd!==null?{id:Kl,overflow:zl}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=ao(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Ci=e,wi=null,!0):!1;default:return!1}}function Yb(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Jb(e){if(kn){var t=wi;if(t){var r=t;if(!r3(e,t)){if(Yb(e))throw Error(bt(418));t=oA(r.nextSibling);var n=Ci;t&&r3(e,t)?j6(n,r):(e.flags=e.flags&-4097|2,kn=!1,Ci=e)}}else{if(Yb(e))throw Error(bt(418));e.flags=e.flags&-4097|2,kn=!1,Ci=e}}}function n3(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ci=e}function mx(e){if(e!==Ci)return!1;if(!kn)return n3(e),kn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!zb(e.type,e.memoizedProps)),t&&(t=wi)){if(Yb(e))throw B6(),Error(bt(418));for(;t;)j6(e,t),t=oA(t.nextSibling)}if(n3(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(bt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){wi=oA(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}wi=null}}else wi=Ci?oA(e.stateNode.nextSibling):null;return!0}function B6(){for(var e=wi;e;)e=oA(e.nextSibling)}function Ff(){wi=Ci=null,kn=!1}function A4(e){Do===null?Do=[e]:Do.push(e)}var $Q=hc.ReactCurrentBatchConfig;function $0(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(bt(309));var n=r.stateNode}if(!n)throw Error(bt(147,e));var s=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(bt(284));if(!r._owner)throw Error(bt(290,e))}return e}function px(e,t){throw e=Object.prototype.toString.call(t),Error(bt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function s3(e){var t=e._init;return t(e._payload)}function S6(e){function t(p,v){if(e){var w=p.deletions;w===null?(p.deletions=[v],p.flags|=16):w.push(v)}}function r(p,v){if(!e)return null;for(;v!==null;)t(p,v),v=v.sibling;return null}function n(p,v){for(p=new Map;v!==null;)v.key!==null?p.set(v.key,v):p.set(v.index,v),v=v.sibling;return p}function s(p,v){return p=dA(p,v),p.index=0,p.sibling=null,p}function i(p,v,w){return p.index=w,e?(w=p.alternate,w!==null?(w=w.index,w<v?(p.flags|=2,v):w):(p.flags|=2,v)):(p.flags|=1048576,v)}function o(p){return e&&p.alternate===null&&(p.flags|=2),p}function l(p,v,w,B){return v===null||v.tag!==6?(v=iw(w,p.mode,B),v.return=p,v):(v=s(v,w),v.return=p,v)}function c(p,v,w,B){var T=w.type;return T===$u?d(p,v,w.props.children,B,w.key):v!==null&&(v.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Mc&&s3(T)===v.type)?(B=s(v,w.props),B.ref=$0(p,v,w),B.return=p,B):(B=Tg(w.type,w.key,w.props,null,p.mode,B),B.ref=$0(p,v,w),B.return=p,B)}function A(p,v,w,B){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=ow(w,p.mode,B),v.return=p,v):(v=s(v,w.children||[]),v.return=p,v)}function d(p,v,w,B,T){return v===null||v.tag!==7?(v=cd(w,p.mode,B,T),v.return=p,v):(v=s(v,w),v.return=p,v)}function u(p,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=iw(""+v,p.mode,w),v.return=p,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case ax:return w=Tg(v.type,v.key,v.props,null,p.mode,w),w.ref=$0(p,null,v),w.return=p,w;case Vu:return v=ow(v,p.mode,w),v.return=p,v;case Mc:var B=v._init;return u(p,B(v._payload),w)}if(lh(v)||R0(v))return v=cd(v,p.mode,w,null),v.return=p,v;px(p,v)}return null}function f(p,v,w,B){var T=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return T!==null?null:l(p,v,""+w,B);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ax:return w.key===T?c(p,v,w,B):null;case Vu:return w.key===T?A(p,v,w,B):null;case Mc:return T=w._init,f(p,v,T(w._payload),B)}if(lh(w)||R0(w))return T!==null?null:d(p,v,w,B,null);px(p,w)}return null}function h(p,v,w,B,T){if(typeof B=="string"&&B!==""||typeof B=="number")return p=p.get(w)||null,l(v,p,""+B,T);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case ax:return p=p.get(B.key===null?w:B.key)||null,c(v,p,B,T);case Vu:return p=p.get(B.key===null?w:B.key)||null,A(v,p,B,T);case Mc:var _=B._init;return h(p,v,w,_(B._payload),T)}if(lh(B)||R0(B))return p=p.get(w)||null,d(v,p,B,T,null);px(v,B)}return null}function x(p,v,w,B){for(var T=null,_=null,j=v,E=v=0,L=null;j!==null&&E<w.length;E++){j.index>E?(L=j,j=null):L=j.sibling;var M=f(p,j,w[E],B);if(M===null){j===null&&(j=L);break}e&&j&&M.alternate===null&&t(p,j),v=i(M,v,E),_===null?T=M:_.sibling=M,_=M,j=L}if(E===w.length)return r(p,j),kn&&zA(p,E),T;if(j===null){for(;E<w.length;E++)j=u(p,w[E],B),j!==null&&(v=i(j,v,E),_===null?T=j:_.sibling=j,_=j);return kn&&zA(p,E),T}for(j=n(p,j);E<w.length;E++)L=h(j,p,E,w[E],B),L!==null&&(e&&L.alternate!==null&&j.delete(L.key===null?E:L.key),v=i(L,v,E),_===null?T=L:_.sibling=L,_=L);return e&&j.forEach(function(F){return t(p,F)}),kn&&zA(p,E),T}function m(p,v,w,B){var T=R0(w);if(typeof T!="function")throw Error(bt(150));if(w=T.call(w),w==null)throw Error(bt(151));for(var _=T=null,j=v,E=v=0,L=null,M=w.next();j!==null&&!M.done;E++,M=w.next()){j.index>E?(L=j,j=null):L=j.sibling;var F=f(p,j,M.value,B);if(F===null){j===null&&(j=L);break}e&&j&&F.alternate===null&&t(p,j),v=i(F,v,E),_===null?T=F:_.sibling=F,_=F,j=L}if(M.done)return r(p,j),kn&&zA(p,E),T;if(j===null){for(;!M.done;E++,M=w.next())M=u(p,M.value,B),M!==null&&(v=i(M,v,E),_===null?T=M:_.sibling=M,_=M);return kn&&zA(p,E),T}for(j=n(p,j);!M.done;E++,M=w.next())M=h(j,p,E,M.value,B),M!==null&&(e&&M.alternate!==null&&j.delete(M.key===null?E:M.key),v=i(M,v,E),_===null?T=M:_.sibling=M,_=M);return e&&j.forEach(function(D){return t(p,D)}),kn&&zA(p,E),T}function g(p,v,w,B){if(typeof w=="object"&&w!==null&&w.type===$u&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case ax:e:{for(var T=w.key,_=v;_!==null;){if(_.key===T){if(T=w.type,T===$u){if(_.tag===7){r(p,_.sibling),v=s(_,w.props.children),v.return=p,p=v;break e}}else if(_.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Mc&&s3(T)===_.type){r(p,_.sibling),v=s(_,w.props),v.ref=$0(p,_,w),v.return=p,p=v;break e}r(p,_);break}else t(p,_);_=_.sibling}w.type===$u?(v=cd(w.props.children,p.mode,B,w.key),v.return=p,p=v):(B=Tg(w.type,w.key,w.props,null,p.mode,B),B.ref=$0(p,v,w),B.return=p,p=B)}return o(p);case Vu:e:{for(_=w.key;v!==null;){if(v.key===_)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){r(p,v.sibling),v=s(v,w.children||[]),v.return=p,p=v;break e}else{r(p,v);break}else t(p,v);v=v.sibling}v=ow(w,p.mode,B),v.return=p,p=v}return o(p);case Mc:return _=w._init,g(p,v,_(w._payload),B)}if(lh(w))return x(p,v,w,B);if(R0(w))return m(p,v,w,B);px(p,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(r(p,v.sibling),v=s(v,w),v.return=p,p=v):(r(p,v),v=iw(w,p.mode,B),v.return=p,p=v),o(p)):r(p,v)}return g}var Ef=S6(!0),F6=S6(!1),f1=SA(null),h1=null,Ju=null,d4=null;function u4(){d4=Ju=h1=null}function f4(e){var t=f1.current;jn(f1),e._currentValue=t}function Zb(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function uf(e,t){h1=e,d4=Ju=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ga=!0),e.firstContext=null)}function Ao(e){var t=e._currentValue;if(d4!==e)if(e={context:e,memoizedValue:t,next:null},Ju===null){if(h1===null)throw Error(bt(308));Ju=e,h1.dependencies={lanes:0,firstContext:e}}else Ju=Ju.next=e;return t}var rd=null;function h4(e){rd===null?rd=[e]:rd.push(e)}function E6(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,h4(t)):(r.next=s.next,s.next=r),t.interleaved=r,lc(e,n)}function lc(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Hc=!1;function m4(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function k6(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Yl(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function lA(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Pr&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,lc(e,r)}return s=n.interleaved,s===null?(t.next=t,h4(n)):(t.next=s.next,s.next=t),n.interleaved=t,lc(e,r)}function jg(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,e4(e,r)}}function a3(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function m1(e,t,r,n){var s=e.updateQueue;Hc=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,A=c.next;c.next=null,o===null?i=A:o.next=A,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=A:l.next=A,d.lastBaseUpdate=c))}if(i!==null){var u=s.baseState;o=0,d=A=c=null,l=i;do{var f=l.lane,h=l.eventTime;if((n&f)===f){d!==null&&(d=d.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,m=l;switch(f=t,h=r,m.tag){case 1:if(x=m.payload,typeof x=="function"){u=x.call(h,u,f);break e}u=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=m.payload,f=typeof x=="function"?x.call(h,u,f):x,f==null)break e;u=Rn({},u,f);break e;case 2:Hc=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else h={eventTime:h,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(A=d=h,c=u):d=d.next=h,o|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(d===null&&(c=u),s.baseState=c,s.firstBaseUpdate=A,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);jd|=o,e.lanes=o,e.memoizedState=u}}function i3(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(bt(191,s));s.call(n)}}}var $m={},xl=SA($m),im=SA($m),om=SA($m);function nd(e){if(e===$m)throw Error(bt(174));return e}function p4(e,t){switch(gn(om,t),gn(im,e),gn(xl,$m),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ib(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ib(t,e)}jn(xl),gn(xl,t)}function kf(){jn(xl),jn(im),jn(om)}function T6(e){nd(om.current);var t=nd(xl.current),r=Ib(t,e.type);t!==r&&(gn(im,e),gn(xl,r))}function x4(e){im.current===e&&(jn(xl),jn(im))}var Un=SA(0);function p1(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ew=[];function g4(){for(var e=0;e<ew.length;e++)ew[e]._workInProgressVersionPrimary=null;ew.length=0}var Bg=hc.ReactCurrentDispatcher,tw=hc.ReactCurrentBatchConfig,Cd=0,On=null,ys=null,ks=null,x1=!1,Sh=!1,lm=0,qQ=0;function ea(){throw Error(bt(321))}function y4(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!$o(e[r],t[r]))return!1;return!0}function v4(e,t,r,n,s,i){if(Cd=i,On=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Bg.current=e===null||e.memoizedState===null?WQ:XQ,e=r(n,s),Sh){i=0;do{if(Sh=!1,lm=0,25<=i)throw Error(bt(301));i+=1,ks=ys=null,t.updateQueue=null,Bg.current=YQ,e=r(n,s)}while(Sh)}if(Bg.current=g1,t=ys!==null&&ys.next!==null,Cd=0,ks=ys=On=null,x1=!1,t)throw Error(bt(300));return e}function w4(){var e=lm!==0;return lm=0,e}function ol(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ks===null?On.memoizedState=ks=e:ks=ks.next=e,ks}function uo(){if(ys===null){var e=On.alternate;e=e!==null?e.memoizedState:null}else e=ys.next;var t=ks===null?On.memoizedState:ks.next;if(t!==null)ks=t,ys=e;else{if(e===null)throw Error(bt(310));ys=e,e={memoizedState:ys.memoizedState,baseState:ys.baseState,baseQueue:ys.baseQueue,queue:ys.queue,next:null},ks===null?On.memoizedState=ks=e:ks=ks.next=e}return ks}function cm(e,t){return typeof t=="function"?t(e):t}function rw(e){var t=uo(),r=t.queue;if(r===null)throw Error(bt(311));r.lastRenderedReducer=e;var n=ys,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var l=o=null,c=null,A=i;do{var d=A.lane;if((Cd&d)===d)c!==null&&(c=c.next={lane:0,action:A.action,hasEagerState:A.hasEagerState,eagerState:A.eagerState,next:null}),n=A.hasEagerState?A.eagerState:e(n,A.action);else{var u={lane:d,action:A.action,hasEagerState:A.hasEagerState,eagerState:A.eagerState,next:null};c===null?(l=c=u,o=n):c=c.next=u,On.lanes|=d,jd|=d}A=A.next}while(A!==null&&A!==i);c===null?o=n:c.next=l,$o(n,t.memoizedState)||(Ga=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do i=s.lane,On.lanes|=i,jd|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function nw(e){var t=uo(),r=t.queue;if(r===null)throw Error(bt(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);$o(i,t.memoizedState)||(Ga=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function _6(){}function I6(e,t){var r=On,n=uo(),s=t(),i=!$o(n.memoizedState,s);if(i&&(n.memoizedState=s,Ga=!0),n=n.queue,b4(D6.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||ks!==null&&ks.memoizedState.tag&1){if(r.flags|=2048,Am(9,U6.bind(null,r,n,s,t),void 0,null),Ls===null)throw Error(bt(349));Cd&30||L6(r,t,s)}return s}function L6(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=On.updateQueue,t===null?(t={lastEffect:null,stores:null},On.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function U6(e,t,r,n){t.value=r,t.getSnapshot=n,P6(t)&&O6(e)}function D6(e,t,r){return r(function(){P6(t)&&O6(e)})}function P6(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!$o(e,r)}catch{return!0}}function O6(e){var t=lc(e,1);t!==null&&Mo(t,e,1,-1)}function o3(e){var t=ol();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:cm,lastRenderedState:e},t.queue=e,e=e.dispatch=GQ.bind(null,On,e),[t.memoizedState,e]}function Am(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=On.updateQueue,t===null?(t={lastEffect:null,stores:null},On.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function R6(){return uo().memoizedState}function Sg(e,t,r,n){var s=ol();On.flags|=e,s.memoizedState=Am(1|t,r,void 0,n===void 0?null:n)}function Iy(e,t,r,n){var s=uo();n=n===void 0?null:n;var i=void 0;if(ys!==null){var o=ys.memoizedState;if(i=o.destroy,n!==null&&y4(n,o.deps)){s.memoizedState=Am(t,r,i,n);return}}On.flags|=e,s.memoizedState=Am(1|t,r,i,n)}function l3(e,t){return Sg(8390656,8,e,t)}function b4(e,t){return Iy(2048,8,e,t)}function Q6(e,t){return Iy(4,2,e,t)}function M6(e,t){return Iy(4,4,e,t)}function H6(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function V6(e,t,r){return r=r!=null?r.concat([e]):null,Iy(4,4,H6.bind(null,t,e),r)}function N4(){}function $6(e,t){var r=uo();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&y4(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function q6(e,t){var r=uo();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&y4(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function K6(e,t,r){return Cd&21?($o(r,t)||(r=YT(),On.lanes|=r,jd|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ga=!0),e.memoizedState=r)}function KQ(e,t){var r=sn;sn=r!==0&&4>r?r:4,e(!0);var n=tw.transition;tw.transition={};try{e(!1),t()}finally{sn=r,tw.transition=n}}function z6(){return uo().memoizedState}function zQ(e,t,r){var n=AA(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},G6(e))W6(t,r);else if(r=E6(e,t,r,n),r!==null){var s=Ia();Mo(r,e,n,s),X6(r,t,n)}}function GQ(e,t,r){var n=AA(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(G6(e))W6(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,r);if(s.hasEagerState=!0,s.eagerState=l,$o(l,o)){var c=t.interleaved;c===null?(s.next=s,h4(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=E6(e,t,s,n),r!==null&&(s=Ia(),Mo(r,e,n,s),X6(r,t,n))}}function G6(e){var t=e.alternate;return e===On||t!==null&&t===On}function W6(e,t){Sh=x1=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function X6(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,e4(e,r)}}var g1={readContext:Ao,useCallback:ea,useContext:ea,useEffect:ea,useImperativeHandle:ea,useInsertionEffect:ea,useLayoutEffect:ea,useMemo:ea,useReducer:ea,useRef:ea,useState:ea,useDebugValue:ea,useDeferredValue:ea,useTransition:ea,useMutableSource:ea,useSyncExternalStore:ea,useId:ea,unstable_isNewReconciler:!1},WQ={readContext:Ao,useCallback:function(e,t){return ol().memoizedState=[e,t===void 0?null:t],e},useContext:Ao,useEffect:l3,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Sg(4194308,4,H6.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Sg(4194308,4,e,t)},useInsertionEffect:function(e,t){return Sg(4,2,e,t)},useMemo:function(e,t){var r=ol();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=ol();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=zQ.bind(null,On,e),[n.memoizedState,e]},useRef:function(e){var t=ol();return e={current:e},t.memoizedState=e},useState:o3,useDebugValue:N4,useDeferredValue:function(e){return ol().memoizedState=e},useTransition:function(){var e=o3(!1),t=e[0];return e=KQ.bind(null,e[1]),ol().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=On,s=ol();if(kn){if(r===void 0)throw Error(bt(407));r=r()}else{if(r=t(),Ls===null)throw Error(bt(349));Cd&30||L6(n,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,l3(D6.bind(null,n,i,e),[e]),n.flags|=2048,Am(9,U6.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=ol(),t=Ls.identifierPrefix;if(kn){var r=zl,n=Kl;r=(n&~(1<<32-Qo(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=lm++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=qQ++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},XQ={readContext:Ao,useCallback:$6,useContext:Ao,useEffect:b4,useImperativeHandle:V6,useInsertionEffect:Q6,useLayoutEffect:M6,useMemo:q6,useReducer:rw,useRef:R6,useState:function(){return rw(cm)},useDebugValue:N4,useDeferredValue:function(e){var t=uo();return K6(t,ys.memoizedState,e)},useTransition:function(){var e=rw(cm)[0],t=uo().memoizedState;return[e,t]},useMutableSource:_6,useSyncExternalStore:I6,useId:z6,unstable_isNewReconciler:!1},YQ={readContext:Ao,useCallback:$6,useContext:Ao,useEffect:b4,useImperativeHandle:V6,useInsertionEffect:Q6,useLayoutEffect:M6,useMemo:q6,useReducer:nw,useRef:R6,useState:function(){return nw(cm)},useDebugValue:N4,useDeferredValue:function(e){var t=uo();return ys===null?t.memoizedState=e:K6(t,ys.memoizedState,e)},useTransition:function(){var e=nw(cm)[0],t=uo().memoizedState;return[e,t]},useMutableSource:_6,useSyncExternalStore:I6,useId:z6,unstable_isNewReconciler:!1};function Io(e,t){if(e&&e.defaultProps){t=Rn({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function eN(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Rn({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Ly={isMounted:function(e){return(e=e._reactInternals)?Rd(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Ia(),s=AA(e),i=Yl(n,s);i.payload=t,r!=null&&(i.callback=r),t=lA(e,i,s),t!==null&&(Mo(t,e,s,n),jg(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Ia(),s=AA(e),i=Yl(n,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=lA(e,i,s),t!==null&&(Mo(t,e,s,n),jg(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Ia(),n=AA(e),s=Yl(r,n);s.tag=2,t!=null&&(s.callback=t),t=lA(e,s,n),t!==null&&(Mo(t,e,n,r),jg(t,e,n))}};function c3(e,t,r,n,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,o):t.prototype&&t.prototype.isPureReactComponent?!rm(r,n)||!rm(s,i):!0}function Y6(e,t,r){var n=!1,s=mA,i=t.contextType;return typeof i=="object"&&i!==null?i=Ao(i):(s=Xa(t)?bd:ya.current,n=t.contextTypes,i=(n=n!=null)?Sf(e,s):mA),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Ly,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function A3(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Ly.enqueueReplaceState(t,t.state,null)}function tN(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},m4(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=Ao(i):(i=Xa(t)?bd:ya.current,s.context=Sf(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(eN(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Ly.enqueueReplaceState(s,s.state,null),m1(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Tf(e,t){try{var r="",n=t;do r+=jR(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function sw(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function rN(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var JQ=typeof WeakMap=="function"?WeakMap:Map;function J6(e,t,r){r=Yl(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){v1||(v1=!0,uN=n),rN(e,t)},r}function Z6(e,t,r){r=Yl(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){rN(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){rN(e,t),typeof n!="function"&&(cA===null?cA=new Set([this]):cA.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function d3(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new JQ;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=uM.bind(null,e,t,r),t.then(e,e))}function u3(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function f3(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Yl(-1,1),t.tag=2,lA(r,t,1))),r.lanes|=1),e)}var ZQ=hc.ReactCurrentOwner,Ga=!1;function Sa(e,t,r,n){t.child=e===null?F6(t,null,r,n):Ef(t,e.child,r,n)}function h3(e,t,r,n,s){r=r.render;var i=t.ref;return uf(t,s),n=v4(e,t,r,n,i,s),r=w4(),e!==null&&!Ga?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,cc(e,t,s)):(kn&&r&&l4(t),t.flags|=1,Sa(e,t,n,s),t.child)}function m3(e,t,r,n,s){if(e===null){var i=r.type;return typeof i=="function"&&!T4(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,e_(e,t,i,n,s)):(e=Tg(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:rm,r(o,n)&&e.ref===t.ref)return cc(e,t,s)}return t.flags|=1,e=dA(i,n),e.ref=t.ref,e.return=t,t.child=e}function e_(e,t,r,n,s){if(e!==null){var i=e.memoizedProps;if(rm(i,n)&&e.ref===t.ref)if(Ga=!1,t.pendingProps=n=i,(e.lanes&s)!==0)e.flags&131072&&(Ga=!0);else return t.lanes=e.lanes,cc(e,t,s)}return nN(e,t,r,n,s)}function t_(e,t,r){var n=t.pendingProps,s=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},gn(ef,mi),mi|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,gn(ef,mi),mi|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,gn(ef,mi),mi|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,gn(ef,mi),mi|=n;return Sa(e,t,s,r),t.child}function r_(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function nN(e,t,r,n,s){var i=Xa(r)?bd:ya.current;return i=Sf(t,i),uf(t,s),r=v4(e,t,r,n,i,s),n=w4(),e!==null&&!Ga?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,cc(e,t,s)):(kn&&n&&l4(t),t.flags|=1,Sa(e,t,r,s),t.child)}function p3(e,t,r,n,s){if(Xa(r)){var i=!0;A1(t)}else i=!1;if(uf(t,s),t.stateNode===null)Fg(e,t),Y6(t,r,n),tN(t,r,n,s),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,A=r.contextType;typeof A=="object"&&A!==null?A=Ao(A):(A=Xa(r)?bd:ya.current,A=Sf(t,A));var d=r.getDerivedStateFromProps,u=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";u||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==A)&&A3(t,o,n,A),Hc=!1;var f=t.memoizedState;o.state=f,m1(t,n,o,s),c=t.memoizedState,l!==n||f!==c||Wa.current||Hc?(typeof d=="function"&&(eN(t,r,d,n),c=t.memoizedState),(l=Hc||c3(t,r,l,n,f,c,A))?(u||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=A,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,k6(e,t),l=t.memoizedProps,A=t.type===t.elementType?l:Io(t.type,l),o.props=A,u=t.pendingProps,f=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Ao(c):(c=Xa(r)?bd:ya.current,c=Sf(t,c));var h=r.getDerivedStateFromProps;(d=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==u||f!==c)&&A3(t,o,n,c),Hc=!1,f=t.memoizedState,o.state=f,m1(t,n,o,s);var x=t.memoizedState;l!==u||f!==x||Wa.current||Hc?(typeof h=="function"&&(eN(t,r,h,n),x=t.memoizedState),(A=Hc||c3(t,r,A,n,f,x,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,x,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),o.props=n,o.state=x,o.context=c,n=A):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return sN(e,t,r,n,i,s)}function sN(e,t,r,n,s,i){r_(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return s&&t3(t,r,!1),cc(e,t,i);n=t.stateNode,ZQ.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=Ef(t,e.child,null,i),t.child=Ef(t,null,l,i)):Sa(e,t,l,i),t.memoizedState=n.state,s&&t3(t,r,!0),t.child}function n_(e){var t=e.stateNode;t.pendingContext?e3(e,t.pendingContext,t.pendingContext!==t.context):t.context&&e3(e,t.context,!1),p4(e,t.containerInfo)}function x3(e,t,r,n,s){return Ff(),A4(s),t.flags|=256,Sa(e,t,r,n),t.child}var aN={dehydrated:null,treeContext:null,retryLane:0};function iN(e){return{baseLanes:e,cachePool:null,transitions:null}}function s_(e,t,r){var n=t.pendingProps,s=Un.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),gn(Un,s&1),e===null)return Jb(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,i?(n=t.mode,i=t.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Py(o,n,0,null),e=cd(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=iN(r),t.memoizedState=aN,e):C4(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return eM(e,t,o,n,l,s,r);if(i){i=n.fallback,o=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=dA(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=dA(l,i):(i=cd(i,o,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,o=e.child.memoizedState,o=o===null?iN(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=aN,n}return i=e.child,e=i.sibling,n=dA(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function C4(e,t){return t=Py({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function xx(e,t,r,n){return n!==null&&A4(n),Ef(t,e.child,null,r),e=C4(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function eM(e,t,r,n,s,i,o){if(r)return t.flags&256?(t.flags&=-257,n=sw(Error(bt(422))),xx(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,s=t.mode,n=Py({mode:"visible",children:n.children},s,0,null),i=cd(i,s,o,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&Ef(t,e.child,null,o),t.child.memoizedState=iN(o),t.memoizedState=aN,i);if(!(t.mode&1))return xx(e,t,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(bt(419)),n=sw(i,n,void 0),xx(e,t,o,n)}if(l=(o&e.childLanes)!==0,Ga||l){if(n=Ls,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,lc(e,s),Mo(n,e,s,-1))}return k4(),n=sw(Error(bt(421))),xx(e,t,o,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=fM.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,wi=oA(s.nextSibling),Ci=t,kn=!0,Do=null,e!==null&&(to[ro++]=Kl,to[ro++]=zl,to[ro++]=Nd,Kl=e.id,zl=e.overflow,Nd=t),t=C4(t,n.children),t.flags|=4096,t)}function g3(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Zb(e.return,t,r)}function aw(e,t,r,n,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function a_(e,t,r){var n=t.pendingProps,s=n.revealOrder,i=n.tail;if(Sa(e,t,n.children,r),n=Un.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&g3(e,r,t);else if(e.tag===19)g3(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(gn(Un,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&p1(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),aw(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&p1(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}aw(t,!0,r,null,i);break;case"together":aw(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Fg(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function cc(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),jd|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(bt(153));if(t.child!==null){for(e=t.child,r=dA(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=dA(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function tM(e,t,r){switch(t.tag){case 3:n_(t),Ff();break;case 5:T6(t);break;case 1:Xa(t.type)&&A1(t);break;case 4:p4(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;gn(f1,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(gn(Un,Un.current&1),t.flags|=128,null):r&t.child.childLanes?s_(e,t,r):(gn(Un,Un.current&1),e=cc(e,t,r),e!==null?e.sibling:null);gn(Un,Un.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return a_(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),gn(Un,Un.current),n)break;return null;case 22:case 23:return t.lanes=0,t_(e,t,r)}return cc(e,t,r)}var i_,oN,o_,l_;i_=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};oN=function(){};o_=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,nd(xl.current);var i=null;switch(r){case"input":s=Eb(e,s),n=Eb(e,n),i=[];break;case"select":s=Rn({},s,{value:void 0}),n=Rn({},n,{value:void 0}),i=[];break;case"textarea":s=_b(e,s),n=_b(e,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=l1)}Lb(r,n);var o;r=null;for(A in s)if(!n.hasOwnProperty(A)&&s.hasOwnProperty(A)&&s[A]!=null)if(A==="style"){var l=s[A];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else A!=="dangerouslySetInnerHTML"&&A!=="children"&&A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&A!=="autoFocus"&&(Wh.hasOwnProperty(A)?i||(i=[]):(i=i||[]).push(A,null));for(A in n){var c=n[A];if(l=s!=null?s[A]:void 0,n.hasOwnProperty(A)&&c!==l&&(c!=null||l!=null))if(A==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(i||(i=[]),i.push(A,r)),r=c;else A==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(A,c)):A==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(A,""+c):A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&(Wh.hasOwnProperty(A)?(c!=null&&A==="onScroll"&&wn("scroll",e),i||l===c||(i=[])):(i=i||[]).push(A,c))}r&&(i=i||[]).push("style",r);var A=i;(t.updateQueue=A)&&(t.flags|=4)}};l_=function(e,t,r,n){r!==n&&(t.flags|=4)};function q0(e,t){if(!kn)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function ta(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function rM(e,t,r){var n=t.pendingProps;switch(c4(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ta(t),null;case 1:return Xa(t.type)&&c1(),ta(t),null;case 3:return n=t.stateNode,kf(),jn(Wa),jn(ya),g4(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(mx(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Do!==null&&(mN(Do),Do=null))),oN(e,t),ta(t),null;case 5:x4(t);var s=nd(om.current);if(r=t.type,e!==null&&t.stateNode!=null)o_(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(bt(166));return ta(t),null}if(e=nd(xl.current),mx(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[ul]=t,n[am]=i,e=(t.mode&1)!==0,r){case"dialog":wn("cancel",n),wn("close",n);break;case"iframe":case"object":case"embed":wn("load",n);break;case"video":case"audio":for(s=0;s<Ah.length;s++)wn(Ah[s],n);break;case"source":wn("error",n);break;case"img":case"image":case"link":wn("error",n),wn("load",n);break;case"details":wn("toggle",n);break;case"input":SB(n,i),wn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},wn("invalid",n);break;case"textarea":EB(n,i),wn("invalid",n)}Lb(r,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&hx(n.textContent,l,e),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&hx(n.textContent,l,e),s=["children",""+l]):Wh.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&wn("scroll",n)}switch(r){case"input":ix(n),FB(n,i,!0);break;case"textarea":ix(n),kB(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=l1)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=DT(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[ul]=t,e[am]=n,i_(e,t,!1,!1),t.stateNode=e;e:{switch(o=Ub(r,n),r){case"dialog":wn("cancel",e),wn("close",e),s=n;break;case"iframe":case"object":case"embed":wn("load",e),s=n;break;case"video":case"audio":for(s=0;s<Ah.length;s++)wn(Ah[s],e);s=n;break;case"source":wn("error",e),s=n;break;case"img":case"image":case"link":wn("error",e),wn("load",e),s=n;break;case"details":wn("toggle",e),s=n;break;case"input":SB(e,n),s=Eb(e,n),wn("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=Rn({},n,{value:void 0}),wn("invalid",e);break;case"textarea":EB(e,n),s=_b(e,n),wn("invalid",e);break;default:s=n}Lb(r,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?RT(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&PT(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Xh(e,c):typeof c=="number"&&Xh(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Wh.hasOwnProperty(i)?c!=null&&i==="onScroll"&&wn("scroll",e):c!=null&&G5(e,i,c,o))}switch(r){case"input":ix(e),FB(e,n,!1);break;case"textarea":ix(e),kB(e);break;case"option":n.value!=null&&e.setAttribute("value",""+hA(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?lf(e,!!n.multiple,i,!1):n.defaultValue!=null&&lf(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=l1)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ta(t),null;case 6:if(e&&t.stateNode!=null)l_(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(bt(166));if(r=nd(om.current),nd(xl.current),mx(t)){if(n=t.stateNode,r=t.memoizedProps,n[ul]=t,(i=n.nodeValue!==r)&&(e=Ci,e!==null))switch(e.tag){case 3:hx(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&hx(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ul]=t,t.stateNode=n}return ta(t),null;case 13:if(jn(Un),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(kn&&wi!==null&&t.mode&1&&!(t.flags&128))B6(),Ff(),t.flags|=98560,i=!1;else if(i=mx(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(bt(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(bt(317));i[ul]=t}else Ff(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ta(t),i=!1}else Do!==null&&(mN(Do),Do=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Un.current&1?bs===0&&(bs=3):k4())),t.updateQueue!==null&&(t.flags|=4),ta(t),null);case 4:return kf(),oN(e,t),e===null&&nm(t.stateNode.containerInfo),ta(t),null;case 10:return f4(t.type._context),ta(t),null;case 17:return Xa(t.type)&&c1(),ta(t),null;case 19:if(jn(Un),i=t.memoizedState,i===null)return ta(t),null;if(n=(t.flags&128)!==0,o=i.rendering,o===null)if(n)q0(i,!1);else{if(bs!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=p1(e),o!==null){for(t.flags|=128,q0(i,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return gn(Un,Un.current&1|2),t.child}e=e.sibling}i.tail!==null&&ts()>_f&&(t.flags|=128,n=!0,q0(i,!1),t.lanes=4194304)}else{if(!n)if(e=p1(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),q0(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!kn)return ta(t),null}else 2*ts()-i.renderingStartTime>_f&&r!==1073741824&&(t.flags|=128,n=!0,q0(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=ts(),t.sibling=null,r=Un.current,gn(Un,n?r&1|2:r&1),t):(ta(t),null);case 22:case 23:return E4(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?mi&1073741824&&(ta(t),t.subtreeFlags&6&&(t.flags|=8192)):ta(t),null;case 24:return null;case 25:return null}throw Error(bt(156,t.tag))}function nM(e,t){switch(c4(t),t.tag){case 1:return Xa(t.type)&&c1(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return kf(),jn(Wa),jn(ya),g4(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return x4(t),null;case 13:if(jn(Un),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(bt(340));Ff()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return jn(Un),null;case 4:return kf(),null;case 10:return f4(t.type._context),null;case 22:case 23:return E4(),null;case 24:return null;default:return null}}var gx=!1,fa=!1,sM=typeof WeakSet=="function"?WeakSet:Set,Kt=null;function Zu(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){$n(e,t,n)}else r.current=null}function lN(e,t,r){try{r()}catch(n){$n(e,t,n)}}var y3=!1;function aM(e,t){if(qb=a1,e=f6(),o4(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,A=0,d=0,u=e,f=null;t:for(;;){for(var h;u!==r||s!==0&&u.nodeType!==3||(l=o+s),u!==i||n!==0&&u.nodeType!==3||(c=o+n),u.nodeType===3&&(o+=u.nodeValue.length),(h=u.firstChild)!==null;)f=u,u=h;for(;;){if(u===e)break t;if(f===r&&++A===s&&(l=o),f===i&&++d===n&&(c=o),(h=u.nextSibling)!==null)break;u=f,f=u.parentNode}u=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Kb={focusedElem:e,selectionRange:r},a1=!1,Kt=t;Kt!==null;)if(t=Kt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Kt=e;else for(;Kt!==null;){t=Kt;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var m=x.memoizedProps,g=x.memoizedState,p=t.stateNode,v=p.getSnapshotBeforeUpdate(t.elementType===t.type?m:Io(t.type,m),g);p.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(bt(163))}}catch(B){$n(t,t.return,B)}if(e=t.sibling,e!==null){e.return=t.return,Kt=e;break}Kt=t.return}return x=y3,y3=!1,x}function Fh(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&lN(t,r,i)}s=s.next}while(s!==n)}}function Uy(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function cN(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function c_(e){var t=e.alternate;t!==null&&(e.alternate=null,c_(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ul],delete t[am],delete t[Wb],delete t[MQ],delete t[HQ])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function A_(e){return e.tag===5||e.tag===3||e.tag===4}function v3(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||A_(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function AN(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=l1));else if(n!==4&&(e=e.child,e!==null))for(AN(e,t,r),e=e.sibling;e!==null;)AN(e,t,r),e=e.sibling}function dN(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(dN(e,t,r),e=e.sibling;e!==null;)dN(e,t,r),e=e.sibling}var Hs=null,Uo=!1;function Lc(e,t,r){for(r=r.child;r!==null;)d_(e,t,r),r=r.sibling}function d_(e,t,r){if(pl&&typeof pl.onCommitFiberUnmount=="function")try{pl.onCommitFiberUnmount(Sy,r)}catch{}switch(r.tag){case 5:fa||Zu(r,t);case 6:var n=Hs,s=Uo;Hs=null,Lc(e,t,r),Hs=n,Uo=s,Hs!==null&&(Uo?(e=Hs,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Hs.removeChild(r.stateNode));break;case 18:Hs!==null&&(Uo?(e=Hs,r=r.stateNode,e.nodeType===8?J2(e.parentNode,r):e.nodeType===1&&J2(e,r),em(e)):J2(Hs,r.stateNode));break;case 4:n=Hs,s=Uo,Hs=r.stateNode.containerInfo,Uo=!0,Lc(e,t,r),Hs=n,Uo=s;break;case 0:case 11:case 14:case 15:if(!fa&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&lN(r,t,o),s=s.next}while(s!==n)}Lc(e,t,r);break;case 1:if(!fa&&(Zu(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){$n(r,t,l)}Lc(e,t,r);break;case 21:Lc(e,t,r);break;case 22:r.mode&1?(fa=(n=fa)||r.memoizedState!==null,Lc(e,t,r),fa=n):Lc(e,t,r);break;default:Lc(e,t,r)}}function w3(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new sM),t.forEach(function(n){var s=hM.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function So(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:Hs=l.stateNode,Uo=!1;break e;case 3:Hs=l.stateNode.containerInfo,Uo=!0;break e;case 4:Hs=l.stateNode.containerInfo,Uo=!0;break e}l=l.return}if(Hs===null)throw Error(bt(160));d_(i,o,s),Hs=null,Uo=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(A){$n(s,t,A)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)u_(t,e),t=t.sibling}function u_(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(So(t,e),el(e),n&4){try{Fh(3,e,e.return),Uy(3,e)}catch(m){$n(e,e.return,m)}try{Fh(5,e,e.return)}catch(m){$n(e,e.return,m)}}break;case 1:So(t,e),el(e),n&512&&r!==null&&Zu(r,r.return);break;case 5:if(So(t,e),el(e),n&512&&r!==null&&Zu(r,r.return),e.flags&32){var s=e.stateNode;try{Xh(s,"")}catch(m){$n(e,e.return,m)}}if(n&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&LT(s,i),Ub(l,o);var A=Ub(l,i);for(o=0;o<c.length;o+=2){var d=c[o],u=c[o+1];d==="style"?RT(s,u):d==="dangerouslySetInnerHTML"?PT(s,u):d==="children"?Xh(s,u):G5(s,d,u,A)}switch(l){case"input":kb(s,i);break;case"textarea":UT(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?lf(s,!!i.multiple,h,!1):f!==!!i.multiple&&(i.defaultValue!=null?lf(s,!!i.multiple,i.defaultValue,!0):lf(s,!!i.multiple,i.multiple?[]:"",!1))}s[am]=i}catch(m){$n(e,e.return,m)}}break;case 6:if(So(t,e),el(e),n&4){if(e.stateNode===null)throw Error(bt(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(m){$n(e,e.return,m)}}break;case 3:if(So(t,e),el(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{em(t.containerInfo)}catch(m){$n(e,e.return,m)}break;case 4:So(t,e),el(e);break;case 13:So(t,e),el(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(S4=ts())),n&4&&w3(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(fa=(A=fa)||d,So(t,e),fa=A):So(t,e),el(e),n&8192){if(A=e.memoizedState!==null,(e.stateNode.isHidden=A)&&!d&&e.mode&1)for(Kt=e,d=e.child;d!==null;){for(u=Kt=d;Kt!==null;){switch(f=Kt,h=f.child,f.tag){case 0:case 11:case 14:case 15:Fh(4,f,f.return);break;case 1:Zu(f,f.return);var x=f.stateNode;if(typeof x.componentWillUnmount=="function"){n=f,r=f.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(m){$n(n,r,m)}}break;case 5:Zu(f,f.return);break;case 22:if(f.memoizedState!==null){N3(u);continue}}h!==null?(h.return=f,Kt=h):N3(u)}d=d.sibling}e:for(d=null,u=e;;){if(u.tag===5){if(d===null){d=u;try{s=u.stateNode,A?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=u.stateNode,c=u.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=OT("display",o))}catch(m){$n(e,e.return,m)}}}else if(u.tag===6){if(d===null)try{u.stateNode.nodeValue=A?"":u.memoizedProps}catch(m){$n(e,e.return,m)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===e)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;u.sibling===null;){if(u.return===null||u.return===e)break e;d===u&&(d=null),u=u.return}d===u&&(d=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:So(t,e),el(e),n&4&&w3(e);break;case 21:break;default:So(t,e),el(e)}}function el(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(A_(r)){var n=r;break e}r=r.return}throw Error(bt(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Xh(s,""),n.flags&=-33);var i=v3(e);dN(e,i,s);break;case 3:case 4:var o=n.stateNode.containerInfo,l=v3(e);AN(e,l,o);break;default:throw Error(bt(161))}}catch(c){$n(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function iM(e,t,r){Kt=e,f_(e)}function f_(e,t,r){for(var n=(e.mode&1)!==0;Kt!==null;){var s=Kt,i=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||gx;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||fa;l=gx;var A=fa;if(gx=o,(fa=c)&&!A)for(Kt=s;Kt!==null;)o=Kt,c=o.child,o.tag===22&&o.memoizedState!==null?C3(s):c!==null?(c.return=o,Kt=c):C3(s);for(;i!==null;)Kt=i,f_(i),i=i.sibling;Kt=s,gx=l,fa=A}b3(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Kt=i):b3(e)}}function b3(e){for(;Kt!==null;){var t=Kt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:fa||Uy(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!fa)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:Io(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&i3(t,i,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}i3(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var A=t.alternate;if(A!==null){var d=A.memoizedState;if(d!==null){var u=d.dehydrated;u!==null&&em(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(bt(163))}fa||t.flags&512&&cN(t)}catch(f){$n(t,t.return,f)}}if(t===e){Kt=null;break}if(r=t.sibling,r!==null){r.return=t.return,Kt=r;break}Kt=t.return}}function N3(e){for(;Kt!==null;){var t=Kt;if(t===e){Kt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Kt=r;break}Kt=t.return}}function C3(e){for(;Kt!==null;){var t=Kt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Uy(4,t)}catch(c){$n(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){$n(t,s,c)}}var i=t.return;try{cN(t)}catch(c){$n(t,i,c)}break;case 5:var o=t.return;try{cN(t)}catch(c){$n(t,o,c)}}}catch(c){$n(t,t.return,c)}if(t===e){Kt=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Kt=l;break}Kt=t.return}}var oM=Math.ceil,y1=hc.ReactCurrentDispatcher,j4=hc.ReactCurrentOwner,lo=hc.ReactCurrentBatchConfig,Pr=0,Ls=null,xs=null,Gs=0,mi=0,ef=SA(0),bs=0,dm=null,jd=0,Dy=0,B4=0,Eh=null,Ka=null,S4=0,_f=1/0,Hl=null,v1=!1,uN=null,cA=null,yx=!1,Gc=null,w1=0,kh=0,fN=null,Eg=-1,kg=0;function Ia(){return Pr&6?ts():Eg!==-1?Eg:Eg=ts()}function AA(e){return e.mode&1?Pr&2&&Gs!==0?Gs&-Gs:$Q.transition!==null?(kg===0&&(kg=YT()),kg):(e=sn,e!==0||(e=window.event,e=e===void 0?16:s6(e.type)),e):1}function Mo(e,t,r,n){if(50<kh)throw kh=0,fN=null,Error(bt(185));Mm(e,r,n),(!(Pr&2)||e!==Ls)&&(e===Ls&&(!(Pr&2)&&(Dy|=r),bs===4&&qc(e,Gs)),Ya(e,n),r===1&&Pr===0&&!(t.mode&1)&&(_f=ts()+500,_y&&FA()))}function Ya(e,t){var r=e.callbackNode;$R(e,t);var n=s1(e,e===Ls?Gs:0);if(n===0)r!==null&&IB(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&IB(r),t===1)e.tag===0?VQ(j3.bind(null,e)):N6(j3.bind(null,e)),RQ(function(){!(Pr&6)&&FA()}),r=null;else{switch(JT(n)){case 1:r=Z5;break;case 4:r=WT;break;case 16:r=n1;break;case 536870912:r=XT;break;default:r=n1}r=w_(r,h_.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function h_(e,t){if(Eg=-1,kg=0,Pr&6)throw Error(bt(327));var r=e.callbackNode;if(ff()&&e.callbackNode!==r)return null;var n=s1(e,e===Ls?Gs:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=b1(e,n);else{t=n;var s=Pr;Pr|=2;var i=p_();(Ls!==e||Gs!==t)&&(Hl=null,_f=ts()+500,ld(e,t));do try{AM();break}catch(l){m_(e,l)}while(!0);u4(),y1.current=i,Pr=s,xs!==null?t=0:(Ls=null,Gs=0,t=bs)}if(t!==0){if(t===2&&(s=Qb(e),s!==0&&(n=s,t=hN(e,s))),t===1)throw r=dm,ld(e,0),qc(e,n),Ya(e,ts()),r;if(t===6)qc(e,n);else{if(s=e.current.alternate,!(n&30)&&!lM(s)&&(t=b1(e,n),t===2&&(i=Qb(e),i!==0&&(n=i,t=hN(e,i))),t===1))throw r=dm,ld(e,0),qc(e,n),Ya(e,ts()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(bt(345));case 2:GA(e,Ka,Hl);break;case 3:if(qc(e,n),(n&130023424)===n&&(t=S4+500-ts(),10<t)){if(s1(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){Ia(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Gb(GA.bind(null,e,Ka,Hl),t);break}GA(e,Ka,Hl);break;case 4:if(qc(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var o=31-Qo(n);i=1<<o,o=t[o],o>s&&(s=o),n&=~i}if(n=s,n=ts()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*oM(n/1960))-n,10<n){e.timeoutHandle=Gb(GA.bind(null,e,Ka,Hl),n);break}GA(e,Ka,Hl);break;case 5:GA(e,Ka,Hl);break;default:throw Error(bt(329))}}}return Ya(e,ts()),e.callbackNode===r?h_.bind(null,e):null}function hN(e,t){var r=Eh;return e.current.memoizedState.isDehydrated&&(ld(e,t).flags|=256),e=b1(e,t),e!==2&&(t=Ka,Ka=r,t!==null&&mN(t)),e}function mN(e){Ka===null?Ka=e:Ka.push.apply(Ka,e)}function lM(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!$o(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function qc(e,t){for(t&=~B4,t&=~Dy,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Qo(t),n=1<<r;e[r]=-1,t&=~n}}function j3(e){if(Pr&6)throw Error(bt(327));ff();var t=s1(e,0);if(!(t&1))return Ya(e,ts()),null;var r=b1(e,t);if(e.tag!==0&&r===2){var n=Qb(e);n!==0&&(t=n,r=hN(e,n))}if(r===1)throw r=dm,ld(e,0),qc(e,t),Ya(e,ts()),r;if(r===6)throw Error(bt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,GA(e,Ka,Hl),Ya(e,ts()),null}function F4(e,t){var r=Pr;Pr|=1;try{return e(t)}finally{Pr=r,Pr===0&&(_f=ts()+500,_y&&FA())}}function Bd(e){Gc!==null&&Gc.tag===0&&!(Pr&6)&&ff();var t=Pr;Pr|=1;var r=lo.transition,n=sn;try{if(lo.transition=null,sn=1,e)return e()}finally{sn=n,lo.transition=r,Pr=t,!(Pr&6)&&FA()}}function E4(){mi=ef.current,jn(ef)}function ld(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,OQ(r)),xs!==null)for(r=xs.return;r!==null;){var n=r;switch(c4(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&c1();break;case 3:kf(),jn(Wa),jn(ya),g4();break;case 5:x4(n);break;case 4:kf();break;case 13:jn(Un);break;case 19:jn(Un);break;case 10:f4(n.type._context);break;case 22:case 23:E4()}r=r.return}if(Ls=e,xs=e=dA(e.current,null),Gs=mi=t,bs=0,dm=null,B4=Dy=jd=0,Ka=Eh=null,rd!==null){for(t=0;t<rd.length;t++)if(r=rd[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=s,n.next=o}r.pending=n}rd=null}return e}function m_(e,t){do{var r=xs;try{if(u4(),Bg.current=g1,x1){for(var n=On.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}x1=!1}if(Cd=0,ks=ys=On=null,Sh=!1,lm=0,j4.current=null,r===null||r.return===null){bs=1,dm=t,xs=null;break}e:{var i=e,o=r.return,l=r,c=t;if(t=Gs,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var A=c,d=l,u=d.tag;if(!(d.mode&1)&&(u===0||u===11||u===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=u3(o);if(h!==null){h.flags&=-257,f3(h,o,l,i,t),h.mode&1&&d3(i,A,t),t=h,c=A;var x=t.updateQueue;if(x===null){var m=new Set;m.add(c),t.updateQueue=m}else x.add(c);break e}else{if(!(t&1)){d3(i,A,t),k4();break e}c=Error(bt(426))}}else if(kn&&l.mode&1){var g=u3(o);if(g!==null){!(g.flags&65536)&&(g.flags|=256),f3(g,o,l,i,t),A4(Tf(c,l));break e}}i=c=Tf(c,l),bs!==4&&(bs=2),Eh===null?Eh=[i]:Eh.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var p=J6(i,c,t);a3(i,p);break e;case 1:l=c;var v=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(cA===null||!cA.has(w)))){i.flags|=65536,t&=-t,i.lanes|=t;var B=Z6(i,l,t);a3(i,B);break e}}i=i.return}while(i!==null)}g_(r)}catch(T){t=T,xs===r&&r!==null&&(xs=r=r.return);continue}break}while(!0)}function p_(){var e=y1.current;return y1.current=g1,e===null?g1:e}function k4(){(bs===0||bs===3||bs===2)&&(bs=4),Ls===null||!(jd&268435455)&&!(Dy&268435455)||qc(Ls,Gs)}function b1(e,t){var r=Pr;Pr|=2;var n=p_();(Ls!==e||Gs!==t)&&(Hl=null,ld(e,t));do try{cM();break}catch(s){m_(e,s)}while(!0);if(u4(),Pr=r,y1.current=n,xs!==null)throw Error(bt(261));return Ls=null,Gs=0,bs}function cM(){for(;xs!==null;)x_(xs)}function AM(){for(;xs!==null&&!UR();)x_(xs)}function x_(e){var t=v_(e.alternate,e,mi);e.memoizedProps=e.pendingProps,t===null?g_(e):xs=t,j4.current=null}function g_(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=nM(r,t),r!==null){r.flags&=32767,xs=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{bs=6,xs=null;return}}else if(r=rM(r,t,mi),r!==null){xs=r;return}if(t=t.sibling,t!==null){xs=t;return}xs=t=e}while(t!==null);bs===0&&(bs=5)}function GA(e,t,r){var n=sn,s=lo.transition;try{lo.transition=null,sn=1,dM(e,t,r,n)}finally{lo.transition=s,sn=n}return null}function dM(e,t,r,n){do ff();while(Gc!==null);if(Pr&6)throw Error(bt(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(bt(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(qR(e,i),e===Ls&&(xs=Ls=null,Gs=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||yx||(yx=!0,w_(n1,function(){return ff(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=lo.transition,lo.transition=null;var o=sn;sn=1;var l=Pr;Pr|=4,j4.current=null,aM(e,r),u_(r,e),TQ(Kb),a1=!!qb,Kb=qb=null,e.current=r,iM(r),DR(),Pr=l,sn=o,lo.transition=i}else e.current=r;if(yx&&(yx=!1,Gc=e,w1=s),i=e.pendingLanes,i===0&&(cA=null),RR(r.stateNode),Ya(e,ts()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(v1)throw v1=!1,e=uN,uN=null,e;return w1&1&&e.tag!==0&&ff(),i=e.pendingLanes,i&1?e===fN?kh++:(kh=0,fN=e):kh=0,FA(),null}function ff(){if(Gc!==null){var e=JT(w1),t=lo.transition,r=sn;try{if(lo.transition=null,sn=16>e?16:e,Gc===null)var n=!1;else{if(e=Gc,Gc=null,w1=0,Pr&6)throw Error(bt(331));var s=Pr;for(Pr|=4,Kt=e.current;Kt!==null;){var i=Kt,o=i.child;if(Kt.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var A=l[c];for(Kt=A;Kt!==null;){var d=Kt;switch(d.tag){case 0:case 11:case 15:Fh(8,d,i)}var u=d.child;if(u!==null)u.return=d,Kt=u;else for(;Kt!==null;){d=Kt;var f=d.sibling,h=d.return;if(c_(d),d===A){Kt=null;break}if(f!==null){f.return=h,Kt=f;break}Kt=h}}}var x=i.alternate;if(x!==null){var m=x.child;if(m!==null){x.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}Kt=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Kt=o;else e:for(;Kt!==null;){if(i=Kt,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Fh(9,i,i.return)}var p=i.sibling;if(p!==null){p.return=i.return,Kt=p;break e}Kt=i.return}}var v=e.current;for(Kt=v;Kt!==null;){o=Kt;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,Kt=w;else e:for(o=v;Kt!==null;){if(l=Kt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Uy(9,l)}}catch(T){$n(l,l.return,T)}if(l===o){Kt=null;break e}var B=l.sibling;if(B!==null){B.return=l.return,Kt=B;break e}Kt=l.return}}if(Pr=s,FA(),pl&&typeof pl.onPostCommitFiberRoot=="function")try{pl.onPostCommitFiberRoot(Sy,e)}catch{}n=!0}return n}finally{sn=r,lo.transition=t}}return!1}function B3(e,t,r){t=Tf(r,t),t=J6(e,t,1),e=lA(e,t,1),t=Ia(),e!==null&&(Mm(e,1,t),Ya(e,t))}function $n(e,t,r){if(e.tag===3)B3(e,e,r);else for(;t!==null;){if(t.tag===3){B3(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(cA===null||!cA.has(n))){e=Tf(r,e),e=Z6(t,e,1),t=lA(t,e,1),e=Ia(),t!==null&&(Mm(t,1,e),Ya(t,e));break}}t=t.return}}function uM(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Ia(),e.pingedLanes|=e.suspendedLanes&r,Ls===e&&(Gs&r)===r&&(bs===4||bs===3&&(Gs&130023424)===Gs&&500>ts()-S4?ld(e,0):B4|=r),Ya(e,t)}function y_(e,t){t===0&&(e.mode&1?(t=cx,cx<<=1,!(cx&130023424)&&(cx=4194304)):t=1);var r=Ia();e=lc(e,t),e!==null&&(Mm(e,t,r),Ya(e,r))}function fM(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),y_(e,r)}function hM(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(bt(314))}n!==null&&n.delete(t),y_(e,r)}var v_;v_=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Wa.current)Ga=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Ga=!1,tM(e,t,r);Ga=!!(e.flags&131072)}else Ga=!1,kn&&t.flags&1048576&&C6(t,u1,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Fg(e,t),e=t.pendingProps;var s=Sf(t,ya.current);uf(t,r),s=v4(null,t,n,e,s,r);var i=w4();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Xa(n)?(i=!0,A1(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,m4(t),s.updater=Ly,t.stateNode=s,s._reactInternals=t,tN(t,n,e,r),t=sN(null,t,n,!0,i,r)):(t.tag=0,kn&&i&&l4(t),Sa(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Fg(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=pM(n),e=Io(n,e),s){case 0:t=nN(null,t,n,e,r);break e;case 1:t=p3(null,t,n,e,r);break e;case 11:t=h3(null,t,n,e,r);break e;case 14:t=m3(null,t,n,Io(n.type,e),r);break e}throw Error(bt(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Io(n,s),nN(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Io(n,s),p3(e,t,n,s,r);case 3:e:{if(n_(t),e===null)throw Error(bt(387));n=t.pendingProps,i=t.memoizedState,s=i.element,k6(e,t),m1(t,n,null,r);var o=t.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=Tf(Error(bt(423)),t),t=x3(e,t,n,r,s);break e}else if(n!==s){s=Tf(Error(bt(424)),t),t=x3(e,t,n,r,s);break e}else for(wi=oA(t.stateNode.containerInfo.firstChild),Ci=t,kn=!0,Do=null,r=F6(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Ff(),n===s){t=cc(e,t,r);break e}Sa(e,t,n,r)}t=t.child}return t;case 5:return T6(t),e===null&&Jb(t),n=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,zb(n,s)?o=null:i!==null&&zb(n,i)&&(t.flags|=32),r_(e,t),Sa(e,t,o,r),t.child;case 6:return e===null&&Jb(t),null;case 13:return s_(e,t,r);case 4:return p4(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Ef(t,null,n,r):Sa(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Io(n,s),h3(e,t,n,s,r);case 7:return Sa(e,t,t.pendingProps,r),t.child;case 8:return Sa(e,t,t.pendingProps.children,r),t.child;case 12:return Sa(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,gn(f1,n._currentValue),n._currentValue=o,i!==null)if($o(i.value,o)){if(i.children===s.children&&!Wa.current){t=cc(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=Yl(-1,r&-r),c.tag=2;var A=i.updateQueue;if(A!==null){A=A.shared;var d=A.pending;d===null?c.next=c:(c.next=d.next,d.next=c),A.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),Zb(i.return,r,t),l.lanes|=r;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(bt(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Zb(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Sa(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,uf(t,r),s=Ao(s),n=n(s),t.flags|=1,Sa(e,t,n,r),t.child;case 14:return n=t.type,s=Io(n,t.pendingProps),s=Io(n.type,s),m3(e,t,n,s,r);case 15:return e_(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Io(n,s),Fg(e,t),t.tag=1,Xa(n)?(e=!0,A1(t)):e=!1,uf(t,r),Y6(t,n,s),tN(t,n,s,r),sN(null,t,n,!0,e,r);case 19:return a_(e,t,r);case 22:return t_(e,t,r)}throw Error(bt(156,t.tag))};function w_(e,t){return GT(e,t)}function mM(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ao(e,t,r,n){return new mM(e,t,r,n)}function T4(e){return e=e.prototype,!(!e||!e.isReactComponent)}function pM(e){if(typeof e=="function")return T4(e)?1:0;if(e!=null){if(e=e.$$typeof,e===X5)return 11;if(e===Y5)return 14}return 2}function dA(e,t){var r=e.alternate;return r===null?(r=ao(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Tg(e,t,r,n,s,i){var o=2;if(n=e,typeof e=="function")T4(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case $u:return cd(r.children,s,i,t);case W5:o=8,s|=8;break;case jb:return e=ao(12,r,t,s|2),e.elementType=jb,e.lanes=i,e;case Bb:return e=ao(13,r,t,s),e.elementType=Bb,e.lanes=i,e;case Sb:return e=ao(19,r,t,s),e.elementType=Sb,e.lanes=i,e;case TT:return Py(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ET:o=10;break e;case kT:o=9;break e;case X5:o=11;break e;case Y5:o=14;break e;case Mc:o=16,n=null;break e}throw Error(bt(130,e==null?e:typeof e,""))}return t=ao(o,r,t,s),t.elementType=e,t.type=n,t.lanes=i,t}function cd(e,t,r,n){return e=ao(7,e,n,t),e.lanes=r,e}function Py(e,t,r,n){return e=ao(22,e,n,t),e.elementType=TT,e.lanes=r,e.stateNode={isHidden:!1},e}function iw(e,t,r){return e=ao(6,e,null,t),e.lanes=r,e}function ow(e,t,r){return t=ao(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function xM(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=M2(0),this.expirationTimes=M2(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=M2(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function _4(e,t,r,n,s,i,o,l,c){return e=new xM(e,t,r,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=ao(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},m4(i),e}function gM(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Vu,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function b_(e){if(!e)return mA;e=e._reactInternals;e:{if(Rd(e)!==e||e.tag!==1)throw Error(bt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Xa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(bt(171))}if(e.tag===1){var r=e.type;if(Xa(r))return b6(e,r,t)}return t}function N_(e,t,r,n,s,i,o,l,c){return e=_4(r,n,!0,e,s,i,o,l,c),e.context=b_(null),r=e.current,n=Ia(),s=AA(r),i=Yl(n,s),i.callback=t??null,lA(r,i,s),e.current.lanes=s,Mm(e,s,n),Ya(e,n),e}function Oy(e,t,r,n){var s=t.current,i=Ia(),o=AA(s);return r=b_(r),t.context===null?t.context=r:t.pendingContext=r,t=Yl(i,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=lA(s,t,o),e!==null&&(Mo(e,s,o,i),jg(e,s,o)),o}function N1(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function S3(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function I4(e,t){S3(e,t),(e=e.alternate)&&S3(e,t)}function yM(){return null}var C_=typeof reportError=="function"?reportError:function(e){console.error(e)};function L4(e){this._internalRoot=e}Ry.prototype.render=L4.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(bt(409));Oy(e,t,null,null)};Ry.prototype.unmount=L4.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Bd(function(){Oy(null,e,null,null)}),t[oc]=null}};function Ry(e){this._internalRoot=e}Ry.prototype.unstable_scheduleHydration=function(e){if(e){var t=t6();e={blockedOn:null,target:e,priority:t};for(var r=0;r<$c.length&&t!==0&&t<$c[r].priority;r++);$c.splice(r,0,e),r===0&&n6(e)}};function U4(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Qy(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function F3(){}function vM(e,t,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var A=N1(o);i.call(A)}}var o=N_(t,n,e,0,null,!1,!1,"",F3);return e._reactRootContainer=o,e[oc]=o.current,nm(e.nodeType===8?e.parentNode:e),Bd(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var A=N1(c);l.call(A)}}var c=_4(e,0,!1,null,null,!1,!1,"",F3);return e._reactRootContainer=c,e[oc]=c.current,nm(e.nodeType===8?e.parentNode:e),Bd(function(){Oy(t,c,r,n)}),c}function My(e,t,r,n,s){var i=r._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=N1(o);l.call(c)}}Oy(t,o,e,s)}else o=vM(r,t,e,s,n);return N1(o)}ZT=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ch(t.pendingLanes);r!==0&&(e4(t,r|1),Ya(t,ts()),!(Pr&6)&&(_f=ts()+500,FA()))}break;case 13:Bd(function(){var n=lc(e,1);if(n!==null){var s=Ia();Mo(n,e,1,s)}}),I4(e,1)}};t4=function(e){if(e.tag===13){var t=lc(e,134217728);if(t!==null){var r=Ia();Mo(t,e,134217728,r)}I4(e,134217728)}};e6=function(e){if(e.tag===13){var t=AA(e),r=lc(e,t);if(r!==null){var n=Ia();Mo(r,e,t,n)}I4(e,t)}};t6=function(){return sn};r6=function(e,t){var r=sn;try{return sn=e,t()}finally{sn=r}};Pb=function(e,t,r){switch(t){case"input":if(kb(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=Ty(n);if(!s)throw Error(bt(90));IT(n),kb(n,s)}}}break;case"textarea":UT(e,r);break;case"select":t=r.value,t!=null&&lf(e,!!r.multiple,t,!1)}};HT=F4;VT=Bd;var wM={usingClientEntryPoint:!1,Events:[Vm,Gu,Ty,QT,MT,F4]},K0={findFiberByHostInstance:td,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},bM={bundleType:K0.bundleType,version:K0.version,rendererPackageName:K0.rendererPackageName,rendererConfig:K0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:hc.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=KT(e),e===null?null:e.stateNode},findFiberByHostInstance:K0.findFiberByHostInstance||yM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vx=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vx.isDisabled&&vx.supportsFiber)try{Sy=vx.inject(bM),pl=vx}catch{}}_i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wM;_i.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!U4(t))throw Error(bt(200));return gM(e,t,null,r)};_i.createRoot=function(e,t){if(!U4(e))throw Error(bt(299));var r=!1,n="",s=C_;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=_4(e,1,!1,null,null,r,!1,n,s),e[oc]=t.current,nm(e.nodeType===8?e.parentNode:e),new L4(t)};_i.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(bt(188)):(e=Object.keys(e).join(","),Error(bt(268,e)));return e=KT(t),e=e===null?null:e.stateNode,e};_i.flushSync=function(e){return Bd(e)};_i.hydrate=function(e,t,r){if(!Qy(t))throw Error(bt(200));return My(null,e,t,!0,r)};_i.hydrateRoot=function(e,t,r){if(!U4(e))throw Error(bt(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",o=C_;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=N_(t,null,e,1,r??null,s,!1,i,o),e[oc]=t.current,nm(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Ry(t)};_i.render=function(e,t,r){if(!Qy(t))throw Error(bt(200));return My(null,e,t,!1,r)};_i.unmountComponentAtNode=function(e){if(!Qy(e))throw Error(bt(40));return e._reactRootContainer?(Bd(function(){My(null,null,e,!1,function(){e._reactRootContainer=null,e[oc]=null})}),!0):!1};_i.unstable_batchedUpdates=F4;_i.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Qy(r))throw Error(bt(200));if(e==null||e._reactInternals===void 0)throw Error(bt(38));return My(e,t,r,!1,n)};_i.version="18.3.1-next-f1338f8080-20240426";function j_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(j_)}catch(e){console.error(e)}}j_(),jT.exports=_i;var B_=jT.exports,E3=B_;Nb.createRoot=E3.createRoot,Nb.hydrateRoot=E3.hydrateRoot;var D4={};Object.defineProperty(D4,"__esModule",{value:!0});D4.parse=EM;D4.serialize=kM;const NM=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,CM=/^[\u0021-\u003A\u003C-\u007E]*$/,jM=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,BM=/^[\u0020-\u003A\u003D-\u007E]*$/,SM=Object.prototype.toString,FM=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function EM(e,t){const r=new FM,n=e.length;if(n<2)return r;const s=(t==null?void 0:t.decode)||TM;let i=0;do{const o=e.indexOf("=",i);if(o===-1)break;const l=e.indexOf(";",i),c=l===-1?n:l;if(o>c){i=e.lastIndexOf(";",o-1)+1;continue}const A=k3(e,i,o),d=T3(e,o,A),u=e.slice(A,d);if(r[u]===void 0){let f=k3(e,o+1,c),h=T3(e,c,f);const x=s(e.slice(f,h));r[u]=x}i=c+1}while(i<n);return r}function k3(e,t,r){do{const n=e.charCodeAt(t);if(n!==32&&n!==9)return t}while(++t<r);return r}function T3(e,t,r){for(;t>r;){const n=e.charCodeAt(--t);if(n!==32&&n!==9)return t+1}return r}function kM(e,t,r){const n=(r==null?void 0:r.encode)||encodeURIComponent;if(!NM.test(e))throw new TypeError(`argument name is invalid: ${e}`);const s=n(t);if(!CM.test(s))throw new TypeError(`argument val is invalid: ${t}`);let i=e+"="+s;if(!r)return i;if(r.maxAge!==void 0){if(!Number.isInteger(r.maxAge))throw new TypeError(`option maxAge is invalid: ${r.maxAge}`);i+="; Max-Age="+r.maxAge}if(r.domain){if(!jM.test(r.domain))throw new TypeError(`option domain is invalid: ${r.domain}`);i+="; Domain="+r.domain}if(r.path){if(!BM.test(r.path))throw new TypeError(`option path is invalid: ${r.path}`);i+="; Path="+r.path}if(r.expires){if(!_M(r.expires)||!Number.isFinite(r.expires.valueOf()))throw new TypeError(`option expires is invalid: ${r.expires}`);i+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(i+="; HttpOnly"),r.secure&&(i+="; Secure"),r.partitioned&&(i+="; Partitioned"),r.priority)switch(typeof r.priority=="string"?r.priority.toLowerCase():void 0){case"low":i+="; Priority=Low";break;case"medium":i+="; Priority=Medium";break;case"high":i+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${r.priority}`)}if(r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:case"strict":i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"none":i+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${r.sameSite}`)}return i}function TM(e){if(e.indexOf("%")===-1)return e;try{return decodeURIComponent(e)}catch{return e}}function _M(e){return SM.call(e)==="[object Date]"}/**
 * react-router v7.0.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var _3="popstate";function IM(e={}){function t(n,s){let{pathname:i,search:o,hash:l}=n.location;return pN("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:um(s)}return UM(t,r,null,e)}function Tn(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function fo(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function LM(){return Math.random().toString(36).substring(2,10)}function I3(e,t){return{usr:e.state,key:e.key,idx:t}}function pN(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Kf(t):t,state:r,key:t&&t.key||n||LM()}}function um({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Kf(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function UM(e,t,r,n={}){let{window:s=document.defaultView,v5Compat:i=!1}=n,o=s.history,l="POP",c=null,A=d();A==null&&(A=0,o.replaceState({...o.state,idx:A},""));function d(){return(o.state||{idx:null}).idx}function u(){l="POP";let g=d(),p=g==null?null:g-A;A=g,c&&c({action:l,location:m.location,delta:p})}function f(g,p){l="PUSH";let v=pN(m.location,g,p);A=d()+1;let w=I3(v,A),B=m.createHref(v);try{o.pushState(w,"",B)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;s.location.assign(B)}i&&c&&c({action:l,location:m.location,delta:1})}function h(g,p){l="REPLACE";let v=pN(m.location,g,p);A=d();let w=I3(v,A),B=m.createHref(v);o.replaceState(w,"",B),i&&c&&c({action:l,location:m.location,delta:0})}function x(g){let p=s.location.origin!=="null"?s.location.origin:s.location.href,v=typeof g=="string"?g:um(g);return v=v.replace(/ $/,"%20"),Tn(p,`No window.location.(origin|href) available to create URL for href: ${v}`),new URL(v,p)}let m={get action(){return l},get location(){return e(s,o)},listen(g){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(_3,u),c=g,()=>{s.removeEventListener(_3,u),c=null}},createHref(g){return t(s,g)},createURL:x,encodeLocation(g){let p=x(g);return{pathname:p.pathname,search:p.search,hash:p.hash}},push:f,replace:h,go(g){return o.go(g)}};return m}function S_(e,t,r="/"){return DM(e,t,r,!1)}function DM(e,t,r,n){let s=typeof t=="string"?Kf(t):t,i=pA(s.pathname||"/",r);if(i==null)return null;let o=F_(e);PM(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let A=GM(i);l=KM(o[c],A,n)}return l}function F_(e,t=[],r=[],n=""){let s=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(Tn(c.relativePath.startsWith(n),`Absolute route path "${c.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(n.length));let A=Jl([n,c.relativePath]),d=r.concat(c);i.children&&i.children.length>0&&(Tn(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${A}".`),F_(i.children,t,d,A)),!(i.path==null&&!i.index)&&t.push({path:A,score:$M(A,i.index),routesMeta:d})};return e.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let c of E_(i.path))s(i,o,c)}),t}function E_(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let o=E_(n.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function PM(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:qM(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var OM=/^:[\w-]+$/,RM=3,QM=2,MM=1,HM=10,VM=-2,L3=e=>e==="*";function $M(e,t){let r=e.split("/"),n=r.length;return r.some(L3)&&(n+=VM),t&&(n+=QM),r.filter(s=>!L3(s)).reduce((s,i)=>s+(OM.test(i)?RM:i===""?MM:HM),n)}function qM(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function KM(e,t,r=!1){let{routesMeta:n}=e,s={},i="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],A=l===n.length-1,d=i==="/"?t:t.slice(i.length)||"/",u=C1({path:c.relativePath,caseSensitive:c.caseSensitive,end:A},d),f=c.route;if(!u&&A&&r&&!n[n.length-1].route.index&&(u=C1({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!u)return null;Object.assign(s,u.params),o.push({params:s,pathname:Jl([i,u.pathname]),pathnameBase:JM(Jl([i,u.pathnameBase])),route:f}),u.pathnameBase!=="/"&&(i=Jl([i,u.pathnameBase]))}return o}function C1(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=zM(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:n.reduce((A,{paramName:d,isOptional:u},f)=>{if(d==="*"){let x=l[f]||"";o=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const h=l[f];return u&&!h?A[d]=void 0:A[d]=(h||"").replace(/%2F/g,"/"),A},{}),pathname:i,pathnameBase:o,pattern:e}}function zM(e,t=!1,r=!0){fo(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function GM(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return fo(!1,`The URL path "${e}" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function pA(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function WM(e,t="/"){let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?Kf(e):e;return{pathname:r?r.startsWith("/")?r:XM(r,t):t,search:ZM(n),hash:e9(s)}}function XM(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function lw(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function YM(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function P4(e){let t=YM(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function O4(e,t,r,n=!1){let s;typeof e=="string"?s=Kf(e):(s={...e},Tn(!s.pathname||!s.pathname.includes("?"),lw("?","pathname","search",s)),Tn(!s.pathname||!s.pathname.includes("#"),lw("#","pathname","hash",s)),Tn(!s.search||!s.search.includes("#"),lw("#","search","hash",s)));let i=e===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=r;else{let u=t.length-1;if(!n&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),u-=1;s.pathname=f.join("/")}l=u>=0?t[u]:"/"}let c=WM(s,l),A=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(A||d)&&(c.pathname+="/"),c}var Jl=e=>e.join("/").replace(/\/\/+/g,"/"),JM=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),ZM=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,e9=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function t9(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var k_=["POST","PUT","PATCH","DELETE"];new Set(k_);var r9=["GET",...k_];new Set(r9);var zf=C.createContext(null);zf.displayName="DataRouter";var Hy=C.createContext(null);Hy.displayName="DataRouterState";var T_=C.createContext({isTransitioning:!1});T_.displayName="ViewTransition";var n9=C.createContext(new Map);n9.displayName="Fetchers";var s9=C.createContext(null);s9.displayName="Await";var qo=C.createContext(null);qo.displayName="Navigation";var qm=C.createContext(null);qm.displayName="Location";var go=C.createContext({outlet:null,matches:[],isDataRoute:!1});go.displayName="Route";var R4=C.createContext(null);R4.displayName="RouteError";function a9(e,{relative:t}={}){Tn(Gf(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=C.useContext(qo),{hash:s,pathname:i,search:o}=Km(e,{relative:t}),l=i;return r!=="/"&&(l=i==="/"?r:Jl([r,i])),n.createHref({pathname:l,search:o,hash:s})}function Gf(){return C.useContext(qm)!=null}function wl(){return Tn(Gf(),"useLocation() may be used only in the context of a <Router> component."),C.useContext(qm).location}var __="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function I_(e){C.useContext(qo).static||C.useLayoutEffect(e)}function Sr(){let{isDataRoute:e}=C.useContext(go);return e?v9():i9()}function i9(){Tn(Gf(),"useNavigate() may be used only in the context of a <Router> component.");let e=C.useContext(zf),{basename:t,navigator:r}=C.useContext(qo),{matches:n}=C.useContext(go),{pathname:s}=wl(),i=JSON.stringify(P4(n)),o=C.useRef(!1);return I_(()=>{o.current=!0}),C.useCallback((c,A={})=>{if(fo(o.current,__),!o.current)return;if(typeof c=="number"){r.go(c);return}let d=O4(c,JSON.parse(i),s,A.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Jl([t,d.pathname])),(A.replace?r.replace:r.push)(d,A.state,A)},[t,r,i,s,e])}var o9=C.createContext(null);function l9(e){let t=C.useContext(go).outlet;return t&&C.createElement(o9.Provider,{value:e},t)}function yo(){let{matches:e}=C.useContext(go),t=e[e.length-1];return t?t.params:{}}function Km(e,{relative:t}={}){let{matches:r}=C.useContext(go),{pathname:n}=wl(),s=JSON.stringify(P4(r));return C.useMemo(()=>O4(e,JSON.parse(s),n,t==="path"),[e,s,n,t])}function c9(e,t){return L_(e,t)}function L_(e,t,r,n){var p;Tn(Gf(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=C.useContext(qo),{matches:i}=C.useContext(go),o=i[i.length-1],l=o?o.params:{},c=o?o.pathname:"/",A=o?o.pathnameBase:"/",d=o&&o.route;{let v=d&&d.path||"";U_(c,!d||v.endsWith("*")||v.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${v}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${v}"> to <Route path="${v==="/"?"*":`${v}/*`}">.`)}let u=wl(),f;if(t){let v=typeof t=="string"?Kf(t):t;Tn(A==="/"||((p=v.pathname)==null?void 0:p.startsWith(A)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${A}" but pathname "${v.pathname}" was given in the \`location\` prop.`),f=v}else f=u;let h=f.pathname||"/",x=h;if(A!=="/"){let v=A.replace(/^\//,"").split("/");x="/"+h.replace(/^\//,"").split("/").slice(v.length).join("/")}let m=S_(e,{pathname:x});fo(d||m!=null,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),fo(m==null||m[m.length-1].route.element!==void 0||m[m.length-1].route.Component!==void 0||m[m.length-1].route.lazy!==void 0,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let g=h9(m&&m.map(v=>Object.assign({},v,{params:Object.assign({},l,v.params),pathname:Jl([A,s.encodeLocation?s.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?A:Jl([A,s.encodeLocation?s.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),i,r,n);return t&&g?C.createElement(qm.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...f},navigationType:"POP"}},g):g}function A9(){let e=y9(),t=t9(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=C.createElement(C.Fragment,null,C.createElement("p",null," Hey developer "),C.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",C.createElement("code",{style:i},"ErrorBoundary")," or"," ",C.createElement("code",{style:i},"errorElement")," prop on your route.")),C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},t),r?C.createElement("pre",{style:s},r):null,o)}var d9=C.createElement(A9,null),u9=class extends C.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?C.createElement(go.Provider,{value:this.props.routeContext},C.createElement(R4.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function f9({routeContext:e,match:t,children:r}){let n=C.useContext(zf);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),C.createElement(go.Provider,{value:e},r)}function h9(e,t=[],r=null,n=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let s=e,i=r==null?void 0:r.errors;if(i!=null){let c=s.findIndex(A=>A.route.id&&(i==null?void 0:i[A.route.id])!==void 0);Tn(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),s=s.slice(0,Math.min(s.length,c+1))}let o=!1,l=-1;if(r)for(let c=0;c<s.length;c++){let A=s[c];if((A.route.HydrateFallback||A.route.hydrateFallbackElement)&&(l=c),A.route.id){let{loaderData:d,errors:u}=r,f=A.route.loader&&!d.hasOwnProperty(A.route.id)&&(!u||u[A.route.id]===void 0);if(A.route.lazy||f){o=!0,l>=0?s=s.slice(0,l+1):s=[s[0]];break}}}return s.reduceRight((c,A,d)=>{let u,f=!1,h=null,x=null;r&&(u=i&&A.route.id?i[A.route.id]:void 0,h=A.route.errorElement||d9,o&&(l<0&&d===0?(U_("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),f=!0,x=null):l===d&&(f=!0,x=A.route.hydrateFallbackElement||null)));let m=t.concat(s.slice(0,d+1)),g=()=>{let p;return u?p=h:f?p=x:A.route.Component?p=C.createElement(A.route.Component,null):A.route.element?p=A.route.element:p=c,C.createElement(f9,{match:A,routeContext:{outlet:c,matches:m,isDataRoute:r!=null},children:p})};return r&&(A.route.ErrorBoundary||A.route.errorElement||d===0)?C.createElement(u9,{location:r.location,revalidation:r.revalidation,component:h,error:u,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()},null)}function Q4(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function m9(e){let t=C.useContext(zf);return Tn(t,Q4(e)),t}function p9(e){let t=C.useContext(Hy);return Tn(t,Q4(e)),t}function x9(e){let t=C.useContext(go);return Tn(t,Q4(e)),t}function M4(e){let t=x9(e),r=t.matches[t.matches.length-1];return Tn(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function g9(){return M4("useRouteId")}function y9(){var n;let e=C.useContext(R4),t=p9("useRouteError"),r=M4("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function v9(){let{router:e}=m9("useNavigate"),t=M4("useNavigate"),r=C.useRef(!1);return I_(()=>{r.current=!0}),C.useCallback(async(s,i={})=>{fo(r.current,__),r.current&&(typeof s=="number"?e.navigate(s):await e.navigate(s,{fromRouteId:t,...i}))},[e,t])}var U3={};function U_(e,t,r){!t&&!U3[e]&&(U3[e]=!0,fo(!1,r))}C.memo(w9);function w9({routes:e,future:t,state:r}){return L_(e,void 0,r,t)}function b9({to:e,replace:t,state:r,relative:n}){Tn(Gf(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=C.useContext(qo);fo(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=C.useContext(go),{pathname:o}=wl(),l=Sr(),c=O4(e,P4(i),o,n==="path"),A=JSON.stringify(c);return C.useEffect(()=>{l(JSON.parse(A),{replace:t,state:r,relative:n})},[l,A,n,t,r]),null}function N9(e){return l9(e.context)}function Xt(e){Tn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function C9({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:s,static:i=!1}){Tn(!Gf(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),l=C.useMemo(()=>({basename:o,navigator:s,static:i,future:{}}),[o,s,i]);typeof r=="string"&&(r=Kf(r));let{pathname:c="/",search:A="",hash:d="",state:u=null,key:f="default"}=r,h=C.useMemo(()=>{let x=pA(c,o);return x==null?null:{location:{pathname:x,search:A,hash:d,state:u,key:f},navigationType:n}},[o,c,A,d,u,f,n]);return fo(h!=null,`<Router basename="${o}"> is not able to match the URL "${c}${A}${d}" because it does not start with the basename, so the <Router> won't render anything.`),h==null?null:C.createElement(qo.Provider,{value:l},C.createElement(qm.Provider,{children:t,value:h}))}function j9({children:e,location:t}){return c9(xN(e),t)}function xN(e,t=[]){let r=[];return C.Children.forEach(e,(n,s)=>{if(!C.isValidElement(n))return;let i=[...t,s];if(n.type===C.Fragment){r.push.apply(r,xN(n.props.children,i));return}Tn(n.type===Xt,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Tn(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=xN(n.props.children,i)),r.push(o)}),r}var _g="get",Ig="application/x-www-form-urlencoded";function Vy(e){return e!=null&&typeof e.tagName=="string"}function B9(e){return Vy(e)&&e.tagName.toLowerCase()==="button"}function S9(e){return Vy(e)&&e.tagName.toLowerCase()==="form"}function F9(e){return Vy(e)&&e.tagName.toLowerCase()==="input"}function E9(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function k9(e,t){return e.button===0&&(!t||t==="_self")&&!E9(e)}function gN(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(s=>[r,s]):[[r,n]])},[]))}function T9(e,t){let r=gN(e);return t&&t.forEach((n,s)=>{r.has(s)||t.getAll(s).forEach(i=>{r.append(s,i)})}),r}var wx=null;function _9(){if(wx===null)try{new FormData(document.createElement("form"),0),wx=!1}catch{wx=!0}return wx}var I9=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function cw(e){return e!=null&&!I9.has(e)?(fo(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ig}"`),null):e}function L9(e,t){let r,n,s,i,o;if(S9(e)){let l=e.getAttribute("action");n=l?pA(l,t):null,r=e.getAttribute("method")||_g,s=cw(e.getAttribute("enctype"))||Ig,i=new FormData(e)}else if(B9(e)||F9(e)&&(e.type==="submit"||e.type==="image")){let l=e.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=e.getAttribute("formaction")||l.getAttribute("action");if(n=c?pA(c,t):null,r=e.getAttribute("formmethod")||l.getAttribute("method")||_g,s=cw(e.getAttribute("formenctype"))||cw(l.getAttribute("enctype"))||Ig,i=new FormData(l,e),!_9()){let{name:A,type:d,value:u}=e;if(d==="image"){let f=A?`${A}.`:"";i.append(`${f}x`,"0"),i.append(`${f}y`,"0")}else A&&i.append(A,u)}}else{if(Vy(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=_g,n=null,s=Ig,o=e}return i&&s==="text/plain"&&(o=i,i=void 0),{action:n,method:r.toLowerCase(),encType:s,formData:i,body:o}}function H4(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function U9(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function D9(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function P9(e,t,r){let n=await Promise.all(e.map(async s=>{let i=t.routes[s.route.id];if(i){let o=await U9(i,r);return o.links?o.links():[]}return[]}));return M9(n.flat(1).filter(D9).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function D3(e,t,r,n,s,i){let o=(c,A)=>r[A]?c.route.id!==r[A].route.id:!0,l=(c,A)=>{var d;return r[A].pathname!==c.pathname||((d=r[A].route.path)==null?void 0:d.endsWith("*"))&&r[A].params["*"]!==c.params["*"]};return i==="assets"?t.filter((c,A)=>o(c,A)||l(c,A)):i==="data"?t.filter((c,A)=>{var u;let d=n.routes[c.route.id];if(!d||!d.hasLoader)return!1;if(o(c,A)||l(c,A))return!0;if(c.route.shouldRevalidate){let f=c.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((u=r[0])==null?void 0:u.params)||{},nextUrl:new URL(e,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function O9(e,t){return R9(e.map(r=>{let n=t.routes[r.route.id];if(!n)return[];let s=[n.module];return n.imports&&(s=s.concat(n.imports)),s}).flat(1))}function R9(e){return[...new Set(e)]}function Q9(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function M9(e,t){let r=new Set;return new Set(t),e.reduce((n,s)=>{let i=JSON.stringify(Q9(s));return r.has(i)||(r.add(i),n.push({key:i,link:s})),n},[])}function H9(e){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function V9(){let e=C.useContext(zf);return H4(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function $9(){let e=C.useContext(Hy);return H4(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var V4=C.createContext(void 0);V4.displayName="FrameworkContext";function D_(){let e=C.useContext(V4);return H4(e,"You must render this element inside a <HydratedRouter> element"),e}function q9(e,t){let r=C.useContext(V4),[n,s]=C.useState(!1),[i,o]=C.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:A,onMouseLeave:d,onTouchStart:u}=t,f=C.useRef(null);C.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let m=p=>{p.forEach(v=>{o(v.isIntersecting)})},g=new IntersectionObserver(m,{threshold:.5});return f.current&&g.observe(f.current),()=>{g.disconnect()}}},[e]),C.useEffect(()=>{if(n){let m=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(m)}}},[n]);let h=()=>{s(!0)},x=()=>{s(!1),o(!1)};return r?e!=="intent"?[i,f,{}]:[i,f,{onFocus:z0(l,h),onBlur:z0(c,x),onMouseEnter:z0(A,h),onMouseLeave:z0(d,x),onTouchStart:z0(u,h)}]:[!1,f,{}]}function z0(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function K9({page:e,...t}){let{router:r}=V9(),n=C.useMemo(()=>S_(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?C.createElement(G9,{page:e,matches:n,...t}):(console.warn(`Tried to prefetch ${e} but no routes matched.`),null)}function z9(e){let{manifest:t,routeModules:r}=D_(),[n,s]=C.useState([]);return C.useEffect(()=>{let i=!1;return P9(e,t,r).then(o=>{i||s(o)}),()=>{i=!0}},[e,t,r]),n}function G9({page:e,matches:t,...r}){let n=wl(),{manifest:s,routeModules:i}=D_(),{loaderData:o,matches:l}=$9(),c=C.useMemo(()=>D3(e,t,l,s,n,"data"),[e,t,l,s,n]),A=C.useMemo(()=>D3(e,t,l,s,n,"assets"),[e,t,l,s,n]),d=C.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let h=new Set,x=!1;if(t.forEach(g=>{var v;let p=s.routes[g.route.id];!p||!p.hasLoader||(!c.some(w=>w.route.id===g.route.id)&&g.route.id in o&&((v=i[g.route.id])!=null&&v.shouldRevalidate)||p.hasClientLoader?x=!0:h.add(g.route.id))}),h.size===0)return[];let m=H9(e);return x&&h.size>0&&m.searchParams.set("_routes",t.filter(g=>h.has(g.route.id)).map(g=>g.route.id).join(",")),[m.pathname+m.search]},[o,n,s,c,t,e,i]),u=C.useMemo(()=>O9(A,s),[A,s]),f=z9(A);return C.createElement(C.Fragment,null,d.map(h=>C.createElement("link",{key:h,rel:"prefetch",as:"fetch",href:h,...r})),u.map(h=>C.createElement("link",{key:h,rel:"modulepreload",href:h,...r})),f.map(({key:h,link:x})=>C.createElement("link",{key:h,...x})))}function W9(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var P_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{P_&&(window.__reactRouterVersion="7.0.2")}catch{}function X9({basename:e,children:t,window:r}){let n=C.useRef();n.current==null&&(n.current=IM({window:r,v5Compat:!0}));let s=n.current,[i,o]=C.useState({action:s.action,location:s.location}),l=C.useCallback(c=>{C.startTransition(()=>o(c))},[o]);return C.useLayoutEffect(()=>s.listen(l),[s,l]),C.createElement(C9,{basename:e,children:t,location:i.location,navigationType:i.action,navigator:s})}var O_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,$y=C.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:s,reloadDocument:i,replace:o,state:l,target:c,to:A,preventScrollReset:d,viewTransition:u,...f},h){let{basename:x}=C.useContext(qo),m=typeof A=="string"&&O_.test(A),g,p=!1;if(typeof A=="string"&&m&&(g=A,P_))try{let L=new URL(window.location.href),M=A.startsWith("//")?new URL(L.protocol+A):new URL(A),F=pA(M.pathname,x);M.origin===L.origin&&F!=null?A=F+M.search+M.hash:p=!0}catch{fo(!1,`<Link to="${A}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let v=a9(A,{relative:s}),[w,B,T]=q9(n,f),_=eH(A,{replace:o,state:l,target:c,preventScrollReset:d,relative:s,viewTransition:u});function j(L){t&&t(L),L.defaultPrevented||_(L)}let E=C.createElement("a",{...f,...T,href:g||v,onClick:p||i?t:j,ref:W9(h,B),target:c,"data-discover":!m&&r==="render"?"true":void 0});return w&&!m?C.createElement(C.Fragment,null,E,C.createElement(K9,{page:v})):E});$y.displayName="Link";var Y9=C.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:s=!1,style:i,to:o,viewTransition:l,children:c,...A},d){let u=Km(o,{relative:A.relative}),f=wl(),h=C.useContext(Hy),{navigator:x,basename:m}=C.useContext(qo),g=h!=null&&iH(u)&&l===!0,p=x.encodeLocation?x.encodeLocation(u).pathname:u.pathname,v=f.pathname,w=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;r||(v=v.toLowerCase(),w=w?w.toLowerCase():null,p=p.toLowerCase()),w&&m&&(w=pA(w,m)||w);const B=p!=="/"&&p.endsWith("/")?p.length-1:p.length;let T=v===p||!s&&v.startsWith(p)&&v.charAt(B)==="/",_=w!=null&&(w===p||!s&&w.startsWith(p)&&w.charAt(p.length)==="/"),j={isActive:T,isPending:_,isTransitioning:g},E=T?t:void 0,L;typeof n=="function"?L=n(j):L=[n,T?"active":null,_?"pending":null,g?"transitioning":null].filter(Boolean).join(" ");let M=typeof i=="function"?i(j):i;return C.createElement($y,{...A,"aria-current":E,className:L,ref:d,style:M,to:o,viewTransition:l},typeof c=="function"?c(j):c)});Y9.displayName="NavLink";var J9=C.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:s,state:i,method:o=_g,action:l,onSubmit:c,relative:A,preventScrollReset:d,viewTransition:u,...f},h)=>{let x=sH(),m=aH(l,{relative:A}),g=o.toLowerCase()==="get"?"get":"post",p=typeof l=="string"&&O_.test(l),v=w=>{if(c&&c(w),w.defaultPrevented)return;w.preventDefault();let B=w.nativeEvent.submitter,T=(B==null?void 0:B.getAttribute("formmethod"))||o;x(B||w.currentTarget,{fetcherKey:t,method:T,navigate:r,replace:s,state:i,relative:A,preventScrollReset:d,viewTransition:u})};return C.createElement("form",{ref:h,method:g,action:m,onSubmit:n?c:v,...f,"data-discover":!p&&e==="render"?"true":void 0})});J9.displayName="Form";function Z9(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function R_(e){let t=C.useContext(zf);return Tn(t,Z9(e)),t}function eH(e,{target:t,replace:r,state:n,preventScrollReset:s,relative:i,viewTransition:o}={}){let l=Sr(),c=wl(),A=Km(e,{relative:i});return C.useCallback(d=>{if(k9(d,t)){d.preventDefault();let u=r!==void 0?r:um(c)===um(A);l(e,{replace:u,state:n,preventScrollReset:s,relative:i,viewTransition:o})}},[c,l,A,r,n,t,e,s,i,o])}function tH(e){fo(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=C.useRef(gN(e)),r=C.useRef(!1),n=wl(),s=C.useMemo(()=>T9(n.search,r.current?null:t.current),[n.search]),i=Sr(),o=C.useCallback((l,c)=>{const A=gN(typeof l=="function"?l(s):l);r.current=!0,i("?"+A,c)},[i,s]);return[s,o]}var rH=0,nH=()=>`__${String(++rH)}__`;function sH(){let{router:e}=R_("useSubmit"),{basename:t}=C.useContext(qo),r=g9();return C.useCallback(async(n,s={})=>{let{action:i,method:o,encType:l,formData:c,body:A}=L9(n,t);if(s.navigate===!1){let d=s.fetcherKey||nH();await e.fetch(d,r,s.action||i,{preventScrollReset:s.preventScrollReset,formData:c,body:A,formMethod:s.method||o,formEncType:s.encType||l,flushSync:s.flushSync})}else await e.navigate(s.action||i,{preventScrollReset:s.preventScrollReset,formData:c,body:A,formMethod:s.method||o,formEncType:s.encType||l,replace:s.replace,state:s.state,fromRouteId:r,flushSync:s.flushSync,viewTransition:s.viewTransition})},[e,t,r])}function aH(e,{relative:t}={}){let{basename:r}=C.useContext(qo),n=C.useContext(go);Tn(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),i={...Km(e||".",{relative:t})},o=wl();if(e==null){i.search=o.search;let l=new URLSearchParams(i.search),c=l.getAll("index");if(c.some(d=>d==="")){l.delete("index"),c.filter(u=>u).forEach(u=>l.append("index",u));let d=l.toString();i.search=d?`?${d}`:""}}return(!e||e===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(i.pathname=i.pathname==="/"?r:Jl([r,i.pathname])),um(i)}function iH(e,t={}){let r=C.useContext(T_);Tn(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=R_("useViewTransitionState"),s=Km(e,{relative:t.relative});if(!r.isTransitioning)return!1;let i=pA(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=pA(r.nextLocation.pathname,n)||r.nextLocation.pathname;return C1(s.pathname,o)!=null||C1(s.pathname,i)!=null}new TextEncoder;/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oH=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Q_=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var lH={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cH=C.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:o,...l},c)=>C.createElement("svg",{ref:c,...lH,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:Q_("lucide",s),...l},[...o.map(([A,d])=>C.createElement(A,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=(e,t)=>{const r=C.forwardRef(({className:n,...s},i)=>C.createElement(cH,{ref:i,iconNode:t,className:Q_(`lucide-${oH(e)}`,n),...s}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qy=Tt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yN=Tt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j1=Tt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AH=Tt("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=Tt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dH=Tt("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P3=Tt("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uH=Tt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O3=Tt("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ho=Tt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vo=Tt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zm=Tt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wf=Tt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bl=Tt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gm=Tt("ChevronsLeft",[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wm=Tt("ChevronsRight",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xA=Tt("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $a=Tt("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=Tt("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aw=Tt("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yi=Tt("CirclePause",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ky=Tt("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M_=Tt("CircleUserRound",[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ea=Tt("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Th=Tt("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ql=Tt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fH=Tt("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gl=Tt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $4=Tt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hH=Tt("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q4=Tt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _n=Tt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mH=Tt("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xf=Tt("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bx=Tt("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Po=Tt("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pH=Tt("FilePen",[["path",{d:"M12.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v9.5",key:"1couwa"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1y4qbx"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K4=Tt("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jr=Tt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B1=Tt("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ti=Tt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R3=Tt("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xH=Tt("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H_=Tt("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gH=Tt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V_=Tt("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fi=Tt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const If=Tt("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yH=Tt("Loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vH=Tt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $_=Tt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wH=Tt("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z4=Tt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bH=Tt("MonitorSmartphone",[["path",{d:"M18 8V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h8",key:"10dyio"}],["path",{d:"M10 19v-3.96 3.15",key:"1irgej"}],["path",{d:"M7 19h5",key:"qswx4l"}],["rect",{width:"6",height:"10",x:"16",y:"12",rx:"2",key:"1egngj"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G4=Tt("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NH=Tt("PanelsTopLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CH=Tt("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jH=Tt("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BH=Tt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yn=Tt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SH=Tt("PowerOff",[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FH=Tt("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EH=Tt("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q3=Tt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q_=Tt("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M3=Tt("ScrollText",[["path",{d:"M15 12h-5",key:"r7krc0"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=Tt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W4=Tt("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K_=Tt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nx=Tt("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=Tt("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z_=Tt("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G_=Tt("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $r=Tt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kH=Tt("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sd=Tt("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W_=Tt("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=Tt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xm=Tt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vN=Tt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _r=Tt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function X_(e,t){return function(){return e.apply(t,arguments)}}const{toString:TH}=Object.prototype,{getPrototypeOf:X4}=Object,zy=(e=>t=>{const r=TH.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Ko=e=>(e=e.toLowerCase(),t=>zy(t)===e),Gy=e=>t=>typeof t===e,{isArray:Yf}=Array,fm=Gy("undefined");function _H(e){return e!==null&&!fm(e)&&e.constructor!==null&&!fm(e.constructor)&&ji(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Y_=Ko("ArrayBuffer");function IH(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Y_(e.buffer),t}const LH=Gy("string"),ji=Gy("function"),J_=Gy("number"),Wy=e=>e!==null&&typeof e=="object",UH=e=>e===!0||e===!1,Lg=e=>{if(zy(e)!=="object")return!1;const t=X4(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},DH=Ko("Date"),PH=Ko("File"),OH=Ko("Blob"),RH=Ko("FileList"),QH=e=>Wy(e)&&ji(e.pipe),MH=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||ji(e.append)&&((t=zy(e))==="formdata"||t==="object"&&ji(e.toString)&&e.toString()==="[object FormData]"))},HH=Ko("URLSearchParams"),[VH,$H,qH,KH]=["ReadableStream","Request","Response","Headers"].map(Ko),zH=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ym(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,s;if(typeof e!="object"&&(e=[e]),Yf(e))for(n=0,s=e.length;n<s;n++)t.call(null,e[n],n,e);else{const i=r?Object.getOwnPropertyNames(e):Object.keys(e),o=i.length;let l;for(n=0;n<o;n++)l=i[n],t.call(null,e[l],l,e)}}function Z_(e,t){t=t.toLowerCase();const r=Object.keys(e);let n=r.length,s;for(;n-- >0;)if(s=r[n],t===s.toLowerCase())return s;return null}const ad=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,eI=e=>!fm(e)&&e!==ad;function wN(){const{caseless:e}=eI(this)&&this||{},t={},r=(n,s)=>{const i=e&&Z_(t,s)||s;Lg(t[i])&&Lg(n)?t[i]=wN(t[i],n):Lg(n)?t[i]=wN({},n):Yf(n)?t[i]=n.slice():t[i]=n};for(let n=0,s=arguments.length;n<s;n++)arguments[n]&&Ym(arguments[n],r);return t}const GH=(e,t,r,{allOwnKeys:n}={})=>(Ym(t,(s,i)=>{r&&ji(s)?e[i]=X_(s,r):e[i]=s},{allOwnKeys:n}),e),WH=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),XH=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},YH=(e,t,r,n)=>{let s,i,o;const l={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),i=s.length;i-- >0;)o=s[i],(!n||n(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=r!==!1&&X4(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},JH=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},ZH=e=>{if(!e)return null;if(Yf(e))return e;let t=e.length;if(!J_(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},eV=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&X4(Uint8Array)),tV=(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let s;for(;(s=n.next())&&!s.done;){const i=s.value;t.call(e,i[0],i[1])}},rV=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},nV=Ko("HTMLFormElement"),sV=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,s){return n.toUpperCase()+s}),H3=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),aV=Ko("RegExp"),tI=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};Ym(r,(s,i)=>{let o;(o=t(s,i,e))!==!1&&(n[i]=o||s)}),Object.defineProperties(e,n)},iV=e=>{tI(e,(t,r)=>{if(ji(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(ji(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},oV=(e,t)=>{const r={},n=s=>{s.forEach(i=>{r[i]=!0})};return Yf(e)?n(e):n(String(e).split(t)),r},lV=()=>{},cV=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t,dw="abcdefghijklmnopqrstuvwxyz",V3="0123456789",rI={DIGIT:V3,ALPHA:dw,ALPHA_DIGIT:dw+dw.toUpperCase()+V3},AV=(e=16,t=rI.ALPHA_DIGIT)=>{let r="";const{length:n}=t;for(;e--;)r+=t[Math.random()*n|0];return r};function dV(e){return!!(e&&ji(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const uV=e=>{const t=new Array(10),r=(n,s)=>{if(Wy(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[s]=n;const i=Yf(n)?[]:{};return Ym(n,(o,l)=>{const c=r(o,s+1);!fm(c)&&(i[l]=c)}),t[s]=void 0,i}}return n};return r(e,0)},fV=Ko("AsyncFunction"),hV=e=>e&&(Wy(e)||ji(e))&&ji(e.then)&&ji(e.catch),nI=((e,t)=>e?setImmediate:t?((r,n)=>(ad.addEventListener("message",({source:s,data:i})=>{s===ad&&i===r&&n.length&&n.shift()()},!1),s=>{n.push(s),ad.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",ji(ad.postMessage)),mV=typeof queueMicrotask<"u"?queueMicrotask.bind(ad):typeof process<"u"&&process.nextTick||nI,at={isArray:Yf,isArrayBuffer:Y_,isBuffer:_H,isFormData:MH,isArrayBufferView:IH,isString:LH,isNumber:J_,isBoolean:UH,isObject:Wy,isPlainObject:Lg,isReadableStream:VH,isRequest:$H,isResponse:qH,isHeaders:KH,isUndefined:fm,isDate:DH,isFile:PH,isBlob:OH,isRegExp:aV,isFunction:ji,isStream:QH,isURLSearchParams:HH,isTypedArray:eV,isFileList:RH,forEach:Ym,merge:wN,extend:GH,trim:zH,stripBOM:WH,inherits:XH,toFlatObject:YH,kindOf:zy,kindOfTest:Ko,endsWith:JH,toArray:ZH,forEachEntry:tV,matchAll:rV,isHTMLForm:nV,hasOwnProperty:H3,hasOwnProp:H3,reduceDescriptors:tI,freezeMethods:iV,toObjectSet:oV,toCamelCase:sV,noop:lV,toFiniteNumber:cV,findKey:Z_,global:ad,isContextDefined:eI,ALPHABET:rI,generateString:AV,isSpecCompliantForm:dV,toJSONObject:uV,isAsyncFn:fV,isThenable:hV,setImmediate:nI,asap:mV};function vr(e,t,r,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}at.inherits(vr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:at.toJSONObject(this.config),code:this.code,status:this.status}}});const sI=vr.prototype,aI={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{aI[e]={value:e}});Object.defineProperties(vr,aI);Object.defineProperty(sI,"isAxiosError",{value:!0});vr.from=(e,t,r,n,s,i)=>{const o=Object.create(sI);return at.toFlatObject(e,o,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),vr.call(o,e.message,t,r,n,s),o.cause=e,o.name=e.name,i&&Object.assign(o,i),o};const pV=null;function bN(e){return at.isPlainObject(e)||at.isArray(e)}function iI(e){return at.endsWith(e,"[]")?e.slice(0,-2):e}function $3(e,t,r){return e?e.concat(t).map(function(s,i){return s=iI(s),!r&&i?"["+s+"]":s}).join(r?".":""):t}function xV(e){return at.isArray(e)&&!e.some(bN)}const gV=at.toFlatObject(at,{},null,function(t){return/^is[A-Z]/.test(t)});function Xy(e,t,r){if(!at.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=at.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,g){return!at.isUndefined(g[m])});const n=r.metaTokens,s=r.visitor||d,i=r.dots,o=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&at.isSpecCompliantForm(t);if(!at.isFunction(s))throw new TypeError("visitor must be a function");function A(x){if(x===null)return"";if(at.isDate(x))return x.toISOString();if(!c&&at.isBlob(x))throw new vr("Blob is not supported. Use a Buffer instead.");return at.isArrayBuffer(x)||at.isTypedArray(x)?c&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function d(x,m,g){let p=x;if(x&&!g&&typeof x=="object"){if(at.endsWith(m,"{}"))m=n?m:m.slice(0,-2),x=JSON.stringify(x);else if(at.isArray(x)&&xV(x)||(at.isFileList(x)||at.endsWith(m,"[]"))&&(p=at.toArray(x)))return m=iI(m),p.forEach(function(w,B){!(at.isUndefined(w)||w===null)&&t.append(o===!0?$3([m],B,i):o===null?m:m+"[]",A(w))}),!1}return bN(x)?!0:(t.append($3(g,m,i),A(x)),!1)}const u=[],f=Object.assign(gV,{defaultVisitor:d,convertValue:A,isVisitable:bN});function h(x,m){if(!at.isUndefined(x)){if(u.indexOf(x)!==-1)throw Error("Circular reference detected in "+m.join("."));u.push(x),at.forEach(x,function(p,v){(!(at.isUndefined(p)||p===null)&&s.call(t,p,at.isString(v)?v.trim():v,m,f))===!0&&h(p,m?m.concat(v):[v])}),u.pop()}}if(!at.isObject(e))throw new TypeError("data must be an object");return h(e),t}function q3(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function Y4(e,t){this._pairs=[],e&&Xy(e,this,t)}const oI=Y4.prototype;oI.append=function(t,r){this._pairs.push([t,r])};oI.toString=function(t){const r=t?function(n){return t.call(this,n,q3)}:q3;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};function yV(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function lI(e,t,r){if(!t)return e;const n=r&&r.encode||yV;at.isFunction(r)&&(r={serialize:r});const s=r&&r.serialize;let i;if(s?i=s(t,r):i=at.isURLSearchParams(t)?t.toString():new Y4(t,r).toString(n),i){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class K3{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){at.forEach(this.handlers,function(n){n!==null&&t(n)})}}const cI={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},vV=typeof URLSearchParams<"u"?URLSearchParams:Y4,wV=typeof FormData<"u"?FormData:null,bV=typeof Blob<"u"?Blob:null,NV={isBrowser:!0,classes:{URLSearchParams:vV,FormData:wV,Blob:bV},protocols:["http","https","file","blob","url","data"]},J4=typeof window<"u"&&typeof document<"u",NN=typeof navigator=="object"&&navigator||void 0,CV=J4&&(!NN||["ReactNative","NativeScript","NS"].indexOf(NN.product)<0),jV=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",BV=J4&&window.location.href||"http://localhost",SV=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:J4,hasStandardBrowserEnv:CV,hasStandardBrowserWebWorkerEnv:jV,navigator:NN,origin:BV},Symbol.toStringTag,{value:"Module"})),ma={...SV,...NV};function FV(e,t){return Xy(e,new ma.classes.URLSearchParams,Object.assign({visitor:function(r,n,s,i){return ma.isNode&&at.isBuffer(r)?(this.append(n,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},t))}function EV(e){return at.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function kV(e){const t={},r=Object.keys(e);let n;const s=r.length;let i;for(n=0;n<s;n++)i=r[n],t[i]=e[i];return t}function AI(e){function t(r,n,s,i){let o=r[i++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=i>=r.length;return o=!o&&at.isArray(s)?s.length:o,c?(at.hasOwnProp(s,o)?s[o]=[s[o],n]:s[o]=n,!l):((!s[o]||!at.isObject(s[o]))&&(s[o]=[]),t(r,n,s[o],i)&&at.isArray(s[o])&&(s[o]=kV(s[o])),!l)}if(at.isFormData(e)&&at.isFunction(e.entries)){const r={};return at.forEachEntry(e,(n,s)=>{t(EV(n),s,r,0)}),r}return null}function TV(e,t,r){if(at.isString(e))try{return(t||JSON.parse)(e),at.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(0,JSON.stringify)(e)}const Jm={transitional:cI,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",s=n.indexOf("application/json")>-1,i=at.isObject(t);if(i&&at.isHTMLForm(t)&&(t=new FormData(t)),at.isFormData(t))return s?JSON.stringify(AI(t)):t;if(at.isArrayBuffer(t)||at.isBuffer(t)||at.isStream(t)||at.isFile(t)||at.isBlob(t)||at.isReadableStream(t))return t;if(at.isArrayBufferView(t))return t.buffer;if(at.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return FV(t,this.formSerializer).toString();if((l=at.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Xy(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return i||s?(r.setContentType("application/json",!1),TV(t)):t}],transformResponse:[function(t){const r=this.transitional||Jm.transitional,n=r&&r.forcedJSONParsing,s=this.responseType==="json";if(at.isResponse(t)||at.isReadableStream(t))return t;if(t&&at.isString(t)&&(n&&!this.responseType||s)){const o=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(t)}catch(l){if(o)throw l.name==="SyntaxError"?vr.from(l,vr.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ma.classes.FormData,Blob:ma.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};at.forEach(["delete","get","head","post","put","patch"],e=>{Jm.headers[e]={}});const _V=at.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),IV=e=>{const t={};let r,n,s;return e&&e.split(`
`).forEach(function(o){s=o.indexOf(":"),r=o.substring(0,s).trim().toLowerCase(),n=o.substring(s+1).trim(),!(!r||t[r]&&_V[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},z3=Symbol("internals");function G0(e){return e&&String(e).trim().toLowerCase()}function Ug(e){return e===!1||e==null?e:at.isArray(e)?e.map(Ug):String(e)}function LV(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const UV=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function uw(e,t,r,n,s){if(at.isFunction(n))return n.call(this,t,r);if(s&&(t=r),!!at.isString(t)){if(at.isString(n))return t.indexOf(n)!==-1;if(at.isRegExp(n))return n.test(t)}}function DV(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function PV(e,t){const r=at.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(s,i,o){return this[n].call(this,t,s,i,o)},configurable:!0})})}class Ja{constructor(t){t&&this.set(t)}set(t,r,n){const s=this;function i(l,c,A){const d=G0(c);if(!d)throw new Error("header name must be a non-empty string");const u=at.findKey(s,d);(!u||s[u]===void 0||A===!0||A===void 0&&s[u]!==!1)&&(s[u||c]=Ug(l))}const o=(l,c)=>at.forEach(l,(A,d)=>i(A,d,c));if(at.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(at.isString(t)&&(t=t.trim())&&!UV(t))o(IV(t),r);else if(at.isHeaders(t))for(const[l,c]of t.entries())i(c,l,n);else t!=null&&i(r,t,n);return this}get(t,r){if(t=G0(t),t){const n=at.findKey(this,t);if(n){const s=this[n];if(!r)return s;if(r===!0)return LV(s);if(at.isFunction(r))return r.call(this,s,n);if(at.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=G0(t),t){const n=at.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||uw(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let s=!1;function i(o){if(o=G0(o),o){const l=at.findKey(n,o);l&&(!r||uw(n,n[l],l,r))&&(delete n[l],s=!0)}}return at.isArray(t)?t.forEach(i):i(t),s}clear(t){const r=Object.keys(this);let n=r.length,s=!1;for(;n--;){const i=r[n];(!t||uw(this,this[i],i,t,!0))&&(delete this[i],s=!0)}return s}normalize(t){const r=this,n={};return at.forEach(this,(s,i)=>{const o=at.findKey(n,i);if(o){r[o]=Ug(s),delete r[i];return}const l=t?DV(i):String(i).trim();l!==i&&delete r[i],r[l]=Ug(s),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return at.forEach(this,(n,s)=>{n!=null&&n!==!1&&(r[s]=t&&at.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(s=>n.set(s)),n}static accessor(t){const n=(this[z3]=this[z3]={accessors:{}}).accessors,s=this.prototype;function i(o){const l=G0(o);n[l]||(PV(s,o),n[l]=!0)}return at.isArray(t)?t.forEach(i):i(t),this}}Ja.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);at.reduceDescriptors(Ja.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});at.freezeMethods(Ja);function fw(e,t){const r=this||Jm,n=t||r,s=Ja.from(n.headers);let i=n.data;return at.forEach(e,function(l){i=l.call(r,i,s.normalize(),t?t.status:void 0)}),s.normalize(),i}function dI(e){return!!(e&&e.__CANCEL__)}function Jf(e,t,r){vr.call(this,e??"canceled",vr.ERR_CANCELED,t,r),this.name="CanceledError"}at.inherits(Jf,vr,{__CANCEL__:!0});function uI(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new vr("Request failed with status code "+r.status,[vr.ERR_BAD_REQUEST,vr.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function OV(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function RV(e,t){e=e||10;const r=new Array(e),n=new Array(e);let s=0,i=0,o;return t=t!==void 0?t:1e3,function(c){const A=Date.now(),d=n[i];o||(o=A),r[s]=c,n[s]=A;let u=i,f=0;for(;u!==s;)f+=r[u++],u=u%e;if(s=(s+1)%e,s===i&&(i=(i+1)%e),A-o<t)return;const h=d&&A-d;return h?Math.round(f*1e3/h):void 0}}function QV(e,t){let r=0,n=1e3/t,s,i;const o=(A,d=Date.now())=>{r=d,s=null,i&&(clearTimeout(i),i=null),e.apply(null,A)};return[(...A)=>{const d=Date.now(),u=d-r;u>=n?o(A,d):(s=A,i||(i=setTimeout(()=>{i=null,o(s)},n-u)))},()=>s&&o(s)]}const S1=(e,t,r=3)=>{let n=0;const s=RV(50,250);return QV(i=>{const o=i.loaded,l=i.lengthComputable?i.total:void 0,c=o-n,A=s(c),d=o<=l;n=o;const u={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:A||void 0,estimated:A&&l&&d?(l-o)/A:void 0,event:i,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(u)},r)},G3=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},W3=e=>(...t)=>at.asap(()=>e(...t)),MV=ma.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,ma.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(ma.origin),ma.navigator&&/(msie|trident)/i.test(ma.navigator.userAgent)):()=>!0,HV=ma.hasStandardBrowserEnv?{write(e,t,r,n,s,i){const o=[e+"="+encodeURIComponent(t)];at.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),at.isString(n)&&o.push("path="+n),at.isString(s)&&o.push("domain="+s),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function VV(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function $V(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function fI(e,t){return e&&!VV(t)?$V(e,t):t}const X3=e=>e instanceof Ja?{...e}:e;function Sd(e,t){t=t||{};const r={};function n(A,d,u,f){return at.isPlainObject(A)&&at.isPlainObject(d)?at.merge.call({caseless:f},A,d):at.isPlainObject(d)?at.merge({},d):at.isArray(d)?d.slice():d}function s(A,d,u,f){if(at.isUndefined(d)){if(!at.isUndefined(A))return n(void 0,A,u,f)}else return n(A,d,u,f)}function i(A,d){if(!at.isUndefined(d))return n(void 0,d)}function o(A,d){if(at.isUndefined(d)){if(!at.isUndefined(A))return n(void 0,A)}else return n(void 0,d)}function l(A,d,u){if(u in t)return n(A,d);if(u in e)return n(void 0,A)}const c={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(A,d,u)=>s(X3(A),X3(d),u,!0)};return at.forEach(Object.keys(Object.assign({},e,t)),function(d){const u=c[d]||s,f=u(e[d],t[d],d);at.isUndefined(f)&&u!==l||(r[d]=f)}),r}const hI=e=>{const t=Sd({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:i,headers:o,auth:l}=t;t.headers=o=Ja.from(o),t.url=lI(fI(t.baseURL,t.url),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let c;if(at.isFormData(r)){if(ma.hasStandardBrowserEnv||ma.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((c=o.getContentType())!==!1){const[A,...d]=c?c.split(";").map(u=>u.trim()).filter(Boolean):[];o.setContentType([A||"multipart/form-data",...d].join("; "))}}if(ma.hasStandardBrowserEnv&&(n&&at.isFunction(n)&&(n=n(t)),n||n!==!1&&MV(t.url))){const A=s&&i&&HV.read(i);A&&o.set(s,A)}return t},qV=typeof XMLHttpRequest<"u",KV=qV&&function(e){return new Promise(function(r,n){const s=hI(e);let i=s.data;const o=Ja.from(s.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:A}=s,d,u,f,h,x;function m(){h&&h(),x&&x(),s.cancelToken&&s.cancelToken.unsubscribe(d),s.signal&&s.signal.removeEventListener("abort",d)}let g=new XMLHttpRequest;g.open(s.method.toUpperCase(),s.url,!0),g.timeout=s.timeout;function p(){if(!g)return;const w=Ja.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),T={data:!l||l==="text"||l==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:w,config:e,request:g};uI(function(j){r(j),m()},function(j){n(j),m()},T),g=null}"onloadend"in g?g.onloadend=p:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(p)},g.onabort=function(){g&&(n(new vr("Request aborted",vr.ECONNABORTED,e,g)),g=null)},g.onerror=function(){n(new vr("Network Error",vr.ERR_NETWORK,e,g)),g=null},g.ontimeout=function(){let B=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const T=s.transitional||cI;s.timeoutErrorMessage&&(B=s.timeoutErrorMessage),n(new vr(B,T.clarifyTimeoutError?vr.ETIMEDOUT:vr.ECONNABORTED,e,g)),g=null},i===void 0&&o.setContentType(null),"setRequestHeader"in g&&at.forEach(o.toJSON(),function(B,T){g.setRequestHeader(T,B)}),at.isUndefined(s.withCredentials)||(g.withCredentials=!!s.withCredentials),l&&l!=="json"&&(g.responseType=s.responseType),A&&([f,x]=S1(A,!0),g.addEventListener("progress",f)),c&&g.upload&&([u,h]=S1(c),g.upload.addEventListener("progress",u),g.upload.addEventListener("loadend",h)),(s.cancelToken||s.signal)&&(d=w=>{g&&(n(!w||w.type?new Jf(null,e,g):w),g.abort(),g=null)},s.cancelToken&&s.cancelToken.subscribe(d),s.signal&&(s.signal.aborted?d():s.signal.addEventListener("abort",d)));const v=OV(s.url);if(v&&ma.protocols.indexOf(v)===-1){n(new vr("Unsupported protocol "+v+":",vr.ERR_BAD_REQUEST,e));return}g.send(i||null)})},zV=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,s;const i=function(A){if(!s){s=!0,l();const d=A instanceof Error?A:this.reason;n.abort(d instanceof vr?d:new Jf(d instanceof Error?d.message:d))}};let o=t&&setTimeout(()=>{o=null,i(new vr(`timeout ${t} of ms exceeded`,vr.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(A=>{A.unsubscribe?A.unsubscribe(i):A.removeEventListener("abort",i)}),e=null)};e.forEach(A=>A.addEventListener("abort",i));const{signal:c}=n;return c.unsubscribe=()=>at.asap(l),c}},GV=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,s;for(;n<r;)s=n+t,yield e.slice(n,s),n=s},WV=async function*(e,t){for await(const r of XV(e))yield*GV(r,t)},XV=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},Y3=(e,t,r,n)=>{const s=WV(e,t);let i=0,o,l=c=>{o||(o=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:A,value:d}=await s.next();if(A){l(),c.close();return}let u=d.byteLength;if(r){let f=i+=u;r(f)}c.enqueue(new Uint8Array(d))}catch(A){throw l(A),A}},cancel(c){return l(c),s.return()}},{highWaterMark:2})},Yy=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",mI=Yy&&typeof ReadableStream=="function",YV=Yy&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),pI=(e,...t)=>{try{return!!e(...t)}catch{return!1}},JV=mI&&pI(()=>{let e=!1;const t=new Request(ma.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),J3=64*1024,CN=mI&&pI(()=>at.isReadableStream(new Response("").body)),F1={stream:CN&&(e=>e.body)};Yy&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!F1[t]&&(F1[t]=at.isFunction(e[t])?r=>r[t]():(r,n)=>{throw new vr(`Response type '${t}' is not supported`,vr.ERR_NOT_SUPPORT,n)})})})(new Response);const ZV=async e=>{if(e==null)return 0;if(at.isBlob(e))return e.size;if(at.isSpecCompliantForm(e))return(await new Request(ma.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(at.isArrayBufferView(e)||at.isArrayBuffer(e))return e.byteLength;if(at.isURLSearchParams(e)&&(e=e+""),at.isString(e))return(await YV(e)).byteLength},e$=async(e,t)=>{const r=at.toFiniteNumber(e.getContentLength());return r??ZV(t)},t$=Yy&&(async e=>{let{url:t,method:r,data:n,signal:s,cancelToken:i,timeout:o,onDownloadProgress:l,onUploadProgress:c,responseType:A,headers:d,withCredentials:u="same-origin",fetchOptions:f}=hI(e);A=A?(A+"").toLowerCase():"text";let h=zV([s,i&&i.toAbortSignal()],o),x;const m=h&&h.unsubscribe&&(()=>{h.unsubscribe()});let g;try{if(c&&JV&&r!=="get"&&r!=="head"&&(g=await e$(d,n))!==0){let T=new Request(t,{method:"POST",body:n,duplex:"half"}),_;if(at.isFormData(n)&&(_=T.headers.get("content-type"))&&d.setContentType(_),T.body){const[j,E]=G3(g,S1(W3(c)));n=Y3(T.body,J3,j,E)}}at.isString(u)||(u=u?"include":"omit");const p="credentials"in Request.prototype;x=new Request(t,{...f,signal:h,method:r.toUpperCase(),headers:d.normalize().toJSON(),body:n,duplex:"half",credentials:p?u:void 0});let v=await fetch(x);const w=CN&&(A==="stream"||A==="response");if(CN&&(l||w&&m)){const T={};["status","statusText","headers"].forEach(L=>{T[L]=v[L]});const _=at.toFiniteNumber(v.headers.get("content-length")),[j,E]=l&&G3(_,S1(W3(l),!0))||[];v=new Response(Y3(v.body,J3,j,()=>{E&&E(),m&&m()}),T)}A=A||"text";let B=await F1[at.findKey(F1,A)||"text"](v,e);return!w&&m&&m(),await new Promise((T,_)=>{uI(T,_,{data:B,headers:Ja.from(v.headers),status:v.status,statusText:v.statusText,config:e,request:x})})}catch(p){throw m&&m(),p&&p.name==="TypeError"&&/fetch/i.test(p.message)?Object.assign(new vr("Network Error",vr.ERR_NETWORK,e,x),{cause:p.cause||p}):vr.from(p,p&&p.code,e,x)}}),jN={http:pV,xhr:KV,fetch:t$};at.forEach(jN,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Z3=e=>`- ${e}`,r$=e=>at.isFunction(e)||e===null||e===!1,xI={getAdapter:e=>{e=at.isArray(e)?e:[e];const{length:t}=e;let r,n;const s={};for(let i=0;i<t;i++){r=e[i];let o;if(n=r,!r$(r)&&(n=jN[(o=String(r)).toLowerCase()],n===void 0))throw new vr(`Unknown adapter '${o}'`);if(n)break;s[o||"#"+i]=n}if(!n){const i=Object.entries(s).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let o=t?i.length>1?`since :
`+i.map(Z3).join(`
`):" "+Z3(i[0]):"as no adapter specified";throw new vr("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:jN};function hw(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Jf(null,e)}function eS(e){return hw(e),e.headers=Ja.from(e.headers),e.data=fw.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),xI.getAdapter(e.adapter||Jm.adapter)(e).then(function(n){return hw(e),n.data=fw.call(e,e.transformResponse,n),n.headers=Ja.from(n.headers),n},function(n){return dI(n)||(hw(e),n&&n.response&&(n.response.data=fw.call(e,e.transformResponse,n.response),n.response.headers=Ja.from(n.response.headers))),Promise.reject(n)})}const gI="1.7.9",Jy={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Jy[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const tS={};Jy.transitional=function(t,r,n){function s(i,o){return"[Axios v"+gI+"] Transitional option '"+i+"'"+o+(n?". "+n:"")}return(i,o,l)=>{if(t===!1)throw new vr(s(o," has been removed"+(r?" in "+r:"")),vr.ERR_DEPRECATED);return r&&!tS[o]&&(tS[o]=!0,console.warn(s(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,o,l):!0}};Jy.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function n$(e,t,r){if(typeof e!="object")throw new vr("options must be an object",vr.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let s=n.length;for(;s-- >0;){const i=n[s],o=t[i];if(o){const l=e[i],c=l===void 0||o(l,i,e);if(c!==!0)throw new vr("option "+i+" must be "+c,vr.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new vr("Unknown option "+i,vr.ERR_BAD_OPTION)}}const Dg={assertOptions:n$,validators:Jy},tl=Dg.validators;class Ad{constructor(t){this.defaults=t,this.interceptors={request:new K3,response:new K3}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Sd(this.defaults,r);const{transitional:n,paramsSerializer:s,headers:i}=r;n!==void 0&&Dg.assertOptions(n,{silentJSONParsing:tl.transitional(tl.boolean),forcedJSONParsing:tl.transitional(tl.boolean),clarifyTimeoutError:tl.transitional(tl.boolean)},!1),s!=null&&(at.isFunction(s)?r.paramsSerializer={serialize:s}:Dg.assertOptions(s,{encode:tl.function,serialize:tl.function},!0)),Dg.assertOptions(r,{baseUrl:tl.spelling("baseURL"),withXsrfToken:tl.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=i&&at.merge(i.common,i[r.method]);i&&at.forEach(["delete","get","head","post","put","patch","common"],x=>{delete i[x]}),r.headers=Ja.concat(o,i);const l=[];let c=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(r)===!1||(c=c&&m.synchronous,l.unshift(m.fulfilled,m.rejected))});const A=[];this.interceptors.response.forEach(function(m){A.push(m.fulfilled,m.rejected)});let d,u=0,f;if(!c){const x=[eS.bind(this),void 0];for(x.unshift.apply(x,l),x.push.apply(x,A),f=x.length,d=Promise.resolve(r);u<f;)d=d.then(x[u++],x[u++]);return d}f=l.length;let h=r;for(u=0;u<f;){const x=l[u++],m=l[u++];try{h=x(h)}catch(g){m.call(this,g);break}}try{d=eS.call(this,h)}catch(x){return Promise.reject(x)}for(u=0,f=A.length;u<f;)d=d.then(A[u++],A[u++]);return d}getUri(t){t=Sd(this.defaults,t);const r=fI(t.baseURL,t.url);return lI(r,t.params,t.paramsSerializer)}}at.forEach(["delete","get","head","options"],function(t){Ad.prototype[t]=function(r,n){return this.request(Sd(n||{},{method:t,url:r,data:(n||{}).data}))}});at.forEach(["post","put","patch"],function(t){function r(n){return function(i,o,l){return this.request(Sd(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}Ad.prototype[t]=r(),Ad.prototype[t+"Form"]=r(!0)});class Z4{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const n=this;this.promise.then(s=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](s);n._listeners=null}),this.promise.then=s=>{let i;const o=new Promise(l=>{n.subscribe(l),i=l}).then(s);return o.cancel=function(){n.unsubscribe(i)},o},t(function(i,o,l){n.reason||(n.reason=new Jf(i,o,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new Z4(function(s){t=s}),cancel:t}}}function s$(e){return function(r){return e.apply(null,r)}}function a$(e){return at.isObject(e)&&e.isAxiosError===!0}const BN={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(BN).forEach(([e,t])=>{BN[t]=e});function yI(e){const t=new Ad(e),r=X_(Ad.prototype.request,t);return at.extend(r,Ad.prototype,t,{allOwnKeys:!0}),at.extend(r,t,null,{allOwnKeys:!0}),r.create=function(s){return yI(Sd(e,s))},r}const Fn=yI(Jm);Fn.Axios=Ad;Fn.CanceledError=Jf;Fn.CancelToken=Z4;Fn.isCancel=dI;Fn.VERSION=gI;Fn.toFormData=Xy;Fn.AxiosError=vr;Fn.Cancel=Fn.CanceledError;Fn.all=function(t){return Promise.all(t)};Fn.spread=s$;Fn.isAxiosError=a$;Fn.mergeConfig=Sd;Fn.AxiosHeaders=Ja;Fn.formToJSON=e=>AI(at.isHTMLForm(e)?new FormData(e):e);Fn.getAdapter=xI.getAdapter;Fn.HttpStatusCode=BN;Fn.default=Fn;const dt=Fn.create({baseURL:"https://porequests-sandbox.corp.capillarytech.com"});dt.interceptors.request.use(e=>{const t=localStorage.getItem("empAccessToken"),r=t||null;return r&&(e.headers.Authorization=`Bearer ${r}`),e},e=>(console.log("Error in Axios interceptor request",e),Promise.reject(e)));dt.interceptors.response.use(e=>e,e=>{if(e.response){console.log("Error in Axios interceptor response",e);const{status:t,data:r}=e.response,n=(r==null?void 0:r.message)||"An unknown error occurred";return console.log("Error response:",n),t===401&&n==="Session Time Out"&&(localStorage.removeItem("empAccessToken"),console.log("Token removed due to session timeout.")),Promise.reject(e)}else return console.log("Error:",e.message),Promise.reject(e)});const vI=async e=>{try{return await dt.post("/employees/verify-person",{email:e})}catch(t){return t}},i$=async(e,t,r,n,s,i)=>{try{return await dt.post(`/request/filter-by-date/${e}/${t}/${r}/${n}`,{from:s,to:i})}catch(o){return o}},o$=async(e,t,r,n)=>{try{return console.log(e,t,r,n),await dt.get(`/request/get-statistic-data/${e}/${t}/${r}/${n}`)}catch(s){return s}},wI=async(e,t)=>{try{return await dt.post(`/request/send-edit-request-mail/${e}/${t}`)}catch(r){return r}},eC=async e=>{try{return await dt.get(`/vendors/vendor-added-by-me/${e}`)}catch(t){return t}},l$=async()=>{try{return await dt.get("/vendors/legal-deviation-count-vendor")}catch(e){return e}},c$=async()=>{try{return await dt.get("/vendors/vendor-management-approve-count")}catch(e){return e}},A$=async()=>{try{return await dt.get("/vendors/legal-deviation-pending-vendor")}catch(e){return e}},bI=async(e,t)=>{try{return await dt.put(`/vendors/approve-vendor/${e}/${t}`)}catch(r){return r}},NI=async(e,t,r)=>{try{return await dt.put(`/vendors/reject-vendor/${e}/${t}`,{reason:r})}catch(n){return n}},CI=async e=>{var t,r;try{console.log("Sending vendor data to API:",e);const n=await dt.post("/vendors/create",e,{headers:{"Content-Type":"application/json"}});return console.log("API Response:",n),n}catch(n){throw console.error("Error in RegVendorData:",{message:n.message,response:(t=n.response)==null?void 0:t.data,status:(r=n.response)==null?void 0:r.status}),n}},tC=async()=>{try{return await dt.get("/vendors/get-all")}catch(e){return e}},rC=async e=>{try{return await dt.delete(`/vendors/delete/${e}`)}catch(t){return t}},d$=async e=>{try{return await dt.get(`/vendors/get-vendor-data/${e}`)}catch(t){return t}},u$=async(e,t)=>{try{return await dt.put(`/vendors/update/${e}`,t,{headers:{"Content-Type":"application/json"}})}catch(r){return r}},f$=async e=>{try{return console.log("loading...."),await dt.get(`/vendors/get-vendor-data/${e}`)}catch(t){return t}},h$=async e=>{try{return await dt.post("/employees/sync-emp-data",{syncOffEmployee:e})}catch(t){return t}},m$=async e=>{try{return await dt.post("/employees/create-new-employee",e)}catch(t){return t}},p$=async e=>{try{return await dt.delete(`/employees/delete/${e}`)}catch(t){return t}},x$=async e=>{try{return await dt.delete(`/employees/panel-delete/${e}`)}catch(t){return t}},jI=async()=>{try{return await dt.get("/employees/get-all")}catch(e){return e}},g$=async()=>{try{return await dt.get("/employees/panel-member-get-all")}catch(e){return e}},y$=async(e,t,r)=>{try{return await dt.put(`/employees/create-newrequest/${e}/${r}`,t)}catch(n){return n}},v$=async e=>{try{return await dt.get(`/employees/get/${e}`)}catch(t){return t}},w$=async e=>{try{return await dt.get(`/employees/get-panel-members/${e}`)}catch(t){return t}},b$=async(e,t)=>{try{return await dt.put(`/employees/update/${e}`,t)}catch(r){return r}},N$=async e=>{try{return await dt.get(`/request/generate-po/${e}`)}catch(t){return t}},C$=async()=>{try{return await dt.get("/request/get-a-request-id")}catch(e){return e}},BI=async(e,t)=>{try{return await dt.put(`/request/update-request/${e}`,t)}catch(r){return r}},j$=async(e,t,r)=>{try{return await dt.post(`/questions/create-new-question/${e}/${r}`,t)}catch(n){return n}},B$=async(e,t)=>{try{return await dt.get(`/questions/get-my-question/${e}/${t}`)}catch(r){return r}},S$=async e=>{try{return await dt.delete(`/questions/delete-my-question/${e}`)}catch(t){return t}},F$=async()=>{try{return await dt.get("/questions/get-all-question")}catch(e){return e}},E$=async e=>{try{return await dt.put(`/questions/update-question-visibility/${e}`)}catch(t){return t}},SI=async()=>{try{return await dt.get("/questions/get-all-legal-questions")}catch(e){return e}},k$=async e=>{try{return await dt.post(`/request/send-reminder/${e}`)}catch(t){return t}},T$=async e=>{try{return await dt.post("/auth/admin-allow-domain",{domain:e})}catch(t){return t}},_$=async e=>{try{return await dt.get("/auth/admin-domain-list",{domain:e})}catch(t){return t}},I$=async e=>{try{return await dt.delete(`/auth/admin-delete-domain/${e}`)}catch(t){return t}},tf=async e=>{try{return console.log("Loading...."),await dt.get(`/employees/get-all-req/${e}`)}catch(t){return t}},FI=async e=>{try{return console.log(e),await dt.get(`/employees/get-individual-req/${e}`)}catch(t){return t}},L$=async e=>{try{return console.log(e),await dt.get(`/request/get-individual-request-data/${e}`)}catch(t){return t}},U$=async(e,t,r)=>{try{return await dt.get(`/request/is-approved/${e}/${t}/${r}`)}catch(n){return n}},Zm=async e=>{try{return await dt.delete(`/employees/delete-req/${e}`)}catch(t){return t}},rf=async()=>{try{return await dt.get("/employees/get-all-req-admin")}catch(e){return e}},rS=async(e,t,r,n,s,i)=>{try{return console.log("request/accept-request-hod"),await dt.post(`/request/accept-request-hod/${e}`,{role:t,reqId:r,status:n,email:s,reason:i})}catch(o){return o}},D$=async(e,t,r,n,s,i)=>{try{return await dt.post(`/request/accept-request-business/${e}`,{role:t,reqId:r,status:n,email:s,reason:i})}catch(o){return o}},P$=async(e,t,r,n,s,i)=>{try{return await dt.post(`/request/accept-request-vendor/${e}`,{role:t,reqId:r,status:n,email:s,reason:i})}catch(o){return o}},O$=async(e,t,r,n,s,i)=>{try{return await dt.post(`/request/accept-request-legal/${e}`,{role:t,reqId:r,status:n,email:s,reason:i})}catch(o){return o}},R$=async(e,t,r,n,s,i)=>{try{return await dt.post(`/request/accept-request-info-security/${e}`,{role:t,reqId:r,status:n,email:s,reason:i})}catch(o){return o}},Q$=async(e,t,r,n,s,i)=>{try{return await dt.post(`/request/accept-request-po-team/${e}`,{role:t,reqId:r,status:n,email:s,reason:i})}catch(o){return o}},M$=async(e,t,r,n,s,i)=>{try{return await dt.post(`/request/accept-request-hof-team/${e}`,{role:t,reqId:r,status:n,email:s,reason:i})}catch(o){return o}},H$=async e=>{try{return await dt.get(`/request/get-new-notification/${e}`)}catch(t){return t}},E1=async(e,t=!1)=>{try{const r=typeof t=="boolean"?t:!1;return await dt.get(`/request/get-approved-req/${e}`,{params:{showPendingOnly:r}})}catch(r){return r}},V$=async(e,t,r,n,s,i)=>{try{return await dt.put(`/request/relese-status/${r}/${n}`,{status:e,department:t,role:s,email:i})}catch(o){return o}},$$=async()=>{try{return await dt.get("/request/get-reports")}catch(e){return e}},q$=async(e,t,r,n)=>{try{return await dt.put(`/request/upload-po-documents/${e}/${t}`,{link:r,poNumber:n})}catch(s){return s}},K$=async(e,t,r,n)=>{try{return await dt.put(`/request/upload-invoice-documents/${e}/${t}`,{link:r,invoiceNumber:n})}catch(s){return s}},Zf=async e=>{try{return await dt.get(`/entity/get-all/${e}`)}catch(t){return t}},z$=async e=>{try{return await dt.post("/entity/create",{data:e})}catch(t){return t}},G$=async e=>{try{return await dt.delete(`/entity/delete/${e}`)}catch(t){return t}},W$=async e=>{try{return await dt.get(`/entity/get/${e}`)}catch(t){return t}},X$=async(e,t)=>{try{return await dt.put(`/entity/update/${e}`,{data:t})}catch(r){return r}},Y$=async e=>{try{return await dt.put(`/request/chats/${e.reqId}`,{data:e})}catch(t){return t}},J$=async e=>{try{return await dt.get(`/request/get-all-chats/${e}`,{})}catch(t){return t}},EI=async e=>{try{return await dt.post("/employees/add-new-panels",{formData:e})}catch(t){return t}},nS=async()=>{try{return await dt.get("/employees/get-approval-datas")}catch(e){return e}},Z$=async e=>{try{return await dt.post("/employees/upload-csv-file",e,{headers:{"Content-Type":"multipart/form-data"}})}catch(t){return t}},eq=async()=>{try{return await dt.get("/employees/darwin-status")}catch(e){return e}},tq=async()=>{try{return await dt.put("/employees/update-darwin-status")}catch(e){return e}},rq=async e=>{try{return await dt.post("/credantials/api-crediantials",{email:e})}catch(t){return t}},nq=async(e,t)=>{try{return await dt.post(`/request/save-commercial-data/${t}`,{formData:e})}catch(r){return r}},sq=async(e,t,r)=>{try{return await dt.post(`/request/edit-commercial-data/${t}/${r}`,{formData:e})}catch(n){return n}},kI=async(e,t)=>{try{return await dt.put(`/request/save-procurements-data/${t}`,{formData:e})}catch(r){return r}},TI=async(e,t)=>{try{return await dt.put(`/request/save-supplies-data/${t}`,{formData:e})}catch(r){return r}},_I=async(e,t)=>{try{return await dt.put(`/request/save-aggrement-data/${t}`,{formData:e})}catch(r){return r}},aq=async(e,t)=>{try{return await dt.get(`/request/get-role-based-approvals/${e}/${t}`)}catch(r){return r}},nC=async(e,t)=>{try{return await dt.post(`/vendors/create-new-vendors/${t}`,{data:e})}catch(r){return r}},iq=async e=>{try{return await dt.post("/request/email-notification-action",{emailData:e})}catch(t){return t}},oq=async()=>{try{return await dt.get("/request/get-email-notification-data")}catch(e){return e}},lq=async(e,t)=>{try{return await dt.get(`/request/tag-employee/${e}/${t}`)}catch(r){return r}},cq=async(e,t)=>{try{return await dt.get("/employees/get-all-employee")}catch(r){return r}},Aq=async()=>{try{return await dt.get("/credantials/get-all-api-data")}catch(e){return e}},dq=async(e,t)=>{try{return await dt.put(`/credantials/update-api-status/${e}`,{status:t})}catch(r){return r}},uq=async()=>{try{return await dt.get("/entity/get-entity-name")}catch(e){return e}},sS=async e=>{try{return await dt.post("/request/get-searched-data",{data:e})}catch(t){return t}},fq=async e=>{try{return await dt.post("/employees/add-new-approver-data",{data:e})}catch(t){return t}},hq=async e=>{try{return await dt.put("/employees/edit-approver-data",{data:e})}catch(t){return t}},mq=async e=>{try{return await dt.put("/employees/delete-approver-data",{data:e})}catch(t){return t}},Zy=async e=>{try{return await dt.post("/upload-s3/refresh-presigned-url",{presignedUrl:e})}catch(t){return t}},pq=async e=>{try{return await dt.post("/create-key/save-new-sso-key",{key:e})}catch(t){return t}},xq=async()=>{try{return await dt.get("/create-key/get-saved-sso-key")}catch(e){return e}},gq=async()=>{try{return await dt.delete("/create-key/delete-saved-sso-key")}catch(e){return e}},yq=async e=>{try{return await dt.post("/currency/add-new-currency ",{currency:e})}catch(t){return t}},mo=async()=>{try{return await dt.get("/currency/get-currency-data")}catch(e){return e}},vq=async(e,t)=>{try{return await dt.put(`/currency/update-currency-status/${e}`,{status:t})}catch(r){return r}},wq=async e=>{try{return await dt.delete(`/currency/delete-currency-data/${e}`)}catch(t){return t}},bq=async(e,t,r)=>{try{return await dt.post(`/request/business-finance-bulk-approval/${e}`,{selectedRequests:t,role:r})}catch(n){return n}},aS=async(e,t)=>{try{return await dt.post(`/purchase-order/add-new-po-data/${t}`,{poData:e})}catch(r){return r}},Nq=async(e,t)=>{try{return await dt.post(`/create-smtp/add-new-smtp-data/${t}`,{smtpConfig:e})}catch(r){return r}},Cq=async()=>{try{return await dt.get("/create-smtp/get-new-smtp-data")}catch(e){return e}},jq=async(e,t)=>{try{return await dt.delete(`/create-smtp/delete-smtp-data/${e}/${t}`)}catch(r){return r}},Cx=async()=>{try{return await dt.get("/purchase-order/get-po-data")}catch(e){return e}},Bq=async(e,t)=>{try{return await dt.delete(`/purchase-order/delete-po-data/${e}/${t}`)}catch(r){return r}},Sq=async(e,t,r)=>{try{return await dt.put(`/purchase-order/update-po-data/${e}/${r}`,{newEntry:t})}catch(n){return n}},Fq=async e=>{try{return await dt.post("/vendors/save-vendor-policy-file",{fileUrl:e})}catch(t){return t}},Eq=async()=>{try{return await dt.get("/vendors/get-vendor-policy-file")}catch(e){return e}},kq=async()=>{try{return await dt.delete("/vendors/delete-vendor-policy-file")}catch(e){return e}},Tq=async e=>{try{return await dt.post("/vendors/save-po-policy-file",{fileUrl:e})}catch(t){return t}},_q=async()=>{try{return await dt.get("/vendors/get-po-policy-file")}catch(e){return e}},Iq=async()=>{try{return await dt.delete("/vendors/delete-po-policy-file")}catch(e){return e}},ev=async()=>{try{return await dt.get("/vendors/get-po-policy-file-link")}catch(e){return e}},II=async(e,t,r)=>{try{return await dt.put(`/vendors/team-verified-the-vendor-data/${e}/${t}`,{reason:r})}catch(n){return n}},LI=async(e,t,r)=>{try{return await dt.put(`/vendors/team-reject-the-vendor-data/${e}/${t}`,{reason:r})}catch(n){return n}},Fd=()=>a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg flex flex-col items-center",children:[a.jsx(yH,{className:"h-8 w-8 animate-spin text-primary"}),a.jsx("p",{className:"mt-4 text-gray-600 font-medium",children:"Loading..."})]})}),Lq=()=>{const e=localStorage.getItem("multiRole"),t=Sr();JSON.parse(localStorage.getItem("user"));const r=localStorage.getItem("role"),n=localStorage.getItem("capEmpId"),s=localStorage.getItem("department"),i=localStorage.getItem("email"),[o,l]=C.useState(!0),[c,A]=C.useState({fromDate:null,toDate:null}),[d,u]=C.useState(!1),[f,h]=C.useState([]),[x,m]=C.useState({adminAllTotalRequests:0,adminAllPendingRequests:0,adminAllCompletedRequests:0,adminAllOnHoldRequests:0,adminAllRejectedRequests:0,adminAlltotalFunds:0,myRequests:0,myApprovals:0,myReqOnHold:0,myReqRejected:0,pendingRequest:0,pendingApprovals:0,completedApprovals:0,rejectedApprovals:0,onHoldApprovals:0,departmentBudget:0,totalApprovals:0,roleApprovals:0,pendingRoleRequests:0,approvedRoleRequests:0,onHoldRoleRequests:0,rejectedRoleRequests:0});C.useEffect(()=>{(async()=>{const K=await mo();K.status===200&&h(K.data.data)})()},[]),C.useEffect(()=>{(async()=>{l(!0);try{const K=await o$(n,r,i,e);K.status===200&&m(K.data)}catch(K){console.error("Failed to fetch statistics:",K)}finally{setTimeout(()=>{l(!1)},500)}})()},[n]);const g=()=>{A({fromDate:"",toDate:""}),u(!1)},p=G=>{const{name:K,value:ae}=G.target;A(Z=>({...Z,[K]:ae}))},v=async()=>{if(c.fromDate&&c.toDate){u(!0);try{const G=await i$(n,r,i,e,c.fromDate,c.toDate);G.status===200&&m(G.data)}catch(G){console.error("Failed to fetch filtered statistics:",G)}}else alert("Please select both From and To dates")},w=()=>a.jsx("div",{className:"bg-white rounded-xl shadow-md p-4 sm:p-6 mb-6 border border-gray-100",children:a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("h3",{className:"text-lg sm:text-xl font-bold text-gray-900 flex items-center",children:[a.jsx(uH,{className:"w-5 h-5 mr-2 text-primary"}),"Date Range Filter"]}),a.jsxs("div",{className:"flex flex-col sm:flex-row flex-wrap items-start sm:items-center gap-4",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2 w-full sm:w-auto",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"From:"}),a.jsx("input",{type:"date",name:"fromDate",value:c.fromDate,onChange:p,className:"w-full sm:w-auto px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2 w-full sm:w-auto",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"To:"}),a.jsx("input",{type:"date",name:"toDate",value:c.toDate,onChange:p,className:"w-full sm:w-auto px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})]}),a.jsxs("div",{className:"flex items-center gap-2 mt-2 sm:mt-0",children:[a.jsxs("button",{onClick:v,className:"flex items-center px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-colors",children:[a.jsx(rn,{className:"w-4 h-4 mr-2"}),"Filter"]}),d&&a.jsxs("button",{onClick:g,className:"flex items-center px-4 py-2 text-red-600 bg-red-50 rounded-md hover:bg-red-100 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-colors",children:[a.jsx(_r,{className:"w-4 h-4 mr-2"}),"Clear"]})]})]})]})}),B=({title:G,value:K,icon:ae,bgColor:Z,textColor:oe,onClick:Y})=>a.jsxs("div",{onClick:Y,className:`${Z} rounded-xl p-4 cursor-pointer transform transition-all duration-300 hover:scale-105 hover:shadow-xl`,children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[a.jsx(ae,{className:`w-6 h-6 sm:w-8 sm:h-8 ${oe}`}),a.jsx("h4",{className:"font-semibold text-sm sm:text-base text-gray-900",children:G})]}),a.jsx("div",{children:a.jsx("span",{className:`text-xl sm:text-3xl font-bold ${oe}`,children:K})})]}),T=({title:G,departmentBudgetByCurrency:K,icon:ae,bgColor:Z,textColor:oe,onClick:Y})=>a.jsxs("div",{onClick:Y,className:`${Z} rounded-xl p-4 cursor-pointer transform transition-all duration-300 hover:scale-105 hover:shadow-xl`,children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[a.jsx(ae,{className:`w-6 h-6 sm:w-8 sm:h-8 ${oe}`}),a.jsx("h4",{className:"font-semibold text-sm sm:text-base text-gray-900",children:G})]}),a.jsxs("div",{className:"space-y-1",children:[K&&Object.entries(K).map(([R,z])=>a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-xs sm:text-sm text-gray-600",children:R}),a.jsx("span",{className:`text-sm sm:text-xl font-bold ${oe}`,children:new Intl.NumberFormat("en-US",{style:"currency",currency:R}).format(z)})]},R)),(!K||Object.keys(K).length===0)&&a.jsx("span",{className:"text-xs sm:text-sm text-gray-500",children:"No budget data available"})]})]}),_=()=>a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mt-6",children:[a.jsx(B,{title:"Approved Role Requests",value:x.completedApprovals||0,icon:Nx,bgColor:"bg-emerald-50 hover:bg-emerald-100",textColor:"text-emerald-600",onClick:()=>t(`/approval-request-list/show-request-statistcs/My-Approvals/${c.fromDate}/${c.toDate}`)}),a.jsx(B,{title:"Pending Role Requests",value:x.pendingApprovals||0,icon:xA,bgColor:"bg-amber-50 hover:bg-amber-100",textColor:"text-amber-600",onClick:()=>t(`/approval-request-list/show-request-statistcs/Pending-Approvals/${c.fromDate}/${c.toDate}`)}),a.jsx(B,{title:"On Hold Role Requests",value:x.onHoldRoleRequests||0,icon:Yi,bgColor:"bg-amber-50 hover:bg-amber-100",textColor:"text-amber-600",onClick:()=>t(`/approval-request-list/show-request-statistcs/OnHold-Approvals/${c.fromDate}/${c.toDate}`)}),a.jsx(B,{title:"Rejected Role Requests",value:x.rejectedRoleRequests||0,icon:Ea,bgColor:"bg-red-50 hover:bg-red-100",textColor:"text-red-600",onClick:()=>t(`/approval-request-list/show-request-statistcs/Rejected-Approvals/${c.fromDate}/${c.toDate}`)}),a.jsx(B,{title:"Total Role Approvals",value:x.totalApprovals||0,icon:vN,bgColor:"bg-purple-50 hover:bg-purple-100",textColor:"text-purple-600",onClick:()=>t(`/approval-request-list/show-request-statistcs/Total-Approvals/${c.fromDate}/${c.toDate}`)})]}),j=()=>a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsx(B,{title:"Total Requests",value:x.adminAllTotalRequests,icon:jr,bgColor:"bg-blue-50 hover:bg-blue-100",textColor:"text-blue-600",onClick:()=>t(`/approval-request-list/show-request-statistcs/Total-Request/${c.fromDate}/${c.toDate}`)}),a.jsx(B,{title:"Pending Requests",value:x.adminAllPendingRequests,icon:ql,bgColor:"bg-orange-50 hover:bg-orange-100",textColor:"text-orange-600",onClick:()=>t(`/approval-request-list/show-request-statistcs/Pending-Request/${c.fromDate}/${c.toDate}`)}),a.jsx(B,{title:"Approved Requests",value:x.adminAllCompletedRequests,icon:ca,bgColor:"bg-green-50 hover:bg-green-100",textColor:"text-green-600",onClick:()=>t(`/approval-request-list/show-request-statistcs/Approved-Request/${c.fromDate}/${c.toDate}`)}),a.jsx(B,{title:"On Hold Requests",value:x.adminAllOnHoldRequests||0,icon:Yi,bgColor:"bg-amber-50 hover:bg-amber-100",textColor:"text-amber-600",onClick:()=>t(`/approval-request-list/show-request-statistcs/OnHold-Request/${c.fromDate}/${c.toDate}`)}),a.jsx(B,{title:"Rejected Requests",value:x.adminAllRejectedRequests||0,icon:Ea,bgColor:"bg-red-50 hover:bg-red-100",textColor:"text-red-600",onClick:()=>t(`/approval-request-list/show-request-statistcs/Rejected-Request/${c.fromDate}/${c.toDate}`)}),a.jsx(T,{title:"Department Expense",departmentBudgetByCurrency:x==null?void 0:x.departmentBudgetByCurrency,icon:Fa,bgColor:"bg-blue-100",textColor:"text-blue-600"})]}),E=()=>a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[a.jsx(B,{title:"My Requests",value:x.myRequests,icon:jr,bgColor:"bg-blue-50 hover:bg-blue-100",textColor:"text-blue-600",onClick:()=>t("/req-list-table")}),a.jsx(B,{title:"Pending Requests",value:x.pendingRequest,icon:ql,bgColor:"bg-orange-50 hover:bg-orange-100",textColor:"text-orange-600",onClick:()=>t("/req-list-table/show-request-statistcs/Pending-Request")}),a.jsx(B,{title:"Approved Requests",value:x.completedApprovals,icon:ca,bgColor:"bg-teal-50 hover:bg-teal-100",textColor:"text-teal-600",onClick:()=>t("/req-list-table/show-request-statistcs/Completed-Request")}),a.jsx(B,{title:"On Hold Requests",value:x.myReqOnHold||0,icon:Yi,bgColor:"bg-amber-50 hover:bg-amber-100",textColor:"text-amber-600",onClick:()=>t("/req-list-table/show-request-statistcs/OnHold-Request")}),a.jsx(B,{title:"Rejected Requests",value:x.myRejectedReq||0,icon:Ea,bgColor:"bg-red-50 hover:bg-red-100",textColor:"text-red-600",onClick:()=>t("/req-list-table/show-request-statistcs/Rejected-Request")}),a.jsx(B,{title:"Approved Approvals",value:x.myApprovals,icon:Nx,bgColor:"bg-green-50 hover:bg-green-100",textColor:"text-green-600",onClick:()=>t(`/approval-request-list/show-request-statistcs/Approved-Approvals/${c.fromDate}/${c.toDate}`)}),a.jsx(B,{title:"Pending Approvals",value:x.pendingApprovals,icon:Th,bgColor:"bg-yellow-50 hover:bg-yellow-100",textColor:"text-yellow-600",onClick:()=>t(`/approval-request-list/show-request-statistcs/Pending-Approvals/${c.fromDate}/${c.toDate}`)}),a.jsx(B,{title:"On Hold Approvals",value:x.onHoldApprovals||0,icon:Yi,bgColor:"bg-amber-50 hover:bg-amber-100",textColor:"text-amber-600",onClick:()=>t(`/approval-request-list/show-request-statistcs/OnHold-Approvals/${c.fromDate}/${c.toDate}`)}),a.jsx(B,{title:"Rejected Approvals",value:x.rejectedApprovals||0,icon:Ea,bgColor:"bg-red-50 hover:bg-red-100",textColor:"text-red-600",onClick:()=>t(`/approval-request-list/show-request-statistcs/Rejected-Approvals/${c.fromDate}/${c.toDate}`)}),a.jsx(B,{title:"My Department Approvals",value:x.totalApprovals,icon:ca,bgColor:"bg-indigo-50 hover:bg-indigo-100",textColor:"text-indigo-600",onClick:()=>t(`/approval-request-list/show-request-statistcs/Total-Approvals/${c.fromDate}/${c.toDate}`)}),a.jsx(T,{title:"Department Expense",departmentBudgetByCurrency:x==null?void 0:x.departmentBudgetByCurrency,icon:Fa,bgColor:"bg-blue-100",textColor:"text-blue-600"})]}),L=()=>a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[a.jsx(B,{title:"My Requests",value:x.myRequests,icon:jr,bgColor:"bg-blue-50 hover:bg-blue-100",textColor:"text-blue-600",onClick:()=>t("/req-list-table")}),a.jsx(B,{title:"Pending Requests",value:x.pendingRequest,icon:ql,bgColor:"bg-orange-50 hover:bg-orange-100",textColor:"text-orange-600",onClick:()=>t("/req-list-table/show-request-statistcs/Pending-Request")}),a.jsx(B,{title:"Completed Requests",value:x.completedRequest,icon:ca,bgColor:"bg-teal-50 hover:bg-teal-100",textColor:"text-teal-600",onClick:()=>t("/req-list-table/show-request-statistcs/Approved-Request")}),a.jsx(B,{title:"On Hold Requests",value:x.myReqOnHold||0,icon:Yi,bgColor:"bg-amber-50 hover:bg-amber-100",textColor:"text-amber-600",onClick:()=>t("/req-list-table/show-request-statistcs/OnHold-Request")}),a.jsx(B,{title:"Rejected Requests",value:x.myRejectedReq||0,icon:Ea,bgColor:"bg-red-50 hover:bg-red-100",textColor:"text-red-600",onClick:()=>t("/req-list-table/show-request-statistcs/Rejected-Request")}),a.jsx(B,{title:"My Approvals",value:x.completedApprovals,icon:Nx,bgColor:"bg-green-50 hover:bg-green-100",textColor:"text-green-600",onClick:()=>t(`/approval-request-list/show-request-statistcs/My-Approvals/${c.fromDate}/${c.toDate}`)}),a.jsx(B,{title:"Pending Approvals",value:x.pendingApprovals,icon:Th,bgColor:"bg-yellow-50 hover:bg-yellow-100",textColor:"text-yellow-600",onClick:()=>t(`/approval-request-list/show-request-statistcs/Pending-Approvals/${c.fromDate}/${c.toDate}`)}),a.jsx(B,{title:"On Hold Approvals",value:x.onHoldApprovals||0,icon:Yi,bgColor:"bg-amber-50 hover:bg-amber-100",textColor:"text-amber-600",onClick:()=>t(`/approval-request-list/show-request-statistcs/OnHold-Approvals/${c.fromDate}/${c.toDate}`)}),a.jsx(B,{title:"Rejected Approvals",value:x.rejectedApprovals||0,icon:Ea,bgColor:"bg-red-50 hover:bg-red-100",textColor:"text-red-600",onClick:()=>t(`/approval-request-list/show-request-statistcs/Rejected-Approvals/${c.fromDate}/${c.toDate}`)}),a.jsx(B,{title:"Total Approvals",value:x.totalApprovals,icon:ca,bgColor:"bg-indigo-50 hover:bg-indigo-100",textColor:"text-indigo-600",onClick:()=>t(`/approval-request-list/show-request-statistcs/Total-Approvals/${c.fromDate}/${c.toDate}`)}),a.jsx(T,{title:"Department Expense",departmentBudgetByCurrency:x==null?void 0:x.departmentBudgetByCurrency,icon:Fa,bgColor:"bg-blue-100",textColor:"text-blue-600"})]}),M=()=>a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsx(B,{title:"My Requests",value:x.myRequests,icon:jr,bgColor:"bg-blue-50 hover:bg-blue-100",textColor:"text-blue-600",onClick:()=>t("/req-list-table")}),a.jsx(B,{title:"Pending Requests",value:x.pendingApprovals,icon:ql,bgColor:"bg-orange-50 hover:bg-orange-100",textColor:"text-orange-600",onClick:()=>t("/req-list-table/show-request-statistcs/Pending-Request")}),a.jsx(B,{title:"Completed Requests",value:x.completedApprovals,icon:ca,bgColor:"bg-green-50 hover:bg-green-100",textColor:"text-green-600",onClick:()=>t("/req-list-table/show-request-statistcs/Approved-Request")}),a.jsx(B,{title:"On Hold Requests",value:x.myReqOnHold||0,icon:Yi,bgColor:"bg-amber-50 hover:bg-amber-100",textColor:"text-amber-600",onClick:()=>t("/req-list-table/show-request-statistcs/OnHold-Request")}),a.jsx(B,{title:"Rejected Requests",value:x.myRejectedReq||0,icon:Ea,bgColor:"bg-red-50 hover:bg-red-100",textColor:"text-red-600",onClick:()=>t("/req-list-table/show-request-statistcs/Rejected-Request")})]}),F=()=>a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[a.jsx(B,{title:"My Requests",value:x.myRequests,icon:jr,bgColor:"bg-blue-50 hover:bg-blue-100",textColor:"text-blue-600",onClick:()=>t("/req-list-table")}),a.jsx(B,{title:"Pending Requests",value:x.pendingRequest,icon:ql,bgColor:"bg-orange-50 hover:bg-orange-100",textColor:"text-orange-600",onClick:()=>t("/req-list-table/show-request-statistcs/Pending-Request")}),a.jsx(B,{title:"Approved Requests",value:x.completedRequest,icon:ca,bgColor:"bg-teal-50 hover:bg-teal-100",textColor:"text-teal-600",onClick:()=>t("/req-list-table/show-request-statistcs/Completed-Request")}),a.jsx(B,{title:"On Hold Requests",value:x.onHoldApprovals||0,icon:Yi,bgColor:"bg-amber-50 hover:bg-amber-100",textColor:"text-amber-600",onClick:()=>t("/req-list-table/show-request-statistcs/OnHold-Request")}),a.jsx(B,{title:"Rejected Requests",value:x.rejectedApprovals||0,icon:Ea,bgColor:"bg-red-50 hover:bg-red-100",textColor:"text-red-600",onClick:()=>t("/req-list-table/show-request-statistcs/Rejected-Request")}),a.jsx(B,{title:"My Approvals",value:x.completedApprovals,icon:Nx,bgColor:"bg-green-50 hover:bg-green-100",textColor:"text-green-600",onClick:()=>t(`/approval-request-list/show-request-statistcs/My-Approvals/${c.fromDate}/${c.toDate}`)}),a.jsx(B,{title:"Pending Approvals",value:x.pendingApprovals,icon:Th,bgColor:"bg-yellow-50 hover:bg-yellow-100",textColor:"text-yellow-600",onClick:()=>t(`/approval-request-list/show-request-statistcs/Pending-Approvals/${c.fromDate}/${c.toDate}`)}),a.jsx(B,{title:"On Hold Approvals",value:x.onHoldApprovals||0,icon:Yi,bgColor:"bg-amber-50 hover:bg-amber-100",textColor:"text-amber-600",onClick:()=>t(`/approval-request-list/show-request-statistcs/OnHold-Approvals/${c.fromDate}/${c.toDate}`)}),a.jsx(B,{title:"Rejected Approvals",value:x.rejectedApprovals||0,icon:Ea,bgColor:"bg-red-50 hover:bg-red-100",textColor:"text-red-600",onClick:()=>t(`/approval-request-list/show-request-statistcs/Rejected-Approvals/${c.fromDate}/${c.toDate}`)}),a.jsx(B,{title:"Total Approvals",value:x.totalApprovals,icon:ca,bgColor:"bg-indigo-50 hover:bg-indigo-100",textColor:"text-indigo-600",onClick:()=>t(`/approval-request-list/show-request-statistcs/Total-Approvals/${c.fromDate}/${c.toDate}`)})]}),D=()=>{switch(r==null?void 0:r.toLowerCase()){case"admin":return(s==null?void 0:s.toLowerCase())==="admin"||(r==null?void 0:r.toLowerCase())==="admin"&&e===0?j():E();case"hod department":return E();case"head of finance":case"business finance":return L();case"vendor management":case"legal team":case"info security":return F();default:return M()}};return a.jsxs(a.Fragment,{children:[o&&a.jsx(Fd,{}),a.jsx("div",{className:"min-h-screen bg-gray-50/50 py-4 sm:py-8 px-2 sm:px-4",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx(w,{}),a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4 sm:p-6 hover:shadow-lg transition-shadow border border-gray-100",children:[a.jsxs("h3",{className:"text-lg sm:text-xl font-bold text-gray-900 mb-4 sm:mb-6 flex items-center",children:[a.jsx("span",{className:"inline-block w-2 h-4 sm:h-6 bg-primary rounded-full mr-2 sm:mr-3"}),"Dashboard Statistics"]}),D(),e==1&&a.jsxs(a.Fragment,{children:[a.jsxs("h3",{className:"text-lg sm:text-xl font-bold text-gray-900 mt-8 mb-4 flex items-center",children:[a.jsx("span",{className:"inline-block w-2 h-4 sm:h-6 bg-purple-500 rounded-full mr-2 sm:mr-3"}),"Role Management"]}),_()]})]})]})})]})};function Uq(e={}){const{nonce:t,onScriptLoadSuccess:r,onScriptLoadError:n}=e,[s,i]=C.useState(!1),o=C.useRef(r);o.current=r;const l=C.useRef(n);return l.current=n,C.useEffect(()=>{const c=document.createElement("script");return c.src="https://accounts.google.com/gsi/client",c.async=!0,c.defer=!0,c.nonce=t,c.onload=()=>{var A;i(!0),(A=o.current)===null||A===void 0||A.call(o)},c.onerror=()=>{var A;i(!1),(A=l.current)===null||A===void 0||A.call(l)},document.body.appendChild(c),()=>{document.body.removeChild(c)}},[t]),s}const UI=C.createContext(null);function Dq({clientId:e,nonce:t,onScriptLoadSuccess:r,onScriptLoadError:n,children:s}){const i=Uq({nonce:t,onScriptLoadSuccess:r,onScriptLoadError:n}),o=C.useMemo(()=>({clientId:e,scriptLoadedSuccessfully:i}),[e,i]);return mr.createElement(UI.Provider,{value:o},s)}function Pq(){const e=C.useContext(UI);if(!e)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return e}function Oq(e){var t;return(t=e==null?void 0:e.clientId)!==null&&t!==void 0?t:e==null?void 0:e.client_id}const Rq={large:40,medium:32,small:20};function Qq({onSuccess:e,onError:t,useOneTap:r,promptMomentNotification:n,type:s="standard",theme:i="outline",size:o="large",text:l,shape:c,logo_alignment:A,width:d,locale:u,click_listener:f,containerProps:h,...x}){const m=C.useRef(null),{clientId:g,scriptLoadedSuccessfully:p}=Pq(),v=C.useRef(e);v.current=e;const w=C.useRef(t);w.current=t;const B=C.useRef(n);return B.current=n,C.useEffect(()=>{var T,_,j,E,L,M,F,D,G;if(p)return(j=(_=(T=window==null?void 0:window.google)===null||T===void 0?void 0:T.accounts)===null||_===void 0?void 0:_.id)===null||j===void 0||j.initialize({client_id:g,callback:K=>{var ae;if(!(K!=null&&K.credential))return(ae=w.current)===null||ae===void 0?void 0:ae.call(w);const{credential:Z,select_by:oe}=K;v.current({credential:Z,clientId:Oq(K),select_by:oe})},...x}),(M=(L=(E=window==null?void 0:window.google)===null||E===void 0?void 0:E.accounts)===null||L===void 0?void 0:L.id)===null||M===void 0||M.renderButton(m.current,{type:s,theme:i,size:o,text:l,shape:c,logo_alignment:A,width:d,locale:u,click_listener:f}),r&&((G=(D=(F=window==null?void 0:window.google)===null||F===void 0?void 0:F.accounts)===null||D===void 0?void 0:D.id)===null||G===void 0||G.prompt(B.current)),()=>{var K,ae,Z;r&&((Z=(ae=(K=window==null?void 0:window.google)===null||K===void 0?void 0:K.accounts)===null||ae===void 0?void 0:ae.id)===null||Z===void 0||Z.cancel())}},[g,p,r,s,i,o,l,c,A,d,u]),mr.createElement("div",{...h,ref:m,style:{height:Rq[o],...h==null?void 0:h.style}})}const Pu="/assets/capilary_logo-CaZO7e6q.png";function DI(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=DI(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Wc(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=DI(e))&&(n&&(n+=" "),n+=t);return n}const hm=e=>typeof e=="number"&&!isNaN(e),dd=e=>typeof e=="string",bi=e=>typeof e=="function",Pg=e=>dd(e)||bi(e)?e:null,SN=e=>C.isValidElement(e)||dd(e)||bi(e)||hm(e);function Mq(e,t,r){r===void 0&&(r=300);const{scrollHeight:n,style:s}=e;requestAnimationFrame(()=>{s.minHeight="initial",s.height=n+"px",s.transition=`all ${r}ms`,requestAnimationFrame(()=>{s.height="0",s.padding="0",s.margin="0",setTimeout(t,r)})})}function tv(e){let{enter:t,exit:r,appendPosition:n=!1,collapse:s=!0,collapseDuration:i=300}=e;return function(o){let{children:l,position:c,preventExitTransition:A,done:d,nodeRef:u,isIn:f,playToast:h}=o;const x=n?`${t}--${c}`:t,m=n?`${r}--${c}`:r,g=C.useRef(0);return C.useLayoutEffect(()=>{const p=u.current,v=x.split(" "),w=B=>{B.target===u.current&&(h(),p.removeEventListener("animationend",w),p.removeEventListener("animationcancel",w),g.current===0&&B.type!=="animationcancel"&&p.classList.remove(...v))};p.classList.add(...v),p.addEventListener("animationend",w),p.addEventListener("animationcancel",w)},[]),C.useEffect(()=>{const p=u.current,v=()=>{p.removeEventListener("animationend",v),s?Mq(p,d,i):d()};f||(A?v():(g.current=1,p.className+=` ${m}`,p.addEventListener("animationend",v)))},[f]),mr.createElement(mr.Fragment,null,l)}}function iS(e,t){return e!=null?{content:e.content,containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,status:t}:{}}const _a=new Map;let mm=[];const FN=new Set,Hq=e=>FN.forEach(t=>t(e)),PI=()=>_a.size>0;function OI(e,t){var r;if(t)return!((r=_a.get(t))==null||!r.isToastActive(e));let n=!1;return _a.forEach(s=>{s.isToastActive(e)&&(n=!0)}),n}function RI(e,t){SN(e)&&(PI()||mm.push({content:e,options:t}),_a.forEach(r=>{r.buildToast(e,t)}))}function oS(e,t){_a.forEach(r=>{t!=null&&t!=null&&t.containerId?(t==null?void 0:t.containerId)===r.id&&r.toggle(e,t==null?void 0:t.id):r.toggle(e,t==null?void 0:t.id)})}function Vq(e){const{subscribe:t,getSnapshot:r,setProps:n}=C.useRef(function(i){const o=i.containerId||1;return{subscribe(l){const c=function(d,u,f){let h=1,x=0,m=[],g=[],p=[],v=u;const w=new Map,B=new Set,T=()=>{p=Array.from(w.values()),B.forEach(E=>E())},_=E=>{g=E==null?[]:g.filter(L=>L!==E),T()},j=E=>{const{toastId:L,onOpen:M,updateId:F,children:D}=E.props,G=F==null;E.staleId&&w.delete(E.staleId),w.set(L,E),g=[...g,E.props.toastId].filter(K=>K!==E.staleId),T(),f(iS(E,G?"added":"updated")),G&&bi(M)&&M(C.isValidElement(D)&&D.props)};return{id:d,props:v,observe:E=>(B.add(E),()=>B.delete(E)),toggle:(E,L)=>{w.forEach(M=>{L!=null&&L!==M.props.toastId||bi(M.toggle)&&M.toggle(E)})},removeToast:_,toasts:w,clearQueue:()=>{x-=m.length,m=[]},buildToast:(E,L)=>{if((b=>{let{containerId:O,toastId:S,updateId:I}=b;const U=O?O!==d:d!==1,Q=w.has(S)&&I==null;return U||Q})(L))return;const{toastId:M,updateId:F,data:D,staleId:G,delay:K}=L,ae=()=>{_(M)},Z=F==null;Z&&x++;const oe={...v,style:v.toastStyle,key:h++,...Object.fromEntries(Object.entries(L).filter(b=>{let[O,S]=b;return S!=null})),toastId:M,updateId:F,data:D,closeToast:ae,isIn:!1,className:Pg(L.className||v.toastClassName),bodyClassName:Pg(L.bodyClassName||v.bodyClassName),progressClassName:Pg(L.progressClassName||v.progressClassName),autoClose:!L.isLoading&&(Y=L.autoClose,R=v.autoClose,Y===!1||hm(Y)&&Y>0?Y:R),deleteToast(){const b=w.get(M),{onClose:O,children:S}=b.props;bi(O)&&O(C.isValidElement(S)&&S.props),f(iS(b,"removed")),w.delete(M),x--,x<0&&(x=0),m.length>0?j(m.shift()):T()}};var Y,R;oe.closeButton=v.closeButton,L.closeButton===!1||SN(L.closeButton)?oe.closeButton=L.closeButton:L.closeButton===!0&&(oe.closeButton=!SN(v.closeButton)||v.closeButton);let z=E;C.isValidElement(E)&&!dd(E.type)?z=C.cloneElement(E,{closeToast:ae,toastProps:oe,data:D}):bi(E)&&(z=E({closeToast:ae,toastProps:oe,data:D}));const ee={content:z,props:oe,staleId:G};v.limit&&v.limit>0&&x>v.limit&&Z?m.push(ee):hm(K)?setTimeout(()=>{j(ee)},K):j(ee)},setProps(E){v=E},setToggle:(E,L)=>{w.get(E).toggle=L},isToastActive:E=>g.some(L=>L===E),getSnapshot:()=>p}}(o,i,Hq);_a.set(o,c);const A=c.observe(l);return mm.forEach(d=>RI(d.content,d.options)),mm=[],()=>{A(),_a.delete(o)}},setProps(l){var c;(c=_a.get(o))==null||c.setProps(l)},getSnapshot(){var l;return(l=_a.get(o))==null?void 0:l.getSnapshot()}}}(e)).current;n(e);const s=C.useSyncExternalStore(t,r,r);return{getToastToRender:function(i){if(!s)return[];const o=new Map;return e.newestOnTop&&s.reverse(),s.forEach(l=>{const{position:c}=l.props;o.has(c)||o.set(c,[]),o.get(c).push(l)}),Array.from(o,l=>i(l[0],l[1]))},isToastActive:OI,count:s==null?void 0:s.length}}function $q(e){const[t,r]=C.useState(!1),[n,s]=C.useState(!1),i=C.useRef(null),o=C.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:l,pauseOnHover:c,closeToast:A,onClick:d,closeOnClick:u}=e;var f,h;function x(){r(!0)}function m(){r(!1)}function g(w){const B=i.current;o.canDrag&&B&&(o.didMove=!0,t&&m(),o.delta=e.draggableDirection==="x"?w.clientX-o.start:w.clientY-o.start,o.start!==w.clientX&&(o.canCloseOnClick=!1),B.style.transform=`translate3d(${e.draggableDirection==="x"?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`},0)`,B.style.opacity=""+(1-Math.abs(o.delta/o.removalDistance)))}function p(){document.removeEventListener("pointermove",g),document.removeEventListener("pointerup",p);const w=i.current;if(o.canDrag&&o.didMove&&w){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance)return s(!0),e.closeToast(),void e.collapseAll();w.style.transition="transform 0.2s, opacity 0.2s",w.style.removeProperty("transform"),w.style.removeProperty("opacity")}}(h=_a.get((f={id:e.toastId,containerId:e.containerId,fn:r}).containerId||1))==null||h.setToggle(f.id,f.fn),C.useEffect(()=>{if(e.pauseOnFocusLoss)return document.hasFocus()||m(),window.addEventListener("focus",x),window.addEventListener("blur",m),()=>{window.removeEventListener("focus",x),window.removeEventListener("blur",m)}},[e.pauseOnFocusLoss]);const v={onPointerDown:function(w){if(e.draggable===!0||e.draggable===w.pointerType){o.didMove=!1,document.addEventListener("pointermove",g),document.addEventListener("pointerup",p);const B=i.current;o.canCloseOnClick=!0,o.canDrag=!0,B.style.transition="none",e.draggableDirection==="x"?(o.start=w.clientX,o.removalDistance=B.offsetWidth*(e.draggablePercent/100)):(o.start=w.clientY,o.removalDistance=B.offsetHeight*(e.draggablePercent===80?1.5*e.draggablePercent:e.draggablePercent)/100)}},onPointerUp:function(w){const{top:B,bottom:T,left:_,right:j}=i.current.getBoundingClientRect();w.nativeEvent.type!=="touchend"&&e.pauseOnHover&&w.clientX>=_&&w.clientX<=j&&w.clientY>=B&&w.clientY<=T?m():x()}};return l&&c&&(v.onMouseEnter=m,e.stacked||(v.onMouseLeave=x)),u&&(v.onClick=w=>{d&&d(w),o.canCloseOnClick&&A()}),{playToast:x,pauseToast:m,isRunning:t,preventExitTransition:n,toastRef:i,eventHandlers:v}}function qq(e){let{delay:t,isRunning:r,closeToast:n,type:s="default",hide:i,className:o,style:l,controlledProgress:c,progress:A,rtl:d,isIn:u,theme:f}=e;const h=i||c&&A===0,x={...l,animationDuration:`${t}ms`,animationPlayState:r?"running":"paused"};c&&(x.transform=`scaleX(${A})`);const m=Wc("Toastify__progress-bar",c?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${f}`,`Toastify__progress-bar--${s}`,{"Toastify__progress-bar--rtl":d}),g=bi(o)?o({rtl:d,type:s,defaultClassName:m}):Wc(m,o),p={[c&&A>=1?"onTransitionEnd":"onAnimationEnd"]:c&&A<1?null:()=>{u&&n()}};return mr.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":h},mr.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${f} Toastify__progress-bar--${s}`}),mr.createElement("div",{role:"progressbar","aria-hidden":h?"true":"false","aria-label":"notification timer",className:g,style:x,...p}))}let Kq=1;const QI=()=>""+Kq++;function zq(e){return e&&(dd(e.toastId)||hm(e.toastId))?e.toastId:QI()}function _h(e,t){return RI(e,t),t.toastId}function k1(e,t){return{...t,type:t&&t.type||e,toastId:zq(t)}}function jx(e){return(t,r)=>_h(t,k1(e,r))}function Ie(e,t){return _h(e,k1("default",t))}Ie.loading=(e,t)=>_h(e,k1("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t})),Ie.promise=function(e,t,r){let n,{pending:s,error:i,success:o}=t;s&&(n=dd(s)?Ie.loading(s,r):Ie.loading(s.render,{...r,...s}));const l={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},c=(d,u,f)=>{if(u==null)return void Ie.dismiss(n);const h={type:d,...l,...r,data:f},x=dd(u)?{render:u}:u;return n?Ie.update(n,{...h,...x}):Ie(x.render,{...h,...x}),f},A=bi(e)?e():e;return A.then(d=>c("success",o,d)).catch(d=>c("error",i,d)),A},Ie.success=jx("success"),Ie.info=jx("info"),Ie.error=jx("error"),Ie.warning=jx("warning"),Ie.warn=Ie.warning,Ie.dark=(e,t)=>_h(e,k1("default",{theme:"dark",...t})),Ie.dismiss=function(e){(function(t){var r;if(PI()){if(t==null||dd(r=t)||hm(r))_a.forEach(n=>{n.removeToast(t)});else if(t&&("containerId"in t||"id"in t)){const n=_a.get(t.containerId);n?n.removeToast(t.id):_a.forEach(s=>{s.removeToast(t.id)})}}else mm=mm.filter(n=>t!=null&&n.options.toastId!==t)})(e)},Ie.clearWaitingQueue=function(e){e===void 0&&(e={}),_a.forEach(t=>{!t.props.limit||e.containerId&&t.id!==e.containerId||t.clearQueue()})},Ie.isActive=OI,Ie.update=function(e,t){t===void 0&&(t={});const r=((n,s)=>{var i;let{containerId:o}=s;return(i=_a.get(o||1))==null?void 0:i.toasts.get(n)})(e,t);if(r){const{props:n,content:s}=r,i={delay:100,...n,...t,toastId:t.toastId||e,updateId:QI()};i.toastId!==e&&(i.staleId=e);const o=i.render||s;delete i.render,_h(o,i)}},Ie.done=e=>{Ie.update(e,{progress:1})},Ie.onChange=function(e){return FN.add(e),()=>{FN.delete(e)}},Ie.play=e=>oS(!0,e),Ie.pause=e=>oS(!1,e);const Gq=typeof window<"u"?C.useLayoutEffect:C.useEffect,Bx=e=>{let{theme:t,type:r,isLoading:n,...s}=e;return mr.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:t==="colored"?"currentColor":`var(--toastify-icon-color-${r})`,...s})},mw={info:function(e){return mr.createElement(Bx,{...e},mr.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(e){return mr.createElement(Bx,{...e},mr.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(e){return mr.createElement(Bx,{...e},mr.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(e){return mr.createElement(Bx,{...e},mr.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return mr.createElement("div",{className:"Toastify__spinner"})}},Wq=e=>{const{isRunning:t,preventExitTransition:r,toastRef:n,eventHandlers:s,playToast:i}=$q(e),{closeButton:o,children:l,autoClose:c,onClick:A,type:d,hideProgressBar:u,closeToast:f,transition:h,position:x,className:m,style:g,bodyClassName:p,bodyStyle:v,progressClassName:w,progressStyle:B,updateId:T,role:_,progress:j,rtl:E,toastId:L,deleteToast:M,isIn:F,isLoading:D,closeOnClick:G,theme:K}=e,ae=Wc("Toastify__toast",`Toastify__toast-theme--${K}`,`Toastify__toast--${d}`,{"Toastify__toast--rtl":E},{"Toastify__toast--close-on-click":G}),Z=bi(m)?m({rtl:E,position:x,type:d,defaultClassName:ae}):Wc(ae,m),oe=function(ee){let{theme:b,type:O,isLoading:S,icon:I}=ee,U=null;const Q={theme:b,type:O};return I===!1||(bi(I)?U=I({...Q,isLoading:S}):C.isValidElement(I)?U=C.cloneElement(I,Q):S?U=mw.spinner():(H=>H in mw)(O)&&(U=mw[O](Q))),U}(e),Y=!!j||!c,R={closeToast:f,type:d,theme:K};let z=null;return o===!1||(z=bi(o)?o(R):C.isValidElement(o)?C.cloneElement(o,R):function(ee){let{closeToast:b,theme:O,ariaLabel:S="close"}=ee;return mr.createElement("button",{className:`Toastify__close-button Toastify__close-button--${O}`,type:"button",onClick:I=>{I.stopPropagation(),b(I)},"aria-label":S},mr.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},mr.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}(R)),mr.createElement(h,{isIn:F,done:M,position:x,preventExitTransition:r,nodeRef:n,playToast:i},mr.createElement("div",{id:L,onClick:A,"data-in":F,className:Z,...s,style:g,ref:n},mr.createElement("div",{...F&&{role:_},className:bi(p)?p({type:d}):Wc("Toastify__toast-body",p),style:v},oe!=null&&mr.createElement("div",{className:Wc("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!D})},oe),mr.createElement("div",null,l)),z,mr.createElement(qq,{...T&&!Y?{key:`pb-${T}`}:{},rtl:E,theme:K,delay:c,isRunning:t,isIn:F,closeToast:f,hide:u,type:d,style:B,className:w,controlledProgress:Y,progress:j||0})))},rv=function(e,t){return t===void 0&&(t=!1),{enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t}},Xq=tv(rv("bounce",!0));tv(rv("slide",!0));tv(rv("zoom"));tv(rv("flip"));const Yq={position:"top-right",transition:Xq,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};function In(e){let t={...Yq,...e};const r=e.stacked,[n,s]=C.useState(!0),i=C.useRef(null),{getToastToRender:o,isToastActive:l,count:c}=Vq(t),{className:A,style:d,rtl:u,containerId:f}=t;function h(m){const g=Wc("Toastify__toast-container",`Toastify__toast-container--${m}`,{"Toastify__toast-container--rtl":u});return bi(A)?A({position:m,rtl:u,defaultClassName:g}):Wc(g,Pg(A))}function x(){r&&(s(!0),Ie.play())}return Gq(()=>{if(r){var m;const g=i.current.querySelectorAll('[data-in="true"]'),p=12,v=(m=t.position)==null?void 0:m.includes("top");let w=0,B=0;Array.from(g).reverse().forEach((T,_)=>{const j=T;j.classList.add("Toastify__toast--stacked"),_>0&&(j.dataset.collapsed=`${n}`),j.dataset.pos||(j.dataset.pos=v?"top":"bot");const E=w*(n?.2:1)+(n?0:p*_);j.style.setProperty("--y",`${v?E:-1*E}px`),j.style.setProperty("--g",`${p}`),j.style.setProperty("--s",""+(1-(n?B:0))),w+=j.offsetHeight,B+=.025})}},[n,c,r]),mr.createElement("div",{ref:i,className:"Toastify",id:f,onMouseEnter:()=>{r&&(s(!1),Ie.pause())},onMouseLeave:x},o((m,g)=>{const p=g.length?{...d}:{...d,pointerEvents:"none"};return mr.createElement("div",{className:h(m),style:p,key:`container-${m}`},g.map(v=>{let{content:w,props:B}=v;return mr.createElement(Wq,{...B,stacked:r,collapseAll:x,isIn:l(B.toastId,B.containerId),style:B.style,key:`toast-${B.key}`},w)}))}))}const Jq=()=>{const[e,t]=C.useState(!1),r=Sr(),n=JSON.parse(localStorage.getItem("user"));if(C.useEffect(()=>{const l=setTimeout(()=>{t(!0)},3e3);return()=>clearTimeout(l)},[]),n)return a.jsx(b9,{to:"/dashboard"});const s=l=>{const A=l.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),d=decodeURIComponent(atob(A).split("").map(u=>`%${`00${u.charCodeAt(0).toString(16)}`.slice(-2)}`).join(""));return JSON.parse(d)},i=async l=>{var d,u,f,h,x,m,g,p,v,w;const c=s(l.credential),{email:A}=c;localStorage.setItem("email",A);try{const B=await vI(A);B.status===200?(localStorage.setItem("userId",(u=(d=B==null?void 0:B.data)==null?void 0:d.data)==null?void 0:u._id),localStorage.setItem("role",(h=(f=B==null?void 0:B.data)==null?void 0:f.data)==null?void 0:h.role),localStorage.setItem("user",JSON.stringify({...c})),localStorage.setItem("department",(m=(x=B==null?void 0:B.data)==null?void 0:x.data)==null?void 0:m.department),localStorage.setItem("empAccessToken",(g=B==null?void 0:B.data)==null?void 0:g.token),localStorage.setItem("capEmpId",(v=(p=B==null?void 0:B.data)==null?void 0:p.data)==null?void 0:v.employee_id),localStorage.setItem("multiRole",(w=B==null?void 0:B.data)==null?void 0:w.multiRole),r("/dashboard")):B.status===401&&(Ie.error(B.response.data.message),setTimeout(()=>{r("/")},1e3))}catch{}},o=()=>{Ie.error("Login Failed")};return a.jsxs("div",{className:"min-h-screen flex flex-col md:flex-row",children:[a.jsx("div",{className:"w-full md:w-2/5 bg-primary p-8 md:p-16 flex flex-col relative",children:a.jsxs("div",{className:"relative z-10 flex flex-col flex-grow",children:[a.jsx("div",{className:"flex-grow flex flex-col justify-center",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-white text-4xl font-sans mb-2",children:"Welcome to"}),a.jsx("h1",{className:"text-white text-5xl font-prima font-bold",children:"Capillary Technologies"}),a.jsx("p",{className:"text-white opacity-80 mt-4",children:"Please sign in to continue"})]})}),a.jsx("div",{className:"mt-auto",children:a.jsxs("a",{href:"/",className:"text-white opacity-80 flex items-center hover:opacity-100 transition-opacity text-sm w-fit",children:[a.jsx("svg",{className:"w-4 h-4 mr-2",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})}),"back to site"]})})]})}),a.jsxs("div",{className:"w-full md:w-3/5 bg-white p-8 md:p-12 flex flex-col",children:[a.jsx("div",{className:"flex justify-end mb-16",children:e&&a.jsx(Qq,{onSuccess:i,onError:o,useOneTap:!0,clientId:void 0})}),a.jsx("div",{className:"flex justify-center items-center flex-grow",children:a.jsx("div",{className:"flex items-center",children:a.jsx("img",{src:Pu,alt:"Capillary Logo"})})})]}),a.jsx(In,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,pauseOnFocusLoss:!0})]})},Zq="/assets/CapillaryLogo_Horiz-B-A3Nhbs.png",eK=()=>{var m,g;const e=Sr(),t=localStorage.getItem("capEmpId"),r=JSON.parse(localStorage.getItem("user")),n=localStorage.getItem("role"),s=localStorage.getItem("department"),[i,o]=C.useState(!1),[l,c]=C.useState(!1),[A,d]=C.useState([]),u=C.useRef(null);C.useEffect(()=>{n!=="Employee"&&(async()=>{try{const v=await H$(t);v.status===200&&d(v.data.reqData)}catch(v){console.error("Failed to fetch notifications:",v)}})()},[t,n]),C.useEffect(()=>{const p=v=>{u.current&&!u.current.contains(v.target)&&c(!1)};return document.addEventListener("mousedown",p),()=>{document.removeEventListener("mousedown",p)}},[]);const f=()=>{o(!i)},h=()=>{localStorage.clear(),e("/")},x=p=>{u.current&&!u.current.contains(p.target)&&e("/employee-profile")};return a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"bg-white shadow-md px-4 sm:px-6 py-4 flex items-center justify-between h-16",children:[a.jsx("div",{className:"flex items-center",children:a.jsx($y,{to:"/dashboard",className:"mr-4 sm:mr-6",children:a.jsx("img",{src:Zq,alt:"Capillary Logo",className:"h-8 w-auto sm:h-16 p-3"})})}),a.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4 ml-auto",children:[a.jsxs("div",{className:"relative",onClick:f,children:[a.jsx(j1,{className:"text-gray-500 cursor-pointer hover:text-primary transition-colors"}),(A==null?void 0:A.length)>0&&a.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:A==null?void 0:A.length})]}),a.jsxs("div",{className:"relative flex items-center bg-gray-100 hover:bg-gray-200 rounded-full cursor-pointer px-3 sm:px-4 py-2 transition-colors duration-200 shadow-sm",onClick:x,onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),children:[a.jsx("div",{className:"mr-2 h-8 w-8 bg-primary text-white rounded-full flex items-center justify-center text-sm font-medium",children:(m=r==null?void 0:r.name)==null?void 0:m.charAt(0)}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-sm font-medium text-gray-800 truncate max-w-[120px]",children:r==null?void 0:r.name}),a.jsxs("span",{className:"text-xs text-gray-500 truncate max-w-[120px]",children:[s&&`${s}`,n&&s&&"  ",n&&`${n}`]})]}),l&&a.jsxs("div",{ref:u,className:"absolute top-full mt-2 right-0 bg-white border border-gray-200 rounded-md shadow-lg p-3 z-50 w-64",onClick:p=>p.stopPropagation(),children:[a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:"h-10 w-10 bg-primary text-white rounded-full flex items-center justify-center text-lg font-medium",children:(g=r==null?void 0:r.name)==null?void 0:g.charAt(0)}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-gray-800",children:r==null?void 0:r.name}),a.jsx("p",{className:"text-sm text-gray-600",children:n}),s&&a.jsx("p",{className:"text-sm text-gray-600",children:s}),(r==null?void 0:r.email)&&a.jsx("p",{className:"text-sm text-gray-600 truncate",children:r.email})]})]}),a.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:a.jsxs("button",{onClick:()=>e("/employee-profile"),className:"w-full text-left text-sm py-1 text-gray-700 hover:text-primary flex items-center",children:[a.jsx(Xm,{size:14,className:"mr-2"}),"View Profile"]})})]})]}),a.jsx(mH,{className:"text-gray-500 cursor-pointer hover:text-gray-700 transition-colors"}),a.jsxs("button",{onClick:h,className:"flex items-center space-x-1 px-3 py-2 text-sm text-red-600 hover:text-red-700 hover:bg-red-50 rounded-md transition-colors",children:[a.jsx(vH,{size:16}),a.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]})]}),i&&a.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white border rounded-lg shadow-lg z-50",children:[a.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[a.jsx("h3",{className:"font-semibold text-gray-800",children:"Notifications"}),a.jsx("button",{className:"text-sm text-gray-500 hover:text-gray-700",onClick:()=>d([]),children:"Clear All"})]}),(A==null?void 0:A.length)===0?a.jsx("div",{className:"p-4 text-center text-gray-500",children:"No notifications"}):a.jsx("ul",{children:A==null?void 0:A.map(p=>a.jsxs("li",{className:"px-4 py-3 hover:bg-gray-50 flex justify-between items-center",children:[a.jsx("div",{children:a.jsx("p",{children:`New Request is created with Request ID: ${p==null?void 0:p.reqid}`})}),a.jsx("button",{onClick:()=>o(!1),className:"text-gray-400 hover:text-gray-600",children:""})]},p==null?void 0:p.reqid))}),a.jsx("div",{className:"p-4 text-center cursor-pointer font-bold text-black hover:underline",children:"View All"})]})]})},tK=({icon:e,title:t,isActive:r,path:n,badgeCount:s})=>a.jsx($y,{to:n,className:"cursor-pointer px-2 relative",children:a.jsxs("div",{className:`aspect-square flex flex-col items-center justify-center p-2 rounded-lg transition-all duration-200 ease-in-out
          hover:bg-primary hover:text-white
          ${r?"bg-primary text-white":"text-gray-600 border-transparent"}
          `,children:[a.jsx(e,{className:`w-5 h-5 mb-2 ${r?"text-white":"text-primary"} group-hover:text-white`}),a.jsx("span",{className:`text-xs font-medium text-center leading-tight ${r?"text-white":""}`,children:t}),s>0&&a.jsx("span",{className:"absolute top-1 right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-bold",children:s>99?"99+":s})]})}),rK=()=>{const e=wl(),t=localStorage.getItem("role")||"Employee",r=localStorage.getItem("multiRole")||"0",[n,s]=C.useState(!1),[i,o]=C.useState(!1),[l,c]=C.useState(0),[A,d]=C.useState(0);console.log("Current role:",t),C.useEffect(()=>{const w=()=>{o(window.innerWidth<768)};return w(),window.addEventListener("resize",w),()=>window.removeEventListener("resize",w)},[]),C.useEffect(()=>{t==="Legal Team"&&(async()=>{try{console.log("Fetching legal vendors count...");const B=await l$();console.log("API response:",B),B.status===200?(console.log("Setting count to:",B.data.count),c(B.data.vendorDeviationData)):(console.log("No count data, setting fallback to 1"),c(0))}catch(B){console.error("Failed to fetch legal vendors count:",B),console.log("Setting fallback count to 1 due to error"),c(0)}})()},[t]),C.useEffect(()=>{t==="Vendor Management"&&(async()=>{try{console.log("Fetching vendor management count...");const B=await c$();console.log("Vendor Management API response:",B),B.status===200?d(B.data.vendorApproveData||0):(console.log("No vendor management count data, setting fallback to 0"),d(0))}catch(B){console.error("Failed to fetch vendor management count:",B),d(0)}})()},[t]);const u=w=>e.pathname===w?!0:w!=="/dashboard"?e.pathname.startsWith(w):!1,f=()=>{s(!n)},h=[{icon:H_,title:"Dashboard",path:"/dashboard"},{icon:bH,title:"Requests",path:"/req-list-table"}],x=[{icon:$a,title:"My Department Approvals",path:"/approval-request-list"}],m=[{icon:Fa,title:"My Vendors",path:"/vendor/my-added-vendors"}],g={Admin:[{icon:$a,title:`${t} Approvals`,path:"/role-based-approvals-list"},{icon:pH,title:"Entities",path:"/entity-list-table"},{icon:vN,title:"Employees",path:"/employee-list-table"},{icon:vN,title:"Users",path:"/panel-members-table"},{icon:Fa,title:"Vendors",path:"/vendor-list-table"},{icon:Fa,title:"Provision",path:"/provision-table"},{icon:Fa,title:"Prepaid",path:"/prepaid-table"},{icon:R3,title:"Reports",path:"/genarate-report-page"},{icon:Aw,title:"Questions",path:"/questions"},{icon:K_,title:"Settings",path:"/settings"}],Employee:[],"Legal Team":[{icon:$a,title:`${t} Approvals`,path:"/role-based-approvals-list"},{icon:Fa,title:"Vendors",path:"/vendor/pending-vendor-list-table",badgeCount:l},{icon:Aw,title:"Questions",path:"/questions"}],"Info Security":[{icon:$a,title:`${t} Approvals`,path:"/role-based-approvals-list"},{icon:Aw,title:"Questions",path:"/questions"}],"Vendor Management":[{icon:$a,title:`${t} Approvals`,path:"/role-based-approvals-list"},{icon:Fa,title:"Vendors",path:"/vendor-list-table",badgeCount:A}],"Head of Finance":[{icon:$a,title:`${t} Approvals`,path:"/role-based-approvals-list"},{icon:Fa,title:"Vendors",path:"/vendor-list-table"},{icon:Fa,title:"Provision",path:"/provision-table"},{icon:Fa,title:"Prepaid",path:"/prepaid-table"},{icon:R3,title:"Reports",path:"/genarate-report-page"}],default:[{icon:$a,title:`${t} Approvals`,path:"/role-based-approvals-list"}]},v=(()=>{const w=[...h];return r==="1"&&w.push(...x),t!=="Admin"&&t!=="Vendor Management"&&w.push(...m),w.push(...g[t]||g.default),w})();return a.jsxs("div",{className:"flex flex-col h-screen scrollbar-none overflow-y-scroll",children:[a.jsx("div",{className:"fixed w-full z-20",children:a.jsx(eK,{})}),i&&a.jsx("button",{onClick:f,className:"fixed top-10 left-2 z-30 bg-white p-2 rounded-md shadow-md","aria-label":"Toggle sidebar",children:n?a.jsx(_r,{className:"h-6 w-6 text-primary"}):a.jsx(z4,{className:"h-6 w-6 text-primary"})}),a.jsxs("div",{className:"flex flex-1 mt-10 scrollbar-none overflow-y-scroll",children:[a.jsx("div",{className:`${i?`fixed inset-y-0 left-0 transform ${n?"translate-x-0":"-translate-x-full"} z-10 mt-20 transition-transform duration-300 ease-in-out`:"w-28 h-full fixed"} bg-white border-r border-gray-200 scrollbar-none overflow-y-scroll`,children:a.jsx("div",{className:"flex flex-col py-6",children:a.jsx("div",{className:"grid grid-cols-1 gap-4 mt-5 mb-10",children:v.map((w,B)=>a.jsx(tK,{icon:w.icon,title:w.title,path:w.path,isActive:u(w.path),badgeCount:w.badgeCount||0},B))})})}),a.jsx(In,{position:"top-center",autoClose:!1,newestOnTop:!0,closeOnClick:!1,rtl:!1,pauseOnFocusLoss:!1,draggable:!1}),a.jsx("div",{className:`flex-1 ${i?"ml-0":"ml-28"} scrollbar-none overflow-y-scroll bg-gray-50 pt-4`,children:a.jsx("div",{className:"p-2 sm:p-8",children:a.jsx(N9,{})})})]})]})},sC=Fn.create({baseURL:"https://porequests-sandbox.corp.capillarytech.com"});sC.interceptors.response.use(e=>e,e=>{if(e.response){const{status:t,data:r}=e.response;t===401&&localStorage.removeItem("accessToken");const n=(r==null?void 0:r.message)||"An unknown error occurred.";return console.log("Error Message from Response:",n),Promise.reject(new Error(n))}else return console.log("Network/Request Error:",e.message),Promise.reject(new Error(e.message||"An unknown network error occurred."))});const aC=async e=>{try{return await sC.post("/signup",e)}catch(t){return t}},nK=async e=>{try{return await sC.post("/auth/fetchuserData",e)}catch(t){return t}},sK=()=>{const[e,t]=C.useState(!1),[r,n]=C.useState({name:"",phone:"",email:"",password:""}),s=o=>{n({...r,[o.target.name]:o.target.value})},i=async o=>{o.preventDefault();try{console.log("formdata",r);const l=await aC(r);console.log(l)}catch(l){console.error("Network error:",l),alert("Failed to connect to the server.")}};return a.jsxs("div",{className:"max-w-5xl mx-auto p-4",children:[a.jsx("h1",{className:"text-2xl font-normal text-primary mb-8",children:"Add New User"}),a.jsxs("form",{onSubmit:i,className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsx("div",{children:a.jsx("input",{type:"text",name:"name",value:r.name,onChange:s,placeholder:"Name",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-primary focus:border-primary"})}),a.jsx("div",{children:a.jsx("input",{type:"email",name:"email",value:r.email,onChange:s,placeholder:"Email",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-primary focus:border-primary"})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 col-span-1 md:col-span-2",children:[a.jsx("div",{children:a.jsx("input",{type:"tel",name:"phone",value:r.phone,onChange:s,placeholder:"Phone Number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-primary focus:border-primary"})}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:e?"text":"password",name:"password",value:r.password,onChange:s,placeholder:"Password",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-primary focus:border-primary"}),a.jsx("button",{type:"button",onClick:()=>t(!e),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e?a.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z M12 9v.01 M12 15v.01"}):a.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"})})})]})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{type:"submit",className:"px-6 py-2 bg-primary text-white rounded-md hover:bg-pink-700 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",children:"SUBMIT"})})]})]})},aK=()=>{const[e]=C.useState([{id:1,name:"rakesh",email:"aswin@gmail.com",phone:"1111111111",password:"123"},{id:2,name:"raj",email:"sksahoosanu7@gmail.com",phone:"3287381292",password:"262838327"},{id:3,name:"jayram",email:"jay@gmail.com",phone:"9287831972",password:"hdhggh27652"},{id:4,name:"aswiniii",email:"www@gmail.com",phone:"00009875123",password:"78jbh998"},{id:5,name:"ttt",email:"cdf@gmail.com",phone:"6543982074",password:"366327rr"},{id:6,name:"hfgfh",email:"anu7@gmail.com",phone:"456789034567",password:"4568yugjhb"},{id:7,name:"ppp",email:"asw@gmail.com",phone:"1111111111",password:"199923"}]);return a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h1",{className:"text-2xl font-medium",children:"User List"}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(rn,{className:"w-5 h-5 text-gray-500 cursor-pointer"}),a.jsx(_n,{className:"w-5 h-5 text-gray-500 cursor-pointer"}),a.jsx(EH,{className:"w-5 h-5 text-gray-500 cursor-pointer"}),a.jsx(NH,{className:"w-5 h-5 text-gray-500 cursor-pointer"}),a.jsx(z4,{className:"w-5 h-5 text-gray-500 cursor-pointer"})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"p-4 w-12",children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-gray-300"})}),a.jsx("th",{className:"p-4 text-left font-medium",children:"Name"}),a.jsx("th",{className:"p-4 text-left font-medium",children:"Email"}),a.jsx("th",{className:"p-4 text-left font-medium",children:"Phone Number"}),a.jsx("th",{className:"p-4 text-left font-medium",children:"Password"}),a.jsx("th",{className:"p-4 text-left font-medium",children:"Actions"})]})}),a.jsx("tbody",{children:e.map(t=>a.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[a.jsx("td",{className:"p-4",children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-gray-300"})}),a.jsx("td",{className:"p-4",children:t.name}),a.jsx("td",{className:"p-4",children:t.email}),a.jsx("td",{className:"p-4",children:t.phone}),a.jsx("td",{className:"p-4",children:t.password}),a.jsx("td",{className:"p-4",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{className:"text-primary hover:text-primary",children:a.jsx(jH,{className:"w-5 h-5"})}),a.jsx("button",{className:"text-primary hover:text-primary",children:a.jsx(kH,{className:"w-5 h-5"})})]})})]},t.id))})]})})]})},iK=()=>{const[e,t]=C.useState(!1),[r,n]=C.useState({name:"",phone:"",email:"",password:""}),s=o=>{n({...r,[o.target.name]:o.target.value})},i=async o=>{o.preventDefault();try{console.log("formdata",r);const l=await aC(r);console.log(l)}catch(l){console.error("Network error:",l),alert("Failed to connect to the server.")}};return a.jsxs("div",{className:"max-w-5xl mx-auto p-4",children:[a.jsx("h1",{className:"text-2xl font-normal text-primary mb-8",children:"Add New User"}),a.jsxs("form",{onSubmit:i,className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsx("div",{children:a.jsx("input",{type:"text",name:"name",value:r.name,onChange:s,placeholder:"Name",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-primary focus:border-primary"})}),a.jsx("div",{children:a.jsx("input",{type:"email",name:"email",value:r.email,onChange:s,placeholder:"Email",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-primary focus:border-primary"})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 col-span-1 md:col-span-2",children:[a.jsx("div",{children:a.jsx("input",{type:"tel",name:"phone",value:r.phone,onChange:s,placeholder:"Phone Number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-primary focus:border-primary"})}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:e?"text":"password",name:"password",value:r.password,onChange:s,placeholder:"Password",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-primary focus:border-primary"}),a.jsx("button",{type:"button",onClick:()=>t(!e),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e?a.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z M12 9v.01 M12 15v.01"}):a.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"})})})]})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{type:"submit",className:"px-6 py-2 bg-primary text-white rounded-md hover:bg-primary focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",children:"SUBMIT"})})]})]})},oK=()=>{const e=localStorage.getItem("email");console.log(e);const[t,r]=C.useState(!1),[n,s]=C.useState({name:"",phone:"",email:"",password:""});C.useEffect(()=>{(async()=>{const c=await nK(e);console.log(c)})()},[e]);const i=l=>{s({...n,[l.target.name]:l.target.value})},o=async l=>{l.preventDefault();try{console.log("formdata",n);const c=await aC(n);console.log(c)}catch(c){console.error("Network error:",c),alert("Failed to connect to the server.")}};return a.jsxs("div",{className:"max-w-5xl mx-auto p-4",children:[a.jsx("h1",{className:"text-2xl font-normal text-primary mb-8",children:"Add New User"}),a.jsxs("form",{onSubmit:o,className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsx("div",{children:a.jsx("input",{type:"text",name:"name",value:n.name,onChange:i,placeholder:"Name",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-primary focus:border-primary"})}),a.jsx("div",{children:a.jsx("input",{type:"email",name:"email",value:n.email,onChange:i,placeholder:"Email",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-primary focus:border-primary"})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 col-span-1 md:col-span-2",children:[a.jsx("div",{children:a.jsx("input",{type:"tel",name:"phone",value:n.phone,onChange:i,placeholder:"Phone Number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-primary focus:border-primary"})}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:t?"text":"password",name:"password",value:n.password,onChange:i,placeholder:"Password",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-primary focus:border-primary"}),a.jsx("button",{type:"button",onClick:()=>r(!t),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t?a.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z M12 9v.01 M12 15v.01"}):a.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"})})})]})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{type:"submit",className:"px-6 py-2 bg-primary text-white rounded-md hover:bg-primary focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",children:"SUBMIT"})})]})]})},lK=()=>{const e=Sr(),[t,r]=C.useState(""),n=async i=>{var o,l,c,A;try{console.log("Domain submitted:",i);const d=await T$(i);if(d.status===201)Ie.success(((o=d==null?void 0:d.data)==null?void 0:o.message)||"Domain added successfully!"),setTimeout(()=>{e("/admin/domain-table")},1500);else{const u=((l=d==null?void 0:d.data)==null?void 0:l.message)||"Domain already exists in the allowed list";Ie.error(u)}}catch(d){console.error("Error in allowing domain:",d);const u=((A=(c=d==null?void 0:d.response)==null?void 0:c.data)==null?void 0:A.message)||"An unexpected error occurred.";Ie.error(u)}},s=i=>{i.preventDefault(),t.trim()&&(n(t),r(""))};return a.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[a.jsxs("div",{className:"w-full max-w-md p-6 bg-white shadow-lg rounded-lg",children:[a.jsx("h2",{className:"text-2xl font-semibold text-center text-gray-700 mb-6",children:"Allow Domain"}),a.jsxs("form",{onSubmit:s,className:"flex flex-col gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"domain",className:"block text-sm font-medium text-gray-600 mb-1",children:"Domain Name"}),a.jsx("input",{id:"domain",type:"text",value:t,onChange:i=>r(i.target.value),placeholder:"Enter a valid domain (e.g., example.com)",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none transition-all"})]}),a.jsx("button",{type:"submit",className:"w-full px-6 py-3 bg-primary text-white font-semibold rounded-lg hover:bg-primary-dark focus:ring-2 focus:ring-primary focus:outline-none transition-all",children:"Submit Domain"})]})]}),a.jsx(In,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,pauseOnFocusLoss:!0})]})},cK=()=>{const[e,t]=C.useState([]),[r,n]=C.useState(1),[s]=C.useState(5),i=Sr();C.useEffect(()=>{(async()=>{var x,m;try{const g=await _$();Array.isArray((x=g==null?void 0:g.data)==null?void 0:x.data)?t((m=g==null?void 0:g.data)==null?void 0:m.data):Ie.error("Invalid data structure returned from the API")}catch(g){console.error("Error fetching domains:",g),Ie.error("Failed to fetch domains")}})()},[]);const o=async h=>{var x,m,g,p;try{const v=await I$(h);console.log(v),(x=v==null?void 0:v.data)!=null&&x.message?Ie.success((m=v.data)==null?void 0:m.message):Ie.success("Domain deleted successfully"),t(e==null?void 0:e.filter(w=>(w==null?void 0:w._id)!==h))}catch(v){console.error("Error deleting domain:",v),Ie.error(((p=(g=v==null?void 0:v.response)==null?void 0:g.data)==null?void 0:p.message)||"Failed to delete domain. Please try again later.")}},l=()=>{i("/admin/domain")},c=r*s,A=c-s,d=e==null?void 0:e.slice(A,c),u=h=>n(h),f=[];for(let h=1;h<=Math.ceil(e.length/s);h++)f.push(h);return a.jsxs("div",{className:"container mx-auto p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-2xl font-semibold",children:"Allowed Domains"}),a.jsx("button",{onClick:l,className:"px-6 py-2 bg-primary text-white font-medium rounded-md hover:bg-primary-dark focus:ring-2 focus:ring-primary focus:outline-none transition-all",children:"Add Domain"})]}),a.jsxs("table",{className:"table-auto w-full border-collapse border border-gray-200",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-primary text-white",children:[a.jsx("th",{className:"border p-2",children:"Sl. No"}),a.jsx("th",{className:"border p-2",children:"Domain Name"}),a.jsx("th",{className:"border p-2",children:"Action"})]})}),a.jsx("tbody",{children:(d==null?void 0:d.length)===0?a.jsx("tr",{children:a.jsx("td",{colSpan:"3",className:"border p-2 text-center",children:"No domains found."})}):d==null?void 0:d.map((h,x)=>a.jsxs("tr",{children:[a.jsx("td",{className:"border p-2 text-center",children:x+1+(r-1)*s}),a.jsx("td",{className:"border p-2",children:h==null?void 0:h.domain}),a.jsx("td",{className:"border p-2 text-center",children:a.jsx("button",{onClick:()=>o(h==null?void 0:h._id),className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark",children:"Delete"})})]},h==null?void 0:h._id))})]}),a.jsx("div",{className:"flex justify-center mt-4",children:a.jsx("ul",{className:"flex list-none",children:f.map(h=>a.jsx("li",{className:"mx-1",children:a.jsx("button",{onClick:()=>u(h),className:`px-4 py-2 border rounded-md ${h===r?"bg-primary text-white":"bg-white text-primary border-primary"} hover:bg-primary hover:text-white transition-all`,children:h})},h))})}),a.jsx(In,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,pauseOnFocusLoss:!0})]})};function Qd(e){this._maxSize=e,this.clear()}Qd.prototype.clear=function(){this._size=0,this._values=Object.create(null)};Qd.prototype.get=function(e){return this._values[e]};Qd.prototype.set=function(e,t){return this._size>=this._maxSize&&this.clear(),e in this._values||this._size++,this._values[e]=t};var AK=/[^.^\]^[]+|(?=\[\]|\.\.)/g,MI=/^\d+$/,dK=/^\d/,uK=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,fK=/^\s*(['"]?)(.*?)(\1)\s*$/,iC=512,lS=new Qd(iC),cS=new Qd(iC),AS=new Qd(iC),ud={Cache:Qd,split:EN,normalizePath:pw,setter:function(e){var t=pw(e);return cS.get(e)||cS.set(e,function(n,s){for(var i=0,o=t.length,l=n;i<o-1;){var c=t[i];if(c==="__proto__"||c==="constructor"||c==="prototype")return n;l=l[t[i++]]}l[t[i]]=s})},getter:function(e,t){var r=pw(e);return AS.get(e)||AS.set(e,function(s){for(var i=0,o=r.length;i<o;)if(s!=null||!t)s=s[r[i++]];else return;return s})},join:function(e){return e.reduce(function(t,r){return t+(oC(r)||MI.test(r)?"["+r+"]":(t?".":"")+r)},"")},forEach:function(e,t,r){hK(Array.isArray(e)?e:EN(e),t,r)}};function pw(e){return lS.get(e)||lS.set(e,EN(e).map(function(t){return t.replace(fK,"$2")}))}function EN(e){return e.match(AK)||[""]}function hK(e,t,r){var n=e.length,s,i,o,l;for(i=0;i<n;i++)s=e[i],s&&(xK(s)&&(s='"'+s+'"'),l=oC(s),o=!l&&/^\d+$/.test(s),t.call(r,s,l,o,i,e))}function oC(e){return typeof e=="string"&&e&&["'",'"'].indexOf(e.charAt(0))!==-1}function mK(e){return e.match(dK)&&!e.match(MI)}function pK(e){return uK.test(e)}function xK(e){return!oC(e)&&(mK(e)||pK(e))}const gK=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,nv=e=>e.match(gK)||[],sv=e=>e[0].toUpperCase()+e.slice(1),lC=(e,t)=>nv(e).join(t).toLowerCase(),HI=e=>nv(e).reduce((t,r)=>`${t}${t?r[0].toUpperCase()+r.slice(1).toLowerCase():r.toLowerCase()}`,""),yK=e=>sv(HI(e)),vK=e=>lC(e,"_"),wK=e=>lC(e,"-"),bK=e=>sv(lC(e," ")),NK=e=>nv(e).map(sv).join(" ");var xw={words:nv,upperFirst:sv,camelCase:HI,pascalCase:yK,snakeCase:vK,kebabCase:wK,sentenceCase:bK,titleCase:NK},cC={exports:{}};cC.exports=function(e){return VI(CK(e),e)};cC.exports.array=VI;function VI(e,t){var r=e.length,n=new Array(r),s={},i=r,o=jK(t),l=BK(e);for(t.forEach(function(A){if(!l.has(A[0])||!l.has(A[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")});i--;)s[i]||c(e[i],i,new Set);return n;function c(A,d,u){if(u.has(A)){var f;try{f=", node was:"+JSON.stringify(A)}catch{f=""}throw new Error("Cyclic dependency"+f)}if(!l.has(A))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(A));if(!s[d]){s[d]=!0;var h=o.get(A)||new Set;if(h=Array.from(h),d=h.length){u.add(A);do{var x=h[--d];c(x,l.get(x),u)}while(d);u.delete(A)}n[--r]=A}}}function CK(e){for(var t=new Set,r=0,n=e.length;r<n;r++){var s=e[r];t.add(s[0]),t.add(s[1])}return Array.from(t)}function jK(e){for(var t=new Map,r=0,n=e.length;r<n;r++){var s=e[r];t.has(s[0])||t.set(s[0],new Set),t.has(s[1])||t.set(s[1],new Set),t.get(s[0]).add(s[1])}return t}function BK(e){for(var t=new Map,r=0,n=e.length;r<n;r++)t.set(e[r],r);return t}var SK=cC.exports;const FK=M5(SK),EK=Object.prototype.toString,kK=Error.prototype.toString,TK=RegExp.prototype.toString,_K=typeof Symbol<"u"?Symbol.prototype.toString:()=>"",IK=/^Symbol\((.*)\)(.*)$/;function LK(e){return e!=+e?"NaN":e===0&&1/e<0?"-0":""+e}function dS(e,t=!1){if(e==null||e===!0||e===!1)return""+e;const r=typeof e;if(r==="number")return LK(e);if(r==="string")return t?`"${e}"`:e;if(r==="function")return"[Function "+(e.name||"anonymous")+"]";if(r==="symbol")return _K.call(e).replace(IK,"Symbol($1)");const n=EK.call(e).slice(8,-1);return n==="Date"?isNaN(e.getTime())?""+e:e.toISOString(e):n==="Error"||e instanceof Error?"["+kK.call(e)+"]":n==="RegExp"?TK.call(e):null}function Zl(e,t){let r=dS(e,t);return r!==null?r:JSON.stringify(e,function(n,s){let i=dS(this[n],t);return i!==null?i:s},2)}function $I(e){return e==null?[]:[].concat(e)}let qI,KI,zI,UK=/\$\{\s*(\w+)\s*\}/g;qI=Symbol.toStringTag;class uS{constructor(t,r,n,s){this.name=void 0,this.message=void 0,this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=void 0,this.inner=void 0,this[qI]="Error",this.name="ValidationError",this.value=r,this.path=n,this.type=s,this.errors=[],this.inner=[],$I(t).forEach(i=>{if(za.isError(i)){this.errors.push(...i.errors);const o=i.inner.length?i.inner:[i];this.inner.push(...o)}else this.errors.push(i)}),this.message=this.errors.length>1?`${this.errors.length} errors occurred`:this.errors[0]}}KI=Symbol.hasInstance;zI=Symbol.toStringTag;class za extends Error{static formatError(t,r){const n=r.label||r.path||"this";return r=Object.assign({},r,{path:n,originalPath:r.path}),typeof t=="string"?t.replace(UK,(s,i)=>Zl(r[i])):typeof t=="function"?t(r):t}static isError(t){return t&&t.name==="ValidationError"}constructor(t,r,n,s,i){const o=new uS(t,r,n,s);if(i)return o;super(),this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=[],this.inner=[],this[zI]="Error",this.name=o.name,this.message=o.message,this.type=o.type,this.value=o.value,this.path=o.path,this.errors=o.errors,this.inner=o.inner,Error.captureStackTrace&&Error.captureStackTrace(this,za)}static[KI](t){return uS[Symbol.hasInstance](t)||super[Symbol.hasInstance](t)}}let ll={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:({path:e,type:t,value:r,originalValue:n})=>{const s=n!=null&&n!==r?` (cast from the value \`${Zl(n,!0)}\`).`:".";return t!=="mixed"?`${e} must be a \`${t}\` type, but the final value was: \`${Zl(r,!0)}\``+s:`${e} must match the configured type. The validated value was: \`${Zl(r,!0)}\``+s}},Ha={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",datetime:"${path} must be a valid ISO date-time",datetime_precision:"${path} must be a valid ISO date-time with a sub-second precision of exactly ${precision} digits",datetime_offset:'${path} must be a valid ISO date-time with UTC "Z" timezone',trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},Oc={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},kN={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},DK={isValue:"${path} field must be ${value}"},Og={noUnknown:"${path} field has unspecified keys: ${unknown}",exact:"${path} object contains unknown properties: ${properties}"},Rg={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},PK={notType:e=>{const{path:t,value:r,spec:n}=e,s=n.types.length;if(Array.isArray(r)){if(r.length<s)return`${t} tuple value has too few items, expected a length of ${s} but got ${r.length} for value: \`${Zl(r,!0)}\``;if(r.length>s)return`${t} tuple value has too many items, expected a length of ${s} but got ${r.length} for value: \`${Zl(r,!0)}\``}return za.formatError(ll.notType,e)}};Object.assign(Object.create(null),{mixed:ll,string:Ha,number:Oc,date:kN,object:Og,array:Rg,boolean:DK,tuple:PK});const av=e=>e&&e.__isYupSchema__;class T1{static fromOptions(t,r){if(!r.then&&!r.otherwise)throw new TypeError("either `then:` or `otherwise:` is required for `when()` conditions");let{is:n,then:s,otherwise:i}=r,o=typeof n=="function"?n:(...l)=>l.every(c=>c===n);return new T1(t,(l,c)=>{var A;let d=o(...l)?s:i;return(A=d==null?void 0:d(c))!=null?A:c})}constructor(t,r){this.fn=void 0,this.refs=t,this.refs=t,this.fn=r}resolve(t,r){let n=this.refs.map(i=>i.getValue(r==null?void 0:r.value,r==null?void 0:r.parent,r==null?void 0:r.context)),s=this.fn(n,t,r);if(s===void 0||s===t)return t;if(!av(s))throw new TypeError("conditions must return a schema object");return s.resolve(r)}}const Sx={context:"$",value:"."};class Md{constructor(t,r={}){if(this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,typeof t!="string")throw new TypeError("ref must be a string, got: "+t);if(this.key=t.trim(),t==="")throw new TypeError("ref must be a non-empty string");this.isContext=this.key[0]===Sx.context,this.isValue=this.key[0]===Sx.value,this.isSibling=!this.isContext&&!this.isValue;let n=this.isContext?Sx.context:this.isValue?Sx.value:"";this.path=this.key.slice(n.length),this.getter=this.path&&ud.getter(this.path,!0),this.map=r.map}getValue(t,r,n){let s=this.isContext?n:this.isValue?t:r;return this.getter&&(s=this.getter(s||{})),this.map&&(s=this.map(s)),s}cast(t,r){return this.getValue(t,r==null?void 0:r.parent,r==null?void 0:r.context)}resolve(){return this}describe(){return{type:"ref",key:this.key}}toString(){return`Ref(${this.key})`}static isRef(t){return t&&t.__isYupRef}}Md.prototype.__isYupRef=!0;const Wl=e=>e==null;function Cu(e){function t({value:r,path:n="",options:s,originalValue:i,schema:o},l,c){const{name:A,test:d,params:u,message:f,skipAbsent:h}=e;let{parent:x,context:m,abortEarly:g=o.spec.abortEarly,disableStackTrace:p=o.spec.disableStackTrace}=s;function v(F){return Md.isRef(F)?F.getValue(r,x,m):F}function w(F={}){const D=Object.assign({value:r,originalValue:i,label:o.spec.label,path:F.path||n,spec:o.spec,disableStackTrace:F.disableStackTrace||p},u,F.params);for(const K of Object.keys(D))D[K]=v(D[K]);const G=new za(za.formatError(F.message||f,D),r,D.path,F.type||A,D.disableStackTrace);return G.params=D,G}const B=g?l:c;let T={path:n,parent:x,type:A,from:s.from,createError:w,resolve:v,options:s,originalValue:i,schema:o};const _=F=>{za.isError(F)?B(F):F?c(null):B(w())},j=F=>{za.isError(F)?B(F):l(F)};if(h&&Wl(r))return _(!0);let L;try{var M;if(L=d.call(T,r,T),typeof((M=L)==null?void 0:M.then)=="function"){if(s.sync)throw new Error(`Validation test of type: "${T.type}" returned a Promise during a synchronous validate. This test will finish after the validate call has returned`);return Promise.resolve(L).then(_,j)}}catch(F){j(F);return}_(L)}return t.OPTIONS=e,t}function OK(e,t,r,n=r){let s,i,o;return t?(ud.forEach(t,(l,c,A)=>{let d=c?l.slice(1,l.length-1):l;e=e.resolve({context:n,parent:s,value:r});let u=e.type==="tuple",f=A?parseInt(d,10):0;if(e.innerType||u){if(u&&!A)throw new Error(`Yup.reach cannot implicitly index into a tuple type. the path part "${o}" must contain an index to the tuple element, e.g. "${o}[0]"`);if(r&&f>=r.length)throw new Error(`Yup.reach cannot resolve an array item at index: ${l}, in the path: ${t}. because there is no value at that index. `);s=r,r=r&&r[f],e=u?e.spec.types[f]:e.innerType}if(!A){if(!e.fields||!e.fields[d])throw new Error(`The schema does not contain the path: ${t}. (failed at: ${o} which is a type: "${e.type}")`);s=r,r=r&&r[d],e=e.fields[d]}i=d,o=c?"["+l+"]":"."+l}),{schema:e,parent:s,parentPath:i}):{parent:s,parentPath:t,schema:e}}class _1 extends Set{describe(){const t=[];for(const r of this.values())t.push(Md.isRef(r)?r.describe():r);return t}resolveAll(t){let r=[];for(const n of this.values())r.push(t(n));return r}clone(){return new _1(this.values())}merge(t,r){const n=this.clone();return t.forEach(s=>n.add(s)),r.forEach(s=>n.delete(s)),n}}function nf(e,t=new Map){if(av(e)||!e||typeof e!="object")return e;if(t.has(e))return t.get(e);let r;if(e instanceof Date)r=new Date(e.getTime()),t.set(e,r);else if(e instanceof RegExp)r=new RegExp(e),t.set(e,r);else if(Array.isArray(e)){r=new Array(e.length),t.set(e,r);for(let n=0;n<e.length;n++)r[n]=nf(e[n],t)}else if(e instanceof Map){r=new Map,t.set(e,r);for(const[n,s]of e.entries())r.set(n,nf(s,t))}else if(e instanceof Set){r=new Set,t.set(e,r);for(const n of e)r.add(nf(n,t))}else if(e instanceof Object){r={},t.set(e,r);for(const[n,s]of Object.entries(e))r[n]=nf(s,t)}else throw Error(`Unable to clone ${e}`);return r}class Ei{constructor(t){this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new _1,this._blacklist=new _1,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation(()=>{this.typeError(ll.notType)}),this.type=t.type,this._typeCheck=t.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,disableStackTrace:!1,nullable:!1,optional:!0,coerce:!0},t==null?void 0:t.spec),this.withMutation(r=>{r.nonNullable()})}get _type(){return this.type}clone(t){if(this._mutate)return t&&Object.assign(this.spec,t),this;const r=Object.create(Object.getPrototypeOf(this));return r.type=this.type,r._typeCheck=this._typeCheck,r._whitelist=this._whitelist.clone(),r._blacklist=this._blacklist.clone(),r.internalTests=Object.assign({},this.internalTests),r.exclusiveTests=Object.assign({},this.exclusiveTests),r.deps=[...this.deps],r.conditions=[...this.conditions],r.tests=[...this.tests],r.transforms=[...this.transforms],r.spec=nf(Object.assign({},this.spec,t)),r}label(t){let r=this.clone();return r.spec.label=t,r}meta(...t){if(t.length===0)return this.spec.meta;let r=this.clone();return r.spec.meta=Object.assign(r.spec.meta||{},t[0]),r}withMutation(t){let r=this._mutate;this._mutate=!0;let n=t(this);return this._mutate=r,n}concat(t){if(!t||t===this)return this;if(t.type!==this.type&&this.type!=="mixed")throw new TypeError(`You cannot \`concat()\` schema's of different types: ${this.type} and ${t.type}`);let r=this,n=t.clone();const s=Object.assign({},r.spec,n.spec);return n.spec=s,n.internalTests=Object.assign({},r.internalTests,n.internalTests),n._whitelist=r._whitelist.merge(t._whitelist,t._blacklist),n._blacklist=r._blacklist.merge(t._blacklist,t._whitelist),n.tests=r.tests,n.exclusiveTests=r.exclusiveTests,n.withMutation(i=>{t.tests.forEach(o=>{i.test(o.OPTIONS)})}),n.transforms=[...r.transforms,...n.transforms],n}isType(t){return t==null?!!(this.spec.nullable&&t===null||this.spec.optional&&t===void 0):this._typeCheck(t)}resolve(t){let r=this;if(r.conditions.length){let n=r.conditions;r=r.clone(),r.conditions=[],r=n.reduce((s,i)=>i.resolve(s,t),r),r=r.resolve(t)}return r}resolveOptions(t){var r,n,s,i;return Object.assign({},t,{from:t.from||[],strict:(r=t.strict)!=null?r:this.spec.strict,abortEarly:(n=t.abortEarly)!=null?n:this.spec.abortEarly,recursive:(s=t.recursive)!=null?s:this.spec.recursive,disableStackTrace:(i=t.disableStackTrace)!=null?i:this.spec.disableStackTrace})}cast(t,r={}){let n=this.resolve(Object.assign({value:t},r)),s=r.assert==="ignore-optionality",i=n._cast(t,r);if(r.assert!==!1&&!n.isType(i)){if(s&&Wl(i))return i;let o=Zl(t),l=Zl(i);throw new TypeError(`The value of ${r.path||"field"} could not be cast to a value that satisfies the schema type: "${n.type}". 

attempted value: ${o} 
`+(l!==o?`result of cast: ${l}`:""))}return i}_cast(t,r){let n=t===void 0?t:this.transforms.reduce((s,i)=>i.call(this,s,t,this),t);return n===void 0&&(n=this.getDefault(r)),n}_validate(t,r={},n,s){let{path:i,originalValue:o=t,strict:l=this.spec.strict}=r,c=t;l||(c=this._cast(c,Object.assign({assert:!1},r)));let A=[];for(let d of Object.values(this.internalTests))d&&A.push(d);this.runTests({path:i,value:c,originalValue:o,options:r,tests:A},n,d=>{if(d.length)return s(d,c);this.runTests({path:i,value:c,originalValue:o,options:r,tests:this.tests},n,s)})}runTests(t,r,n){let s=!1,{tests:i,value:o,originalValue:l,path:c,options:A}=t,d=m=>{s||(s=!0,r(m,o))},u=m=>{s||(s=!0,n(m,o))},f=i.length,h=[];if(!f)return u([]);let x={value:o,originalValue:l,path:c,options:A,schema:this};for(let m=0;m<i.length;m++){const g=i[m];g(x,d,function(v){v&&(Array.isArray(v)?h.push(...v):h.push(v)),--f<=0&&u(h)})}}asNestedTest({key:t,index:r,parent:n,parentPath:s,originalParent:i,options:o}){const l=t??r;if(l==null)throw TypeError("Must include `key` or `index` for nested validations");const c=typeof l=="number";let A=n[l];const d=Object.assign({},o,{strict:!0,parent:n,value:A,originalValue:i[l],key:void 0,[c?"index":"key"]:l,path:c||l.includes(".")?`${s||""}[${c?l:`"${l}"`}]`:(s?`${s}.`:"")+t});return(u,f,h)=>this.resolve(d)._validate(A,d,f,h)}validate(t,r){var n;let s=this.resolve(Object.assign({},r,{value:t})),i=(n=r==null?void 0:r.disableStackTrace)!=null?n:s.spec.disableStackTrace;return new Promise((o,l)=>s._validate(t,r,(c,A)=>{za.isError(c)&&(c.value=A),l(c)},(c,A)=>{c.length?l(new za(c,A,void 0,void 0,i)):o(A)}))}validateSync(t,r){var n;let s=this.resolve(Object.assign({},r,{value:t})),i,o=(n=r==null?void 0:r.disableStackTrace)!=null?n:s.spec.disableStackTrace;return s._validate(t,Object.assign({},r,{sync:!0}),(l,c)=>{throw za.isError(l)&&(l.value=c),l},(l,c)=>{if(l.length)throw new za(l,t,void 0,void 0,o);i=c}),i}isValid(t,r){return this.validate(t,r).then(()=>!0,n=>{if(za.isError(n))return!1;throw n})}isValidSync(t,r){try{return this.validateSync(t,r),!0}catch(n){if(za.isError(n))return!1;throw n}}_getDefault(t){let r=this.spec.default;return r==null?r:typeof r=="function"?r.call(this,t):nf(r)}getDefault(t){return this.resolve(t||{})._getDefault(t)}default(t){return arguments.length===0?this._getDefault():this.clone({default:t})}strict(t=!0){return this.clone({strict:t})}nullability(t,r){const n=this.clone({nullable:t});return n.internalTests.nullable=Cu({message:r,name:"nullable",test(s){return s===null?this.schema.spec.nullable:!0}}),n}optionality(t,r){const n=this.clone({optional:t});return n.internalTests.optionality=Cu({message:r,name:"optionality",test(s){return s===void 0?this.schema.spec.optional:!0}}),n}optional(){return this.optionality(!0)}defined(t=ll.defined){return this.optionality(!1,t)}nullable(){return this.nullability(!0)}nonNullable(t=ll.notNull){return this.nullability(!1,t)}required(t=ll.required){return this.clone().withMutation(r=>r.nonNullable(t).defined(t))}notRequired(){return this.clone().withMutation(t=>t.nullable().optional())}transform(t){let r=this.clone();return r.transforms.push(t),r}test(...t){let r;if(t.length===1?typeof t[0]=="function"?r={test:t[0]}:r=t[0]:t.length===2?r={name:t[0],test:t[1]}:r={name:t[0],message:t[1],test:t[2]},r.message===void 0&&(r.message=ll.default),typeof r.test!="function")throw new TypeError("`test` is a required parameters");let n=this.clone(),s=Cu(r),i=r.exclusive||r.name&&n.exclusiveTests[r.name]===!0;if(r.exclusive&&!r.name)throw new TypeError("Exclusive tests must provide a unique `name` identifying the test");return r.name&&(n.exclusiveTests[r.name]=!!r.exclusive),n.tests=n.tests.filter(o=>!(o.OPTIONS.name===r.name&&(i||o.OPTIONS.test===s.OPTIONS.test))),n.tests.push(s),n}when(t,r){!Array.isArray(t)&&typeof t!="string"&&(r=t,t=".");let n=this.clone(),s=$I(t).map(i=>new Md(i));return s.forEach(i=>{i.isSibling&&n.deps.push(i.key)}),n.conditions.push(typeof r=="function"?new T1(s,r):T1.fromOptions(s,r)),n}typeError(t){let r=this.clone();return r.internalTests.typeError=Cu({message:t,name:"typeError",skipAbsent:!0,test(n){return this.schema._typeCheck(n)?!0:this.createError({params:{type:this.schema.type}})}}),r}oneOf(t,r=ll.oneOf){let n=this.clone();return t.forEach(s=>{n._whitelist.add(s),n._blacklist.delete(s)}),n.internalTests.whiteList=Cu({message:r,name:"oneOf",skipAbsent:!0,test(s){let i=this.schema._whitelist,o=i.resolveAll(this.resolve);return o.includes(s)?!0:this.createError({params:{values:Array.from(i).join(", "),resolved:o}})}}),n}notOneOf(t,r=ll.notOneOf){let n=this.clone();return t.forEach(s=>{n._blacklist.add(s),n._whitelist.delete(s)}),n.internalTests.blacklist=Cu({message:r,name:"notOneOf",test(s){let i=this.schema._blacklist,o=i.resolveAll(this.resolve);return o.includes(s)?this.createError({params:{values:Array.from(i).join(", "),resolved:o}}):!0}}),n}strip(t=!0){let r=this.clone();return r.spec.strip=t,r}describe(t){const r=(t?this.resolve(t):this).clone(),{label:n,meta:s,optional:i,nullable:o}=r.spec;return{meta:s,label:n,optional:i,nullable:o,default:r.getDefault(t),type:r.type,oneOf:r._whitelist.describe(),notOneOf:r._blacklist.describe(),tests:r.tests.map(c=>({name:c.OPTIONS.name,params:c.OPTIONS.params})).filter((c,A,d)=>d.findIndex(u=>u.name===c.name)===A)}}}Ei.prototype.__isYupSchema__=!0;for(const e of["validate","validateSync"])Ei.prototype[`${e}At`]=function(t,r,n={}){const{parent:s,parentPath:i,schema:o}=OK(this,t,r,n.context);return o[e](s&&s[i],Object.assign({},n,{parent:s,path:t}))};for(const e of["equals","is"])Ei.prototype[e]=Ei.prototype.oneOf;for(const e of["not","nope"])Ei.prototype[e]=Ei.prototype.notOneOf;const RK=()=>!0;function fl(e){return new GI(e)}class GI extends Ei{constructor(t){super(typeof t=="function"?{type:"mixed",check:t}:Object.assign({type:"mixed",check:RK},t))}}fl.prototype=GI.prototype;const QK=/^(\d{4}|[+-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,.](\d{1,}))?)?(?:(Z)|([+-])(\d{2})(?::?(\d{2}))?)?)?$/;function MK(e){const t=TN(e);if(!t)return Date.parse?Date.parse(e):Number.NaN;if(t.z===void 0&&t.plusMinus===void 0)return new Date(t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond).valueOf();let r=0;return t.z!=="Z"&&t.plusMinus!==void 0&&(r=t.hourOffset*60+t.minuteOffset,t.plusMinus==="+"&&(r=0-r)),Date.UTC(t.year,t.month,t.day,t.hour,t.minute+r,t.second,t.millisecond)}function TN(e){var t,r;const n=QK.exec(e);return n?{year:Ol(n[1]),month:Ol(n[2],1)-1,day:Ol(n[3],1),hour:Ol(n[4]),minute:Ol(n[5]),second:Ol(n[6]),millisecond:n[7]?Ol(n[7].substring(0,3)):0,precision:(t=(r=n[7])==null?void 0:r.length)!=null?t:void 0,z:n[8]||void 0,plusMinus:n[9]||void 0,hourOffset:Ol(n[10]),minuteOffset:Ol(n[11])}:null}function Ol(e,t=0){return Number(e)||t}let HK=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,VK=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,$K=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,qK="^\\d{4}-\\d{2}-\\d{2}",KK="\\d{2}:\\d{2}:\\d{2}",zK="(([+-]\\d{2}(:?\\d{2})?)|Z)",GK=new RegExp(`${qK}T${KK}(\\.\\d+)?${zK}$`),WK=e=>Wl(e)||e===e.trim(),XK={}.toString();function St(){return new WI}class WI extends Ei{constructor(){super({type:"string",check(t){return t instanceof String&&(t=t.valueOf()),typeof t=="string"}}),this.withMutation(()=>{this.transform((t,r,n)=>{if(!n.spec.coerce||n.isType(t)||Array.isArray(t))return t;const s=t!=null&&t.toString?t.toString():t;return s===XK?t:s})})}required(t){return super.required(t).withMutation(r=>r.test({message:t||ll.required,name:"required",skipAbsent:!0,test:n=>!!n.length}))}notRequired(){return super.notRequired().withMutation(t=>(t.tests=t.tests.filter(r=>r.OPTIONS.name!=="required"),t))}length(t,r=Ha.length){return this.test({message:r,name:"length",exclusive:!0,params:{length:t},skipAbsent:!0,test(n){return n.length===this.resolve(t)}})}min(t,r=Ha.min){return this.test({message:r,name:"min",exclusive:!0,params:{min:t},skipAbsent:!0,test(n){return n.length>=this.resolve(t)}})}max(t,r=Ha.max){return this.test({name:"max",exclusive:!0,message:r,params:{max:t},skipAbsent:!0,test(n){return n.length<=this.resolve(t)}})}matches(t,r){let n=!1,s,i;return r&&(typeof r=="object"?{excludeEmptyString:n=!1,message:s,name:i}=r:s=r),this.test({name:i||"matches",message:s||Ha.matches,params:{regex:t},skipAbsent:!0,test:o=>o===""&&n||o.search(t)!==-1})}email(t=Ha.email){return this.matches(HK,{name:"email",message:t,excludeEmptyString:!0})}url(t=Ha.url){return this.matches(VK,{name:"url",message:t,excludeEmptyString:!0})}uuid(t=Ha.uuid){return this.matches($K,{name:"uuid",message:t,excludeEmptyString:!1})}datetime(t){let r="",n,s;return t&&(typeof t=="object"?{message:r="",allowOffset:n=!1,precision:s=void 0}=t:r=t),this.matches(GK,{name:"datetime",message:r||Ha.datetime,excludeEmptyString:!0}).test({name:"datetime_offset",message:r||Ha.datetime_offset,params:{allowOffset:n},skipAbsent:!0,test:i=>{if(!i||n)return!0;const o=TN(i);return o?!!o.z:!1}}).test({name:"datetime_precision",message:r||Ha.datetime_precision,params:{precision:s},skipAbsent:!0,test:i=>{if(!i||s==null)return!0;const o=TN(i);return o?o.precision===s:!1}})}ensure(){return this.default("").transform(t=>t===null?"":t)}trim(t=Ha.trim){return this.transform(r=>r!=null?r.trim():r).test({message:t,name:"trim",test:WK})}lowercase(t=Ha.lowercase){return this.transform(r=>Wl(r)?r:r.toLowerCase()).test({message:t,name:"string_case",exclusive:!0,skipAbsent:!0,test:r=>Wl(r)||r===r.toLowerCase()})}uppercase(t=Ha.uppercase){return this.transform(r=>Wl(r)?r:r.toUpperCase()).test({message:t,name:"string_case",exclusive:!0,skipAbsent:!0,test:r=>Wl(r)||r===r.toUpperCase()})}}St.prototype=WI.prototype;let YK=e=>e!=+e;function Lf(){return new XI}class XI extends Ei{constructor(){super({type:"number",check(t){return t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&!YK(t)}}),this.withMutation(()=>{this.transform((t,r,n)=>{if(!n.spec.coerce)return t;let s=t;if(typeof s=="string"){if(s=s.replace(/\s/g,""),s==="")return NaN;s=+s}return n.isType(s)||s===null?s:parseFloat(s)})})}min(t,r=Oc.min){return this.test({message:r,name:"min",exclusive:!0,params:{min:t},skipAbsent:!0,test(n){return n>=this.resolve(t)}})}max(t,r=Oc.max){return this.test({message:r,name:"max",exclusive:!0,params:{max:t},skipAbsent:!0,test(n){return n<=this.resolve(t)}})}lessThan(t,r=Oc.lessThan){return this.test({message:r,name:"max",exclusive:!0,params:{less:t},skipAbsent:!0,test(n){return n<this.resolve(t)}})}moreThan(t,r=Oc.moreThan){return this.test({message:r,name:"min",exclusive:!0,params:{more:t},skipAbsent:!0,test(n){return n>this.resolve(t)}})}positive(t=Oc.positive){return this.moreThan(0,t)}negative(t=Oc.negative){return this.lessThan(0,t)}integer(t=Oc.integer){return this.test({name:"integer",message:t,skipAbsent:!0,test:r=>Number.isInteger(r)})}truncate(){return this.transform(t=>Wl(t)?t:t|0)}round(t){var r;let n=["ceil","floor","round","trunc"];if(t=((r=t)==null?void 0:r.toLowerCase())||"round",t==="trunc")return this.truncate();if(n.indexOf(t.toLowerCase())===-1)throw new TypeError("Only valid options for round() are: "+n.join(", "));return this.transform(s=>Wl(s)?s:Math[t](s))}}Lf.prototype=XI.prototype;let JK=new Date(""),ZK=e=>Object.prototype.toString.call(e)==="[object Date]";class iv extends Ei{constructor(){super({type:"date",check(t){return ZK(t)&&!isNaN(t.getTime())}}),this.withMutation(()=>{this.transform((t,r,n)=>!n.spec.coerce||n.isType(t)||t===null?t:(t=MK(t),isNaN(t)?iv.INVALID_DATE:new Date(t)))})}prepareParam(t,r){let n;if(Md.isRef(t))n=t;else{let s=this.cast(t);if(!this._typeCheck(s))throw new TypeError(`\`${r}\` must be a Date or a value that can be \`cast()\` to a Date`);n=s}return n}min(t,r=kN.min){let n=this.prepareParam(t,"min");return this.test({message:r,name:"min",exclusive:!0,params:{min:t},skipAbsent:!0,test(s){return s>=this.resolve(n)}})}max(t,r=kN.max){let n=this.prepareParam(t,"max");return this.test({message:r,name:"max",exclusive:!0,params:{max:t},skipAbsent:!0,test(s){return s<=this.resolve(n)}})}}iv.INVALID_DATE=JK;iv.prototype;function ez(e,t=[]){let r=[],n=new Set,s=new Set(t.map(([o,l])=>`${o}-${l}`));function i(o,l){let c=ud.split(o)[0];n.add(c),s.has(`${l}-${c}`)||r.push([l,c])}for(const o of Object.keys(e)){let l=e[o];n.add(o),Md.isRef(l)&&l.isSibling?i(l.path,o):av(l)&&"deps"in l&&l.deps.forEach(c=>i(c,o))}return FK.array(Array.from(n),r).reverse()}function fS(e,t){let r=1/0;return e.some((n,s)=>{var i;if((i=t.path)!=null&&i.includes(n))return r=s,!0}),r}function YI(e){return(t,r)=>fS(e,t)-fS(e,r)}const JI=(e,t,r)=>{if(typeof e!="string")return e;let n=e;try{n=JSON.parse(e)}catch{}return r.isType(n)?n:e};function Qg(e){if("fields"in e){const t={};for(const[r,n]of Object.entries(e.fields))t[r]=Qg(n);return e.setFields(t)}if(e.type==="array"){const t=e.optional();return t.innerType&&(t.innerType=Qg(t.innerType)),t}return e.type==="tuple"?e.optional().clone({types:e.spec.types.map(Qg)}):"optional"in e?e.optional():e}const tz=(e,t)=>{const r=[...ud.normalizePath(t)];if(r.length===1)return r[0]in e;let n=r.pop(),s=ud.getter(ud.join(r),!0)(e);return!!(s&&n in s)};let hS=e=>Object.prototype.toString.call(e)==="[object Object]";function mS(e,t){let r=Object.keys(e.fields);return Object.keys(t).filter(n=>r.indexOf(n)===-1)}const rz=YI([]);function ri(e){return new ZI(e)}class ZI extends Ei{constructor(t){super({type:"object",check(r){return hS(r)||typeof r=="function"}}),this.fields=Object.create(null),this._sortErrors=rz,this._nodes=[],this._excludedEdges=[],this.withMutation(()=>{t&&this.shape(t)})}_cast(t,r={}){var n;let s=super._cast(t,r);if(s===void 0)return this.getDefault(r);if(!this._typeCheck(s))return s;let i=this.fields,o=(n=r.stripUnknown)!=null?n:this.spec.noUnknown,l=[].concat(this._nodes,Object.keys(s).filter(u=>!this._nodes.includes(u))),c={},A=Object.assign({},r,{parent:c,__validating:r.__validating||!1}),d=!1;for(const u of l){let f=i[u],h=u in s;if(f){let x,m=s[u];A.path=(r.path?`${r.path}.`:"")+u,f=f.resolve({value:m,context:r.context,parent:c});let g=f instanceof Ei?f.spec:void 0,p=g==null?void 0:g.strict;if(g!=null&&g.strip){d=d||u in s;continue}x=!r.__validating||!p?f.cast(s[u],A):s[u],x!==void 0&&(c[u]=x)}else h&&!o&&(c[u]=s[u]);(h!==u in c||c[u]!==s[u])&&(d=!0)}return d?c:s}_validate(t,r={},n,s){let{from:i=[],originalValue:o=t,recursive:l=this.spec.recursive}=r;r.from=[{schema:this,value:o},...i],r.__validating=!0,r.originalValue=o,super._validate(t,r,n,(c,A)=>{if(!l||!hS(A)){s(c,A);return}o=o||A;let d=[];for(let u of this._nodes){let f=this.fields[u];!f||Md.isRef(f)||d.push(f.asNestedTest({options:r,key:u,parent:A,parentPath:r.path,originalParent:o}))}this.runTests({tests:d,value:A,originalValue:o,options:r},n,u=>{s(u.sort(this._sortErrors).concat(c),A)})})}clone(t){const r=super.clone(t);return r.fields=Object.assign({},this.fields),r._nodes=this._nodes,r._excludedEdges=this._excludedEdges,r._sortErrors=this._sortErrors,r}concat(t){let r=super.concat(t),n=r.fields;for(let[s,i]of Object.entries(this.fields)){const o=n[s];n[s]=o===void 0?i:o}return r.withMutation(s=>s.setFields(n,[...this._excludedEdges,...t._excludedEdges]))}_getDefault(t){if("default"in this.spec)return super._getDefault(t);if(!this._nodes.length)return;let r={};return this._nodes.forEach(n=>{var s;const i=this.fields[n];let o=t;(s=o)!=null&&s.value&&(o=Object.assign({},o,{parent:o.value,value:o.value[n]})),r[n]=i&&"getDefault"in i?i.getDefault(o):void 0}),r}setFields(t,r){let n=this.clone();return n.fields=t,n._nodes=ez(t,r),n._sortErrors=YI(Object.keys(t)),r&&(n._excludedEdges=r),n}shape(t,r=[]){return this.clone().withMutation(n=>{let s=n._excludedEdges;return r.length&&(Array.isArray(r[0])||(r=[r]),s=[...n._excludedEdges,...r]),n.setFields(Object.assign(n.fields,t),s)})}partial(){const t={};for(const[r,n]of Object.entries(this.fields))t[r]="optional"in n&&n.optional instanceof Function?n.optional():n;return this.setFields(t)}deepPartial(){return Qg(this)}pick(t){const r={};for(const n of t)this.fields[n]&&(r[n]=this.fields[n]);return this.setFields(r,this._excludedEdges.filter(([n,s])=>t.includes(n)&&t.includes(s)))}omit(t){const r=[];for(const n of Object.keys(this.fields))t.includes(n)||r.push(n);return this.pick(r)}from(t,r,n){let s=ud.getter(t,!0);return this.transform(i=>{if(!i)return i;let o=i;return tz(i,t)&&(o=Object.assign({},i),n||delete o[t],o[r]=s(i)),o})}json(){return this.transform(JI)}exact(t){return this.test({name:"exact",exclusive:!0,message:t||Og.exact,test(r){if(r==null)return!0;const n=mS(this.schema,r);return n.length===0||this.createError({params:{properties:n.join(", ")}})}})}stripUnknown(){return this.clone({noUnknown:!0})}noUnknown(t=!0,r=Og.noUnknown){typeof t!="boolean"&&(r=t,t=!0);let n=this.test({name:"noUnknown",exclusive:!0,message:r,test(s){if(s==null)return!0;const i=mS(this.schema,s);return!t||i.length===0||this.createError({params:{unknown:i.join(", ")}})}});return n.spec.noUnknown=t,n}unknown(t=!0,r=Og.noUnknown){return this.noUnknown(!t,r)}transformKeys(t){return this.transform(r=>{if(!r)return r;const n={};for(const s of Object.keys(r))n[t(s)]=r[s];return n})}camelCase(){return this.transformKeys(xw.camelCase)}snakeCase(){return this.transformKeys(xw.snakeCase)}constantCase(){return this.transformKeys(t=>xw.snakeCase(t).toUpperCase())}describe(t){const r=(t?this.resolve(t):this).clone(),n=super.describe(t);n.fields={};for(const[i,o]of Object.entries(r.fields)){var s;let l=t;(s=l)!=null&&s.value&&(l=Object.assign({},l,{parent:l.value,value:l.value[i]})),n.fields[i]=o.describe(l)}return n}}ri.prototype=ZI.prototype;function ov(e){return new e8(e)}class e8 extends Ei{constructor(t){super({type:"array",spec:{types:t},check(r){return Array.isArray(r)}}),this.innerType=void 0,this.innerType=t}_cast(t,r){const n=super._cast(t,r);if(!this._typeCheck(n)||!this.innerType)return n;let s=!1;const i=n.map((o,l)=>{const c=this.innerType.cast(o,Object.assign({},r,{path:`${r.path||""}[${l}]`}));return c!==o&&(s=!0),c});return s?i:n}_validate(t,r={},n,s){var i;let o=this.innerType,l=(i=r.recursive)!=null?i:this.spec.recursive;r.originalValue!=null&&r.originalValue,super._validate(t,r,n,(c,A)=>{var d;if(!l||!o||!this._typeCheck(A)){s(c,A);return}let u=new Array(A.length);for(let h=0;h<A.length;h++){var f;u[h]=o.asNestedTest({options:r,index:h,parent:A,parentPath:r.path,originalParent:(f=r.originalValue)!=null?f:t})}this.runTests({value:A,tests:u,originalValue:(d=r.originalValue)!=null?d:t,options:r},n,h=>s(h.concat(c),A))})}clone(t){const r=super.clone(t);return r.innerType=this.innerType,r}json(){return this.transform(JI)}concat(t){let r=super.concat(t);return r.innerType=this.innerType,t.innerType&&(r.innerType=r.innerType?r.innerType.concat(t.innerType):t.innerType),r}of(t){let r=this.clone();if(!av(t))throw new TypeError("`array.of()` sub-schema must be a valid yup schema not: "+Zl(t));return r.innerType=t,r.spec=Object.assign({},r.spec,{types:t}),r}length(t,r=Rg.length){return this.test({message:r,name:"length",exclusive:!0,params:{length:t},skipAbsent:!0,test(n){return n.length===this.resolve(t)}})}min(t,r){return r=r||Rg.min,this.test({message:r,name:"min",exclusive:!0,params:{min:t},skipAbsent:!0,test(n){return n.length>=this.resolve(t)}})}max(t,r){return r=r||Rg.max,this.test({message:r,name:"max",exclusive:!0,params:{max:t},skipAbsent:!0,test(n){return n.length<=this.resolve(t)}})}ensure(){return this.default(()=>[]).transform((t,r)=>this._typeCheck(t)?t:r==null?[]:[].concat(r))}compact(t){let r=t?(n,s,i)=>!t(n,s,i):n=>!!n;return this.transform(n=>n!=null?n.filter(r):n)}describe(t){const r=(t?this.resolve(t):this).clone(),n=super.describe(t);if(r.innerType){var s;let i=t;(s=i)!=null&&s.value&&(i=Object.assign({},i,{parent:i.value,value:i.value[0]})),n.innerType=r.innerType.describe(i)}return n}}ov.prototype=e8.prototype;const nz=ri().shape({services:ov().of(ri().shape({productName:St().required("Product Name is required"),productDescription:St().required("Product Description is required"),quantity:Lf().typeError("Quantity must be a number").required("Quantity is required").min(1,"Quantity must be at least 1"),price:Lf().typeError("Price must be a number").required("Price is required").min(0,"Price cannot be negative")}))}),sz=({formData:e,setFormData:t,onBack:r,onSubmit:n,handleSubmited:s,onNext:i,reqId:o})=>{console.log("reqId",o);const l={productName:"",productDescription:"",quantity:"",price:"",tax:""},[c,A]=C.useState((e==null?void 0:e.services)||[l]),[d,u]=C.useState(!1),[f,h]=C.useState(e.selectedCurrency||"INR"),[x,m]=C.useState([]),[g,p]=C.useState(!0);C.useEffect(()=>{(async()=>{try{p(!0);const F=await mo();if(F.status===200){const D=F.data.data;if(m(D),!D.some(K=>K.code===f)&&D.length>0){const K=D[0].code;h(K),t(ae=>({...ae,selectedCurrency:K}))}}}catch(F){console.error("Error fetching currencies:",F)}finally{p(!1)}})()},[]);const v=M=>{(isNaN(M)||M===null||M===void 0)&&(M=0);const F=x.find(D=>D.code===f);if(!F||!F.locale||!F.code)return`${f} ${M.toFixed(2)}`;try{return new Intl.NumberFormat(F.locale,{style:"currency",currency:F.code,minimumFractionDigits:2,maximumFractionDigits:2}).format(M)}catch(D){return console.error("Currency formatting error:",D),`${F.symbol||F.code}${M.toFixed(2)}`}},w=M=>{const F=M.target.value;h(F),t(D=>({...D,selectedCurrency:F}))},B=(M,F)=>{const{name:D,value:G}=M.target,K=[...c];K[F][D]=G,A(K)},T=()=>{A([...c,{...l}])},_=M=>{if(c.length>1){const F=c.filter((D,G)=>G!==M);A(F)}},j=M=>{const F=parseFloat(M.quantity||0),D=parseFloat(M.price||0),G=parseFloat(M.tax||0);return Number((F*D*(1+G/100)).toFixed(2))},E=c.reduce((M,F)=>M+j(F),0),L=async()=>{const M={...e,services:c,totalValue:E,selectedCurrency:f};try{await nz.validate({services:c},{abortEarly:!1}),t(D=>({...D,...M})),u(!0),n&&n(M);const F=await TI(M,o);console.log("Supplies",F),F.status===200&&i()}catch(F){if(F.inner){const D=F.inner.map(G=>G.message).join(`
`);Ie.error(D);return}}};return a.jsxs("div",{className:"mx-auto bg-white shadow-2xl rounded-2xl overflow-hidden max-w-full",children:[a.jsx("div",{className:"bg-gradient-to-r from-primary to-primary p-6",children:a.jsx("h2",{className:"text-3xl font-extrabold text-white text-center",children:"Product/Services"})}),a.jsxs("div",{className:"p-4 md:p-8 space-y-6",children:[a.jsx("div",{className:"lg:hidden space-y-4",children:c==null?void 0:c.map((M,F)=>a.jsxs("div",{className:"border rounded-lg p-4 shadow-sm bg-white space-y-3",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("h3",{className:"font-bold text-gray-700",children:["Item ",F+1]}),a.jsx("button",{type:"button",onClick:()=>_(F),className:`text-red-500 hover:text-red-700 transition duration-300 ${c.length===1?"cursor-not-allowed opacity-50":""}`,disabled:c.length===1,children:a.jsx($r,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-semibold text-gray-600 uppercase mb-1",children:["Product / Service Name"," ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"productName",value:M==null?void 0:M.productName,onChange:D=>B(D,F),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300",placeholder:"Product Name"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-semibold text-gray-600 uppercase mb-1",children:["Description"," ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{name:"productDescription",value:M==null?void 0:M.productDescription,onChange:D=>B(D,F),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300 resize-y",placeholder:"Description",rows:2})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-semibold text-gray-600 uppercase mb-1",children:["Purpose"," ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{name:"productPurpose",value:M==null?void 0:M.productPurpose,onChange:D=>B(D,F),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300 resize-y",placeholder:"Product Purpose",rows:2})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-semibold text-gray-600 uppercase mb-1",children:["Quantity"," ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"number",name:"quantity",value:M==null?void 0:M.quantity,onChange:D=>B(D,F),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300",placeholder:"Quantity",min:"0"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-semibold text-gray-600 uppercase mb-1",children:["Price"," ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"number",name:"price",value:M==null?void 0:M.price,onChange:D=>B(D,F),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300",placeholder:"Price",min:"0",step:"0.01"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-gray-600 uppercase mb-1",children:"Tax (%)"}),a.jsx("input",{type:"number",name:"tax",value:M==null?void 0:M.tax,onChange:D=>B(D,F),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300",placeholder:"Tax (%)",min:"0",step:"0.01"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-gray-600 uppercase mb-1",children:"Row Total"}),a.jsx("input",{type:"text",value:v(j(M)),readOnly:!0,className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed",placeholder:"Row Total"})]})]})]})]},F))}),a.jsx("div",{className:"hidden lg:block overflow-x-auto",children:a.jsxs("table",{className:"w-full border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-100 border-b-2 border-gray-200",children:[a.jsxs("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:["Product / Service Name",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:["Description",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:["Purpose",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:["Quantity",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:["Price",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Tax (%)"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Row Total"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider"})]})}),a.jsx("tbody",{children:c==null?void 0:c.map((M,F)=>a.jsxs("tr",{className:"border-b hover:bg-gray-50 transition duration-200",children:[a.jsx("td",{className:"px-4 py-4",children:a.jsx("input",{type:"text",name:"productName",value:M==null?void 0:M.productName,onChange:D=>B(D,F),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300",placeholder:"Product Name"})}),a.jsx("td",{className:"px-3 py-4",children:a.jsx("textarea",{name:"productDescription",value:M==null?void 0:M.productDescription,onChange:D=>B(D,F),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300 resize-y",placeholder:"Description",rows:3})}),a.jsx("td",{className:"px-3 py-4",children:a.jsx("textarea",{name:"productPurpose",value:M==null?void 0:M.productPurpose,onChange:D=>B(D,F),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300 resize-y",placeholder:"Product Purpose",rows:3})}),a.jsx("td",{className:"px-3 py-4",children:a.jsx("input",{type:"number",name:"quantity",value:M==null?void 0:M.quantity,onChange:D=>B(D,F),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300",placeholder:"Quantity",min:"0"})}),a.jsx("td",{className:"px-3 py-4",children:a.jsx("input",{type:"number",name:"price",value:M==null?void 0:M.price,onChange:D=>B(D,F),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300",placeholder:"Price",min:"0",step:"0.01"})}),a.jsx("td",{className:"px-3 py-4",children:a.jsx("input",{type:"number",name:"tax",value:M==null?void 0:M.tax,onChange:D=>B(D,F),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300",placeholder:"Tax (%)",min:"0",step:"0.01"})}),a.jsx("td",{className:"px-3 py-4",children:a.jsx("input",{type:"text",value:v(j(M)),readOnly:!0,className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed",placeholder:"Row Total"})}),a.jsx("td",{className:"px-3 py-4 text-right",children:a.jsx("button",{type:"button",onClick:()=>_(F),className:`text-red-500 hover:text-red-700 transition duration-300 ${c.length===1?"cursor-not-allowed opacity-50":""}`,disabled:c.length===1,children:a.jsx($r,{className:"w-5 h-5"})})})]},F))})]})}),a.jsx("div",{className:"bg-gray-100 p-4 rounded-lg",children:a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[a.jsx("div",{className:"font-bold text-gray-700",children:"Total Amount:"}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3",children:[g?a.jsx("div",{className:"px-3 py-2 text-gray-500",children:"Loading currencies..."}):x.length>0?a.jsx("select",{value:f,onChange:w,className:"px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300 w-full sm:w-auto",children:x.map(M=>a.jsxs("option",{value:M.code,children:[M.code," (",M.symbol,")"]},M.code))}):a.jsx("div",{className:"px-3 py-2 text-red-500",children:"Error loading currencies"}),a.jsx("div",{className:"font-bold text-blue-600 text-lg",children:v(E)})]})]})}),a.jsx("div",{className:"mt-4",children:a.jsxs("button",{type:"button",onClick:T,className:"flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary transition duration-300 shadow-md hover:shadow-lg",children:[a.jsx(Ky,{className:"w-5 h-5"}),"Add Product/Service"]})}),a.jsxs("div",{className:"mt-6",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Remarks"}),a.jsx("textarea",{name:"remarks",value:e.remarks,onChange:M=>t({...e,remarks:M.target.value}),rows:4,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition duration-300",placeholder:"Enter additional remarks or notes here..."})]}),a.jsxs("div",{className:"mt-8 flex flex-col sm:flex-row justify-between gap-4",children:[a.jsx("div",{}),a.jsxs("button",{onClick:L,className:"bg-primary text-white px-6 py-3 rounded-lg hover:bg-primary transition-colors flex items-center justify-center order-1 sm:order-2",children:[a.jsx(ca,{className:"mr-2"})," Next"]})]})]})]})};var t8={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},pS=mr.createContext&&mr.createContext(t8),az=["attr","size","title"];function iz(e,t){if(e==null)return{};var r=oz(e,t),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function oz(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function I1(){return I1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},I1.apply(this,arguments)}function xS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function L1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xS(Object(r),!0).forEach(function(n){lz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lz(e,t,r){return t=cz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cz(e){var t=Az(e,"string");return typeof t=="symbol"?t:t+""}function Az(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function r8(e){return e&&e.map((t,r)=>mr.createElement(t.tag,L1({key:r},t.attr),r8(t.child)))}function n8(e){return t=>mr.createElement(dz,I1({attr:L1({},e.attr)},t),r8(e.child))}function dz(e){var t=r=>{var{attr:n,size:s,title:i}=e,o=iz(e,az),l=s||r.size||"1em",c;return r.className&&(c=r.className),e.className&&(c=(c?c+" ":"")+e.className),mr.createElement("svg",I1({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,o,{className:c,style:L1(L1({color:e.color||r.color},r.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),i&&mr.createElement("title",null,i),e.children)};return pS!==void 0?mr.createElement(pS.Consumer,null,r=>t(r)):t(t8)}function ep(e){return n8({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M181.9 256.1c-5-16-4.9-46.9-2-46.9 8.4 0 7.6 36.9 2 46.9zm-1.7 47.2c-7.7 20.2-17.3 43.3-28.4 62.7 18.3-7 39-17.2 62.9-21.9-12.7-9.6-24.9-23.4-34.5-40.8zM86.1 428.1c0 .8 13.2-5.4 34.9-40.2-6.7 6.3-29.1 24.5-34.9 40.2zM248 160h136v328c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V24C0 10.7 10.7 0 24 0h200v136c0 13.2 10.8 24 24 24zm-8 171.8c-20-12.2-33.3-29-42.7-53.8 4.5-18.5 11.6-46.6 6.2-64.2-4.7-29.4-42.4-26.5-47.8-6.8-5 18.3-.4 44.1 8.1 77-11.6 27.6-28.7 64.6-40.8 85.8-.1 0-.1.1-.2.1-27.1 13.9-73.6 44.5-54.5 68 5.6 6.9 16 10 21.5 10 17.9 0 35.7-18 61.1-61.8 25.8-8.5 54.1-19.1 79-23.2 21.7 11.8 47.1 19.5 64 19.5 29.2 0 31.2-32 19.7-43.4-13.9-13.6-54.3-9.7-73.6-7.2zM377 105L279 7c-4.5-4.5-10.6-7-17-7h-6v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-74.1 255.3c4.1-2.7-2.5-11.9-42.8-9 37.1 15.8 42.8 9 42.8 9z"},child:[]}]})(e)}function s8(e){return n8({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(e)}const Ac=async(e,t,r)=>{try{console.log("files",e);const n=new FormData;n.append("files",e),n.append("fileType",t);const s=await Fn.post(`https://porequests-sandbox.corp.capillarytech.com/upload-s3/upload?reqId=${r}`,n,{headers:{"Content-Type":"multipart/form-data"}}),{fileUrls:i}=s.data;return console.log("response",s),console.log("Uploaded file URLs:",i),s}catch(n){throw console.error("Error uploading files:",n),new Error("Failed to upload files")}},uz=({formData:e={},setFormData:t,onBack:r,onNext:n,reqId:s})=>{console.log("procurements formData",e);const[i,o]=C.useState([]),[l,c]=C.useState(""),[A,d]=C.useState(!1),u=C.useRef(null),[f,h]=C.useState({vendor:"",servicePeriod:"",poValidFrom:"",poValidTo:"",quotationDate:""}),[x,m]=C.useState([{id:Date.now(),fileType:"",otherType:"",files:[],urls:[],agreementValidFrom:"",agreementValidTo:""}]);C.useEffect(()=>{if(e.vendor&&e.vendorName){const R=`${e.vendor} - ${e.vendorName}`;c(R)}},[e.vendor,e.vendorName]),C.useEffect(()=>{(async()=>{var z,ee;try{const b=await tC();if(b.status===200&&(o((z=b==null?void 0:b.data)==null?void 0:z.vendors),e.vendor)){const O=(ee=b==null?void 0:b.data)==null?void 0:ee.vendors.find(S=>S.vendorId===e.vendor||S.ID===e.vendor);if(O){const S=j(O);c(S)}}}catch(b){console.error("Error fetching vendors:",b)}})()},[]),C.useEffect(()=>{if(e.uploadedFiles&&Object.keys(e.uploadedFiles).length>0){const R=Object.entries(e.uploadedFiles).map(([z,ee])=>({id:Date.now()+Math.random(),fileType:z,otherType:z==="Other"?z:"",files:[],urls:ee.urls||ee,agreementValidFrom:ee.agreementValidFrom||"",agreementValidTo:ee.agreementValidTo||""}));m(R.length>0?R:[{id:Date.now(),fileType:"",otherType:"",files:[],urls:[],agreementValidFrom:"",agreementValidTo:""}])}},[]),C.useEffect(()=>{if(!e.quotationDate){const R=new Date().toISOString().split("T")[0];t(z=>({...z,quotationDate:R,servicePeriod:"One Time"}))}},[t,e.quotationDate]),C.useEffect(()=>{const R=z=>{u.current&&!u.current.contains(z.target)&&d(!1)};return document.addEventListener("mousedown",R),()=>document.removeEventListener("mousedown",R)},[]);const g=()=>{const R=new Date;return R.setDate(R.getDate()-10),R.toISOString().split("T")[0]},p=()=>new Date().toISOString().split("T")[0],v=()=>l?i.filter(R=>{const z=(R.firstName||R.Name||R.name||R.vendorName||"").toLowerCase(),ee=(R.ID||R.vendorId||"").toString().toLowerCase(),b=l.toLowerCase();return z.includes(b)||ee.includes(b)}):[],w=R=>R.fileType==="Other"?R.otherType:R.fileType,B=()=>{let R={},z=!0;if(e.vendor||(R.vendor="Vendor selection is required",z=!1),e.servicePeriod||(R.servicePeriod="Service period is required",z=!1),e.uploadedFiles&&Object.keys(e.uploadedFiles).length>0&&Object.values(e.uploadedFiles).some(b=>(b.urls||b).length>0)||(R.documents="At least one document must be uploaded",z=!1),e.servicePeriod==="custom"){if(!e.poValidFrom)R.poValidFrom="Valid from date is required",z=!1;else{const b=new Date(e.poValidFrom),O=new Date;O.setDate(O.getDate()-11),b<=O&&(R.poValidFrom="Date cannot be more than 10 days in the past",z=!1)}if(!e.poValidTo)R.poValidTo="Valid to date is required",z=!1;else{const b=new Date(e.poValidTo),O=new Date;O.setDate(O.getDate()-11),b<=O&&(R.poValidTo="Date cannot be more than 10 days in the past",z=!1)}e.poValidFrom&&e.poValidTo&&new Date(e.poValidFrom)>new Date(e.poValidTo)&&(R.poValidTo="Valid to date must be after valid from date",z=!1)}if(!e.quotationDate)R.quotationDate="Quotation date is required",z=!1;else{const b=new Date(e.quotationDate),O=new Date;O.setDate(O.getDate()-11),b<=O&&(R.quotationDate="Quotation date cannot be more than 10 days in the past",z=!1)}return e.uploadedFiles&&Object.entries(e.uploadedFiles).forEach(([b,O])=>{O.agreementValidFrom&&O.agreementValidTo&&new Date(O.agreementValidFrom)>new Date(O.agreementValidTo)&&(R[`${b}_agreementDates`]=`${b}: Agreement Valid To date must be after Valid From date`,z=!1)}),h(R),z},T=R=>{const{name:z,value:ee}=R.target;if((z==="poValidFrom"||z==="poValidTo")&&ee){const b=new Date(ee),O=new Date;if(O.setDate(O.getDate()-11),b<=O){h(S=>({...S,[z]:"Date cannot be more than 10 days in the past"}));return}else h(S=>({...S,[z]:""}))}if(z==="quotationDate"&&ee){const b=new Date(ee),O=new Date;O.setDate(O.getDate()-11);const S=new Date;if(b<O){h(I=>({...I,quotationDate:"Quotation date cannot be more than 10 days in the past"}));return}else if(b>S){h(I=>({...I,quotationDate:"Quotation date cannot be in the future"}));return}else h(I=>({...I,quotationDate:""}))}if(z==="vendor"){const b=i.find(O=>O.vendorId===ee);console.log("selectedVendor",b),t(O=>({...O,vendor:ee,vendorName:b?b.vendorName||b.Name||b.name:"",email:b.email,isNewVendor:b.isNewVendor}))}else t(b=>({...b,[z]:ee}))},_=R=>{const z=R.ID||R.vendorId,ee=R.firstName||R.Name||R.name||R.vendorName;t(b=>({...b,vendor:z,vendorName:ee,email:R.email,isNewVendor:R.isNewVendor})),c(j(R)),d(!1),h(b=>({...b,vendor:""}))},j=R=>{if(R.isNewVendor)return`${R.firstName} (New Vendor)`;const z=R.firstName||R.Name||R.name||R.vendorName;return`${R.vendorId||R.ID} - ${z}`},E=async(R,z)=>{const ee=Array.from(R.target.files),b=x[z],O=w(b);if(!O){alert("Please select a file type first");return}try{const S=await Promise.all(ee.map(async I=>(await Ac(I,O,s)).data.fileUrls[0]));m(I=>I.map((U,Q)=>Q===z?{...U,files:[...U.files,...ee],urls:[...U.urls,...S]}:U)),t(I=>{const U=I.uploadedFiles||{},Q=U[O]||{urls:[],agreementValidFrom:"",agreementValidTo:""};return{...I,uploadedFiles:{...U,[O]:{urls:[...Q.urls||Q,...S],agreementValidFrom:Q.agreementValidFrom||"",agreementValidTo:Q.agreementValidTo||""}}}})}catch(S){console.error("Error uploading files:",S),alert("Error uploading files. Please try again.")}},L=async(R,z,ee)=>{t(b=>{const O={...b.uploadedFiles};if(O[R]){const S=O[R],U=(S.urls||S).filter((Q,H)=>H!==z);U.length===0?delete O[R]:O[R]={...S,urls:U}}return{...b,uploadedFiles:O}}),m(b=>b.map(O=>{if(w(O)===R){const I=O.urls.filter((U,Q)=>Q!==z);return I.length!==O.urls.length?{...O,urls:I}:O}return O}))},M=(R,z)=>{const ee=R.target.value;m(S=>{const I=[...S];return I[z]={...I[z],fileType:ee,otherType:ee==="Other"?I[z].otherType:""},I});const b=w(x[z]),O=ee==="Other"?x[z].otherType:ee;b&&b!==O&&t(S=>{const I={...S.uploadedFiles};return x[z].urls.length>0&&(I[O]={urls:x[z].urls,agreementValidFrom:x[z].agreementValidFrom,agreementValidTo:x[z].agreementValidTo}),delete I[b],{...S,uploadedFiles:I}})},F=(R,z)=>{const ee=[...x];ee[z].otherType=R.target.value,m(ee)},D=(R,z,ee)=>{const{value:b}=R.target,O=x[z],S=w(O);m(I=>I.map((U,Q)=>Q===z?{...U,[ee]:b}:U)),S&&t(I=>{const U={...I.uploadedFiles};return U[S]||(U[S]={urls:[],agreementValidFrom:"",agreementValidTo:""}),U[S]={...U[S],[ee]:b},{...I,uploadedFiles:U}})},G=()=>{m(R=>[...R,{id:Date.now()+Math.random(),fileType:"",otherType:"",files:[],urls:[],agreementValidFrom:"",agreementValidTo:""}])},K=R=>{const z=w(x[R]),ee=x.filter((b,O)=>O!==R);m(ee),z&&t(b=>{const O={...b.uploadedFiles};return delete O[z],{...b,uploadedFiles:O}})},ae=async()=>{console.log("FormData being sent:",e),console.log("UploadedFiles structure:",e.uploadedFiles),B()?(await kI(e,s)).status===200&&n():Ie.error("Please fill in all required fields correctly")},Z=()=>{const R=v();return a.jsxs("div",{className:"relative",ref:u,children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Choose Vendor",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(s8,{className:"text-gray-400"})}),a.jsx("input",{type:"text",placeholder:"Search vendor by name or ID...",value:l,onChange:z=>{c(z.target.value),d(!0)},onClick:()=>d(!0),className:"w-full pl-10 px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300"})]}),A&&a.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:R.length>0?R.map(z=>a.jsxs("div",{className:"px-4 py-2 hover:bg-gray-100 cursor-pointer transition duration-200",onClick:()=>_(z),children:[a.jsx("div",{className:"font-medium",children:j(z)}),z.email&&a.jsx("div",{className:"text-sm text-gray-500",children:z.email})]},z._id)):a.jsx("div",{className:"px-4 py-3 text-gray-500",children:"No vendors found"})}),a.jsx(Y,{error:f.vendor})]})},oe=R=>{const z=x[R],ee=w(z);if(!ee||!z.urls.length)return null;const b=z.fileType==="Other"?z.otherType:z.fileType;return a.jsx("div",{className:"flex flex-col gap-4",children:a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:b}),a.jsx("div",{className:"flex flex-wrap gap-2",children:z.urls.map((O,S)=>a.jsxs("div",{className:"flex items-center bg-gray-100 rounded-lg p-2",children:[a.jsxs("a",{href:O,target:"_blank",rel:"noopener noreferrer",className:"flex items-center",children:[a.jsx(ep,{size:24,className:"text-red-500"}),a.jsx("span",{className:"ml-1 text-sm md:text-base truncate max-w-xs",children:`${ee}-${S}`})]}),a.jsx("button",{onClick:()=>L(ee,S),className:"ml-2 text-red-500 hover:text-red-700",children:""})]},S))})]})})},Y=({error:R})=>R?a.jsx("p",{className:"text-red-500 text-sm mt-1",children:R}):null;return a.jsxs("div",{className:"mx-auto bg-white shadow-2xl rounded-2xl overflow-hidden",children:[a.jsx("div",{className:"bg-gradient-to-r from-primary to-primary p-4 md:p-6",children:a.jsx("h2",{className:"text-xl md:text-3xl font-extrabold text-white text-center",children:"Procurement Details"})}),a.jsx("div",{className:"p-4 md:p-8 space-y-6",children:a.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx("div",{className:"col-span-1",children:Z()}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Quotation Date"}),a.jsx("input",{type:"date",name:"quotationDate",value:e.quotationDate||"",onChange:T,min:g(),max:p(),className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300"}),a.jsx(Y,{error:f.quotationDate})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Quotation Number"}),a.jsx("input",{type:"text",name:"quotationNumber",value:e.quotationNumber||"",onChange:T,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300",placeholder:"Enter Quotation Number"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Service Period",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{name:"servicePeriod",value:e.servicePeriod||"oneTime",onChange:R=>{T(R),R.target.value==="oneTime"&&t(z=>({...z,poValidFrom:"",poValidTo:""}))},className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300",children:[a.jsx("option",{value:"oneTime",children:"One Time"}),a.jsx("option",{value:"custom",children:"Custom"})]}),a.jsx(Y,{error:f.servicePeriod})]}),e.servicePeriod==="custom"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Service Valid From"}),a.jsx("input",{type:"date",name:"poValidFrom",value:e.poValidFrom||"",onChange:T,min:g(),max:p(),className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300"}),a.jsx(Y,{error:f.poValidFrom})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Service Valid To"}),a.jsx("input",{type:"date",name:"poValidTo",value:e.poValidTo||"",onChange:T,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300"}),a.jsx(Y,{error:f.poValidTo})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Project Code"}),a.jsx("input",{type:"text",name:"projectCode",value:e.projectCode||"",onChange:T,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Client Name"}),a.jsx("input",{type:"text",name:"clientName",value:e.clientName||"",onChange:T,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Upload Documents"}),f.documents&&a.jsx("p",{className:"text-red-500 text-sm mt-1 mb-2",children:f.documents}),Object.entries(f).map(([R,z])=>R.includes("_agreementDates")?a.jsx(Y,{error:z},R):null),a.jsxs("div",{className:"overflow-x-auto",children:[a.jsx("div",{className:"md:hidden",children:x.map((R,z)=>a.jsxs("div",{className:"mb-4 p-4 border rounded-lg shadow-sm",children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"block text-xs font-semibold text-gray-600 uppercase mb-2",children:"File Type"}),a.jsxs("select",{value:R.fileType,onChange:ee=>M(ee,z),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",children:[a.jsx("option",{value:"",children:"Select File Type"}),a.jsx("option",{value:"finalQuotation",children:"Final Quotation"}),a.jsx("option",{value:"competitive",children:"Competitive"}),a.jsx("option",{value:"agreement",children:"Agreement"}),a.jsx("option",{value:"engagementwork",children:"Engagement Letter(EL)"}),a.jsx("option",{value:"statementofwork",children:"Statement Of Work (SOW)"}),a.jsx("option",{value:"Other",children:"Other"})]}),R.fileType==="Other"&&a.jsx("input",{type:"text",placeholder:"Enter other file type",value:R.otherType,onChange:ee=>F(ee,z),className:"mt-2 w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-gray-600 uppercase mb-2",children:"Agreement Valid From"}),a.jsx("input",{type:"date",value:R.agreementValidFrom,onChange:ee=>D(ee,z,"agreementValidFrom"),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-gray-600 uppercase mb-2",children:"Agreement Valid To"}),a.jsx("input",{type:"date",value:R.agreementValidTo,onChange:ee=>D(ee,z,"agreementValidTo"),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary"})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"block text-xs font-semibold text-gray-600 uppercase mb-2",children:"Upload File"}),a.jsx("input",{type:"file",onChange:ee=>E(ee,z),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",multiple:!0,disabled:!R.fileType})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"block text-xs font-semibold text-gray-600 uppercase mb-2",children:"Uploaded Files"}),oe(z)]}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{onClick:()=>K(z),className:`bg-red-500 text-white hover:bg-red-700 px-4 py-2 rounded-lg transition duration-300 ${z===0?"cursor-not-allowed opacity-50":""}`,disabled:z===0,children:"Remove"})})]},R.id))}),a.jsx("div",{className:"hidden md:block",children:a.jsxs("table",{className:"w-full table-auto border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-100 border-b-2 border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"File Type"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Agreement Valid From"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Agreement Valid To"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Upload File"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Uploaded Files"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{children:x.map((R,z)=>a.jsxs("tr",{className:"border-b hover:bg-gray-50 transition duration-200",children:[a.jsxs("td",{className:"px-4 py-3",children:[a.jsxs("select",{value:R.fileType,onChange:ee=>M(ee,z),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",children:[a.jsx("option",{value:"",children:"Select File Type"}),a.jsx("option",{value:"finalQuotation",children:"Final Quotation"}),a.jsx("option",{value:"competitive",children:"Competitive"}),a.jsx("option",{value:"agreement",children:"Agreement"}),a.jsx("option",{value:"engagementwork",children:"Engagement Letter(EL)"}),a.jsx("option",{value:"statementofwork",children:"Statement Of Work (SOW)"}),a.jsx("option",{value:"Other",children:"Other"})]}),R.fileType==="Other"&&a.jsx("input",{type:"text",placeholder:"Enter other file type",value:R.otherType,onChange:ee=>F(ee,z),className:"mt-2 w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary"})]}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("input",{type:"date",value:R.agreementValidFrom,onChange:ee=>D(ee,z,"agreementValidFrom"),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary"})}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("input",{type:"date",value:R.agreementValidTo,onChange:ee=>D(ee,z,"agreementValidTo"),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary"})}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("input",{type:"file",onChange:ee=>E(ee,z),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",multiple:!0,disabled:!R.fileType})}),a.jsx("td",{className:"px-4 py-3",children:oe(z)}),a.jsx("td",{className:"px-4 py-3 text-right",children:a.jsx("button",{onClick:()=>K(z),className:`bg-red-500 text-white hover:bg-red-700 px-4 py-2 rounded-lg transition duration-300 ${z===0?"cursor-not-allowed opacity-50":""}`,disabled:z===0,children:"Remove"})})]},R.id))})]})})]}),a.jsx("div",{className:"mt-4 flex justify-start",children:a.jsx("button",{onClick:G,className:"bg-primary text-white flex items-center px-4 py-2 rounded-lg hover:bg-primary-dark transition duration-300",children:"Add Row"})})]}),a.jsxs("div",{className:"mt-8 flex flex-col sm:flex-row justify-between gap-4",children:[a.jsx("div",{}),a.jsx("button",{onClick:ae,className:"px-6 py-2 w-full sm:w-40 text-sm font-semibold text-white bg-primary rounded-lg hover:bg-primary-dark",children:"Next"})]})]})})]})},a8=ri().shape({businessUnit:St().required("Business Unit is required"),entity:St().required("Entity is required"),department:St().required("Department is required"),hod:St().required("Head of Department is required"),billTo:St().required("Bill To address is required"),shipTo:St().required("Ship To address is required"),paymentTerms:ov().of(ri().shape({percentageTerm:Lf().required("Percentage Term is required").min(0,"Percentage Term must be at least 0").max(100,"Percentage Term cannot exceed 100"),paymentTerm:St().required("Payment Term is required"),paymentType:St().required("Payment Type is required")})).test("total-percentage","Total Percentage Terms must equal 100%",function(e){var r;return(r=this.parent)!=null&&r.isCreditCardSelected?!0:!Array.isArray(e)||e.length===0?!1:e.reduce((n,s)=>n+(parseFloat(s.percentageTerm)||0),0)===100})}),U1=[{value:"Asia",label:"ASIA"},{value:"Central",label:"CENTRAL"},{value:"Dubai",label:"DUBAI"},{value:"India",label:"INDIA"},{value:"Indonesia",label:"INDONESIA"},{value:"Malaysia",label:"MALAYSIA"},{value:"Singapore",label:"SINGAPORE"},{value:"UK",label:"UK"},{value:"US",label:"US"}],fz=({formData:e,setFormData:t,onNext:r,setReqId:n,reqId:s})=>{const i=localStorage.getItem("department"),o=JSON.parse(localStorage.getItem("user")||"{}");console.log("user",s);const l=localStorage.getItem("userId"),[c,A]=C.useState(!1),[d,u]=C.useState([]);C.useState([]);const[f,h]=C.useState(null),[x,m]=C.useState([]),[g,p]=C.useState(!1),[v,w]=C.useState([]),[B,T]=C.useState(""),[_,j]=C.useState([]),[E,L]=C.useState([]),[M,F]=C.useState([]),[D,G]=C.useState(""),[K,ae]=C.useState([]),[Z,oe]=C.useState([]),[Y,R]=C.useState(""),[z,ee]=C.useState(""),[b,O]=C.useState(!1),[S,I]=C.useState(!1),[U,Q]=C.useState([]),[H,X]=C.useState([]),[V,Ae]=C.useState([]),[W,J]=C.useState([]),ve=[{id:"CAP-651",name:"Anant Choubey",email:"anant.choubey@capillarytech.com",department:"Corporate (12CCRM01)"},{id:"CAP-005",name:"Aneesh Reddy Boddu",email:"aneesh@capillarytech.com",department:"Corporate (12CCRM01)"}].sort((Ke,Le)=>Ke.name.localeCompare(Le.name)),[de,te]=C.useState({entity:e.entity||"",city:e.city||"",site:e.site||"",department:e.department||i||"",amount:e.amount||"",entityId:e.entityId||"",paymentTerms:e.paymentTerms||[{percentageTerm:0,paymentTerm:"",paymentType:"",customPaymentTerm:"",customPaymentType:""}],billTo:e.billTo||"",shipTo:e.shipTo||"",hod:e.hod||"",hodEmail:e.hodEmail||"",businessUnit:e.businessUnit||"",isCreditCardSelected:e.isCreditCardSelected||!1,newReqId:s,empDepartment:i,userName:o.name,additionalApprover:e.additionalApprover||"",additionalApproverName:e.additionalApproverName||"",additionalApproverEmail:e.additionalApproverEmail||"",additionalApproverProof:e.additionalApproverProof||null}),[je,qe]=C.useState([]),[He,Ze]=C.useState(null),[xe,ue]=C.useState({}),[Fe,ke]=C.useState([]),[Te,Ne]=C.useState(""),[et,Se]=C.useState(!1),[Ce,Be]=C.useState([]),[Pe,Bt]=C.useState([]),[tt,Ot]=C.useState(new Map),[vt,Vt]=C.useState(""),[pr,$t]=C.useState(!1),Qr=C.useRef(null),[ir,Gr]=C.useState(""),[un,Nr]=C.useState(""),[Wt,lt]=C.useState(!1),[Et,It]=C.useState(""),[Ee,Oe]=C.useState(!1),[Re,Ye]=C.useState([]);C.useEffect(()=>{(async()=>{const Le=await C$();Le.status===200&&(n(Le.data.reqid),te(ct=>({...ct,newReqId:Le.data.reqid})))})()},[]),C.useEffect(()=>{if(e.department&&c){Ne(e.department);const Ke=Pe.find(ct=>ct.department===e.department);Ke&&(h(Ke),u(Ke.approvers),Be([Ke]));const Le=(e.department||"").split(":");Gr((Le[0]||"").trim()),It((Le.slice(1).join(":")||"").trim())}else e.department||(Gr(""),It(""))},[e.department,Pe,c]),C.useEffect(()=>{if(!c)return;if(!ir){Ye([]);return}const Ke=Pe.filter(ct=>(ct.department||"").split(":")[0].trim().toLowerCase()===ir.toLowerCase()).map(ct=>(ct.department.split(":").slice(1).join(":")||"").trim()).filter(Boolean),Le=Array.from(new Set(Ke)).sort((ct,jt)=>ct.toLowerCase().localeCompare(jt.toLowerCase()));Ye(Le),Et&&!Le.includes(Et)&&It("")},[c,ir,Pe]),C.useEffect(()=>{const Ke=M&&M.length>0?M:je;if(Ke.length>0){const Le=[...new Set(Ke.map(jt=>jt.city).filter(Boolean))].sort();Q(Le),Ae(Le);const ct=[...new Set(Ke.map(jt=>jt.site||jt.area).filter(Boolean))].sort();X(ct),J(ct),e.city&&R(e.city),e.site&&ee(e.site)}else Q([]),Ae([]),X([]),J([])},[je,M,e.city,e.site]),C.useEffect(()=>{const Ke=Le=>{Qr&&Qr.current&&!Qr.current.contains(Le.target)&&$t(!1)};return document.addEventListener("mousedown",Ke),()=>document.removeEventListener("mousedown",Ke)},[]),C.useEffect(()=>{(async()=>{try{const Le=await Zf(l);if(Le.status===200){const ct=(Le.data.entities||[]).sort((jt,Gt)=>(jt.entityName||"").toLowerCase().localeCompare((Gt.entityName||"").toLowerCase()));if(qe(ct),ke(Le.data.department||[]),A(Le.data.isDropDown),Le.data.isDropDown&&Array.isArray(Le.data.department)){const jt=new Set;Le.data.department.forEach(er=>{er.businessUnit&&jt.add(er.businessUnit)});const Gt=Array.from(jt).sort().map(er=>({value:er,label:er}));if(m(Gt),e.businessUnit){const er=Le.data.department.filter(Xr=>{var Tr;return((Tr=Xr.businessUnit)==null?void 0:Tr.toLowerCase())===e.businessUnit.toLowerCase()}),Pt=new Map;er.forEach(Xr=>{const Tr=Xr.department;Pt.has(Tr)||Pt.set(Tr,{department:Xr.department,businessUnit:Xr.businessUnit,approvers:er.filter(fn=>fn.department===Xr.department).map(fn=>({hod:fn.hod,hodEmail:fn.hod_email_id}))})}),Ot(Pt);const xr=Array.from(Pt.values()).sort((Xr,Tr)=>(Xr.department||"").toLowerCase().localeCompare((Tr.department||"").toLowerCase()));Bt(xr),Be(xr)}}else{const jt=U1.sort((Gt,er)=>Gt.label.localeCompare(er.label));m(jt)}if(!Le.data.isDropDown&&e.department){const jt=Le.data.department.find(Gt=>Gt.department===e.department);jt&&te(Gt=>({...Gt,hod:jt.hod,hodEmail:jt.hod_email_id}))}}}catch(Le){console.error("Error fetching entities:",Le),ke([]),Be([]),Bt([]),Ot(new Map),m(c?[]:U1.sort((ct,jt)=>ct.label.localeCompare(jt.label)))}})()},[l,e.businessUnit,e.department]),C.useEffect(()=>{w(ve)},[]),C.useEffect(()=>()=>{E.forEach(Ke=>{Ke.preview&&URL.revokeObjectURL(Ke.preview)})},[E]);const ft=Ke=>{const Le=(M&&M.length>0?M:je.filter(Gt=>Gt.entityName===de.entity)).filter(Gt=>(Gt.city||"")===Ke),ct=[...new Set(Le.map(Gt=>Gt.site||Gt.area).filter(Boolean))].sort();let jt={...de,city:Ke};if(X(ct),J(ct),ct.length===1){const Gt=ct[0],er=Le.find(xr=>(xr.site||xr.area)===Gt)||Le[0];Ze(er),G(er._id);const Pt=`${er.addressLine}

Tax ID: ${er.taxId||"N/A"}
Tax Type: ${er.type||"N/A"}`;jt={...jt,site:Gt,billTo:Pt,shipTo:Pt},ee(Gt)}else jt={...jt,site:"",billTo:"",shipTo:""},ee("");te(jt),t(jt),R(Ke),O(!1),xe.city&&ue(Gt=>{const er={...Gt};return delete er.city,er})},mt=Ke=>{const Le={...de,site:Ke};te(Le),t(Le),ee(Ke),I(!1),xe.site&&ue(ct=>{const jt={...ct};return delete jt.site,jt})},qt=Ke=>{const{name:Le,value:ct}=Ke.target;if(c){const jt={...de,[Le]:ct,department:"",hod:"",hodEmail:""};te(jt),t(jt),Ne(""),h(null),u([]),Gr(""),It(""),Ye([]),Oe(!1)}else{const jt={...de,[Le]:ct};te(jt),t(jt),Ne(""),h(null),u([]),Gr(""),It(""),Ye([]),Oe(!1)}xe[Le]&&ue(jt=>{const Gt={...jt};return delete Gt[Le],Gt})},Nt=Ke=>{h(Ke),u(Ke.approvers);const Le={...de,department:Ke.department,hod:"",hodEmail:""};te(Le),t(Le),Ne(Ke.department),Se(!1)},se=Ke=>{const Le=d.find(ct=>ct.hod===Ke.target.value);if(Le){const ct={...de,hod:Le.hod,hodEmail:Le.hodEmail};te(ct),t(ct)}},pe=Ke=>{const Le=Ke.target.value;T(Le);const ct=v.find(Gt=>Gt.id===Le),jt={...de,additionalApprover:Le,additionalApproverName:ct?ct.name:"",additionalApproverEmail:ct?ct.email:""};Le||(jt.additionalApproverProof=null,j([]),L([])),te(jt),t(jt)},he=async Ke=>{console.log("Uploading files",Ke.target.files);const Le=Array.from(Ke.target.files);if(Le.length!==0)try{const ct=Le.map(async Pt=>{console.log("Processing file:",Pt.name);let xr={file:Pt,name:Pt.name,size:Pt.size,type:Pt.type,preview:null,uploadedUrl:null};Pt.type.startsWith("image/")&&(xr.preview=URL.createObjectURL(Pt));const Xr=await Ac(Pt,Pt.type,s);return xr.uploadedUrl=Xr.data.fileUrls[0],console.log("File uploaded successfully:",xr.uploadedUrl),xr}),jt=await Promise.all(ct);j(Pt=>[...Pt,...jt]),L(Pt=>[...Pt,...jt]);const Gt=[..._,...jt].map(Pt=>Pt.uploadedUrl),er={...de,additionalApproverProof:Gt};te(er),t(er),Ke.target.value=""}catch(ct){console.error("File upload failed:",ct),Ie.error("File upload failed. Please try again.")}},me=Ke=>{const Le=_[Ke];Le!=null&&Le.preview&&URL.revokeObjectURL(Le.preview);const ct=_.filter((Pt,xr)=>xr!==Ke),jt=E.filter((Pt,xr)=>xr!==Ke);j(ct),L(jt);const Gt=ct.map(Pt=>Pt.uploadedUrl),er={...de,additionalApproverProof:Gt.length>0?Gt:null};te(er),t(er)},ge=Ke=>{Ke.uploadedUrl?window.open(Ke.uploadedUrl,"_blank"):Ke.preview&&window.open(Ke.preview,"_blank")},we=()=>!_||_.length===0?null:a.jsxs("div",{className:"mt-3 space-y-2",children:[a.jsxs("h4",{className:"text-sm font-medium text-gray-700",children:["Uploaded Files (",_.length,")"]}),_.map((Ke,Le)=>a.jsx("div",{className:"p-3 border border-gray-200 rounded-lg bg-gray-50",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[Ke.preview&&Ke.type.startsWith("image/")?a.jsx("img",{src:Ke.preview,alt:"File preview",className:"w-12 h-12 object-cover rounded border flex-shrink-0"}):a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded border flex items-center justify-center flex-shrink-0",children:Ke.type==="application/pdf"?a.jsx("span",{className:"text-red-600 text-xs font-bold",children:"PDF"}):Ke.type.includes("word")||Ke.name.endsWith(".doc")||Ke.name.endsWith(".docx")?a.jsx("span",{className:"text-blue-600 text-xs font-bold",children:"DOC"}):a.jsx("span",{className:"text-blue-600 text-xs font-medium",children:Ke.name.split(".").pop().toUpperCase()})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:Ke.name}),a.jsxs("p",{className:"text-xs text-gray-500",children:[(Ke.size/1024).toFixed(1)," KB"]}),Ke.uploadedUrl&&a.jsx("p",{className:"text-xs text-green-600",children:" Uploaded"})]})]}),a.jsxs("div",{className:"flex items-center space-x-2 ml-2",children:[a.jsx("button",{type:"button",onClick:()=>ge(Ke),className:"text-blue-500 hover:text-blue-700 transition duration-200 text-xs px-2 py-1 border border-blue-300 rounded",title:"View file",children:"View"}),a.jsx("button",{type:"button",onClick:()=>me(Le),className:"text-red-500 hover:text-red-700 transition duration-200",title:"Remove file",children:a.jsx(_r,{size:16})})]})]})},Le))]}),ze=async()=>{try{return await a8.validate(de,{abortEarly:!1}),ue({}),!0}catch(Ke){if(Ke.inner){const Le=Ke.inner.reduce((jt,Gt)=>(jt[Gt.path]=Gt.message,jt),{});ue(Le);const ct=Object.keys(Le)[0];ct&&Ie.error(Le[ct])}return!1}},rt=Ke=>{const{name:Le,value:ct}=Ke.target;let jt={...de,[Le]:ct};Le==="paymentMode"&&ct==="creditcard"?(jt.paymentTerms=[{percentageTerm:"100",paymentTerm:"Immediate",paymentType:"Full Payment"}],jt.isCreditCardSelected=!0):Le==="paymentMode"&&(jt.isCreditCardSelected=!1),te(jt),t(jt),xe[Le]&&ue(Gt=>{const er={...Gt};return delete er[Le],er})},$e=Ke=>{const Le=Ke.target.value,ct=je.filter(jt=>jt.entityName===Le);if(ct.length>0){F(ct);const jt=ct.map(Pt=>({value:`${Pt.addressLine}

Tax ID: ${Pt.taxId||"N/A"}
Tax Type: ${Pt.type||"N/A"}`,label:`${Pt.addressLine} - ${Pt.city||"N/A"}`,entity:Pt})),Gt=ct.map(Pt=>({value:`${Pt.addressLine}

Tax ID: ${Pt.taxId||"N/A"}
Tax Type: ${Pt.type||"N/A"}`,label:`${Pt.addressLine} - ${Pt.city||"N/A"}`,entity:Pt}));ae(jt),oe(Gt);const er=[...new Set(ct.map(Pt=>Pt.city).filter(Boolean))].sort();if(ct.length===1){const Pt=ct[0];Ze(Pt),G(Pt._id);const xr=`${Pt.addressLine}

Tax ID: ${Pt.taxId||"N/A"}
Tax Type: ${Pt.type||"N/A"}`,Xr={...de,entity:Le,entityId:Pt._id,city:Pt.city||"",site:Pt.area||Pt.site||"",billTo:xr,shipTo:xr};te(Xr),t(Xr),R(Pt.city||""),ee(Pt.area||Pt.site||""),Q(er),Ae(er);const Tr=[...new Set([Pt.site||Pt.area].filter(Boolean))].sort();X(Tr),J(Tr)}else{const Pt={...de,entity:Le,entityId:"",city:"",site:"",billTo:"",shipTo:""};if(te(Pt),t(Pt),Q(er),Ae(er),er.length===1){const xr=er[0];R(xr);const Xr=ct.filter(fn=>(fn.city||"")===xr),Tr=[...new Set(Xr.map(fn=>fn.site||fn.area).filter(Boolean))].sort();if(X(Tr),J(Tr),Tr.length===1){const fn=Tr[0];ee(fn);const Xs=Xr.find(tu=>(tu.site||tu.area)===fn)||Xr[0];Ze(Xs),G(Xs._id);const Ys=`${Xs.addressLine}

Tax ID: ${Xs.taxId||"N/A"}
Tax Type: ${Xs.type||"N/A"}`,IA={...Pt,city:xr,site:fn,billTo:Ys,shipTo:Ys};te(IA),t(IA)}else R(xr),ee("")}else R(""),ee(""),X([]),J([])}xe.entity&&ue(Pt=>{const xr={...Pt};return delete xr.entity,xr})}},Xe=Ke=>{const Le=Ke.target.value,ct=K.find(jt=>jt.value===Le);if(ct){const jt={...de,billTo:Le,city:ct.entity.city||"",site:ct.entity.area||ct.entity.site||"",entityId:ct.entity._id};te(jt),t(jt),Ze(ct.entity),R(ct.entity.city||""),ee(ct.entity.area||ct.entity.site||"")}},Je=Ke=>{const Le=Ke.target.value,ct={...de,shipTo:Le};te(ct),t(ct)},gt=(Ke,Le)=>{var xr,Xr;const{name:ct,value:jt}=Ke.target,Gt=[...de.paymentTerms],er={...Gt[Le]};ct==="paymentTerm"?(er[ct]=jt,jt!=="Others"&&(er.customPaymentTerm="")):ct==="paymentType"?(er[ct]=jt,jt!=="Others"&&(er.customPaymentType="")):er[ct]=jt,Gt[Le]=er;const Pt={...de,paymentTerms:Gt};te(Pt),t(Pt),(Xr=(xr=xe.paymentTerms)==null?void 0:xr[Le])!=null&&Xr[ct]&&ue(Tr=>{var Xs;const fn={...Tr};return(Xs=fn.paymentTerms)!=null&&Xs[Le]&&delete fn.paymentTerms[Le][ct],fn})},Ct=(Ke,Le,ct)=>{const{value:jt}=Ke.target,Gt=[...de.paymentTerms];Gt[Le]={...Gt[Le],[ct]:jt};const er={...de,paymentTerms:Gt};te(er),t(er)},Ut=()=>{const Ke={...de,paymentTerms:[...de.paymentTerms,{percentageTerm:"",paymentTerm:"",paymentType:"",customPaymentTerm:"",customPaymentType:""}]};te(Ke),t(Ke)},wt=Ke=>{const Le=de.paymentTerms.filter((jt,Gt)=>Gt!==Ke),ct={...de,paymentTerms:Le};te(ct),t(ct)},Lt=async()=>{if(await ze()){const Le=or();console.log(Le);const ct=await nq(Le,l);Ie.success(ct.data.message),ct.status===200&&(t(jt=>({...jt})),r())}};C.useEffect(()=>{const Ke=Le=>{Le.target.closest(".site-dropdown")||I(!1),Le.target.closest(".city-dropdown")||O(!1),Le.target.closest(".relative")||Se(!1)};return document.addEventListener("mousedown",Ke),()=>{document.removeEventListener("mousedown",Ke)}},[]);const or=()=>{const Ke={...de};return Ke.paymentTerms=de.paymentTerms.map(Le=>{const ct={...Le};return Le.paymentTerm==="Others"&&Le.customPaymentTerm&&(ct.paymentTerm=Le.customPaymentTerm),Le.paymentType==="Others"&&Le.customPaymentType&&(ct.paymentType=Le.customPaymentType),delete ct.customPaymentTerm,delete ct.customPaymentType,ct}),Ke},Mr=()=>g?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Payment Term Information"}),a.jsx("button",{onClick:()=>p(!1),className:"text-gray-500 hover:text-gray-700",children:a.jsx(_r,{size:20})})]}),a.jsx("p",{className:"text-gray-600 text-sm",children:"Enter 100% if full amount to be paid upfront; otherwise, select the appropriate %"}),a.jsx("div",{className:"mt-4 flex justify-end",children:a.jsx("button",{onClick:()=>p(!1),className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition duration-300",children:"Got it"})})]})}):null,Wr=()=>a.jsxs("div",{className:"city-dropdown relative w-full",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"City"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:Y,onChange:Ke=>{R(Ke.target.value);const Le=U.filter(ct=>ct.toLowerCase().includes(Ke.target.value.toLowerCase()));Ae(Le)},onFocus:()=>O(!0),placeholder:"Search city...",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300"}),a.jsx(rn,{className:"absolute right-3 top-3.5 text-gray-400",size:20})]}),b&&a.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:V.length>0?V.map(Ke=>a.jsx("div",{className:"px-4 py-3 hover:bg-gray-100 cursor-pointer border-b border-gray-100",onClick:()=>ft(Ke),children:a.jsx("span",{className:"font-medium",children:Ke})},Ke)):a.jsx("div",{className:"px-4 py-3 text-gray-500",children:"No cities found"})}),xe.city&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:xe.city})]}),Qn=()=>a.jsxs("div",{className:"site-dropdown relative w-full",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Site"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:z,onChange:Ke=>{ee(Ke.target.value);const Le=H.filter(ct=>ct.toLowerCase().includes(Ke.target.value.toLowerCase()));J(Le)},onFocus:()=>I(!0),placeholder:"Search site...",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300"}),a.jsx(rn,{className:"absolute right-3 top-3.5 text-gray-400",size:20})]}),S&&a.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:W.length>0?W.map(Ke=>a.jsx("div",{className:"px-4 py-3 hover:bg-gray-100 cursor-pointer border-b border-gray-100",onClick:()=>mt(Ke),children:a.jsx("span",{className:"font-medium",children:Ke})},Ke)):a.jsx("div",{className:"px-4 py-3 text-gray-500",children:"No sites found"})}),xe.site&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:xe.site})]}),li=()=>{if(c){const Ke=Array.from(new Set(Pe.map(Le=>(Le.department||"").split(":")[0].trim()).filter(Boolean))).sort((Le,ct)=>Le.toLowerCase().localeCompare(ct.toLowerCase()));return a.jsxs("div",{className:"relative w-full",children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Cost Center ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"w-full",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Cost Center 1"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:un||ir,onChange:Le=>{const ct=Le.target.value;Nr(ct),lt(!0)},onFocus:()=>lt(!0),placeholder:"Search cost center 1...",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300"}),a.jsx(rn,{className:"absolute right-3 top-3.5 text-gray-400",size:20}),Wt&&a.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:[Ke.filter(Le=>Le.toLowerCase().includes((un||"").toLowerCase())).map(Le=>a.jsx("div",{className:"px-4 py-3 hover:bg-gray-100 cursor-pointer border-b border-gray-100",onClick:()=>{Gr(Le),Nr(Le),lt(!1),It(""),Oe(!1),h(null),u([]);const ct={...de,department:"",hod:"",hodEmail:""};te(ct),t(ct)},children:a.jsx("span",{className:"font-medium",children:Le})},Le)),Ke.filter(Le=>Le.toLowerCase().includes((un||"").toLowerCase())).length===0&&a.jsx("div",{className:"px-4 py-3 text-gray-500",children:"No options found"})]})]}),xe.department&&!ir&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:xe.department})]}),a.jsxs("div",{className:"w-full",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Cost Center 2"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:Et,onChange:Le=>{const ct=Le.target.value;It(ct),Oe(!0)},onFocus:()=>Oe(!0),placeholder:ir?"Search cost center 2...":"Select Cost Center 1 first",disabled:!ir,className:`w-full px-4 py-3 border-2 rounded-lg focus:outline-none transition duration-300 ${ir?"border-gray-300 focus:ring-2 focus:ring-primary focus:border-transparent":"border-gray-300 bg-gray-100"}`}),a.jsx(rn,{className:"absolute right-3 top-3.5 text-gray-400",size:20}),Ee&&ir&&a.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:[Re.filter(Le=>Le.toLowerCase().includes(Et.toLowerCase())).map(Le=>a.jsx("div",{className:"px-4 py-3 hover:bg-gray-100 cursor-pointer border-b border-gray-100",onClick:()=>{const ct=`${ir} : ${Le}`;It(Le),Oe(!1),Ne(ct);const jt=Pe.find(Gt=>Gt.department===ct);if(jt)Nt(jt);else{const Gt={...de,department:ct,hod:"",hodEmail:""};te(Gt),t(Gt),h(null),u([])}},children:a.jsx("span",{className:"font-medium",children:Le})},Le)),Re.filter(Le=>Le.toLowerCase().includes(Et.toLowerCase())).length===0&&a.jsx("div",{className:"px-4 py-3 text-gray-500",children:"No options found"})]})]})]})]}),xe.department&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:xe.department})]})}return a.jsxs("div",{className:"relative w-full",children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Cost Center ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",value:e.department||i,className:"w-full px-4 py-3 border-2 bg-gray-100 border-gray-500 rounded-lg",placeholder:"",readOnly:!0}),xe.department&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:xe.department})]})},bo=()=>c?a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 w-full",children:[a.jsxs("div",{className:"w-full",children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Approver ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{value:de.hod,onChange:se,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300",disabled:!f,children:[a.jsx("option",{value:"",children:"Select Approver"}),d.map((Ke,Le)=>a.jsx("option",{value:Ke.hod,children:Ke.hod},Le))]}),xe.hod&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:xe.hod})]}),a.jsxs("div",{className:"w-full",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Additional Approver"}),a.jsxs("select",{value:B,onChange:pe,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300",children:[a.jsx("option",{value:"",children:"Select Additional Approver"}),v.map(Ke=>a.jsxs("option",{value:Ke.id,children:[Ke.id," - ",Ke.name," - ",Ke.email," - ",Ke.department]},Ke.id))]}),B&&a.jsxs("div",{className:"mt-3",children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Upload Proof"," ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("label",{className:"flex items-center px-4 py-2 bg-gray-100 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-200 transition duration-300",children:[a.jsx(Ds,{size:16,className:"mr-2"}),"Choose Files",a.jsx("input",{type:"file",className:"hidden",onChange:he,accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",multiple:!0})]}),a.jsx("span",{className:"text-xs text-gray-500",children:"PDF, DOC, DOCX, JPG, PNG (Max 5MB each) - Multiple files allowed"})]}),a.jsx(we,{})]})]})]})]}):a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 w-full",children:[a.jsxs("div",{className:"w-full",children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Approver ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"hod",value:de.hod,readOnly:!0,className:"w-full px-4 py-3 border-2 border-gray-500 rounded-lg bg-gray-100",placeholder:"HOD will be auto-populated"}),xe.hod&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:xe.hod})]}),a.jsxs("div",{className:"w-full",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Additional Approver"}),a.jsxs("select",{value:B,onChange:pe,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300",children:[a.jsx("option",{value:"",children:"Select Additional Approver"}),v.map(Ke=>a.jsxs("option",{value:Ke.id,children:[Ke.id," - ",Ke.name," - ",Ke.email," - ",Ke.department]},Ke.id))]}),B&&a.jsxs("div",{className:"mt-3",children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Upload Proof"," ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("label",{className:"flex items-center px-4 py-2 bg-gray-100 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-200 transition duration-300",children:[a.jsx(Ds,{size:16,className:"mr-2"}),"Choose Files",a.jsx("input",{type:"file",className:"hidden",onChange:he,accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",multiple:!0})]}),a.jsx("span",{className:"text-xs text-gray-500",children:"PDF, DOC, DOCX, JPG, PNG (Max 5MB each) - Multiple files allowed"})]}),a.jsx(we,{})]})]})]})]}),Pi=()=>a.jsxs("div",{className:"w-full",children:[a.jsxs("label",{className:"block text-sm font-semibold text-primary mb-2",children:["Business Unit ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{onChange:qt,value:de.businessUnit,name:"businessUnit",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg appearance-none focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300",children:[a.jsx("option",{value:"",children:"Select Business Unit"}),x.map(Ke=>a.jsx("option",{value:Ke.value,children:Ke.label},Ke.value))]}),xe.businessUnit&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:xe.businessUnit})]}),Pa=Ke=>Ke?Ke.toLowerCase().split(" ").filter(Boolean).map(Le=>Le.charAt(0).toUpperCase()+Le.slice(1)).join(" "):"",Oi=()=>{const Ke=[...new Set(je.map(Le=>Le.entityName).filter(Boolean))].sort((Le,ct)=>Le.toLowerCase().localeCompare(ct.toLowerCase()));return a.jsxs("div",{className:"w-full",children:[a.jsxs("label",{className:"block text-sm font-semibold text-primary mb-2",children:["Entity ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"relative",ref:Qr,children:[a.jsx("input",{type:"text",name:"entity",value:vt||de.entity,onChange:Le=>{Vt(Le.target.value),$t(!0)},onFocus:()=>$t(!0),placeholder:"Search entity...",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"}),a.jsx(rn,{className:"absolute right-3 top-3.5 text-gray-400",size:20}),pr&&a.jsxs("div",{className:"absolute left-0 z-30 mt-1 bg-white border border-gray-300 rounded-lg shadow-2xl max-h-96 overflow-y-auto min-w-[20rem] md:min-w-[20rem]",children:[Ke.filter(Le=>(vt||"").toLowerCase()?Le.toLowerCase().includes(vt.toLowerCase()):!0).map(Le=>a.jsx("button",{type:"button",className:"w-full text-left px-4 py-2.5 hover:bg-gray-50 cursor-pointer text-sm text-gray-800",onClick:()=>{Vt(Le),$t(!1),$e({target:{value:Le}})},title:Pa(Le),children:a.jsx("span",{className:"block whitespace-normal break-words",children:Pa(Le)})},Le)),Ke.filter(Le=>(vt||"").toLowerCase()?Le.toLowerCase().includes(vt.toLowerCase()):!0).length===0&&a.jsx("div",{className:"px-4 py-3 text-xs text-gray-500",children:"No entities found"})]})]}),xe.entity&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:xe.entity})]})};return a.jsxs("div",{className:"w-full mx-auto bg-white shadow-2xl rounded-2xl overflow-hidden",children:[a.jsx(Mr,{}),a.jsx("div",{className:"bg-gradient-to-r from-primary to-primary p-4 sm:p-6",children:a.jsx("h2",{className:"text-xl sm:text-2xl md:text-3xl font-extrabold text-white text-center",children:"Commercial Details"})}),a.jsxs("div",{className:"p-4 sm:p-6 md:p-8 space-y-4 sm:space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 sm:gap-6",children:[Pi(),Oi(),Wr(),Qn()]}),a.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:gap-6",children:[li(),bo()]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"mb-2 sm:mb-4 flex items-center gap-2",children:[a.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-700",children:"Payment Term"}),a.jsx("button",{type:"button",onClick:()=>p(!0),className:"text-blue-500 hover:text-blue-700 transition duration-300",children:a.jsx(Fi,{size:18})})]}),a.jsx("div",{className:"overflow-x-auto -mx-4 sm:mx-0 px-4 sm:px-0",children:a.jsx("div",{className:"min-w-max sm:min-w-0 sm:w-full",children:a.jsxs("table",{className:"w-full table-auto border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-100 border-b-2 border-gray-200",children:[a.jsxs("th",{className:"px-2 sm:px-4 py-2 sm:py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:["Percentage Term"," ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("th",{className:"px-2 sm:px-4 py-2 sm:py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:["Payment Term"," ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("th",{className:"px-2 sm:px-4 py-2 sm:py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:["Payment Type"," ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("th",{className:"px-2 sm:px-4 py-2 sm:py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{children:de.paymentTerms.map((Ke,Le)=>{var ct,jt,Gt,er,Pt,xr,Xr,Tr,fn,Xs;return a.jsxs("tr",{className:"border-b hover:bg-gray-50 transition duration-200",children:[a.jsxs("td",{className:"px-2 sm:px-4 py-2 sm:py-3",children:[a.jsx("input",{type:"number",name:"percentageTerm",value:Ke.percentageTerm,onChange:Ys=>gt(Ys,Le),disabled:de.isCreditCardSelected,className:`w-full px-2 sm:px-3 py-1 sm:py-2 border-2 border-gray-300 rounded-lg ${de.isCreditCardSelected?"bg-gray-100 cursor-not-allowed":"focus:ring-2 focus:ring-primary"} focus:outline-none focus:border-transparent transition duration-300`,placeholder:"Enter %",style:{appearance:"none",MozAppearance:"textfield",WebkitAppearance:"none"}}),((jt=(ct=xe.paymentTerms)==null?void 0:ct[Le])==null?void 0:jt.percentageTerm)&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:xe.paymentTerms[Le].percentageTerm})]}),a.jsxs("td",{className:"px-2 sm:px-4 py-2 sm:py-3",children:[a.jsxs("select",{name:"paymentTerm",value:Ke.paymentTerm,onChange:Ys=>gt(Ys,Le),disabled:de.isCreditCardSelected,className:`w-full px-2 sm:px-3 py-1 sm:py-2 border-2 border-gray-300 rounded-lg text-xs sm:text-sm ${de.isCreditCardSelected?"bg-gray-100 cursor-not-allowed":"focus:ring-2 focus:ring-primary"} focus:outline-none focus:border-transparent transition duration-300`,children:[a.jsx("option",{value:"",children:"Select Payment Term"}),a.jsx("option",{value:"Immediate",children:"Immediate"}),a.jsx("option",{value:"30 days credit period",children:"30 days credit period"}),a.jsx("option",{value:"45 days credit period",children:"45 days credit period"}),a.jsx("option",{value:"60 days credit period",children:"60 days credit period"}),a.jsx("option",{value:"90 days credit period",children:"90 days credit period"}),a.jsx("option",{value:"Others",children:"Others"})]}),Ke.paymentTerm==="Others"&&a.jsx("input",{type:"text",value:Ke.customPaymentTerm||"",onChange:Ys=>Ct(Ys,Le,"customPaymentTerm"),disabled:de.isCreditCardSelected,className:"w-full mt-2 px-2 sm:px-3 py-1 sm:py-2 border-2 border-gray-300 rounded-lg text-xs sm:text-sm focus:ring-2 focus:ring-primary focus:outline-none focus:border-transparent transition duration-300",placeholder:"Specify payment term"}),((er=(Gt=xe.paymentTerms)==null?void 0:Gt[Le])==null?void 0:er.paymentTerm)&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:xe.paymentTerms[Le].paymentTerm}),Ke.paymentTerm==="Others"&&((xr=(Pt=xe.paymentTerms)==null?void 0:Pt[Le])==null?void 0:xr.customPaymentTerm)&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:xe.paymentTerms[Le].customPaymentTerm})]}),a.jsxs("td",{className:"px-2 sm:px-4 py-2 sm:py-3",children:[a.jsxs("select",{name:"paymentType",value:Ke.paymentType,onChange:Ys=>gt(Ys,Le),disabled:de.isCreditCardSelected,className:`w-full px-2 sm:px-3 py-1 sm:py-2 border-2 border-gray-300 rounded-lg text-xs sm:text-sm ${de.isCreditCardSelected?"bg-gray-100 cursor-not-allowed":"focus:ring-2 focus:ring-primary"} focus:outline-none focus:border-transparent transition duration-300`,children:[a.jsx("option",{value:"",children:"Select Payment Type"}),a.jsx("option",{value:"Full Payment",children:"Full Payment"}),a.jsx("option",{value:"Advance Payment",children:"Advance Payment"}),a.jsx("option",{value:"Payment on Delivery",children:"Payment on Delivery"}),a.jsx("option",{value:"Part Payment",children:"Part Payment"}),a.jsx("option",{value:"Others",children:"Others"})]}),Ke.paymentType==="Others"&&a.jsx("input",{type:"text",value:Ke.customPaymentType||"",onChange:Ys=>Ct(Ys,Le,"customPaymentType"),disabled:de.isCreditCardSelected,className:"w-full mt-2 px-2 sm:px-3 py-1 sm:py-2 border-2 border-gray-300 rounded-lg text-xs sm:text-sm focus:ring-2 focus:ring-primary focus:outline-none focus:border-transparent transition duration-300",placeholder:"Specify payment type"}),((Tr=(Xr=xe.paymentTerms)==null?void 0:Xr[Le])==null?void 0:Tr.paymentType)&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:xe.paymentTerms[Le].paymentType}),Ke.paymentType==="Others"&&((Xs=(fn=xe.paymentTerms)==null?void 0:fn[Le])==null?void 0:Xs.customPaymentType)&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:xe.paymentTerms[Le].customPaymentType})]}),a.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3 text-right",children:a.jsx("div",{className:"flex justify-end",children:a.jsxs("button",{type:"button",onClick:()=>wt(Le),disabled:de.isCreditCardSelected||Le===0,className:`flex items-center px-2 sm:px-4 py-1 sm:py-2 rounded-lg transition duration-300 text-xs sm:text-sm ${de.isCreditCardSelected||Le===0?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-red-500 text-white hover:bg-red-700"}`,children:[a.jsx($r,{size:16,className:"mr-1 sm:mr-2 hidden sm:inline"}),"Delete"]})})})]},Le)})})]})})}),a.jsx("div",{className:"mt-2 sm:mt-4 flex justify-start",children:a.jsxs("button",{type:"button",onClick:Ut,className:`${de.isCreditCardSelected?"bg-gray-300 text-black":"bg-primary text-white"} flex items-center px-3 py-2 sm:px-4 sm:py-2 rounded-lg hover:bg-primary-dark transition duration-300 text-xs sm:text-sm`,disabled:de.isCreditCardSelected,children:[a.jsx(Ky,{size:16,className:"mr-1 sm:mr-2"}),"Add Payment Term"]})})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Bill To ",a.jsx("span",{className:"text-red-500",children:"*"})]}),K.length>1?a.jsxs("select",{name:"billTo",value:de.billTo,onChange:Xe,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300",children:[a.jsx("option",{value:"",children:"Select Bill To Address"}),K.map((Ke,Le)=>a.jsx("option",{value:Ke.value,children:Ke.label},Le))]}):a.jsx("textarea",{name:"billTo",value:de.billTo,readOnly:!!He,onChange:He?void 0:rt,className:`w-full px-4 py-3 border-2 rounded-lg focus:outline-none transition duration-300 ${He?"border-gray-500 bg-gray-100":"border-gray-300 focus:ring-2 focus:ring-primary focus:border-transparent"}`,placeholder:"Enter Bill To",rows:window.innerWidth<640?"4":"6"}),xe.billTo&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:xe.billTo})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Ship To ",a.jsx("span",{className:"text-red-500",children:"*"})]}),Z.length>1?a.jsxs("select",{name:"shipTo",value:de.shipTo,onChange:Je,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300",children:[a.jsx("option",{value:"",children:"Select Ship To Address"}),Z.map((Ke,Le)=>a.jsx("option",{value:Ke.value,children:Ke.label},Le))]}):a.jsx("textarea",{name:"shipTo",value:de.shipTo,readOnly:!!He,onChange:He?void 0:rt,className:`w-full px-4 py-3 border-2 rounded-lg focus:outline-none transition duration-300 ${He?"border-gray-500 bg-gray-100":"border-gray-300 focus:ring-2 focus:ring-primary focus:border-transparent"}`,placeholder:"Enter Ship To",rows:window.innerWidth<640?"4":"6"}),xe.shipTo&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:xe.shipTo})]})]}),a.jsx("div",{className:"mt-4 sm:mt-8 flex justify-end",children:a.jsx("button",{type:"button",onClick:Lt,className:"px-6 sm:px-10 py-2 sm:py-3 bg-gradient-to-r from-primary to-primary text-white font-bold rounded-lg shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition duration-300 ease-in-out",children:"Next"})})]})]})},lv="/assets/pdfIcon-D0Dwp73r.png",so=e=>{const t=new Date(e),r=t.getDate(),n=t.toLocaleString("en-US",{month:"short"}),s=t.getFullYear();return`${r} ${n} ${s}`},hz=({formData:e})=>{var t,r,n,s,i,o;return a.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[a.jsxs("div",{className:"flex items-center space-x-2 text-primary",children:[a.jsx(q4,{size:24}),a.jsx("h2",{className:"text-xl sm:text-2xl font-bold border-b pb-3",children:"Commercials Details"})]}),e.commercials&&Object.values(e.commercials).some(l=>l)&&a.jsxs("div",{className:"grid gap-4 sm:gap-6 p-2 sm:p-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"bg-gray-50 p-3 sm:p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Business Unit"}),a.jsx("div",{className:"text-gray-800 font-semibold mt-1",children:e.commercials.businessUnit})]}),a.jsxs("div",{className:"bg-gray-50 p-3 sm:p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Entity"}),a.jsx("div",{className:"text-gray-800 font-semibold mt-1",children:e.commercials.entity})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-gray-50 p-3 sm:p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"City"}),a.jsx("div",{className:"text-gray-800 font-semibold mt-1",children:e.commercials.city})]}),a.jsxs("div",{className:"bg-gray-50 p-3 sm:p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Site"}),a.jsx("div",{className:"text-gray-800 font-semibold mt-1",children:e.commercials.site})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"bg-gray-50 p-3 sm:p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Requestor Details"}),a.jsxs("div",{className:"mt-2 space-y-1",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500 text-sm",children:"Name:"}),a.jsx("div",{className:"text-gray-800 font-semibold",children:e.commercials.userName||"N/A"})]}),e.commercials.userIdd&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500 text-sm",children:"ID:"}),a.jsx("div",{className:"text-gray-800 font-semibold",children:e.commercials.userIdd})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500 text-sm",children:"Department:"}),a.jsx("div",{className:"text-gray-800 font-semibold",children:e.commercials.empDepartment||"N/A"})]})]})]}),a.jsxs("div",{className:"bg-gray-50 p-3 sm:p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"HOD Details"}),a.jsxs("div",{className:"mt-2 space-y-1",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500 text-sm",children:"Name:"}),a.jsx("div",{className:"text-gray-800 font-semibold",children:e.commercials.hod||"N/A"})]}),e.commercials.hodId&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500 text-sm",children:"ID:"}),a.jsx("div",{className:"text-gray-800 font-semibold",children:e.commercials.hodId})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500 text-sm",children:"Email:"}),a.jsx("div",{className:"text-gray-800 font-semibold break-words",children:e.commercials.hodEmail||"N/A"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500 text-sm",children:"Department:"}),a.jsx("div",{className:"text-gray-800 font-semibold",children:e.commercials.department||"N/A"})]})]})]})]}),(e.commercials.additionalApprover||e.commercials.additionalApproverName||e.commercials.additionalApproverEmail)&&a.jsxs("div",{className:"bg-gray-50 p-3 sm:p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Additional Approver Details"}),a.jsxs("div",{className:"mt-2 space-y-2",children:[e.commercials.additionalApproverName&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500 text-sm",children:"Name:"}),a.jsx("div",{className:"text-gray-800 font-semibold",children:e.commercials.additionalApproverName})]}),e.commercials.additionalApprover&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500 text-sm",children:"ID:"}),a.jsx("div",{className:"text-gray-800 font-semibold",children:e.commercials.additionalApprover})]}),e.commercials.additionalApproverEmail&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500 text-sm",children:"Email:"}),a.jsx("div",{className:"text-gray-800 font-semibold break-words",children:e.commercials.additionalApproverEmail})]})]}),e.commercials.additionalApproverProof&&e.commercials.additionalApproverProof.length>0&&a.jsxs("div",{className:"mt-3",children:[a.jsx("span",{className:"text-gray-500 text-sm",children:"Additional Approver Proof:"}),a.jsx("div",{className:"mt-2 grid grid-cols-2 sm:grid-cols-3 gap-2",children:e.commercials.additionalApproverProof.map((l,c)=>a.jsx("div",{className:"flex flex-col items-center bg-white rounded p-2 border",children:a.jsxs("a",{href:l,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:text-blue-800 truncate max-w-full text-center",children:[a.jsx("img",{src:lv,alt:`Proof ${c+1}`,className:"w-8 h-8 object-cover mb-1"}),a.jsxs("span",{children:["Document"," ",c+1]})]})},c))})]})]}),a.jsx("div",{className:"bg-gray-50 p-4 sm:p-6 rounded-lg w-full",children:a.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between gap-6 lg:gap-4",children:[a.jsxs("div",{className:"w-full lg:w-1/2 lg:pr-4",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Bill To"}),a.jsx("div",{className:"text-gray-800 font-semibold mt-1",children:e.commercials.billTo.split("Tax ID:")[0].trim()}),a.jsxs("div",{className:"text-gray-500 mt-1",children:["Tax ID:"," ",(t=e.commercials.billTo.split("Tax ID:")[1])==null?void 0:t.split("Tax Type:")[0].trim()]}),a.jsxs("div",{className:"text-gray-500 mt-1",children:["Tax Type:"," ",(r=e.commercials.billTo.split("Tax Type:")[1])==null?void 0:r.trim()]})]}),a.jsxs("div",{className:"w-full lg:w-1/2 lg:pl-4 mt-4 lg:mt-0",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Ship To"}),a.jsx("div",{className:"text-gray-800 font-semibold mt-1",children:e.commercials.shipTo.split("Tax ID:")[0].trim()}),a.jsxs("div",{className:"text-gray-500 mt-1",children:["Tax ID:"," ",(n=e.commercials.shipTo.split("Tax ID:")[1])==null?void 0:n.split("Tax Type:")[0].trim()]}),a.jsxs("div",{className:"text-gray-500 mt-1",children:["Tax Type:"," ",(s=e.commercials.shipTo.split("Tax Type:")[1])==null?void 0:s.trim()]})]})]})})]}),((o=(i=e.commercials)==null?void 0:i.paymentTerms)==null?void 0:o.length)>0&&a.jsxs("div",{className:"mt-4 sm:mt-6",children:[a.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-primary mb-2 sm:mb-4",children:"Payment Terms"}),a.jsx("div",{className:"bg-white shadow-lg rounded-lg overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-primary/10",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 sm:px-6 py-3 sm:py-4 text-left text-primary font-semibold",children:"Percentage"}),a.jsx("th",{className:"px-3 sm:px-6 py-3 sm:py-4 text-left text-primary font-semibold",children:"Payment Term"}),a.jsx("th",{className:"px-3 sm:px-6 py-3 sm:py-4 text-left text-primary font-semibold",children:"Type"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:e.commercials.paymentTerms.map((l,c)=>{var A,d;return a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsxs("td",{className:"px-3 sm:px-6 py-3 sm:py-4 text-left font-medium",children:[l.percentageTerm,"%"]}),a.jsxs("td",{className:"px-3 sm:px-6 py-3 sm:py-4 capitalize",children:[(A=l.paymentTerm)==null?void 0:A.toLowerCase(),l.customPaymentTerm?` - ${l.customPaymentTerm.toLowerCase()}`:""]}),a.jsxs("td",{className:"px-3 sm:px-6 py-3 sm:py-4 capitalize",children:[(d=l.paymentType)==null?void 0:d.toLowerCase(),l.customPaymentType?` - ${l.customPaymentType.toLowerCase()}`:""]})]},c)})})]})})})]})]})},mz=({formData:e,formatDateToDDMMYY:t,renderUploadedFiles:r})=>{var n;return a.jsxs("div",{className:"space-y-4 sm:space-y-6 mt-6 sm:mt-8",children:[a.jsxs("div",{className:"flex items-center space-x-2 text-primary",children:[a.jsx(G4,{size:24}),a.jsx("h2",{className:"text-xl sm:text-2xl font-bold border-b pb-3",children:"Procurements Details"})]}),e.procurements&&Object.values(e.procurements).some(s=>s)&&a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{label:"Client Name",value:e.procurements.clientName},{label:"Project Code",value:e.procurements.projectCode},{label:"Vendor ID",value:e.procurements.vendor},{label:"Vendor Name",value:e.procurements.vendorName},{label:"Quotation Number",value:e.procurements.quotationNumber},{label:"Quotation Date",value:e.procurements.quotationDate?t(e.procurements.quotationDate):null},{label:"Service Period",value:e.procurements.servicePeriod},{label:"PO Valid From",value:e.procurements.poValidFrom?t(e.procurements.poValidFrom):null},{label:"PO Valid To",value:e.procurements.poValidTo?t(e.procurements.poValidTo):null}].filter(s=>s.value).map((s,i)=>a.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium mb-1 sm:mb-0",children:s.label}),a.jsx("span",{className:"text-gray-800 font-semibold",children:s.value})]},i))}),((n=e.procurements)==null?void 0:n.uploadedFiles)&&a.jsxs("div",{className:"mt-4 sm:mt-6",children:[a.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-primary mb-2 sm:mb-4",children:"Uploaded Files"}),a.jsxs("div",{className:"bg-white shadow-md rounded-lg p-4",children:[Object.keys(e.procurements.uploadedFiles).length>0?a.jsxs("div",{className:"text-green-600 flex items-center mb-4",children:[a.jsx(ca,{className:"mr-2",size:20}),"Files uploaded successfully"]}):a.jsx("div",{className:"text-gray-500 flex items-center",children:"No files uploaded"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(e.procurements.uploadedFiles).map(([s,i])=>(i==null?void 0:i.urls)&&i.urls.length>0&&a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-3 capitalize border-b pb-2",children:s.replace(/([A-Z])/g," $1").toLowerCase()}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 mb-3",children:i.urls.map((o,l)=>a.jsx("div",{className:"flex flex-col items-center bg-gray-50 rounded p-2",children:a.jsxs("a",{href:o,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:text-blue-800 truncate max-w-full text-center",children:[a.jsx("div",{className:"w-10 h-10 bg-red-100 rounded flex items-center justify-center mb-2",children:a.jsx("span",{className:"text-red-600 text-xs font-bold",children:"PDF"})}),a.jsxs("span",{className:"block text-xs",children:["File"," ",l+1]})]})},l))}),(i.agreementValidFrom||i.agreementValidTo)&&a.jsxs("div",{className:"border-t pt-3 mt-3",children:[a.jsx("h5",{className:"text-xs font-medium text-gray-700 mb-2",children:"Agreement Validity"}),a.jsxs("div",{className:"space-y-2",children:[i.agreementValidFrom&&a.jsxs("div",{className:"flex justify-between text-xs",children:[a.jsx("span",{className:"text-gray-600",children:"Valid From:"}),a.jsx("span",{className:"text-gray-800 font-medium",children:t(i.agreementValidFrom)})]}),i.agreementValidTo&&a.jsxs("div",{className:"flex justify-between text-xs",children:[a.jsx("span",{className:"text-gray-600",children:"Valid To:"}),a.jsx("span",{className:"text-gray-800 font-medium",children:t(i.agreementValidTo)})]})]})]})]},s))})]})]})]})},pz=({formData:e,parseFloat:t,formatCurrency:r})=>{var n,s,i,o;return a.jsxs("div",{className:"space-y-4 sm:space-y-6 mt-6 sm:mt-8",children:[a.jsxs("div",{className:"flex items-center space-x-2 text-primary",children:[a.jsx(Th,{size:24}),a.jsx("h2",{className:"text-xl sm:text-2xl font-bold border-b pb-3",children:"Product/Services Details"})]}),((s=(n=e.supplies)==null?void 0:n.services)==null?void 0:s.length)>0&&a.jsxs("div",{className:"mt-4 sm:mt-6",children:[a.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-primary mb-2 sm:mb-4",children:"Services"}),a.jsx("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-primary/10",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 sm:p-3 text-left text-primary text-sm sm:text-base",children:"Product Names"}),a.jsx("th",{className:"p-2 sm:p-3 text-left text-primary text-sm sm:text-base",children:"Description"}),a.jsx("th",{className:"p-2 sm:p-3 text-left text-primary text-sm sm:text-base",children:"Purpose"}),a.jsx("th",{className:"p-2 sm:p-3 text-left text-primary text-sm sm:text-base",children:"Quantity"}),a.jsx("th",{className:"p-2 sm:p-3 text-left text-primary text-sm sm:text-base",children:"Price"}),a.jsx("th",{className:"p-2 sm:p-3 text-left text-primary text-sm sm:text-base",children:"Tax (%)"}),a.jsx("th",{className:"p-2 sm:p-3 text-left text-primary text-sm sm:text-base",children:"Total"})]})}),a.jsx("tbody",{children:e.supplies.services.map((l,c)=>{const A=t(l.quantity)||0,d=t(l.price)||0,u=t(l.tax)||0,f=A*d*(1+u/100);return a.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[a.jsx("td",{className:"p-2 sm:p-3 text-sm",children:l.productName||"N/A"}),a.jsx("td",{className:"p-2 sm:p-3 text-sm",children:l.productDescription||"N/A"}),a.jsx("td",{className:"p-2 sm:p-3 text-sm",children:l.productPurpose||"N/A"}),a.jsx("td",{className:"p-2 sm:p-3 text-sm",children:l.quantity}),a.jsx("td",{className:"p-2 sm:p-3 text-sm",children:r(l.price)}),a.jsx("td",{className:"p-2 sm:p-3 text-sm",children:l.tax||"N/A"}),a.jsx("td",{className:"p-2 sm:p-3 text-sm font-semibold",children:r(f)})]},c)})})]})})})]}),((i=e.supplies)==null?void 0:i.totalValue)!==void 0&&a.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg flex flex-col sm:flex-row sm:justify-between",children:[a.jsx("span",{className:"text-gray-600 font-medium mb-1 sm:mb-0",children:"Total Value"}),a.jsx("span",{className:"text-gray-800 font-semibold",children:r(e.supplies.totalValue)})]}),((o=e.supplies)==null?void 0:o.remarks)&&a.jsxs("div",{className:"mt-4 sm:mt-6",children:[a.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-primary mb-2 sm:mb-4",children:"Remarks"}),a.jsx("p",{className:"bg-gray-50 p-4 rounded-lg text-sm sm:text-base",children:e.supplies.remarks})]})]})},xz=({formData:e,openInfoModal:t})=>{var r,n;return a.jsxs("div",{className:"space-y-4 sm:space-y-6 mt-6 sm:mt-8",children:[a.jsxs("div",{className:"flex items-center space-x-2 text-primary",children:[a.jsx(jr,{size:24}),a.jsx("h2",{className:"text-xl sm:text-2xl font-bold border-b pb-3",children:"Compliance Details"})]}),e.complinces&&(e!=null&&e.complinces)?a.jsx("div",{className:"space-y-4",children:((r=Object.keys(e==null?void 0:e.complinces))==null?void 0:r.length)>0?(n=Object.entries(e==null?void 0:e.complinces))==null?void 0:n.map(([s,i],o)=>{var l,c,A;return a.jsxs("div",{className:`p-3 sm:p-4 rounded-lg ${i.deviation?"bg-red-50 border border-red-200":"bg-green-50 border border-green-200"}`,children:[a.jsxs("div",{className:"flex items-start ",children:[a.jsx("h3",{className:`text-base sm:text-lg font-semibold ${i.deviation?"text-red-800":"text-green-800"}`,children:i.question}),a.jsx("button",{onClick:()=>t(i.question,i.description),className:"ml-2 text-gray-500 hover:text-gray-700 focus:outline-none","aria-label":"More information",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2h-1V9a1 1 0 00-1-1z",clipRule:"evenodd"})})})]}),a.jsx("p",{className:`mt-2 font-medium ${i.deviation?"text-red-600":"text-green-600"}`,children:i.answer?"Yes":"No"}),i.department&&a.jsxs("p",{className:"mt-2 text-xs sm:text-sm text-gray-600",children:[a.jsx("strong",{children:"Department:"})," ",i.department]}),i.deviation&&a.jsx("div",{className:"mt-2 p-2 sm:p-3 bg-red-100 rounded",children:a.jsxs("p",{className:"text-xs sm:text-sm text-red-700",children:[a.jsx("strong",{children:"Deviation Reason:"})," ",i.deviation.reason]})}),((c=(l=i==null?void 0:i.deviation)==null?void 0:l.attachments)==null?void 0:c.length)>0&&a.jsxs("div",{className:"mt-4",children:[a.jsx("strong",{className:"text-xs sm:text-sm text-red-700",children:"Attachments:"}),a.jsx("ul",{className:"list-disc pl-4 sm:pl-6 mt-2",children:(A=i==null?void 0:i.deviation)==null?void 0:A.attachments.map((d,u)=>a.jsx("li",{className:"text-xs sm:text-sm",children:a.jsxs("a",{href:d,target:"_blank",rel:"noopener noreferrer",className:"text-red-600 hover:text-red-800 underline",children:["Attachment"," ",u+1]})},u))})]})]},s)}):a.jsx("div",{className:"text-gray-500",children:"No compliance details available"})}):a.jsx("div",{className:"text-gray-500",children:"No compliance data available"})]})},gz=({formData:e})=>{var t;return a.jsxs("div",{className:"p-4 sm:p-6 border rounded-lg shadow-sm bg-gray-50",children:[a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-4 sm:mb-6",children:[a.jsx(Xm,{className:"w-6 h-6 sm:w-8 sm:h-8 text-blue-600"}),a.jsx("h3",{className:"font-semibold text-xl sm:text-2xl",children:"Approver"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4 sm:gap-8 p-3 sm:p-4",children:[a.jsxs("div",{className:"w-full sm:w-auto",children:[a.jsx("div",{className:"text-gray-600 text-xs sm:text-sm",children:"Department"}),a.jsx("div",{className:"font-medium text-sm sm:text-base",children:e.commercials.department})]}),a.jsxs("div",{className:"w-full sm:w-auto",children:[a.jsx("div",{className:"text-gray-600 text-xs sm:text-sm",children:"Head of Department"}),a.jsx("div",{className:"font-medium text-sm sm:text-base",children:e.commercials.hod||"No HOD found"})]}),a.jsxs("div",{className:"w-full sm:w-auto",children:[a.jsx("div",{className:"text-gray-600 text-xs sm:text-sm",children:"HOD Email"}),a.jsx("div",{className:"font-medium text-sm sm:text-base break-words",children:((t=e==null?void 0:e.commercials)==null?void 0:t.hodEmail)||"No email found"})]})]})]})},yz=({formData:e,onSubmit:t,onBack:r})=>{console.log("FORMDATA",e);const[n,s]=C.useState(!1),[i,o]=C.useState(!1),[l,c]=C.useState({title:"",description:""}),[A,d]=C.useState([]);C.useEffect(()=>{(async()=>{const g=await mo();g.status===200&&d(g.data.data)})()},[]);const u=(m,g)=>{c({title:m,description:g||"No additional information available for this question."}),o(!0)},f=()=>{o(!1)},h=m=>{const g=A.find(p=>p.code===e.supplies.selectedCurrency);return!g||!m?"N/A":new Intl.NumberFormat(g.locale,{style:"currency",currency:g.code,minimumFractionDigits:2,maximumFractionDigits:2}).format(m)},x=m=>{var g;return!m||((g=Object.keys(m))==null?void 0:g.length)===0?a.jsx("div",{className:"text-gray-500",children:"No files uploaded"}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(m).map(([p,v])=>v&&v.length>0&&a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-3 capitalize border-b pb-2",children:p.replace(/([A-Z])/g," $1").toLowerCase()}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:v.map((w,B)=>a.jsx("div",{className:"flex flex-col items-center bg-gray-50 rounded p-2",children:a.jsxs("a",{href:w,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:text-blue-800 truncate max-w-full text-center",children:[" ",a.jsx("img",{src:lv,alt:`Icon ${B+1}`,className:"w-10 h-10 object-cover mb-2"})]})},B))})]},p))})};return a.jsxs("div",{className:"w-full mx-auto bg-white shadow-lg rounded-lg overflow-hidden",children:[a.jsxs("div",{className:"space-y-6 p-4 sm:p-6",children:[a.jsx(hz,{formData:e}),a.jsx(mz,{formData:e,formatDateToDDMMYY:so,renderUploadedFiles:x}),a.jsx(pz,{formData:e,parseFloat,formatCurrency:h}),a.jsx(xz,{formData:e,openInfoModal:u}),a.jsx(gz,{formData:e})]}),a.jsxs("div",{className:"p-4 sm:p-6 flex flex-col sm:flex-row justify-between items-center gap-4 border-t mt-6 sm:mt-8",children:[a.jsx("div",{}),a.jsxs("button",{onClick:()=>s(!0),className:"w-full sm:w-auto flex items-center justify-center bg-primary text-white px-4 sm:px-6 py-2 rounded-md hover:bg-primary-dark transition-colors duration-300",children:[a.jsx(q_,{className:"mr-2",size:20}),"Submit"]})]}),i&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6 relative",children:[a.jsx("button",{onClick:f,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:l.title}),a.jsx("p",{className:"text-gray-600",children:l.description}),a.jsx("div",{className:"mt-4 flex justify-end",children:a.jsx("button",{onClick:f,className:"px-4 py-2 bg-primary text-white rounded hover:bg-primary/90 transition-colors",children:"Close"})})]})}),n&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-lg shadow-lg w-full max-w-xs sm:max-w-sm",children:[a.jsx("h3",{className:"text-lg sm:text-xl font-semibold mb-3 sm:mb-4",children:"Confirm Submission"}),a.jsx("p",{className:"mb-4 sm:mb-6 text-sm sm:text-base",children:"Are you sure you want to submit this form?"}),a.jsxs("div",{className:"flex flex-col sm:flex-row-reverse justify-end gap-3 sm:gap-4",children:[a.jsx("button",{onClick:()=>{t(),s(!1)},className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary w-full sm:w-auto",children:"Submit Request"}),a.jsx("button",{onClick:()=>s(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-100 w-full sm:w-auto mt-2 sm:mt-0",children:"Cancel"})]})]})})]})},vz=({formData:e,setFormData:t,onNext:r,onBack:n,reqId:s})=>{const[i,o]=C.useState([]),[l,c]=C.useState({}),[A,d]=C.useState({}),[u,f]=C.useState(!0),[h,x]=C.useState({}),[m,g]=C.useState(!1),[p,v]=C.useState({}),[w,B]=C.useState(!1),[T,_]=C.useState(!1),[j,E]=C.useState({title:"",description:""}),[L,M]=C.useState(!1);C.useEffect(()=>{if(i.length>0&&Object.keys(l).length>0){const U=i.some(H=>l[H._id]!==H.expectedAnswer),Q=i.reduce((H,X)=>{const V=X.createdBy.department;return H[V]||(H[V]=!1),l[X._id]!==X.expectedAnswer&&(H[V]=!0),H},{});x(Q),t(H=>({...H,hasDeviations:U?1:0,departmentDeviations:Q}))}},[i,l,t]),C.useEffect(()=>{(async()=>{try{f(!0);const H=(await SI()).data.data;o(H);const X={},V={},Ae={},W={};[...new Set(H.map(ve=>ve.createdBy.department))].forEach(ve=>{W[ve]=!0,Ae[ve]=!1}),H.forEach(ve=>{var je;const de=(je=e.complinces)==null?void 0:je[ve._id],te=ve.createdBy.department;de?(X[ve._id]=de.answer,V[ve._id]=de.deviation||{reason:"",attachments:[]},de.answer!==ve.expectedAnswer&&(Ae[te]=!0)):(X[ve._id]=ve.expectedAnswer,V[ve._id]={reason:"",attachments:[]},t(qe=>({...qe,complinces:{...qe.complinces,[ve._id]:{questionId:ve._id,question:ve.question,answer:ve.expectedAnswer,department:ve.createdBy.department,deviation:null,expectedAnswer:ve.expectedAnswer,description:ve.description}},hasDeviations:0,departmentDeviations:Ae,riskAccepted:!1})))}),c(X),d(V),x(Ae),v(W),e.riskAccepted!==void 0&&g(e.riskAccepted),f(!1)}catch(Q){console.error("Error fetching questions:",Q),f(!1)}})()},[]);const F=U=>{v(Q=>({...Q,[U]:!Q[U]}))},D=(U,Q)=>{const H=i.find(Ae=>Ae._id===U),X=Q!==(H==null?void 0:H.expectedAnswer),V=H==null?void 0:H.createdBy.department;c(Ae=>({...Ae,[U]:Q})),t(Ae=>({...Ae,complinces:{...Ae.complinces,[U]:{questionId:U,question:H.question,answer:Q,department:V,deviation:X?A[U]:null,expectedAnswer:H.expectedAnswer,description:H.description}}}))},G=(U,Q,H)=>{const X={...A[U],[Q]:H};d(V=>({...V,[U]:X})),t(V=>({...V,complinces:{...V.complinces,[U]:{...V.complinces[U],deviation:X}}}))},K=async(U,Q)=>{var H;try{const X=Array.from(Q).map(J=>Ac(J,"compliances",s)),Ae=(await Promise.all(X)).flatMap(J=>J.data.fileUrls[0]),W=[...((H=A[U])==null?void 0:H.attachments)||[],...Ae];G(U,"attachments",W)}catch(X){console.error("Upload error:",X)}},ae=(U,Q)=>{var X;const H=(X=A[U])==null?void 0:X.attachments.filter(V=>V!==Q);G(U,"attachments",H)},Z=(U,Q)=>{E({title:U,description:Q}),_(!0)},oe=()=>{_(!1)},Y=U=>{const Q=U.target.checked;g(Q),t(H=>({...H,riskAccepted:Q}))},R=()=>{i.some(Q=>{var Ae;const H=(((Ae=Q==null?void 0:Q.createdBy)==null?void 0:Ae.department)||"").toLowerCase(),X=H.includes("legal"),V=H.includes("info")&&H.includes("security");return X||V?l[Q._id]!==Q.expectedAnswer:!1})?ee():M(!0)},z=()=>{M(!1),ee()},ee=async()=>{try{B(!0),(await _I(e,s)).status===200&&r()}catch(U){console.error("Error saving data:",U)}finally{B(!1)}},b=U=>{try{let Q=U.split("/").pop();return Q=Q.split("?")[0],Q=decodeURIComponent(Q),Q=Q.replace(/[-_]/g," ").split(" ").map(H=>H.charAt(0).toUpperCase()+H.slice(1)).join(" "),Q=Q.replace(/\.[^/.]+$/,""),Q}catch(Q){return console.error("Error parsing filename:",Q),"Document"}},O=i.reduce((U,Q)=>{const H=Q.createdBy.department;return U[H]||(U[H]=[]),U[H].push(Q),U},{}),S=i.some(U=>l[U._id]!==U.expectedAnswer);if(u)return a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})});const I=({files:U,onRemove:Q})=>a.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:U.map((H,X)=>a.jsxs("div",{className:"flex items-center gap-2 bg-white px-3 py-2 rounded-md border border-gray-200 w-full sm:w-auto",children:[a.jsxs("a",{href:H,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 hover:text-primary flex-1 min-w-0",children:[a.jsx(ep,{size:14,className:"text-red-500 shrink-0"}),a.jsx("span",{className:"text-sm text-gray-600 truncate",children:b(H)})]}),a.jsx("button",{onClick:()=>Q(H),className:"p-1 hover:bg-gray-100 rounded-full shrink-0",title:"Remove file",children:a.jsx(_r,{size:12,className:"text-gray-500"})})]},X))});return a.jsxs("div",{className:"w-full max-w-7xl mx-auto px-4 sm:px-6",children:[a.jsxs("div",{className:"mb-6 bg-white rounded-xl shadow-lg overflow-hidden",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Agreement Compliance Assessment"}),a.jsx("p",{className:"mt-2 text-gray-600",children:"Review and respond to compliance questions from different departments. Any deviations from expected answers will require justification."})]}),a.jsx("div",{className:"p-6 flex flex-col sm:flex-row sm:items-center gap-4 sm:gap-8 bg-gray-50",children:a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"flex items-center gap-3",children:S?a.jsxs("div",{className:"flex items-center gap-2 text-red-600",children:[a.jsx(sd,{className:"h-5 w-5"}),a.jsx("span",{className:"font-semibold",children:"Deviations Present"})]}):a.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[a.jsx($a,{className:"h-5 w-5"}),a.jsx("span",{className:"font-semibold",children:"All Compliant"})]})}),a.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[Object.keys(O).length," ","departments, ",i.length," total questions"]})]})})]}),a.jsxs("div",{className:"space-y-6",children:[Object.entries(O).map(([U,Q])=>{const H=h[U]||!1,X=p[U]||!1;return a.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden",children:[a.jsxs("button",{onClick:()=>F(U),className:`w-full px-6 py-4 flex justify-between items-center ${H?"bg-red-50 hover:bg-red-100":"bg-primary/10 hover:bg-primary/15"} transition-colors`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:U}),H&&a.jsxs("div",{className:"flex items-center gap-2 bg-red-100 px-3 py-1 rounded-full",children:[a.jsx(sd,{className:"text-red-500 h-4 w-4"}),a.jsxs("span",{className:"text-sm font-medium text-red-600",children:[Q.filter(V=>l[V._id]!==V.expectedAnswer).length," ","Deviation(s)"]})]})]}),X?a.jsx(bl,{className:"h-5 w-5 text-gray-500"}):a.jsx(vo,{className:"h-5 w-5 text-gray-500"})]}),X&&a.jsx("div",{className:"divide-y divide-gray-100",children:Q.map(V=>{var ve,de;const Ae=l[V._id],W=A[V._id],J=Ae!==V.expectedAnswer;return a.jsxs("div",{className:`p-6 hover:bg-gray-50 transition-colors ${J?"bg-red-50/50":""}`,children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4",children:[a.jsx("div",{className:"flex items-start space-x-2 flex-1",children:a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-lg text-gray-800 font-medium",children:V.question}),V.description&&a.jsx("div",{className:"mt-2 flex items-center",children:a.jsxs("button",{onClick:()=>Z(V.question,V.description),className:"text-sm text-primary hover:text-primary/80 flex items-center gap-1 transition-colors",children:[a.jsx(Fi,{size:14}),a.jsx("span",{children:"View more details"})]})})]})}),a.jsx("div",{className:"flex items-center gap-6 shrink-0",children:a.jsxs("div",{className:`flex items-center gap-4 p-3 rounded-lg ${Ae?"bg-green-50/70":"bg-red-50/70"}`,children:[a.jsxs("label",{className:"inline-flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"radio",name:V._id,checked:Ae===!0,onChange:()=>D(V._id,!0),className:"w-5 h-5 text-primary"}),a.jsx("span",{className:"text-base text-gray-700 font-medium",children:"Yes"})]}),a.jsxs("label",{className:"inline-flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"radio",name:V._id,checked:Ae===!1,onChange:()=>D(V._id,!1),className:"w-5 h-5 text-primary"}),a.jsx("span",{className:"text-base text-gray-700 font-medium",children:"No"})]})]})})]}),J&&a.jsxs("div",{className:"mt-5 bg-red-50 rounded-lg p-4 border border-red-100",children:[a.jsxs("h4",{className:"text-red-700 font-medium mb-3 flex items-center gap-2",children:[a.jsx(sd,{size:16}),"Justification Required"]}),a.jsx("textarea",{placeholder:"Please provide justification for this deviation...",value:(W==null?void 0:W.reason)||"",onChange:te=>G(V._id,"reason",te.target.value),className:"w-full p-3 border rounded-lg resize-none focus:ring-2 focus:ring-primary/50 focus:border-primary",rows:3}),a.jsxs("div",{className:"mt-4 space-y-3",children:[a.jsxs("div",{className:"flex flex-col xs:flex-row xs:items-center xs:justify-between gap-2",children:[a.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 bg-white rounded-lg border hover:bg-gray-50 cursor-pointer w-full xs:w-auto transition-colors",children:[a.jsx(Ds,{size:16,className:"text-primary shrink-0"}),a.jsx("span",{className:"text-sm font-medium truncate",children:"Upload Supporting Documents"}),a.jsx("input",{type:"file",multiple:!0,className:"hidden",onChange:te=>K(V._id,te.target.files)})]}),a.jsxs("span",{className:"text-sm text-gray-600",children:[((ve=W==null?void 0:W.attachments)==null?void 0:ve.length)||0," ","files attached"]})]}),((de=W==null?void 0:W.attachments)==null?void 0:de.length)>0&&a.jsx(I,{files:W.attachments,onRemove:te=>ae(V._id,te)})]})]})]},V._id)})})]},U)}),a.jsxs("div",{className:"flex justify-between pt-4 mb-8",children:[a.jsx("div",{}),a.jsx("button",{onClick:R,disabled:w,className:`px-5 py-3 bg-primary text-white font-medium rounded-lg shadow-md flex items-center gap-2 ${w?"opacity-50 cursor-not-allowed":"hover:bg-primary/90"}`,children:w?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full mr-2"}),"Saving..."]}):a.jsxs(a.Fragment,{children:["Continue to Preview",a.jsx(yN,{size:18})]})})]})]}),L&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full p-6 relative",children:[a.jsx("button",{onClick:()=>M(!1),className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx(_r,{size:20})}),a.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[a.jsx(sd,{className:"text-yellow-500 h-8 w-8 shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-3",children:"Risk Acknowledgment Required"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Deviations have been identified in your compliance assessment. Please acknowledge the risks before proceeding."})]})]}),a.jsx("div",{className:"bg-yellow-50 rounded-lg border border-yellow-100 p-4 mb-6",children:a.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:m,onChange:Y,className:"w-5 h-5 text-primary rounded mt-0.5 flex-shrink-0"}),a.jsx("span",{className:"text-base font-medium text-gray-800",children:"The information provided above is accurate to the best of my knowledge and has the necessary agreement/legal confirmation. However, if any discrepancies or non-compliance with policies are identified in the future, I acknowledge that the associated risks and responsibilities will be taken by me."})]})}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx("button",{onClick:()=>M(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),a.jsx("button",{onClick:z,disabled:!m||w,className:`px-6 py-2 bg-primary text-white rounded-lg font-medium flex items-center gap-2 ${!m||w?"opacity-50 cursor-not-allowed":"hover:bg-primary/90"} transition-colors`,children:w?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full"}),"Saving..."]}):a.jsxs(a.Fragment,{children:["Accept & Continue",a.jsx(yN,{size:16})]})})]})]})}),T&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6 relative",children:[a.jsx("button",{onClick:oe,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx(_r,{size:20})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:j.title}),a.jsx("p",{className:"text-gray-600",children:j.description}),a.jsx("div",{className:"mt-6 flex justify-end",children:a.jsx("button",{onClick:oe,className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors",children:"Close"})})]})})]})},gS=()=>{const e=Sr(),{id:t}=yo();tH();const r=localStorage.getItem("capEmpId"),[n,s]=C.useState([]),[i,o]=C.useState(!1),[l,c]=C.useState(!1),[A,d]=C.useState(t||null),[u,f]=C.useState([0]),[h,x]=C.useState(!!t),[m,g]=C.useState({commercials:{},procurements:{},supplies:[],remarks:"",complinces:[]});C.useEffect(()=>{(async()=>{if(t){c(!0);try{const j=await getRequestById(t);if(j.status===200&&j.data){const E=j.data;g({commercials:E.commercials||{},procurements:E.procurements||{},supplies:E.supplies||[],remarks:E.remarks||"",complinces:E.complinces||[]});const L=[];E.commercials&&Object.keys(E.commercials).length>0&&L.push(0),E.procurements&&Object.keys(E.procurements).length>0&&L.push(1),E.supplies&&E.supplies.length>0&&L.push(2),E.complinces&&E.complinces.length>0&&L.push(3),s(L),d(t)}}catch(j){console.error("Error loading request data:",j),Ie.error("Failed to load request data")}finally{c(!1)}}})()},[t]);const p=async()=>{var _;o(!0);try{const j={...m,complinces:Object.values(m.complinces).map(L=>({questionId:L.questionId,question:L.question,answer:L.answer,department:L.department,expectedAnswer:L.expectedAnswer,deviation:L.deviation?{reason:L.deviation.reason,attachments:L.deviation.attachments}:null}))};let E;h?(E=await BI(t,r,j),E.status===200&&(Ie.success("Request updated successfully"),setTimeout(()=>{e("/req-list-table")},1500))):(E=await y$(r,j,(_=j==null?void 0:j.commercials)==null?void 0:_.newReqId),E.status===200&&(Ie.success("New Request created successfully"),setTimeout(()=>{e("/req-list-table")},1500)))}catch(j){console.error("Error in submit req",j),Ie.error(h?"Failed to update request":"Failed to create request")}finally{o(!1)}},v=[{title:"Commercials",icon:jr,description:"Enter commercial details and information",content:a.jsx(fz,{formData:m.commercials,setFormData:_=>g(j=>({...j,commercials:typeof _=="function"?_(j.commercials):_})),onNext:()=>w(0),setReqId:d,reqId:A,isEditMode:h})},{title:"Procurements",icon:$4,description:"Manage procurement details and requirements",content:a.jsx(uz,{formData:m.procurements,setFormData:_=>g(j=>({...j,procurements:typeof _=="function"?_(j.procurements):_})),onNext:()=>w(1),onBack:()=>{},reqId:A,isEditMode:h})},{title:"Supplies",icon:W_,description:"Add supply items and logistics information",content:a.jsx(sz,{formData:m.supplies,setFormData:_=>g(j=>({...j,supplies:typeof _=="function"?_(j.supplies):_})),remarks:m.remarks,onBack:()=>{},onNext:()=>w(2),reqId:A,isEditMode:h})},{title:"Agreement Compliance",icon:jr,description:"Review and complete compliance requirements",content:a.jsx(vz,{formData:m,setFormData:g,onBack:()=>{},onNext:()=>w(3),reqId:A,isEditMode:h})},{title:"Preview",icon:ho,description:"Review all information before submission",content:a.jsx(yz,{formData:m,onSubmit:p,onBack:()=>{},isEditMode:h})}],w=_=>{console.log("formData",m,A),n.includes(_)||s([...n,_]),_+1<v.length&&B(_+1)},B=_=>{f(j=>j.includes(_)?j.filter(E=>E!==_):[...j,_])},T=_=>_===0||h?!0:n.includes(_-1);return l?a.jsx("div",{className:"w-full mx-auto bg-gray-50 p-2 sm:p-4 md:p-6",children:a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(If,{className:"w-6 h-6 animate-spin text-primary"}),a.jsx("span",{className:"text-gray-700",children:"Loading request data..."})]})})}):a.jsxs("div",{className:"w-full mx-auto bg-gray-50 p-2 sm:p-4 md:p-6",children:[i&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white p-4 rounded-lg flex items-center gap-3",children:[a.jsx(If,{className:"w-6 h-6 animate-spin text-primary"}),a.jsx("span",{className:"text-gray-700",children:h?"Updating request...":"Creating request..."})]})}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:h?`Edit Request ${A}`:"Create Request"}),a.jsx("p",{className:"text-gray-600",children:h?"Modify the information below to update your request.":"Complete all steps below to create your request. Click on each step to expand and fill the required information."})]}),a.jsx("div",{className:"space-y-4",children:v.map((_,j)=>{const E=_.icon,L=n.includes(j),M=u.includes(j),F=T(j);return a.jsxs("div",{className:`bg-white rounded-lg border transition-all duration-200 ${L?"border-green-300 shadow-md":M?"border-primary shadow-lg":"border-gray-200 shadow-sm"} ${F?"":"opacity-60"}`,children:[a.jsxs("div",{className:`flex items-center justify-between p-4 cursor-pointer ${F?"hover:bg-gray-50":"cursor-not-allowed"}`,onClick:()=>F&&B(j),children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center border-2 ${L?"border-green-500 bg-green-500 text-white":M?"border-primary bg-primary text-white":"border-gray-300 bg-gray-100 text-gray-400"}`,children:L?a.jsx(ho,{className:"w-6 h-6"}):a.jsx(E,{className:"w-6 h-6"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("h3",{className:`font-semibold text-lg ${L?"text-green-700":M?"text-primary":"text-gray-700"}`,children:[j+1,". ",_.title]}),L&&a.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs rounded-full font-medium",children:"Completed"})]}),a.jsx("p",{className:"text-gray-600 text-sm mt-1",children:_.description})]})]}),F&&a.jsx("div",{className:"flex-shrink-0",children:M?a.jsx(bl,{className:"w-5 h-5 text-gray-400"}):a.jsx(vo,{className:"w-5 h-5 text-gray-400"})})]}),M&&F&&a.jsx("div",{className:"px-4 pb-4",children:a.jsx("div",{className:"border-t border-gray-200 pt-4",children:_.content})})]},j)})}),a.jsx(In,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,pauseOnFocusLoss:!0})]})},tp=({currentPage:e,totalPages:t,handlePageChange:r,itemsPerPage:n,totalItems:s})=>{const i=()=>{const h=[],x=[];let m;for(let g=1;g<=t;g++)(g===1||g===t||g>=e-2&&g<=e+2)&&h.push(g);return h.forEach(g=>{m&&(g-m===2?x.push(m+1):g-m!==1&&x.push("...")),x.push(g),m=g}),x},o=(e-1)*n,l=Math.min(o+n,s),c="flex items-center justify-center px-3 py-2 text-sm font-medium transition-colors duration-200",A="bg-primary text-white hover:bg-primary/90",d="text-gray-500 hover:bg-gray-100",u="text-gray-300 cursor-not-allowed hover:bg-transparent";return a.jsxs("div",{className:"flex items-center justify-between px-6 py-4 bg-gray-50 border-t border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[a.jsx("span",{children:"Showing"}),a.jsx("span",{className:"font-medium",children:o+1}),a.jsx("span",{children:"to"}),a.jsx("span",{className:"font-medium",children:l}),a.jsx("span",{children:"of"}),a.jsx("span",{className:"font-medium",children:s}),a.jsx("span",{children:"entries"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>r(1),disabled:e===1,className:`${c} rounded-l-lg ${e===1?u:d}`,children:a.jsx(Gm,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>r(e-1),disabled:e===1,className:`${c} ${e===1?u:d}`,children:a.jsx(zm,{className:"h-4 w-4"})}),a.jsx("div",{className:"flex items-center",children:i().map((f,h)=>a.jsx("button",{onClick:()=>typeof f=="number"&&r(f),className:`${c} ${f===e?A:typeof f=="number"?d:u}`,disabled:typeof f!="number",children:f},h))}),a.jsx("button",{onClick:()=>r(e+1),disabled:e===t,className:`${c} ${e===t?u:d}`,children:a.jsx(Wf,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>r(t),disabled:e===t,className:`${c} rounded-r-lg ${e===t?u:d}`,children:a.jsx(Wm,{className:"h-4 w-4"})})]})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var D1={};D1.version="0.18.5";var i8=1252,wz=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],AC={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},dC=function(e){wz.indexOf(e)!=-1&&(i8=AC[0]=e)};function bz(){dC(1252)}var Oo=function(e){dC(e)};function uC(){Oo(1200),bz()}function yS(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Nz(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function o8(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var dh=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Nz(e.slice(2)):t==254&&r==255?o8(e.slice(2)):t==65279?e.slice(1):e},Fx=function(t){return String.fromCharCode(t)},vS=function(t){return String.fromCharCode(t)},Kc,Xc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function pm(e){for(var t="",r=0,n=0,s=0,i=0,o=0,l=0,c=0,A=0;A<e.length;)r=e.charCodeAt(A++),i=r>>2,n=e.charCodeAt(A++),o=(r&3)<<4|n>>4,s=e.charCodeAt(A++),l=(n&15)<<2|s>>6,c=s&63,isNaN(n)?l=c=64:isNaN(s)&&(c=64),t+=Xc.charAt(i)+Xc.charAt(o)+Xc.charAt(l)+Xc.charAt(c);return t}function ki(e){var t="",r=0,n=0,s=0,i=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var A=0;A<e.length;)i=Xc.indexOf(e.charAt(A++)),o=Xc.indexOf(e.charAt(A++)),r=i<<2|o>>4,t+=String.fromCharCode(r),l=Xc.indexOf(e.charAt(A++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=Xc.indexOf(e.charAt(A++)),s=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var Cr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),mc=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function gA(e){return Cr?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function wS(e){return Cr?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var gi=function(t){return Cr?mc(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function cv(e){if(typeof ArrayBuffer>"u")return gi(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function EA(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Cz(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function fC(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return fC(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var _s=Cr?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:mc(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function jz(e){for(var t=[],r=0,n=e.length+250,s=gA(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++i)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|l>>6&15|(o&3)<<4,s[r++]=128|l&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>n&&(t.push(s.slice(0,r)),r=0,s=gA(65535),n=65530)}return t.push(s.slice(0,r)),_s(t)}var La=/\u0000/g,uh=/[\u0001-\u0006]/g;function hf(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ro(e,t){var r=""+e;return r.length>=t?r:qn("0",t-r.length)+r}function hC(e,t){var r=""+e;return r.length>=t?r:qn(" ",t-r.length)+r}function P1(e,t){var r=""+e;return r.length>=t?r:r+qn(" ",t-r.length)}function Bz(e,t){var r=""+Math.round(e);return r.length>=t?r:qn("0",t-r.length)+r}function Sz(e,t){var r=""+e;return r.length>=t?r:qn("0",t-r.length)+r}var bS=Math.pow(2,32);function ju(e,t){if(e>bS||e<-bS)return Bz(e,t);var r=Math.round(e);return Sz(r,t)}function O1(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var NS=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],gw=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Fz(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ar={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},CS={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Ez={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function R1(e,t,r){for(var n=e<0?-1:1,s=e*n,i=0,o=1,l=0,c=1,A=0,d=0,u=Math.floor(s);A<t&&(u=Math.floor(s),l=u*o+i,d=u*A+c,!(s-u<5e-8));)s=1/(s-u),i=o,o=l,c=A,A=d;if(d>t&&(A>t?(d=c,l=i):(d=A,l=o)),!r)return[0,n*l,d];var f=Math.floor(n*l/d);return[f,n*l-f*d,d]}function id(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),i=0,o=[],l={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=Uz(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=i,l}var l8=new Date(1899,11,31,0,0,0),kz=l8.getTime(),Tz=new Date(1900,2,1,0,0,0);function c8(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Tz&&(r+=24*60*60*1e3),(r-(kz+(e.getTimezoneOffset()-l8.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function mC(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function _z(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Iz(e){var t=e<0?12:11,r=mC(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Lz(e){var t=mC(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function xm(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Iz(e):t===10?r=e.toFixed(10).substr(0,12):r=Lz(e),mC(_z(r.toUpperCase()))}function Ed(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):xm(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return po(14,c8(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Uz(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Dz(e,t,r,n){var s="",i=0,o=0,l=r.y,c,A=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,A=2;break;default:c=l%1e4,A=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,A=t.length;break;case 3:return gw[r.m-1][1];case 5:return gw[r.m-1][0];default:return gw[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,A=t.length;break;case 3:return NS[r.q][0];default:return NS[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,A=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,A=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,A=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ro(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(s=Ro(i,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}A=t.length===3?1:2;break;case 101:c=l,A=1;break}var d=A>0?Ro(c,A):"";return d}function Yc(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var A8=/%/g;function Pz(e,t,r){var n=t.replace(A8,""),s=t.length-n.length;return ec(e,n,r*Math.pow(10,2*s))+qn("%",s)}function Oz(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ec(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function d8(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+d8(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,A,d){return c+A+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var u8=/# (\?+)( ?)\/( ?)(\d+)/;function Rz(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),i=Math.floor(s/n),o=s-i*n,l=n;return r+(i===0?"":""+i)+" "+(o===0?qn(" ",e[1].length+1+e[4].length):hC(o,e[1].length)+e[2]+"/"+e[3]+Ro(l,e[4].length))}function Qz(e,t,r){return r+(t===0?"":""+t)+qn(" ",e[1].length+2+e[4].length)}var f8=/^#*0*\.([0#]+)/,h8=/\).*[0#]/,m8=/\(###\) ###\\?-####/;function ka(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function jS(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function BS(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Mz(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Hz(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Gi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(h8)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Gi("n",n,r):"("+Gi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Oz(e,t,r);if(t.indexOf("%")!==-1)return Pz(e,t,r);if(t.indexOf("E")!==-1)return d8(t,r);if(t.charCodeAt(0)===36)return"$"+Gi(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,o,l,c=Math.abs(r),A=r<0?"-":"";if(t.match(/^00+$/))return A+ju(c,t.length);if(t.match(/^[#?]+$/))return s=ju(r,0),s==="0"&&(s=""),s.length>t.length?s:ka(t.substr(0,t.length-s.length))+s;if(i=t.match(u8))return Rz(i,c,A);if(t.match(/^#+0+$/))return A+ju(c,t.length-t.indexOf("0"));if(i=t.match(f8))return s=jS(r,i[1].length).replace(/^([^\.]+)$/,"$1."+ka(i[1])).replace(/\.$/,"."+ka(i[1])).replace(/\.(\d*)$/,function(x,m){return"."+m+qn("0",ka(i[1]).length-m.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return A+jS(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return A+Yc(ju(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Gi(e,t,-r):Yc(""+(Math.floor(r)+Mz(r,i[1].length)))+"."+Ro(BS(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Gi(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=hf(Gi(e,t.replace(/[\\-]/g,""),r)),o=0,hf(hf(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<s.length?s.charAt(o++):x==="0"?"0":""}));if(t.match(m8))return s=Gi(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=R1(c,Math.pow(10,o)-1,!1),s=""+A,d=ec("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=P1(l[2],o),d.length<i[4].length&&(d=ka(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=R1(c,Math.pow(10,o)-1,!0),A+(l[0]||(l[1]?"":"0"))+" "+(l[1]?hC(l[1],o)+i[2]+"/"+i[3]+P1(l[2],o):qn(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=ju(r,0),t.length<=s.length?s:ka(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var u=t.indexOf(".")-o,f=t.length-s.length-u;return ka(t.substr(0,u)+s+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=BS(r,i[1].length),r<0?"-"+Gi(e,t,-r):Yc(Hz(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Ro(0,3-x.length):"")+x})+"."+Ro(o,i[1].length);switch(t){case"###,##0.00":return Gi(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=Yc(ju(c,0));return h!=="0"?A+h:"";case"###,###.00":return Gi(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Gi(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Vz(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ec(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function $z(e,t,r){var n=t.replace(A8,""),s=t.length-n.length;return ec(e,n,r*Math.pow(10,2*s))+qn("%",s)}function p8(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+p8(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,A,d){return c+A+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function sl(e,t,r){if(e.charCodeAt(0)===40&&!t.match(h8)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?sl("n",n,r):"("+sl("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Vz(e,t,r);if(t.indexOf("%")!==-1)return $z(e,t,r);if(t.indexOf("E")!==-1)return p8(t,r);if(t.charCodeAt(0)===36)return"$"+sl(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,o,l,c=Math.abs(r),A=r<0?"-":"";if(t.match(/^00+$/))return A+Ro(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:ka(t.substr(0,t.length-s.length))+s;if(i=t.match(u8))return Qz(i,c,A);if(t.match(/^#+0+$/))return A+Ro(c,t.length-t.indexOf("0"));if(i=t.match(f8))return s=(""+r).replace(/^([^\.]+)$/,"$1."+ka(i[1])).replace(/\.$/,"."+ka(i[1])),s=s.replace(/\.(\d*)$/,function(x,m){return"."+m+qn("0",ka(i[1]).length-m.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return A+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return A+Yc(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+sl(e,t,-r):Yc(""+r)+"."+qn("0",i[1].length);if(i=t.match(/^#,#*,#0/))return sl(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=hf(sl(e,t.replace(/[\\-]/g,""),r)),o=0,hf(hf(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<s.length?s.charAt(o++):x==="0"?"0":""}));if(t.match(m8))return s=sl(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=R1(c,Math.pow(10,o)-1,!1),s=""+A,d=ec("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=P1(l[2],o),d.length<i[4].length&&(d=ka(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=R1(c,Math.pow(10,o)-1,!0),A+(l[0]||(l[1]?"":"0"))+" "+(l[1]?hC(l[1],o)+i[2]+"/"+i[3]+P1(l[2],o):qn(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:ka(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var u=t.indexOf(".")-o,f=t.length-s.length-u;return ka(t.substr(0,u)+s+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+sl(e,t,-r):Yc(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Ro(0,3-x.length):"")+x})+"."+Ro(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=Yc(""+c);return h!=="0"?A+h:"";default:if(t.match(/\.[0#?]*$/))return sl(e,t.slice(0,t.lastIndexOf(".")),r)+ka(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ec(e,t,r){return(r|0)===r?sl(e,t,r):Gi(e,t,r)}function qz(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var x8=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function e0(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":O1(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(x8))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Kz(e,t,r,n){for(var s=[],i="",o=0,l="",c="t",A,d,u,f="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!O1(e,o))throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(u=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(u);s[s.length]={t:"t",v:i},++o;break;case"\\":var h=e.charAt(++o),x=h==="("||h===")"?h:"t";s[s.length]={t:x,v:h},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(A==null&&(A=id(t,r,e.charAt(o+1)==="2"),A==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||A==null&&(A=id(t,r),A==null))return"";for(i=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=f),s[s.length]={t:l,v:i},c=l;break;case"A":case"a":case"":var m={t:l,v:l};if(A==null&&(A=id(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(A!=null&&(m.v=A.H>=12?"P":"A"),m.t="T",f="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(A!=null&&(m.v=A.H>=12?"PM":"AM"),m.t="T",o+=5,f="h"):e.substr(o,5).toUpperCase()==="/"?(A!=null&&(m.v=A.H>=12?"":""),m.t="T",o+=5,f="h"):(m.t="t",++o),A==null&&m.t==="T")return"";s[s.length]=m,c=l;break;case"[":for(i=l;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(x8)){if(A==null&&(A=id(t,r),A==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",e0(e)||(s[s.length]={t:"t",v:i}));break;case".":if(A!=null){for(i=l;++o<e.length&&(l=e.charAt(o))==="0";)i+=l;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)i+=l;s[s.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++o)===l;)i+=l;s[s.length]={t:l,v:i},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:l,v:l},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"t",v:l},++o;break}var g=0,p=0,v;for(o=s.length-1,c="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=f,c="h",g<1&&(g=1);break;case"s":(v=s[o].v.match(/\.0+$/))&&(p=Math.max(p,v[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=s[o].t;break;case"m":c==="s"&&(s[o].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&s[o].v.match(/[Hh]/)&&(g=1),g<2&&s[o].v.match(/[Mm]/)&&(g=2),g<3&&s[o].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:A.u>=.5&&(A.u=0,++A.S),A.S>=60&&(A.S=0,++A.M),A.M>=60&&(A.M=0,++A.H);break;case 2:A.u>=.5&&(A.u=0,++A.S),A.S>=60&&(A.S=0,++A.M);break}var w="",B;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=Dz(s[o].t.charCodeAt(0),s[o].v,A,p),s[o].t="t";break;case"n":case"?":for(B=o+1;s[B]!=null&&((l=s[B].t)==="?"||l==="D"||(l===" "||l==="t")&&s[B+1]!=null&&(s[B+1].t==="?"||s[B+1].t==="t"&&s[B+1].v==="/")||s[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[B].v==="/"||s[B].v===" "&&s[B+1]!=null&&s[B+1].t=="?"));)s[o].v+=s[B].v,s[B]={v:"",t:";"},++B;w+=s[o].v,o=B-1;break;case"G":s[o].t="t",s[o].v=Ed(t,r);break}var T="",_,j;if(w.length>0){w.charCodeAt(0)==40?(_=t<0&&w.charCodeAt(0)===45?-t:t,j=ec("n",w,_)):(_=t<0&&n>1?-t:t,j=ec("n",w,_),_<0&&s[0]&&s[0].t=="t"&&(j=j.substr(1),s[0].v="-"+s[0].v)),B=j.length-1;var E=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){E=o;break}var L=s.length;if(E===s.length&&j.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(B>=s[o].v.length-1?(B-=s[o].v.length,s[o].v=j.substr(B+1,s[o].v.length)):B<0?s[o].v="":(s[o].v=j.substr(0,B+1),B=-1),s[o].t="t",L=o);B>=0&&L<s.length&&(s[L].v=j.substr(0,B+1)+s[L].v)}else if(E!==s.length&&j.indexOf("E")===-1){for(B=j.indexOf(".")-1,o=E;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(d=s[o].v.indexOf(".")>-1&&o===E?s[o].v.indexOf(".")-1:s[o].v.length-1,T=s[o].v.substr(d+1);d>=0;--d)B>=0&&(s[o].v.charAt(d)==="0"||s[o].v.charAt(d)==="#")&&(T=j.charAt(B--)+T);s[o].v=T,s[o].t="t",L=o}for(B>=0&&L<s.length&&(s[L].v=j.substr(0,B+1)+s[L].v),B=j.indexOf(".")+1,o=E;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==E)){for(d=s[o].v.indexOf(".")>-1&&o===E?s[o].v.indexOf(".")+1:0,T=s[o].v.substr(0,d);d<s[o].v.length;++d)B<j.length&&(T+=j.charAt(B++));s[o].v=T,s[o].t="t",L=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(_=n>1&&t<0&&o>0&&s[o-1].v==="-"?-t:t,s[o].v=ec(s[o].t,s[o].v,_),s[o].t="t");var M="";for(o=0;o!==s.length;++o)s[o]!=null&&(M+=s[o].v);return M}var SS=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function FS(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function zz(e,t){var r=qz(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(SS),l=r[1].match(SS);return FS(t,o)?[n,r[0]]:FS(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,i]}function po(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ar)[e],n==null&&(n=r.table&&r.table[CS[e]]||ar[CS[e]]),n==null&&(n=Ez[e]||"General");break}if(O1(n,0))return Ed(t,r);t instanceof Date&&(t=c8(t,r.date1904));var s=zz(n,t);if(O1(s[1]))return Ed(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Kz(s[1],t,r,s[0])}function tc(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ar[r]==null){t<0&&(t=r);continue}if(ar[r]==e){t=r;break}}t<0&&(t=391)}return ar[t]=e,t}function Av(e){for(var t=0;t!=392;++t)e[t]!==void 0&&tc(e[t],t)}function t0(){ar=Fz()}var Gz={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},g8=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Wz(e){var t=typeof e=="number"?ar[e]:e;return t=t.replace(g8,"(\\d+)"),new RegExp("^"+t+"$")}function Xz(e,t,r){var n=-1,s=-1,i=-1,o=-1,l=-1,c=-1;(t.match(g8)||[]).forEach(function(u,f){var h=parseInt(r[f+1],10);switch(u.toLowerCase().charAt(0)){case"y":n=h;break;case"d":i=h;break;case"h":o=h;break;case"s":c=h;break;case"m":o>=0?l=h:s=h;break}}),c>=0&&l==-1&&s>=0&&(l=s,s=-1);var A=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);A.length==7&&(A="0"+A),A.length==8&&(A="20"+A);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?A:n==-1&&s==-1&&i==-1?d:A+"T"+d}var Yz=function(){var e={};e.version="1.2.0";function t(){for(var j=0,E=new Array(256),L=0;L!=256;++L)j=L,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,E[L]=j;return typeof Int32Array<"u"?new Int32Array(E):E}var r=t();function n(j){var E=0,L=0,M=0,F=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)F[M]=j[M];for(M=0;M!=256;++M)for(L=j[M],E=256+M;E<4096;E+=256)L=F[E]=L>>>8^j[L&255];var D=[];for(M=1;M!=16;++M)D[M-1]=typeof Int32Array<"u"?F.subarray(M*256,M*256+256):F.slice(M*256,M*256+256);return D}var s=n(r),i=s[0],o=s[1],l=s[2],c=s[3],A=s[4],d=s[5],u=s[6],f=s[7],h=s[8],x=s[9],m=s[10],g=s[11],p=s[12],v=s[13],w=s[14];function B(j,E){for(var L=E^-1,M=0,F=j.length;M<F;)L=L>>>8^r[(L^j.charCodeAt(M++))&255];return~L}function T(j,E){for(var L=E^-1,M=j.length-15,F=0;F<M;)L=w[j[F++]^L&255]^v[j[F++]^L>>8&255]^p[j[F++]^L>>16&255]^g[j[F++]^L>>>24]^m[j[F++]]^x[j[F++]]^h[j[F++]]^f[j[F++]]^u[j[F++]]^d[j[F++]]^A[j[F++]]^c[j[F++]]^l[j[F++]]^o[j[F++]]^i[j[F++]]^r[j[F++]];for(M+=15;F<M;)L=L>>>8^r[(L^j[F++])&255];return~L}function _(j,E){for(var L=E^-1,M=0,F=j.length,D=0,G=0;M<F;)D=j.charCodeAt(M++),D<128?L=L>>>8^r[(L^D)&255]:D<2048?(L=L>>>8^r[(L^(192|D>>6&31))&255],L=L>>>8^r[(L^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,G=j.charCodeAt(M++)&1023,L=L>>>8^r[(L^(240|D>>8&7))&255],L=L>>>8^r[(L^(128|D>>2&63))&255],L=L>>>8^r[(L^(128|G>>6&15|(D&3)<<4))&255],L=L>>>8^r[(L^(128|G&63))&255]):(L=L>>>8^r[(L^(224|D>>12&15))&255],L=L>>>8^r[(L^(128|D>>6&63))&255],L=L>>>8^r[(L^(128|D&63))&255]);return~L}return e.table=r,e.bstr=B,e.buf=T,e.str=_,e}(),Jt=function(){var t={};t.version="1.2.1";function r(se,pe){for(var he=se.split("/"),me=pe.split("/"),ge=0,we=0,ze=Math.min(he.length,me.length);ge<ze;++ge){if(we=he[ge].length-me[ge].length)return we;if(he[ge]!=me[ge])return he[ge]<me[ge]?-1:1}return he.length-me.length}function n(se){if(se.charAt(se.length-1)=="/")return se.slice(0,-1).indexOf("/")===-1?se:n(se.slice(0,-1));var pe=se.lastIndexOf("/");return pe===-1?se:se.slice(0,pe+1)}function s(se){if(se.charAt(se.length-1)=="/")return s(se.slice(0,-1));var pe=se.lastIndexOf("/");return pe===-1?se:se.slice(pe+1)}function i(se,pe){typeof pe=="string"&&(pe=new Date(pe));var he=pe.getHours();he=he<<6|pe.getMinutes(),he=he<<5|pe.getSeconds()>>>1,se.write_shift(2,he);var me=pe.getFullYear()-1980;me=me<<4|pe.getMonth()+1,me=me<<5|pe.getDate(),se.write_shift(2,me)}function o(se){var pe=se.read_shift(2)&65535,he=se.read_shift(2)&65535,me=new Date,ge=he&31;he>>>=5;var we=he&15;he>>>=4,me.setMilliseconds(0),me.setFullYear(he+1980),me.setMonth(we-1),me.setDate(ge);var ze=pe&31;pe>>>=5;var rt=pe&63;return pe>>>=6,me.setHours(pe),me.setMinutes(rt),me.setSeconds(ze<<1),me}function l(se){$s(se,0);for(var pe={},he=0;se.l<=se.length-4;){var me=se.read_shift(2),ge=se.read_shift(2),we=se.l+ge,ze={};switch(me){case 21589:he=se.read_shift(1),he&1&&(ze.mtime=se.read_shift(4)),ge>5&&(he&2&&(ze.atime=se.read_shift(4)),he&4&&(ze.ctime=se.read_shift(4))),ze.mtime&&(ze.mt=new Date(ze.mtime*1e3));break}se.l=we,pe[me]=ze}return pe}var c;function A(){return c||(c={})}function d(se,pe){if(se[0]==80&&se[1]==75)return ir(se,pe);if((se[0]|32)==109&&(se[1]|32)==105)return Oe(se,pe);if(se.length<512)throw new Error("CFB file size "+se.length+" < 512");var he=3,me=512,ge=0,we=0,ze=0,rt=0,$e=0,Xe=[],Je=se.slice(0,512);$s(Je,0);var gt=u(Je);switch(he=gt[0],he){case 3:me=512;break;case 4:me=4096;break;case 0:if(gt[1]==0)return ir(se,pe);default:throw new Error("Major Version: Expected 3 or 4 saw "+he)}me!==512&&(Je=se.slice(0,me),$s(Je,28));var Ct=se.slice(0,me);f(Je,he);var Ut=Je.read_shift(4,"i");if(he===3&&Ut!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ut);Je.l+=4,ze=Je.read_shift(4,"i"),Je.l+=4,Je.chk("00100000","Mini Stream Cutoff Size: "),rt=Je.read_shift(4,"i"),ge=Je.read_shift(4,"i"),$e=Je.read_shift(4,"i"),we=Je.read_shift(4,"i");for(var wt=-1,Lt=0;Lt<109&&(wt=Je.read_shift(4,"i"),!(wt<0));++Lt)Xe[Lt]=wt;var or=h(se,me);g($e,we,or,me,Xe);var Mr=v(or,ze,Xe,me);Mr[ze].name="!Directory",ge>0&&rt!==G&&(Mr[rt].name="!MiniFAT"),Mr[Xe[0]].name="!FAT",Mr.fat_addrs=Xe,Mr.ssz=me;var Wr={},Qn=[],li=[],bo=[];w(ze,Mr,or,Qn,ge,Wr,li,rt),x(li,bo,Qn),Qn.shift();var Pi={FileIndex:li,FullPaths:bo};return pe&&pe.raw&&(Pi.raw={header:Ct,sectors:or}),Pi}function u(se){if(se[se.l]==80&&se[se.l+1]==75)return[0,0];se.chk(K,"Header Signature: "),se.l+=16;var pe=se.read_shift(2,"u");return[se.read_shift(2,"u"),pe]}function f(se,pe){var he=9;switch(se.l+=2,he=se.read_shift(2)){case 9:if(pe!=3)throw new Error("Sector Shift: Expected 9 saw "+he);break;case 12:if(pe!=4)throw new Error("Sector Shift: Expected 12 saw "+he);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+he)}se.chk("0600","Mini Sector Shift: "),se.chk("000000000000","Reserved: ")}function h(se,pe){for(var he=Math.ceil(se.length/pe)-1,me=[],ge=1;ge<he;++ge)me[ge-1]=se.slice(ge*pe,(ge+1)*pe);return me[he-1]=se.slice(he*pe),me}function x(se,pe,he){for(var me=0,ge=0,we=0,ze=0,rt=0,$e=he.length,Xe=[],Je=[];me<$e;++me)Xe[me]=Je[me]=me,pe[me]=he[me];for(;rt<Je.length;++rt)me=Je[rt],ge=se[me].L,we=se[me].R,ze=se[me].C,Xe[me]===me&&(ge!==-1&&Xe[ge]!==ge&&(Xe[me]=Xe[ge]),we!==-1&&Xe[we]!==we&&(Xe[me]=Xe[we])),ze!==-1&&(Xe[ze]=me),ge!==-1&&me!=Xe[me]&&(Xe[ge]=Xe[me],Je.lastIndexOf(ge)<rt&&Je.push(ge)),we!==-1&&me!=Xe[me]&&(Xe[we]=Xe[me],Je.lastIndexOf(we)<rt&&Je.push(we));for(me=1;me<$e;++me)Xe[me]===me&&(we!==-1&&Xe[we]!==we?Xe[me]=Xe[we]:ge!==-1&&Xe[ge]!==ge&&(Xe[me]=Xe[ge]));for(me=1;me<$e;++me)if(se[me].type!==0){if(rt=me,rt!=Xe[rt])do rt=Xe[rt],pe[me]=pe[rt]+"/"+pe[me];while(rt!==0&&Xe[rt]!==-1&&rt!=Xe[rt]);Xe[me]=-1}for(pe[0]+="/",me=1;me<$e;++me)se[me].type!==2&&(pe[me]+="/")}function m(se,pe,he){for(var me=se.start,ge=se.size,we=[],ze=me;he&&ge>0&&ze>=0;)we.push(pe.slice(ze*D,ze*D+D)),ge-=D,ze=YA(he,ze*4);return we.length===0?ot(0):_s(we).slice(0,se.size)}function g(se,pe,he,me,ge){var we=G;if(se===G){if(pe!==0)throw new Error("DIFAT chain shorter than expected")}else if(se!==-1){var ze=he[se],rt=(me>>>2)-1;if(!ze)return;for(var $e=0;$e<rt&&(we=YA(ze,$e*4))!==G;++$e)ge.push(we);g(YA(ze,me-4),pe-1,he,me,ge)}}function p(se,pe,he,me,ge){var we=[],ze=[];ge||(ge=[]);var rt=me-1,$e=0,Xe=0;for($e=pe;$e>=0;){ge[$e]=!0,we[we.length]=$e,ze.push(se[$e]);var Je=he[Math.floor($e*4/me)];if(Xe=$e*4&rt,me<4+Xe)throw new Error("FAT boundary crossed: "+$e+" 4 "+me);if(!se[Je])break;$e=YA(se[Je],Xe)}return{nodes:we,data:QS([ze])}}function v(se,pe,he,me){var ge=se.length,we=[],ze=[],rt=[],$e=[],Xe=me-1,Je=0,gt=0,Ct=0,Ut=0;for(Je=0;Je<ge;++Je)if(rt=[],Ct=Je+pe,Ct>=ge&&(Ct-=ge),!ze[Ct]){$e=[];var wt=[];for(gt=Ct;gt>=0;){wt[gt]=!0,ze[gt]=!0,rt[rt.length]=gt,$e.push(se[gt]);var Lt=he[Math.floor(gt*4/me)];if(Ut=gt*4&Xe,me<4+Ut)throw new Error("FAT boundary crossed: "+gt+" 4 "+me);if(!se[Lt]||(gt=YA(se[Lt],Ut),wt[gt]))break}we[Ct]={nodes:rt,data:QS([$e])}}return we}function w(se,pe,he,me,ge,we,ze,rt){for(var $e=0,Xe=me.length?2:0,Je=pe[se].data,gt=0,Ct=0,Ut;gt<Je.length;gt+=128){var wt=Je.slice(gt,gt+128);$s(wt,64),Ct=wt.read_shift(2),Ut=bC(wt,0,Ct-Xe),me.push(Ut);var Lt={name:Ut,type:wt.read_shift(1),color:wt.read_shift(1),L:wt.read_shift(4,"i"),R:wt.read_shift(4,"i"),C:wt.read_shift(4,"i"),clsid:wt.read_shift(16),state:wt.read_shift(4,"i"),start:0,size:0},or=wt.read_shift(2)+wt.read_shift(2)+wt.read_shift(2)+wt.read_shift(2);or!==0&&(Lt.ct=B(wt,wt.l-8));var Mr=wt.read_shift(2)+wt.read_shift(2)+wt.read_shift(2)+wt.read_shift(2);Mr!==0&&(Lt.mt=B(wt,wt.l-8)),Lt.start=wt.read_shift(4,"i"),Lt.size=wt.read_shift(4,"i"),Lt.size<0&&Lt.start<0&&(Lt.size=Lt.type=0,Lt.start=G,Lt.name=""),Lt.type===5?($e=Lt.start,ge>0&&$e!==G&&(pe[$e].name="!StreamData")):Lt.size>=4096?(Lt.storage="fat",pe[Lt.start]===void 0&&(pe[Lt.start]=p(he,Lt.start,pe.fat_addrs,pe.ssz)),pe[Lt.start].name=Lt.name,Lt.content=pe[Lt.start].data.slice(0,Lt.size)):(Lt.storage="minifat",Lt.size<0?Lt.size=0:$e!==G&&Lt.start!==G&&pe[$e]&&(Lt.content=m(Lt,pe[$e].data,(pe[rt]||{}).data))),Lt.content&&$s(Lt.content,0),we[Ut]=Lt,ze.push(Lt)}}function B(se,pe){return new Date((xi(se,pe+4)/1e7*Math.pow(2,32)+xi(se,pe)/1e7-11644473600)*1e3)}function T(se,pe){return A(),d(c.readFileSync(se),pe)}function _(se,pe){var he=pe&&pe.type;switch(he||Cr&&Buffer.isBuffer(se)&&(he="buffer"),he||"base64"){case"file":return T(se,pe);case"base64":return d(gi(ki(se)),pe);case"binary":return d(gi(se),pe)}return d(se,pe)}function j(se,pe){var he=pe||{},me=he.root||"Root Entry";if(se.FullPaths||(se.FullPaths=[]),se.FileIndex||(se.FileIndex=[]),se.FullPaths.length!==se.FileIndex.length)throw new Error("inconsistent CFB structure");se.FullPaths.length===0&&(se.FullPaths[0]=me+"/",se.FileIndex[0]={name:me,type:5}),he.CLSID&&(se.FileIndex[0].clsid=he.CLSID),E(se)}function E(se){var pe="Sh33tJ5";if(!Jt.find(se,"/"+pe)){var he=ot(4);he[0]=55,he[1]=he[3]=50,he[2]=54,se.FileIndex.push({name:pe,type:2,content:he,size:4,L:69,R:69,C:69}),se.FullPaths.push(se.FullPaths[0]+pe),L(se)}}function L(se,pe){j(se);for(var he=!1,me=!1,ge=se.FullPaths.length-1;ge>=0;--ge){var we=se.FileIndex[ge];switch(we.type){case 0:me?he=!0:(se.FileIndex.pop(),se.FullPaths.pop());break;case 1:case 2:case 5:me=!0,isNaN(we.R*we.L*we.C)&&(he=!0),we.R>-1&&we.L>-1&&we.R==we.L&&(he=!0);break;default:he=!0;break}}if(!(!he&&!pe)){var ze=new Date(1987,1,19),rt=0,$e=Object.create?Object.create(null):{},Xe=[];for(ge=0;ge<se.FullPaths.length;++ge)$e[se.FullPaths[ge]]=!0,se.FileIndex[ge].type!==0&&Xe.push([se.FullPaths[ge],se.FileIndex[ge]]);for(ge=0;ge<Xe.length;++ge){var Je=n(Xe[ge][0]);me=$e[Je],me||(Xe.push([Je,{name:s(Je).replace("/",""),type:1,clsid:Z,ct:ze,mt:ze,content:null}]),$e[Je]=!0)}for(Xe.sort(function(Ut,wt){return r(Ut[0],wt[0])}),se.FullPaths=[],se.FileIndex=[],ge=0;ge<Xe.length;++ge)se.FullPaths[ge]=Xe[ge][0],se.FileIndex[ge]=Xe[ge][1];for(ge=0;ge<Xe.length;++ge){var gt=se.FileIndex[ge],Ct=se.FullPaths[ge];if(gt.name=s(Ct).replace("/",""),gt.L=gt.R=gt.C=-(gt.color=1),gt.size=gt.content?gt.content.length:0,gt.start=0,gt.clsid=gt.clsid||Z,ge===0)gt.C=Xe.length>1?1:-1,gt.size=0,gt.type=5;else if(Ct.slice(-1)=="/"){for(rt=ge+1;rt<Xe.length&&n(se.FullPaths[rt])!=Ct;++rt);for(gt.C=rt>=Xe.length?-1:rt,rt=ge+1;rt<Xe.length&&n(se.FullPaths[rt])!=n(Ct);++rt);gt.R=rt>=Xe.length?-1:rt,gt.type=1}else n(se.FullPaths[ge+1]||"")==n(Ct)&&(gt.R=ge+1),gt.type=2}}}function M(se,pe){var he=pe||{};if(he.fileType=="mad")return Re(se,he);switch(L(se),he.fileType){case"zip":return un(se,he)}var me=function(Ut){for(var wt=0,Lt=0,or=0;or<Ut.FileIndex.length;++or){var Mr=Ut.FileIndex[or];if(Mr.content){var Wr=Mr.content.length;Wr>0&&(Wr<4096?wt+=Wr+63>>6:Lt+=Wr+511>>9)}}for(var Qn=Ut.FullPaths.length+3>>2,li=wt+7>>3,bo=wt+127>>7,Pi=li+Lt+Qn+bo,Pa=Pi+127>>7,Oi=Pa<=109?0:Math.ceil((Pa-109)/127);Pi+Pa+Oi+127>>7>Pa;)Oi=++Pa<=109?0:Math.ceil((Pa-109)/127);var Ke=[1,Oi,Pa,bo,Qn,Lt,wt,0];return Ut.FileIndex[0].size=wt<<6,Ke[7]=(Ut.FileIndex[0].start=Ke[0]+Ke[1]+Ke[2]+Ke[3]+Ke[4]+Ke[5])+(Ke[6]+7>>3),Ke}(se),ge=ot(me[7]<<9),we=0,ze=0;{for(we=0;we<8;++we)ge.write_shift(1,ae[we]);for(we=0;we<8;++we)ge.write_shift(2,0);for(ge.write_shift(2,62),ge.write_shift(2,3),ge.write_shift(2,65534),ge.write_shift(2,9),ge.write_shift(2,6),we=0;we<3;++we)ge.write_shift(2,0);for(ge.write_shift(4,0),ge.write_shift(4,me[2]),ge.write_shift(4,me[0]+me[1]+me[2]+me[3]-1),ge.write_shift(4,0),ge.write_shift(4,4096),ge.write_shift(4,me[3]?me[0]+me[1]+me[2]-1:G),ge.write_shift(4,me[3]),ge.write_shift(-4,me[1]?me[0]-1:G),ge.write_shift(4,me[1]),we=0;we<109;++we)ge.write_shift(-4,we<me[2]?me[1]+we:-1)}if(me[1])for(ze=0;ze<me[1];++ze){for(;we<236+ze*127;++we)ge.write_shift(-4,we<me[2]?me[1]+we:-1);ge.write_shift(-4,ze===me[1]-1?G:ze+1)}var rt=function(Ut){for(ze+=Ut;we<ze-1;++we)ge.write_shift(-4,we+1);Ut&&(++we,ge.write_shift(-4,G))};for(ze=we=0,ze+=me[1];we<ze;++we)ge.write_shift(-4,oe.DIFSECT);for(ze+=me[2];we<ze;++we)ge.write_shift(-4,oe.FATSECT);rt(me[3]),rt(me[4]);for(var $e=0,Xe=0,Je=se.FileIndex[0];$e<se.FileIndex.length;++$e)Je=se.FileIndex[$e],Je.content&&(Xe=Je.content.length,!(Xe<4096)&&(Je.start=ze,rt(Xe+511>>9)));for(rt(me[6]+7>>3);ge.l&511;)ge.write_shift(-4,oe.ENDOFCHAIN);for(ze=we=0,$e=0;$e<se.FileIndex.length;++$e)Je=se.FileIndex[$e],Je.content&&(Xe=Je.content.length,!(!Xe||Xe>=4096)&&(Je.start=ze,rt(Xe+63>>6)));for(;ge.l&511;)ge.write_shift(-4,oe.ENDOFCHAIN);for(we=0;we<me[4]<<2;++we){var gt=se.FullPaths[we];if(!gt||gt.length===0){for($e=0;$e<17;++$e)ge.write_shift(4,0);for($e=0;$e<3;++$e)ge.write_shift(4,-1);for($e=0;$e<12;++$e)ge.write_shift(4,0);continue}Je=se.FileIndex[we],we===0&&(Je.start=Je.size?Je.start-1:G);var Ct=we===0&&he.root||Je.name;if(Xe=2*(Ct.length+1),ge.write_shift(64,Ct,"utf16le"),ge.write_shift(2,Xe),ge.write_shift(1,Je.type),ge.write_shift(1,Je.color),ge.write_shift(-4,Je.L),ge.write_shift(-4,Je.R),ge.write_shift(-4,Je.C),Je.clsid)ge.write_shift(16,Je.clsid,"hex");else for($e=0;$e<4;++$e)ge.write_shift(4,0);ge.write_shift(4,Je.state||0),ge.write_shift(4,0),ge.write_shift(4,0),ge.write_shift(4,0),ge.write_shift(4,0),ge.write_shift(4,Je.start),ge.write_shift(4,Je.size),ge.write_shift(4,0)}for(we=1;we<se.FileIndex.length;++we)if(Je=se.FileIndex[we],Je.size>=4096)if(ge.l=Je.start+1<<9,Cr&&Buffer.isBuffer(Je.content))Je.content.copy(ge,ge.l,0,Je.size),ge.l+=Je.size+511&-512;else{for($e=0;$e<Je.size;++$e)ge.write_shift(1,Je.content[$e]);for(;$e&511;++$e)ge.write_shift(1,0)}for(we=1;we<se.FileIndex.length;++we)if(Je=se.FileIndex[we],Je.size>0&&Je.size<4096)if(Cr&&Buffer.isBuffer(Je.content))Je.content.copy(ge,ge.l,0,Je.size),ge.l+=Je.size+63&-64;else{for($e=0;$e<Je.size;++$e)ge.write_shift(1,Je.content[$e]);for(;$e&63;++$e)ge.write_shift(1,0)}if(Cr)ge.l=ge.length;else for(;ge.l<ge.length;)ge.write_shift(1,0);return ge}function F(se,pe){var he=se.FullPaths.map(function($e){return $e.toUpperCase()}),me=he.map(function($e){var Xe=$e.split("/");return Xe[Xe.length-($e.slice(-1)=="/"?2:1)]}),ge=!1;pe.charCodeAt(0)===47?(ge=!0,pe=he[0].slice(0,-1)+pe):ge=pe.indexOf("/")!==-1;var we=pe.toUpperCase(),ze=ge===!0?he.indexOf(we):me.indexOf(we);if(ze!==-1)return se.FileIndex[ze];var rt=!we.match(uh);for(we=we.replace(La,""),rt&&(we=we.replace(uh,"!")),ze=0;ze<he.length;++ze)if((rt?he[ze].replace(uh,"!"):he[ze]).replace(La,"")==we||(rt?me[ze].replace(uh,"!"):me[ze]).replace(La,"")==we)return se.FileIndex[ze];return null}var D=64,G=-2,K="d0cf11e0a1b11ae1",ae=[208,207,17,224,161,177,26,225],Z="00000000000000000000000000000000",oe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:G,FREESECT:-1,HEADER_SIGNATURE:K,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Y(se,pe,he){A();var me=M(se,he);c.writeFileSync(pe,me)}function R(se){for(var pe=new Array(se.length),he=0;he<se.length;++he)pe[he]=String.fromCharCode(se[he]);return pe.join("")}function z(se,pe){var he=M(se,pe);switch(pe&&pe.type||"buffer"){case"file":return A(),c.writeFileSync(pe.filename,he),he;case"binary":return typeof he=="string"?he:R(he);case"base64":return pm(typeof he=="string"?he:R(he));case"buffer":if(Cr)return Buffer.isBuffer(he)?he:mc(he);case"array":return typeof he=="string"?gi(he):he}return he}var ee;function b(se){try{var pe=se.InflateRaw,he=new pe;if(he._processChunk(new Uint8Array([3,0]),he._finishFlushFlag),he.bytesRead)ee=se;else throw new Error("zlib does not expose bytesRead")}catch(me){console.error("cannot use native zlib: "+(me.message||me))}}function O(se,pe){if(!ee)return $t(se,pe);var he=ee.InflateRaw,me=new he,ge=me._processChunk(se.slice(se.l),me._finishFlushFlag);return se.l+=me.bytesRead,ge}function S(se){return ee?ee.deflateRawSync(se):Be(se)}var I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],U=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Q=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function H(se){var pe=(se<<1|se<<11)&139536|(se<<5|se<<15)&558144;return(pe>>16|pe>>8|pe)&255}for(var X=typeof Uint8Array<"u",V=X?new Uint8Array(256):[],Ae=0;Ae<256;++Ae)V[Ae]=H(Ae);function W(se,pe){var he=V[se&255];return pe<=8?he>>>8-pe:(he=he<<8|V[se>>8&255],pe<=16?he>>>16-pe:(he=he<<8|V[se>>16&255],he>>>24-pe))}function J(se,pe){var he=pe&7,me=pe>>>3;return(se[me]|(he<=6?0:se[me+1]<<8))>>>he&3}function ve(se,pe){var he=pe&7,me=pe>>>3;return(se[me]|(he<=5?0:se[me+1]<<8))>>>he&7}function de(se,pe){var he=pe&7,me=pe>>>3;return(se[me]|(he<=4?0:se[me+1]<<8))>>>he&15}function te(se,pe){var he=pe&7,me=pe>>>3;return(se[me]|(he<=3?0:se[me+1]<<8))>>>he&31}function je(se,pe){var he=pe&7,me=pe>>>3;return(se[me]|(he<=1?0:se[me+1]<<8))>>>he&127}function qe(se,pe,he){var me=pe&7,ge=pe>>>3,we=(1<<he)-1,ze=se[ge]>>>me;return he<8-me||(ze|=se[ge+1]<<8-me,he<16-me)||(ze|=se[ge+2]<<16-me,he<24-me)||(ze|=se[ge+3]<<24-me),ze&we}function He(se,pe,he){var me=pe&7,ge=pe>>>3;return me<=5?se[ge]|=(he&7)<<me:(se[ge]|=he<<me&255,se[ge+1]=(he&7)>>8-me),pe+3}function Ze(se,pe,he){var me=pe&7,ge=pe>>>3;return he=(he&1)<<me,se[ge]|=he,pe+1}function xe(se,pe,he){var me=pe&7,ge=pe>>>3;return he<<=me,se[ge]|=he&255,he>>>=8,se[ge+1]=he,pe+8}function ue(se,pe,he){var me=pe&7,ge=pe>>>3;return he<<=me,se[ge]|=he&255,he>>>=8,se[ge+1]=he&255,se[ge+2]=he>>>8,pe+16}function Fe(se,pe){var he=se.length,me=2*he>pe?2*he:pe+5,ge=0;if(he>=pe)return se;if(Cr){var we=wS(me);if(se.copy)se.copy(we);else for(;ge<se.length;++ge)we[ge]=se[ge];return we}else if(X){var ze=new Uint8Array(me);if(ze.set)ze.set(se);else for(;ge<he;++ge)ze[ge]=se[ge];return ze}return se.length=me,se}function ke(se){for(var pe=new Array(se),he=0;he<se;++he)pe[he]=0;return pe}function Te(se,pe,he){var me=1,ge=0,we=0,ze=0,rt=0,$e=se.length,Xe=X?new Uint16Array(32):ke(32);for(we=0;we<32;++we)Xe[we]=0;for(we=$e;we<he;++we)se[we]=0;$e=se.length;var Je=X?new Uint16Array($e):ke($e);for(we=0;we<$e;++we)Xe[ge=se[we]]++,me<ge&&(me=ge),Je[we]=0;for(Xe[0]=0,we=1;we<=me;++we)Xe[we+16]=rt=rt+Xe[we-1]<<1;for(we=0;we<$e;++we)rt=se[we],rt!=0&&(Je[we]=Xe[rt+16]++);var gt=0;for(we=0;we<$e;++we)if(gt=se[we],gt!=0)for(rt=W(Je[we],me)>>me-gt,ze=(1<<me+4-gt)-1;ze>=0;--ze)pe[rt|ze<<gt]=gt&15|we<<4;return me}var Ne=X?new Uint16Array(512):ke(512),et=X?new Uint16Array(32):ke(32);if(!X){for(var Se=0;Se<512;++Se)Ne[Se]=0;for(Se=0;Se<32;++Se)et[Se]=0}(function(){for(var se=[],pe=0;pe<32;pe++)se.push(5);Te(se,et,32);var he=[];for(pe=0;pe<=143;pe++)he.push(8);for(;pe<=255;pe++)he.push(9);for(;pe<=279;pe++)he.push(7);for(;pe<=287;pe++)he.push(8);Te(he,Ne,288)})();var Ce=function(){for(var pe=X?new Uint8Array(32768):[],he=0,me=0;he<Q.length-1;++he)for(;me<Q[he+1];++me)pe[me]=he;for(;me<32768;++me)pe[me]=29;var ge=X?new Uint8Array(259):[];for(he=0,me=0;he<U.length-1;++he)for(;me<U[he+1];++me)ge[me]=he;function we(rt,$e){for(var Xe=0;Xe<rt.length;){var Je=Math.min(65535,rt.length-Xe),gt=Xe+Je==rt.length;for($e.write_shift(1,+gt),$e.write_shift(2,Je),$e.write_shift(2,~Je&65535);Je-- >0;)$e[$e.l++]=rt[Xe++]}return $e.l}function ze(rt,$e){for(var Xe=0,Je=0,gt=X?new Uint16Array(32768):[];Je<rt.length;){var Ct=Math.min(65535,rt.length-Je);if(Ct<10){for(Xe=He($e,Xe,+(Je+Ct==rt.length)),Xe&7&&(Xe+=8-(Xe&7)),$e.l=Xe/8|0,$e.write_shift(2,Ct),$e.write_shift(2,~Ct&65535);Ct-- >0;)$e[$e.l++]=rt[Je++];Xe=$e.l*8;continue}Xe=He($e,Xe,+(Je+Ct==rt.length)+2);for(var Ut=0;Ct-- >0;){var wt=rt[Je];Ut=(Ut<<5^wt)&32767;var Lt=-1,or=0;if((Lt=gt[Ut])&&(Lt|=Je&-32768,Lt>Je&&(Lt-=32768),Lt<Je))for(;rt[Lt+or]==rt[Je+or]&&or<250;)++or;if(or>2){wt=ge[or],wt<=22?Xe=xe($e,Xe,V[wt+1]>>1)-1:(xe($e,Xe,3),Xe+=5,xe($e,Xe,V[wt-23]>>5),Xe+=3);var Mr=wt<8?0:wt-4>>2;Mr>0&&(ue($e,Xe,or-U[wt]),Xe+=Mr),wt=pe[Je-Lt],Xe=xe($e,Xe,V[wt]>>3),Xe-=3;var Wr=wt<4?0:wt-2>>1;Wr>0&&(ue($e,Xe,Je-Lt-Q[wt]),Xe+=Wr);for(var Qn=0;Qn<or;++Qn)gt[Ut]=Je&32767,Ut=(Ut<<5^rt[Je])&32767,++Je;Ct-=or-1}else wt<=143?wt=wt+48:Xe=Ze($e,Xe,1),Xe=xe($e,Xe,V[wt]),gt[Ut]=Je&32767,++Je}Xe=xe($e,Xe,0)-1}return $e.l=(Xe+7)/8|0,$e.l}return function($e,Xe){return $e.length<8?we($e,Xe):ze($e,Xe)}}();function Be(se){var pe=ot(50+Math.floor(se.length*1.1)),he=Ce(se,pe);return pe.slice(0,he)}var Pe=X?new Uint16Array(32768):ke(32768),Bt=X?new Uint16Array(32768):ke(32768),tt=X?new Uint16Array(128):ke(128),Ot=1,vt=1;function Vt(se,pe){var he=te(se,pe)+257;pe+=5;var me=te(se,pe)+1;pe+=5;var ge=de(se,pe)+4;pe+=4;for(var we=0,ze=X?new Uint8Array(19):ke(19),rt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],$e=1,Xe=X?new Uint8Array(8):ke(8),Je=X?new Uint8Array(8):ke(8),gt=ze.length,Ct=0;Ct<ge;++Ct)ze[I[Ct]]=we=ve(se,pe),$e<we&&($e=we),Xe[we]++,pe+=3;var Ut=0;for(Xe[0]=0,Ct=1;Ct<=$e;++Ct)Je[Ct]=Ut=Ut+Xe[Ct-1]<<1;for(Ct=0;Ct<gt;++Ct)(Ut=ze[Ct])!=0&&(rt[Ct]=Je[Ut]++);var wt=0;for(Ct=0;Ct<gt;++Ct)if(wt=ze[Ct],wt!=0){Ut=V[rt[Ct]]>>8-wt;for(var Lt=(1<<7-wt)-1;Lt>=0;--Lt)tt[Ut|Lt<<wt]=wt&7|Ct<<3}var or=[];for($e=1;or.length<he+me;)switch(Ut=tt[je(se,pe)],pe+=Ut&7,Ut>>>=3){case 16:for(we=3+J(se,pe),pe+=2,Ut=or[or.length-1];we-- >0;)or.push(Ut);break;case 17:for(we=3+ve(se,pe),pe+=3;we-- >0;)or.push(0);break;case 18:for(we=11+je(se,pe),pe+=7;we-- >0;)or.push(0);break;default:or.push(Ut),$e<Ut&&($e=Ut);break}var Mr=or.slice(0,he),Wr=or.slice(he);for(Ct=he;Ct<286;++Ct)Mr[Ct]=0;for(Ct=me;Ct<30;++Ct)Wr[Ct]=0;return Ot=Te(Mr,Pe,286),vt=Te(Wr,Bt,30),pe}function pr(se,pe){if(se[0]==3&&!(se[1]&3))return[gA(pe),2];for(var he=0,me=0,ge=wS(pe||1<<18),we=0,ze=ge.length>>>0,rt=0,$e=0;!(me&1);){if(me=ve(se,he),he+=3,me>>>1)me>>1==1?(rt=9,$e=5):(he=Vt(se,he),rt=Ot,$e=vt);else{he&7&&(he+=8-(he&7));var Xe=se[he>>>3]|se[(he>>>3)+1]<<8;if(he+=32,Xe>0)for(!pe&&ze<we+Xe&&(ge=Fe(ge,we+Xe),ze=ge.length);Xe-- >0;)ge[we++]=se[he>>>3],he+=8;continue}for(;;){!pe&&ze<we+32767&&(ge=Fe(ge,we+32767),ze=ge.length);var Je=qe(se,he,rt),gt=me>>>1==1?Ne[Je]:Pe[Je];if(he+=gt&15,gt>>>=4,!(gt>>>8&255))ge[we++]=gt;else{if(gt==256)break;gt-=257;var Ct=gt<8?0:gt-4>>2;Ct>5&&(Ct=0);var Ut=we+U[gt];Ct>0&&(Ut+=qe(se,he,Ct),he+=Ct),Je=qe(se,he,$e),gt=me>>>1==1?et[Je]:Bt[Je],he+=gt&15,gt>>>=4;var wt=gt<4?0:gt-2>>1,Lt=Q[gt];for(wt>0&&(Lt+=qe(se,he,wt),he+=wt),!pe&&ze<Ut&&(ge=Fe(ge,Ut+100),ze=ge.length);we<Ut;)ge[we]=ge[we-Lt],++we}}}return pe?[ge,he+7>>>3]:[ge.slice(0,we),he+7>>>3]}function $t(se,pe){var he=se.slice(se.l||0),me=pr(he,pe);return se.l+=me[1],me[0]}function Qr(se,pe){if(se)typeof console<"u"&&console.error(pe);else throw new Error(pe)}function ir(se,pe){var he=se;$s(he,0);var me=[],ge=[],we={FileIndex:me,FullPaths:ge};j(we,{root:pe.root});for(var ze=he.length-4;(he[ze]!=80||he[ze+1]!=75||he[ze+2]!=5||he[ze+3]!=6)&&ze>=0;)--ze;he.l=ze+4,he.l+=4;var rt=he.read_shift(2);he.l+=6;var $e=he.read_shift(4);for(he.l=$e,ze=0;ze<rt;++ze){he.l+=20;var Xe=he.read_shift(4),Je=he.read_shift(4),gt=he.read_shift(2),Ct=he.read_shift(2),Ut=he.read_shift(2);he.l+=8;var wt=he.read_shift(4),Lt=l(he.slice(he.l+gt,he.l+gt+Ct));he.l+=gt+Ct+Ut;var or=he.l;he.l=wt+4,Gr(he,Xe,Je,we,Lt),he.l=or}return we}function Gr(se,pe,he,me,ge){se.l+=2;var we=se.read_shift(2),ze=se.read_shift(2),rt=o(se);if(we&8257)throw new Error("Unsupported ZIP encryption");for(var $e=se.read_shift(4),Xe=se.read_shift(4),Je=se.read_shift(4),gt=se.read_shift(2),Ct=se.read_shift(2),Ut="",wt=0;wt<gt;++wt)Ut+=String.fromCharCode(se[se.l++]);if(Ct){var Lt=l(se.slice(se.l,se.l+Ct));(Lt[21589]||{}).mt&&(rt=Lt[21589].mt),((ge||{})[21589]||{}).mt&&(rt=ge[21589].mt)}se.l+=Ct;var or=se.slice(se.l,se.l+Xe);switch(ze){case 8:or=O(se,Je);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ze)}var Mr=!1;we&8&&($e=se.read_shift(4),$e==134695760&&($e=se.read_shift(4),Mr=!0),Xe=se.read_shift(4),Je=se.read_shift(4)),Xe!=pe&&Qr(Mr,"Bad compressed size: "+pe+" != "+Xe),Je!=he&&Qr(Mr,"Bad uncompressed size: "+he+" != "+Je),ft(me,Ut,or,{unsafe:!0,mt:rt})}function un(se,pe){var he=pe||{},me=[],ge=[],we=ot(1),ze=he.compression?8:0,rt=0,$e=0,Xe=0,Je=0,gt=0,Ct=se.FullPaths[0],Ut=Ct,wt=se.FileIndex[0],Lt=[],or=0;for($e=1;$e<se.FullPaths.length;++$e)if(Ut=se.FullPaths[$e].slice(Ct.length),wt=se.FileIndex[$e],!(!wt.size||!wt.content||Ut=="Sh33tJ5")){var Mr=Je,Wr=ot(Ut.length);for(Xe=0;Xe<Ut.length;++Xe)Wr.write_shift(1,Ut.charCodeAt(Xe)&127);Wr=Wr.slice(0,Wr.l),Lt[gt]=Yz.buf(wt.content,0);var Qn=wt.content;ze==8&&(Qn=S(Qn)),we=ot(30),we.write_shift(4,67324752),we.write_shift(2,20),we.write_shift(2,rt),we.write_shift(2,ze),wt.mt?i(we,wt.mt):we.write_shift(4,0),we.write_shift(-4,Lt[gt]),we.write_shift(4,Qn.length),we.write_shift(4,wt.content.length),we.write_shift(2,Wr.length),we.write_shift(2,0),Je+=we.length,me.push(we),Je+=Wr.length,me.push(Wr),Je+=Qn.length,me.push(Qn),we=ot(46),we.write_shift(4,33639248),we.write_shift(2,0),we.write_shift(2,20),we.write_shift(2,rt),we.write_shift(2,ze),we.write_shift(4,0),we.write_shift(-4,Lt[gt]),we.write_shift(4,Qn.length),we.write_shift(4,wt.content.length),we.write_shift(2,Wr.length),we.write_shift(2,0),we.write_shift(2,0),we.write_shift(2,0),we.write_shift(2,0),we.write_shift(4,0),we.write_shift(4,Mr),or+=we.l,ge.push(we),or+=Wr.length,ge.push(Wr),++gt}return we=ot(22),we.write_shift(4,101010256),we.write_shift(2,0),we.write_shift(2,0),we.write_shift(2,gt),we.write_shift(2,gt),we.write_shift(4,or),we.write_shift(4,Je),we.write_shift(2,0),_s([_s(me),_s(ge),we])}var Nr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Wt(se,pe){if(se.ctype)return se.ctype;var he=se.name||"",me=he.match(/\.([^\.]+)$/);return me&&Nr[me[1]]||pe&&(me=(he=pe).match(/[\.\\]([^\.\\])+$/),me&&Nr[me[1]])?Nr[me[1]]:"application/octet-stream"}function lt(se){for(var pe=pm(se),he=[],me=0;me<pe.length;me+=76)he.push(pe.slice(me,me+76));return he.join(`\r
`)+`\r
`}function Et(se){var pe=se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Xe){var Je=Xe.charCodeAt(0).toString(16).toUpperCase();return"="+(Je.length==1?"0"+Je:Je)});pe=pe.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),pe.charAt(0)==`
`&&(pe="=0D"+pe.slice(1)),pe=pe.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var he=[],me=pe.split(`\r
`),ge=0;ge<me.length;++ge){var we=me[ge];if(we.length==0){he.push("");continue}for(var ze=0;ze<we.length;){var rt=76,$e=we.slice(ze,ze+rt);$e.charAt(rt-1)=="="?rt--:$e.charAt(rt-2)=="="?rt-=2:$e.charAt(rt-3)=="="&&(rt-=3),$e=we.slice(ze,ze+rt),ze+=rt,ze<we.length&&($e+="="),he.push($e)}}return he.join(`\r
`)}function It(se){for(var pe=[],he=0;he<se.length;++he){for(var me=se[he];he<=se.length&&me.charAt(me.length-1)=="=";)me=me.slice(0,me.length-1)+se[++he];pe.push(me)}for(var ge=0;ge<pe.length;++ge)pe[ge]=pe[ge].replace(/[=][0-9A-Fa-f]{2}/g,function(we){return String.fromCharCode(parseInt(we.slice(1),16))});return gi(pe.join(`\r
`))}function Ee(se,pe,he){for(var me="",ge="",we="",ze,rt=0;rt<10;++rt){var $e=pe[rt];if(!$e||$e.match(/^\s*$/))break;var Xe=$e.match(/^(.*?):\s*([^\s].*)$/);if(Xe)switch(Xe[1].toLowerCase()){case"content-location":me=Xe[2].trim();break;case"content-type":we=Xe[2].trim();break;case"content-transfer-encoding":ge=Xe[2].trim();break}}switch(++rt,ge.toLowerCase()){case"base64":ze=gi(ki(pe.slice(rt).join("")));break;case"quoted-printable":ze=It(pe.slice(rt));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ge)}var Je=ft(se,me.slice(he.length),ze,{unsafe:!0});we&&(Je.ctype=we)}function Oe(se,pe){if(R(se.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var he=pe&&pe.root||"",me=(Cr&&Buffer.isBuffer(se)?se.toString("binary"):R(se)).split(`\r
`),ge=0,we="";for(ge=0;ge<me.length;++ge)if(we=me[ge],!!/^Content-Location:/i.test(we)&&(we=we.slice(we.indexOf("file")),he||(he=we.slice(0,we.lastIndexOf("/")+1)),we.slice(0,he.length)!=he))for(;he.length>0&&(he=he.slice(0,he.length-1),he=he.slice(0,he.lastIndexOf("/")+1),we.slice(0,he.length)!=he););var ze=(me[1]||"").match(/boundary="(.*?)"/);if(!ze)throw new Error("MAD cannot find boundary");var rt="--"+(ze[1]||""),$e=[],Xe=[],Je={FileIndex:$e,FullPaths:Xe};j(Je);var gt,Ct=0;for(ge=0;ge<me.length;++ge){var Ut=me[ge];Ut!==rt&&Ut!==rt+"--"||(Ct++&&Ee(Je,me.slice(gt,ge),he),gt=ge)}return Je}function Re(se,pe){var he=pe||{},me=he.boundary||"SheetJS";me="------="+me;for(var ge=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+me.slice(2)+'"',"","",""],we=se.FullPaths[0],ze=we,rt=se.FileIndex[0],$e=1;$e<se.FullPaths.length;++$e)if(ze=se.FullPaths[$e].slice(we.length),rt=se.FileIndex[$e],!(!rt.size||!rt.content||ze=="Sh33tJ5")){ze=ze.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(or){return"_x"+or.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(or){return"_u"+or.charCodeAt(0).toString(16)+"_"});for(var Xe=rt.content,Je=Cr&&Buffer.isBuffer(Xe)?Xe.toString("binary"):R(Xe),gt=0,Ct=Math.min(1024,Je.length),Ut=0,wt=0;wt<=Ct;++wt)(Ut=Je.charCodeAt(wt))>=32&&Ut<128&&++gt;var Lt=gt>=Ct*4/5;ge.push(me),ge.push("Content-Location: "+(he.root||"file:///C:/SheetJS/")+ze),ge.push("Content-Transfer-Encoding: "+(Lt?"quoted-printable":"base64")),ge.push("Content-Type: "+Wt(rt,ze)),ge.push(""),ge.push(Lt?Et(Je):lt(Je))}return ge.push(me+`--\r
`),ge.join(`\r
`)}function Ye(se){var pe={};return j(pe,se),pe}function ft(se,pe,he,me){var ge=me&&me.unsafe;ge||j(se);var we=!ge&&Jt.find(se,pe);if(!we){var ze=se.FullPaths[0];pe.slice(0,ze.length)==ze?ze=pe:(ze.slice(-1)!="/"&&(ze+="/"),ze=(ze+pe).replace("//","/")),we={name:s(pe),type:2},se.FileIndex.push(we),se.FullPaths.push(ze),ge||Jt.utils.cfb_gc(se)}return we.content=he,we.size=he?he.length:0,me&&(me.CLSID&&(we.clsid=me.CLSID),me.mt&&(we.mt=me.mt),me.ct&&(we.ct=me.ct)),we}function mt(se,pe){j(se);var he=Jt.find(se,pe);if(he){for(var me=0;me<se.FileIndex.length;++me)if(se.FileIndex[me]==he)return se.FileIndex.splice(me,1),se.FullPaths.splice(me,1),!0}return!1}function qt(se,pe,he){j(se);var me=Jt.find(se,pe);if(me){for(var ge=0;ge<se.FileIndex.length;++ge)if(se.FileIndex[ge]==me)return se.FileIndex[ge].name=s(he),se.FullPaths[ge]=he,!0}return!1}function Nt(se){L(se,!0)}return t.find=F,t.read=_,t.parse=d,t.write=z,t.writeFile=Y,t.utils={cfb_new:Ye,cfb_add:ft,cfb_del:mt,cfb_mov:qt,cfb_gc:Nt,ReadShift:Ih,CheckField:Q8,prep_blob:$s,bconcat:_s,use_zlib:b,_deflateRaw:Be,_inflateRaw:$t,consts:oe},t}();function Jz(e){return typeof e=="string"?cv(e):Array.isArray(e)?Cz(e):e}function rp(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=cv(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?hl(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([Jz(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=EA(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function Zz(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Gn(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function ES(e,t){for(var r=[],n=Gn(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function dv(e){for(var t=[],r=Gn(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function uv(e){for(var t=[],r=Gn(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function eG(e){for(var t=[],r=Gn(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Q1=new Date(1899,11,30,0,0,0);function Ns(e,t){var r=e.getTime(),n=Q1.getTime()+(e.getTimezoneOffset()-Q1.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var y8=new Date,tG=Q1.getTime()+(y8.getTimezoneOffset()-Q1.getTimezoneOffset())*6e4,kS=y8.getTimezoneOffset();function fv(e){var t=new Date;return t.setTime(e*24*60*60*1e3+tG),t.getTimezoneOffset()!==kS&&t.setTime(t.getTime()+(t.getTimezoneOffset()-kS)*6e4),t}function rG(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(n=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[i],10)}return t}var TS=new Date("2017-02-19T19:06:09.000Z"),v8=isNaN(TS.getFullYear())?new Date("2/19/17"):TS,nG=v8.getFullYear()==2017;function Bn(e,t){var r=new Date(e);if(nG)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(v8.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function kd(e,t){if(Cr&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return hl(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return hl(o8(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return hl(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return hl(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Sn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Sn(e[r]));return t}function qn(e,t){for(var r="";r.length<t;)r+=e;return r}function Ho(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var sG=["january","february","march","april","may","june","july","august","september","october","november","december"];function Uf(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&sG.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var aG=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),o=[i[0]],l=1;l<i.length;++l)o.push(s),o.push(i[l]);return o}}();function w8(e){return e?e.content&&e.type?kd(e.content,!0):e.data?dh(e.data):e.asNodeBuffer&&Cr?dh(e.asNodeBuffer().toString("binary")):e.asBinary?dh(e.asBinary()):e._data&&e._data.getContent?dh(kd(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function b8(e){if(!e)return null;if(e.data)return yS(e.data);if(e.asNodeBuffer&&Cr)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?yS(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function iG(e){return e&&e.name.slice(-4)===".bin"?b8(e):w8(e)}function Ji(e,t){for(var r=e.FullPaths||Gn(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||s==o)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function pC(e,t){var r=Ji(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function fs(e,t,r){if(!r)return iG(pC(e,t));if(!t)return null;try{return fs(e,t)}catch{return null}}function yi(e,t,r){if(!r)return w8(pC(e,t));if(!t)return null;try{return yi(e,t)}catch{return null}}function oG(e,t,r){return b8(pC(e,t))}function _S(e){for(var t=e.FullPaths||Gn(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function br(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Cr?n=mc(r):n=jz(r),Jt.utils.cfb_add(e,t,n)}Jt.utils.cfb_add(e,t,r)}else e.file(t,r)}function xC(){return Jt.utils.cfb_new()}function N8(e,t){switch(t.type){case"base64":return Jt.read(e,{type:"base64"});case"binary":return Jt.read(e,{type:"binary"});case"buffer":case"array":return Jt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function fh(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var os=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,lG=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,IS=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,cG=/<[^>]*>/g,ba=os.match(IS)?IS:cG,AG=/<\w*:/,dG=/<(\/?)\w+:/;function dr(e,t,r){for(var n={},s=0,i=0;s!==e.length&&!((i=e.charCodeAt(s))===32||i===10||i===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var o=e.match(lG),l=0,c="",A=0,d="",u="",f=1;if(o)for(A=0;A!=o.length;++A){for(u=o[A],i=0;i!=u.length&&u.charCodeAt(i)!==61;++i);for(d=u.slice(0,i).trim();u.charCodeAt(i+1)==32;)++i;for(f=(s=u.charCodeAt(i+1))==34||s==39?1:0,c=u.slice(i+1+f,u.length-f),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,n[d.toLowerCase()]=c;else{var h=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(n[h]&&d.slice(l-3,l)=="ext")continue;n[h]=c,n[h.toLowerCase()]=c}}return n}function Nl(e){return e.replace(dG,"<$1")}var C8={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},gC=dv(C8),Or=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(e,function(l,c){return C8[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,o)+r(s.slice(o+3))}}(),yC=/[&<>'"]/g,uG=/[\u0000-\u0008\u000b-\u001f]/g;function nn(e){var t=e+"";return t.replace(yC,function(r){return gC[r]}).replace(uG,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function LS(e){return nn(e).replace(/ /g,"_x0020_")}var j8=/[\u0000-\u001f]/g;function vC(e){var t=e+"";return t.replace(yC,function(r){return gC[r]}).replace(/\n/g,"<br/>").replace(j8,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function fG(e){var t=e+"";return t.replace(yC,function(r){return gC[r]}).replace(j8,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var US=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function hG(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Nn(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function yw(e){for(var t="",r=0,n=0,s=0,i=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=s&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(s&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function DS(e){var t=gA(2*e.length),r,n,s=1,i=0,o=0,l;for(n=0;n<e.length;n+=s)s=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),s=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function PS(e){return mc(e,"binary").toString("utf8")}var Ex="foo bar baz",cn=Cr&&(PS(Ex)==yw(Ex)&&PS||DS(Ex)==yw(Ex)&&DS)||yw,hl=Cr?function(e){return mc(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},gm=function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),B8=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),mG=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),pG=/<\/?(?:vt:)?variant>/g,xG=/<(?:vt:)([^>]*)>([\s\S]*)</;function OS(e,t){var r=dr(e),n=e.match(mG(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(i){var o=i.replace(pG,"").match(xG);o&&s.push({v:cn(o[2]),t:o[1]})}),s}var S8=/(^\s|\s$|\n)/;function Ks(e,t){return"<"+e+(t.match(S8)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function ym(e){return Gn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ft(e,t,r){return"<"+e+(r!=null?ym(r):"")+(t!=null?(t.match(S8)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function _N(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function gG(e,t){switch(typeof e){case"string":var r=Ft("vt:lpwstr",nn(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ft((e|0)==e?"vt:i4":"vt:r8",nn(String(e)));case"boolean":return Ft("vt:bool",e?"true":"false")}if(e instanceof Date)return Ft("vt:filetime",_N(e));throw new Error("Unable to serialize "+e)}function wC(e){if(Cr&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return cn(EA(fC(e)));throw new Error("Bad input format: expected Buffer or string")}var vm=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,ws={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Hd=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],pi={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function yG(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,i=5;i>=0;--i)s=s*256+e[t+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function vG(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,i=0,o=n?-t:t;isFinite(o)?o==0?s=i=0:(s=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(s&15)<<4|i&15,e[r+7]=s>>4|n}var RS=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,i=e[0][n].length;s<i;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},QS=Cr?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:mc(t)})):RS(e)}:RS,MS=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(Xl(e,s)));return n.join("").replace(La,"")},bC=Cr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(La,""):MS(e,t,r)}:MS,HS=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},F8=Cr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):HS(e,t,r)}:HS,VS=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Ou(e,s)));return n.join("")},np=Cr?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):VS(t,r,n)}:VS,E8=function(e,t){var r=xi(e,t);return r>0?np(e,t+4,t+4+r-1):""},k8=E8,T8=function(e,t){var r=xi(e,t);return r>0?np(e,t+4,t+4+r-1):""},_8=T8,I8=function(e,t){var r=2*xi(e,t);return r>0?np(e,t+4,t+4+r-1):""},L8=I8,U8=function(t,r){var n=xi(t,r);return n>0?bC(t,r+4,r+4+n):""},D8=U8,P8=function(e,t){var r=xi(e,t);return r>0?np(e,t+4,t+4+r):""},O8=P8,R8=function(e,t){return yG(e,t)},M1=R8,NC=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Cr&&(k8=function(t,r){if(!Buffer.isBuffer(t))return E8(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},_8=function(t,r){if(!Buffer.isBuffer(t))return T8(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},L8=function(t,r){if(!Buffer.isBuffer(t))return I8(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},D8=function(t,r){if(!Buffer.isBuffer(t))return U8(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},O8=function(t,r){if(!Buffer.isBuffer(t))return P8(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},M1=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):R8(t,r)},NC=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ou=function(e,t){return e[t]},Xl=function(e,t){return e[t+1]*256+e[t]},wG=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},xi=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},YA=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},bG=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ih(e,t){var r="",n,s,i=[],o,l,c,A;switch(t){case"dbcs":if(A=this.l,Cr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Xl(this,A)),A+=2;e*=2;break;case"utf8":r=np(this,this.l,this.l+e);break;case"utf16le":e*=2,r=bC(this,this.l,this.l+e);break;case"wstr":return Ih.call(this,e,"dbcs");case"lpstr-ansi":r=k8(this,this.l),e=4+xi(this,this.l);break;case"lpstr-cp":r=_8(this,this.l),e=4+xi(this,this.l);break;case"lpwstr":r=L8(this,this.l),e=4+2*xi(this,this.l);break;case"lpp4":e=4+xi(this,this.l),r=D8(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+xi(this,this.l),r=O8(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Ou(this,this.l+e++))!==0;)i.push(Fx(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=Xl(this,this.l+e))!==0;)i.push(Fx(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",A=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(A)!==-1)return o=Ou(this,A),this.l=A+1,l=Ih.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Fx(Xl(this,A))),A+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",A=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(A)!==-1)return o=Ou(this,A),this.l=A+1,l=Ih.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Fx(Ou(this,A))),A+=1}r=i.join("");break;default:switch(e){case 1:return n=Ou(this,this.l),this.l++,n;case 2:return n=(t==="i"?wG:Xl)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?YA:bG)(this,this.l),this.l+=4,n):(s=xi(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=M1(this,this.l):s=M1([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=F8(this,this.l,e);break}}return this.l+=e,r}var NG=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},CG=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},jG=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function BG(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)jG(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var o=t.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,NG(this,t,this.l);break;case 8:if(n=8,r==="f"){vG(this,t,this.l);break}case 16:break;case-4:n=4,CG(this,t,this.l);break}return this.l+=n,this}function Q8(e,t){var r=F8(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function $s(e,t){e.l=t,e.read_shift=Ih,e.chk=Q8,e.write_shift=BG}function va(e,t){e.l+=t}function ot(e){var t=gA(e);return $s(t,0),t}function pc(e,t,r){if(e){var n,s,i;$s(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var A=Bm[l]||Bm[65535];for(n=e.read_shift(1),i=n&127,s=1;s<4&&n&128;++s)i+=((n=e.read_shift(1))&127)<<7*s;c=e.l+i;var d=A.f&&A.f(e,i,r);if(e.l=c,t(d,A,l))return}}}function Za(){var e=[],t=Cr?256:2048,r=function(A){var d=ot(A);return $s(d,0),d},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(A){return n&&A<n.length-n.l?n:(s(),n=r(Math.max(A+1,t)))},o=function(){return s(),_s(e)},l=function(A){s(),n=A,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:l,end:o,_bufs:e}}function pt(e,t,r,n){var s=+t,i;if(!isNaN(s)){n||(n=Bm[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var o=e.next(i);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&NC(r)&&e.push(r)}}function Lh(e,t,r){var n=Sn(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function $S(e,t,r){var n=Sn(e);return n.s=Lh(n.s,t.s,r),n.e=Lh(n.e,t.s,r),n}function Uh(e,t){if(e.cRel&&e.c<0)for(e=Sn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Sn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ar(e);return!e.cRel&&e.cRel!=null&&(r=EG(r)),!e.rRel&&e.rRel!=null&&(r=SG(r)),r}function vw(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Dn(e.s.c)+":"+(e.e.cRel?"":"$")+Dn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+is(e.s.r)+":"+(e.e.rRel?"":"$")+is(e.e.r):Uh(e.s,t.biff)+":"+Uh(e.e,t.biff)}function CC(e){return parseInt(FG(e),10)-1}function is(e){return""+(e+1)}function SG(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function FG(e){return e.replace(/\$(\d+)$/,"$1")}function jC(e){for(var t=kG(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Dn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function EG(e){return e.replace(/^([A-Z])/,"$$$1")}function kG(e){return e.replace(/^\$([A-Z])/,"$1")}function TG(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Pn(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Ar(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function ni(e){var t=e.indexOf(":");return t==-1?{s:Pn(e),e:Pn(e)}:{s:Pn(e.slice(0,t)),e:Pn(e.slice(t+1))}}function wr(e,t){return typeof t>"u"||typeof t=="number"?wr(e.s,e.e):(typeof e!="string"&&(e=Ar(e)),typeof t!="string"&&(t=Ar(t)),e==t?e:e+":"+t)}function Rr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=e.length;for(r=0;n<i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===i||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function qS(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=po(e.z,r?Ns(t):t)}catch{}try{return e.w=po((e.XF||{}).numFmtId||(r?14:0),r?Ns(t):t)}catch{return""+t}}function dc(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?xc[e.v]||e.v:t==null?qS(e,e.v):qS(e,t))}function kA(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function M8(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,i=e||(s?[]:{}),o=0,l=0;if(i&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Pn(n.origin):n.origin;o=c.r,l=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var A={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=Rr(i["!ref"]);A.s.c=d.s.c,A.s.r=d.s.r,A.e.c=Math.max(A.e.c,d.e.c),A.e.r=Math.max(A.e.r,d.e.r),o==-1&&(A.e.r=o=d.e.r+1)}for(var u=0;u!=t.length;++u)if(t[u]){if(!Array.isArray(t[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[u].length;++f)if(!(typeof t[u][f]>"u")){var h={v:t[u][f]},x=o+u,m=l+f;if(A.s.r>x&&(A.s.r=x),A.s.c>m&&(A.s.c=m),A.e.r<x&&(A.e.r=x),A.e.c<m&&(A.e.c=m),t[u][f]&&typeof t[u][f]=="object"&&!Array.isArray(t[u][f])&&!(t[u][f]instanceof Date))h=t[u][f];else if(Array.isArray(h.v)&&(h.f=t[u][f][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||ar[14],n.cellDates?(h.t="d",h.w=po(h.z,Ns(h.v))):(h.t="n",h.v=Ns(h.v),h.w=po(h.z,h.v))):h.t="s";if(s)i[x]||(i[x]=[]),i[x][m]&&i[x][m].z&&(h.z=i[x][m].z),i[x][m]=h;else{var g=Ar({c:m,r:x});i[g]&&i[g].z&&(h.z=i[g].z),i[g]=h}}}return A.s.c<1e7&&(i["!ref"]=wr(A)),i}function r0(e,t){return M8(null,e,t)}function _G(e){return e.read_shift(4,"i")}function Vo(e,t){return t||(t=ot(4)),t.write_shift(4,e),t}function ga(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Is(e,t){var r=!1;return t==null&&(r=!0,t=ot(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function IG(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function LG(e,t){return t||(t=ot(4)),t.write_shift(2,0),t.write_shift(2,0),t}function BC(e,t){var r=e.l,n=e.read_shift(1),s=ga(e),i=[],o={t:s,h:s};if(n&1){for(var l=e.read_shift(4),c=0;c!=l;++c)i.push(IG(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function UG(e,t){var r=!1;return t==null&&(r=!0,t=ot(15+4*e.t.length)),t.write_shift(1,0),Is(e.t,t),r?t.slice(0,t.l):t}var DG=BC;function PG(e,t){var r=!1;return t==null&&(r=!0,t=ot(23+4*e.t.length)),t.write_shift(1,1),Is(e.t,t),t.write_shift(4,1),LG({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function wo(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Vd(e,t){return t==null&&(t=ot(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function $d(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function qd(e,t){return t==null&&(t=ot(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var OG=ga,H8=Is;function SC(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function H1(e,t){var r=!1;return t==null&&(r=!0,t=ot(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var RG=ga,IN=SC,FC=H1;function EC(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?M1([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):YA(t,0)>>2;return r?s/100:s}function V8(e,t){t==null&&(t=ot(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:s==(s|0)&&s>=-(1<<29)&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function $8(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function QG(e,t){return t||(t=ot(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Kd=$8,n0=QG;function pa(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Td(e,t){return(t||ot(8)).write_shift(8,e,"f")}function MG(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var A=fd[s];A&&(t.rgb=bm(A));break;case 2:t.rgb=bm([o,l,c]);break;case 3:t.theme=s;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function V1(e,t){if(t||(t=ot(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function HG(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function VG(e,t){t||(t=ot(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function q8(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function $G(e){return q8(e,1)}function qG(e){return q8(e,2)}var kC=2,Va=3,kx=11,KS=12,$1=19,Tx=64,KG=65,zG=71,GG=4108,WG=4126,Es=80,K8=81,XG=[Es,K8],LN={1:{n:"CodePage",t:kC},2:{n:"Category",t:Es},3:{n:"PresentationFormat",t:Es},4:{n:"ByteCount",t:Va},5:{n:"LineCount",t:Va},6:{n:"ParagraphCount",t:Va},7:{n:"SlideCount",t:Va},8:{n:"NoteCount",t:Va},9:{n:"HiddenCount",t:Va},10:{n:"MultimediaClipCount",t:Va},11:{n:"ScaleCrop",t:kx},12:{n:"HeadingPairs",t:GG},13:{n:"TitlesOfParts",t:WG},14:{n:"Manager",t:Es},15:{n:"Company",t:Es},16:{n:"LinksUpToDate",t:kx},17:{n:"CharacterCount",t:Va},19:{n:"SharedDoc",t:kx},22:{n:"HyperlinksChanged",t:kx},23:{n:"AppVersion",t:Va,p:"version"},24:{n:"DigSig",t:KG},26:{n:"ContentType",t:Es},27:{n:"ContentStatus",t:Es},28:{n:"Language",t:Es},29:{n:"Version",t:Es},255:{},2147483648:{n:"Locale",t:$1},2147483651:{n:"Behavior",t:$1},1919054434:{}},UN={1:{n:"CodePage",t:kC},2:{n:"Title",t:Es},3:{n:"Subject",t:Es},4:{n:"Author",t:Es},5:{n:"Keywords",t:Es},6:{n:"Comments",t:Es},7:{n:"Template",t:Es},8:{n:"LastAuthor",t:Es},9:{n:"RevNumber",t:Es},10:{n:"EditTime",t:Tx},11:{n:"LastPrinted",t:Tx},12:{n:"CreatedDate",t:Tx},13:{n:"ModifiedDate",t:Tx},14:{n:"PageCount",t:Va},15:{n:"WordCount",t:Va},16:{n:"CharCount",t:Va},17:{n:"Thumbnail",t:zG},18:{n:"Application",t:Es},19:{n:"DocSecurity",t:Va},255:{},2147483648:{n:"Locale",t:$1},2147483651:{n:"Behavior",t:$1},1919054434:{}},zS={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},YG=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function JG(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var ZG=JG([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),fd=Sn(ZG),xc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},z8={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},DN={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},_x={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function TC(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function eW(e){var t=TC();if(!e||!e.match)return t;var r={};if((e.match(ba)||[]).forEach(function(n){var s=dr(n);switch(s[0].replace(AG,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[DN[s.ContentType]]!==void 0&&t[DN[s.ContentType]].push(s.PartName);break}}),t.xmlns!==ws.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function G8(e,t){var r=eG(DN),n=[],s;n[n.length]=os,n[n.length]=Ft("Types",null,{xmlns:ws.CT,"xmlns:xsd":ws.xsd,"xmlns:xsi":ws.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Ft("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(s=e[c][0],n[n.length]=Ft("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:_x[c][t.bookType]||_x[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(A){n[n.length]=Ft("Override",null,{PartName:(A[0]=="/"?"":"/")+A,ContentType:_x[c][t.bookType]||_x[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(A){n[n.length]=Ft("Override",null,{PartName:(A[0]=="/"?"":"/")+A,ContentType:r[c][0]})})};return i("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Br={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function wm(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Dh(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(ba)||[]).forEach(function(s){var i=dr(s);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:fh(i.Target,t);r[l]=o,n[i.Id]=o}}),r["!id"]=n,r}function mf(e){var t=[os,Ft("Relationships",null,{xmlns:ws.RELS})];return Gn(e["!id"]).forEach(function(r){t[t.length]=Ft("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function tn(e,t,r,n,s,i){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[Br.HLINK,Br.XPATH,Br.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var tW="application/vnd.oasis.opendocument.spreadsheet";function rW(e,t){for(var r=wC(e),n,s;n=vm.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=dr(n[0],!1),s.path=="/"&&s.type!==tW)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function nW(e){var t=[os];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function GS(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function sW(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function aW(e){var t=[os];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(GS(e[r][0],e[r][1])),t.push(sW("",e[r][0]));return t.push(GS("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function W8(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+D1.version+"</meta:generator></office:meta></office:document-meta>"}var co=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],iW=function(){for(var e=new Array(co.length),t=0;t<co.length;++t){var r=co[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function X8(e){var t={};e=cn(e);for(var r=0;r<co.length;++r){var n=co[r],s=e.match(iW[r]);s!=null&&s.length>0&&(t[n[1]]=Or(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Bn(t[n[1]]))}return t}function ww(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=nn(t),n[n.length]=r?Ft(e,t,r):Ks(e,t))}function Y8(e,t){var r=t||{},n=[os,Ft("cp:coreProperties",null,{"xmlns:cp":ws.CORE_PROPS,"xmlns:dc":ws.dc,"xmlns:dcterms":ws.dcterms,"xmlns:dcmitype":ws.dcmitype,"xmlns:xsi":ws.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&ww("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:_N(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&ww("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:_N(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var i=0;i!=co.length;++i){var o=co[i],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&ww(o[0],l,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var hd=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],J8=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Z8(e,t,r,n){var s=[];if(typeof e=="string")s=OS(e,n);else for(var i=0;i<e.length;++i)s=s.concat(e[i].map(function(d){return{v:d}}));var o=typeof t=="string"?OS(t,n).map(function(d){return d.v}):t,l=0,c=0;if(o.length>0)for(var A=0;A!==s.length;A+=2){switch(c=+s[A+1].v,s[A].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function oW(e,t,r){var n={};return t||(t={}),e=cn(e),hd.forEach(function(s){var i=(e.match(gm(s[0]))||[])[1];switch(s[2]){case"string":i&&(t[s[1]]=Or(i));break;case"bool":t[s[1]]=i==="true";break;case"raw":var o=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(n[s[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Z8(n.HeadingPairs,n.TitlesOfParts,t,r),t}function eL(e){var t=[],r=Ft;return e||(e={}),e.Application="SheetJS",t[t.length]=os,t[t.length]=Ft("Properties",null,{xmlns:ws.EXT_PROPS,"xmlns:vt":ws.vt}),hd.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=nn(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+nn(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var lW=/<[^>]+>[^<]*/g;function cW(e,t){var r={},n="",s=e.match(lW);if(s)for(var i=0;i!=s.length;++i){var o=s[i],l=dr(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Or(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),A=c[0].slice(4),d=c[1];switch(A){case"lpstr":case"bstr":case"lpwstr":r[n]=Or(d);break;case"bool":r[n]=Nn(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=Bn(d);break;case"cy":case"error":r[n]=Or(d);break;default:if(A.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,A,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function tL(e){var t=[os,Ft("Properties",null,{xmlns:ws.CUST_PROPS,"xmlns:vt":ws.vt})];if(!e)return t.join("");var r=1;return Gn(e).forEach(function(s){++r,t[t.length]=Ft("property",gG(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:nn(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var PN={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},bw;function AW(e,t,r){bw||(bw=dv(PN)),t=bw[t]||t,e[t]=r}function dW(e,t){var r=[];return Gn(PN).map(function(n){for(var s=0;s<co.length;++s)if(co[s][1]==n)return co[s];for(s=0;s<hd.length;++s)if(hd[s][1]==n)return hd[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Ks(PN[n[1]]||n[1],s))}}),Ft("DocumentProperties",r.join(""),{xmlns:pi.o})}function uW(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&Gn(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var o=0;o<co.length;++o)if(i==co[o][1])return;for(o=0;o<hd.length;++o)if(i==hd[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var l=e[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),s.push(Ft(LS(i),l,{"dt:dt":c}))}}),t&&Gn(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var o=t[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),s.push(Ft(LS(i),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+pi.o+'">'+s.join("")+"</"+n+">"}function _C(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function fW(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),s+=i);var o=ot(8);return o.write_shift(4,n),o.write_shift(4,s),o}function rL(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function nL(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function sL(e,t,r){return t===31?nL(e):rL(e,t,r)}function ON(e,t,r){return sL(e,t,r===!1?0:4)}function hW(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return sL(e,t,0)}function mW(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(La,""),e.l-s&2&&(e.l+=2)}return r}function pW(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(La,"");return r}function xW(e){var t=e.l,r=q1(e,K8);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=q1(e,Va);return[r,n]}function gW(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(xW(e));return r}function WS(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var i=e.read_shift(4),o=e.read_shift(4);n[i]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(La,"").replace(uh,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function aL(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function yW(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function q1(e,t,r){var n=e.read_shift(2),s,i=r||{};if(e.l+=2,t!==KS&&n!==t&&XG.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===KS?n:t){case 2:return s=e.read_shift(2,"i"),i.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return rL(e,n,4).replace(La,"");case 31:return nL(e);case 64:return _C(e);case 65:return aL(e);case 71:return yW(e);case 80:return ON(e,n,!i.raw).replace(La,"");case 81:return hW(e,n).replace(La,"");case 4108:return gW(e);case 4126:case 4127:return n==4127?mW(e):pW(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function XS(e,t){var r=ot(4),n=ot(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=ot(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=fW(t);break;case 31:case 80:for(n=ot(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return _s([r,n])}function YS(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),i=[],o=0,l=0,c=-1,A={};for(o=0;o!=s;++o){var d=e.read_shift(4),u=e.read_shift(4);i[o]=[d,u+r]}i.sort(function(v,w){return v[1]-w[1]});var f={};for(o=0;o!=s;++o){if(e.l!==i[o][1]){var h=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,h=!1);break;case 80:e.l<=i[o][1]&&(e.l=i[o][1],h=!1);break;case 4108:e.l<=i[o][1]&&(e.l=i[o][1],h=!1);break}if((!t||o==0)&&e.l<=i[o][1]&&(h=!1,e.l=i[o][1]),h)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var x=t[i[o][0]];if(f[x.n]=q1(e,x.t,{raw:!0}),x.p==="version"&&(f[x.n]=String(f[x.n]>>16)+"."+("0000"+String(f[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(f[x.n]){case 0:f[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Oo(l=f[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[x.n])}}else if(i[o][0]===1){if(l=f.CodePage=q1(e,kC),Oo(l),c!==-1){var m=e.l;e.l=i[c][1],A=WS(e,l),e.l=m}}else if(i[o][0]===0){if(l===0){c=o,e.l=i[o+1][1];continue}A=WS(e,l)}else{var g=A[i[o][0]],p;switch(e[e.l]){case 65:e.l+=4,p=aL(e);break;case 30:e.l+=4,p=ON(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,p=ON(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,p=e.read_shift(4,"i");break;case 19:e.l+=4,p=e.read_shift(4);break;case 5:e.l+=4,p=e.read_shift(8,"f");break;case 11:e.l+=4,p=Jn(e,4);break;case 64:e.l+=4,p=Bn(_C(e));break;default:throw new Error("unparsed value: "+e[e.l])}f[g]=p}}return e.l=r+n,f}var iL=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function vW(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function JS(e,t,r){var n=ot(8),s=[],i=[],o=8,l=0,c=ot(8),A=ot(8);if(c.write_shift(4,2),c.write_shift(4,1200),A.write_shift(4,1),i.push(c),s.push(A),o+=8+c.length,!t){A=ot(8),A.write_shift(4,0),s.unshift(A);var d=[ot(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var u=e[l][0];for(c=ot(8+2*(u.length+1)+(u.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,u.length+1),c.write_shift(0,u,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=_s(d),i.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(iL.indexOf(e[l][0])>-1||J8.indexOf(e[l][0])>-1)&&e[l][1]!=null){var f=e[l][1],h=0;if(t){h=+t[e[l][0]];var x=r[h];if(x.p=="version"&&typeof f=="string"){var m=f.split(".");f=(+m[0]<<16)+(+m[1]||0)}c=XS(x.t,f)}else{var g=vW(f);g==-1&&(g=31,f=String(f)),c=XS(g,f)}i.push(c),A=ot(8),A.write_shift(4,t?h:2+l),s.push(A),o+=8+c.length}var p=8*(i.length+1);for(l=0;l<i.length;++l)s[l].write_shift(4,p),p+=i[l].length;return n.write_shift(4,o),n.write_shift(4,i.length),_s([n].concat(s).concat(i))}function ZS(e,t,r){var n=e.content;if(!n)return{};$s(n,0);var s,i,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var A=n.read_shift(4),d=n.read_shift(16);if(d!==Jt.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=n.read_shift(16),l=n.read_shift(4),s===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);s===2&&(o=n.read_shift(16),c=n.read_shift(4));var u=YS(n,t),f={SystemIdentifier:A};for(var h in u)f[h]=u[h];if(f.FMTID=i,s===1)return f;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var x;try{x=YS(n,null)}catch{}for(h in x)f[h]=x[h];return f.FMTID=[i,o],f}function eF(e,t,r,n,s,i){var o=ot(s?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Jt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,s?68:48);var c=JS(e,r,n);if(l.push(c),s){var A=JS(s,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+c.length),l.push(A)}return _s(l)}function Uc(e,t){return e.read_shift(t),null}function wW(e,t){t||(t=ot(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function bW(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function Jn(e,t){return e.read_shift(t)===1}function Ta(e,t){return t||(t=ot(2)),t.write_shift(2,+!!e),t}function hs(e){return e.read_shift(2,"u")}function eo(e,t){return t||(t=ot(2)),t.write_shift(2,e),t}function oL(e,t){return bW(e,t,hs)}function NW(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function lL(e,t,r){return r||(r=ot(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function sp(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=n?e.read_shift(n,s):"";return o}function CW(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,i=1+(r&1),o=0,l,c={};s&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var A=i==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,A);return s&&(e.l+=4*o),n&&(e.l+=l),c.t=d,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function jW(e){var t=e.t||"",r=ot(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=ot(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return _s(s)}function _d(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function ap(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):_d(e,n,r)}function zd(e,t,r){if(r.biff>5)return ap(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function cL(e,t,r){return r||(r=ot(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function BW(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function SW(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(La,"");return n&&(e.l+=24),s}function FW(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(i>>1,"utf16le").replace(La,"");return r+o}function EW(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return SW(e);case"0303000000000000c000000000000046":return FW(e);default:throw new Error("Unsupported Moniker "+r)}}function Ix(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(La,""):"";return r}function tF(e,t){t||(t=ot(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function kW(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var i,o,l,c,A="",d,u;s&16&&(i=Ix(e,r-e.l)),s&128&&(o=Ix(e,r-e.l)),(s&257)===257&&(l=Ix(e,r-e.l)),(s&257)===1&&(c=EW(e,r-e.l)),s&8&&(A=Ix(e,r-e.l)),s&32&&(d=e.read_shift(16)),s&64&&(u=_C(e)),e.l=r;var f=o||l||c||"";f&&A&&(f+="#"+A),f||(f="#"+A),s&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var h={Target:f};return d&&(h.guid=d),u&&(h.time=u),i&&(h.Tooltip=i),h}function TW(e){var t=ot(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),i=s>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(i==28)n=n.slice(1),tF(n,t);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),i&8&&tF(s>-1?n.slice(s+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function AL(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function dL(e,t){var r=AL(e);return r[3]=0,r}function Cl(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Id(e,t,r,n){return n||(n=ot(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function _W(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function IW(e,t,r){return t===0?"":zd(e,t,r)}function LW(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),i=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[s,i,o]}function uL(e){var t=e.read_shift(2),r=EC(e);return[t,r]}function UW(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=sp(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,s}function hv(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function fL(e,t){return t||(t=ot(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function hL(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var DW=hL;function mL(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function PW(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function OW(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function ra(e){e.l+=2,e.l+=e.read_shift(2)}var RW={0:ra,4:ra,5:ra,6:ra,7:OW,8:ra,9:ra,10:ra,11:ra,12:ra,13:PW,14:ra,15:ra,16:ra,17:ra,18:ra,19:ra,20:ra,21:mL};function QW(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(RW[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Lx(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function IC(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=ot(s);return i.write_shift(2,n),i.write_shift(2,t),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function MW(e,t){return t===0||e.read_shift(2),1200}function HW(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=zd(e,0,r);return e.read_shift(t+n-e.l),s}function VW(e,t){var r=!t||t.biff==8,n=ot(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function $W(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function qW(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=sp(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:s,dt:i,name:o}}function KW(e,t){var r=!t||t.biff>=8?2:1,n=ot(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function zW(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),i=[],o=0;o!=s&&e.l<r;++o)i.push(CW(e));return i.Count=n,i.Unique=s,i}function GW(e,t){var r=ot(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=jW(e[s]);var i=_s([r].concat(n));return i.parts=[r.length].concat(n.map(function(o){return o.length})),i}function WW(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function XW(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function YW(e){var t=_W(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function JW(e){return e.read_shift(2),e.read_shift(4)}function rF(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,s]}function ZW(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),A=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:i,CurTab:o,FirstTab:l,Selected:c,TabRatio:A}}function eX(){var e=ot(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function tX(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function rX(e){var t=ot(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function nX(){}function sX(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=sp(e,0,r),n}function aX(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,i=ot(s);return i.write_shift(2,(e.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function iX(e){var t=Cl(e);return t.isst=e.read_shift(4),t}function oX(e,t,r,n){var s=ot(10);return Id(e,t,n,s),s.write_shift(4,r),s}function lX(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=Cl(e);r.biff==2&&e.l++;var i=ap(e,n-e.l,r);return s.val=i,s}function cX(e,t,r,n,s){var i=!s||s.biff==8,o=ot(8+ +i+(1+i)*r.length);return Id(e,t,n,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function AX(e,t,r){var n=e.read_shift(2),s=zd(e,0,r);return[n,s]}function dX(e,t,r,n){var s=r&&r.biff==5;n||(n=ot(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var uX=zd;function nF(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,i=e.read_shift(s),o=e.read_shift(s),l=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:i,c:l},e:{r:o,c}}}function fX(e,t){var r=t.biff==8||!t.biff?4:2,n=ot(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function hX(e){var t=e.read_shift(2),r=e.read_shift(2),n=uL(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function mX(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(uL(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:o,rkrec:i}}function pX(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:o,ixfe:i}}function xX(e,t,r,n){var s={},i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return s.patternType=YG[l>>26],n.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=l&127,s.icvBottom=l>>7&127,s.icvDiag=l>>14&127,s.dgDiag=l>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function gX(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=xX(e,t,n.fStyle,r),n}function sF(e,t,r,n){var s=r&&r.biff==5;n||(n=ot(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&s&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function yX(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function vX(e){var t=ot(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function aF(e,t,r){var n=Cl(e);(r.biff==2||t==9)&&++e.l;var s=NW(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function wX(e,t,r,n,s,i){var o=ot(8);return Id(e,t,n,o),lL(r,i,o),o}function bX(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Cl(e),s=pa(e);return n.val=s,n}function NX(e,t,r,n){var s=ot(14);return Id(e,t,n,s),Td(r,s),s}var iF=IW;function CX(e,t,r){var n=e.l+t,s=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=_d(e,i),l=[];n>e.l;)l.push(ap(e));return[i,s,o,l]}function oF(e,t,r){var n=e.read_shift(2),s,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=UW(e,t-2,r)),i.body=s||e.read_shift(t-2),typeof s=="string"&&(i.Name=s),i}var jX=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function lF(e,t,r){var n=e.l+t,s=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var A=_d(e,o,r);s&32&&(A=jX[A.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var u=n==e.l||l===0||!(d>0)?[]:Qee(e,d,r,l);return{chKey:i,Name:A,itab:c,rgce:u}}function pL(e,t,r){if(r.biff<8)return BX(e,t,r);for(var n=[],s=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(LW(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function BX(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=sp(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function SX(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),i=_d(e,n,r),o=_d(e,s,r);return[i,o]}function FX(e,t,r){var n=hL(e);e.l++;var s=e.read_shift(1);return t-=8,[Mee(e,t,r),s,n]}function cF(e,t,r){var n=DW(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Oee(e,t,r)]}function EX(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function kX(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=zd(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},l,o,i]}}function TX(e,t,r){return kX(e,t,r)}function _X(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(hv(e));return r}function IX(e){var t=ot(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)fL(e[r],t);return t}function LX(e,t,r){if(r&&r.biff<8)return DX(e,t,r);var n=mL(e),s=QW(e,t-22,n[1]);return{cmo:n,ft:s}}var UX={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function DX(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((UX[n]||va)(e,t,r)),{cmo:[s,n,i],ft:o}}function PX(e,t,r){var n=e.l,s="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:o=BW(e,6,r);var l=e.read_shift(2);e.read_shift(2),hs(e,2);var c=e.read_shift(2);e.l+=c;for(var A=1;A<e.lens.length-1;++A){if(e.l-n!=e.lens[A])throw new Error("TxO: bad continue record");var d=e[e.l],u=_d(e,e.lens[A+1]-e.lens[A]-1);if(s+=u,s.length>=(d?l:2*l))break}if(s.length!==l&&s.length!==l*2)throw new Error("cchText: "+l+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function OX(e,t){var r=hv(e);e.l+=16;var n=kW(e,t-24);return[r,n]}function RX(e){var t=ot(24),r=Pn(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return _s([t,TW(e[1])])}function QX(e,t){e.read_shift(2);var r=hv(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(La,""),[r,n]}function MX(e){var t=e[1].Tooltip,r=ot(10+2*(t.length+1));r.write_shift(2,2048);var n=Pn(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function HX(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=zS[r]||r,r=e.read_shift(2),t[1]=zS[r]||r,t}function VX(e){return e||(e=ot(4)),e.write_shift(2,1),e.write_shift(2,1),e}function $X(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(dL(e));return r}function qX(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(dL(e));return r}function KX(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function xL(e,t,r){if(!r.cellStyles)return va(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var A={s,e:i,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(A.level=c>>8&7),A}function zX(e,t){var r=ot(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function GX(e,t){var r={};return t<32||(e.l+=16,r.header=pa(e),r.footer=pa(e),e.l+=2),r}function WX(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function XX(e){for(var t=ot(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var YX=Cl,JX=oL,ZX=ap;function eY(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function tY(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Cl(e);++e.l;var s=zd(e,t-7,r);return n.t="str",n.val=s,n}function rY(e){var t=Cl(e);++e.l;var r=pa(e);return t.t="n",t.val=r,t}function nY(e,t,r){var n=ot(15);return cp(n,e,t),n.write_shift(8,r,"f"),n}function sY(e){var t=Cl(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function aY(e,t,r){var n=ot(9);return cp(n,e,t),n.write_shift(2,r),n}function iY(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function oY(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function lY(e,t,r){var n=e.l+t,s=Cl(e),i=e.read_shift(2),o=_d(e,i,r);return e.l=n,s.t="str",s.val=o,s}var cY=[2,3,48,49,131,139,140,245],RN=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=dv({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var A=[],d=gA(1);switch(c.type){case"base64":d=gi(ki(l));break;case"binary":d=gi(l);break;case"buffer":case"array":d=l;break}$s(d,0);var u=d.read_shift(1),f=!!(u&136),h=!1,x=!1;switch(u){case 2:break;case 3:break;case 48:h=!0,f=!0;break;case 49:h=!0,f=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+u.toString(16))}var m=0,g=521;u==2&&(m=d.read_shift(2)),d.l+=3,u!=2&&(m=d.read_shift(4)),m>1048576&&(m=1e6),u!=2&&(g=d.read_shift(2));var p=d.read_shift(2),v=c.codepage||1252;u!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(v=e[d[d.l]]),d.l+=1,d.l+=2),x&&(d.l+=36);for(var w=[],B={},T=Math.min(d.length,u==2?521:g-10-(h?264:0)),_=x?32:11;d.l<T&&d[d.l]!=13;)switch(B={},B.name=Kc.utils.decode(v,d.slice(d.l,d.l+_)).replace(/[\u0000\r\n].*$/g,""),d.l+=_,B.type=String.fromCharCode(d.read_shift(1)),u!=2&&!x&&(B.offset=d.read_shift(4)),B.len=d.read_shift(1),u==2&&(B.offset=d.read_shift(2)),B.dec=d.read_shift(1),B.name.length&&w.push(B),u!=2&&(d.l+=x?13:14),B.type){case"B":(!h||B.len!=8)&&c.WTF&&console.log("Skipping "+B.name+":"+B.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+B.name+":"+B.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+B.type)}if(d[d.l]!==13&&(d.l=g-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=g;var j=0,E=0;for(A[0]=[],E=0;E!=w.length;++E)A[0][E]=w[E].name;for(;m-- >0;){if(d[d.l]===42){d.l+=p;continue}for(++d.l,A[++j]=[],E=0,E=0;E!=w.length;++E){var L=d.slice(d.l,d.l+w[E].len);d.l+=w[E].len,$s(L,0);var M=Kc.utils.decode(v,L);switch(w[E].type){case"C":M.trim().length&&(A[j][E]=M.replace(/\s+$/,""));break;case"D":M.length===8?A[j][E]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):A[j][E]=M;break;case"F":A[j][E]=parseFloat(M.trim());break;case"+":case"I":A[j][E]=x?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":A[j][E]=!0;break;case"N":case"F":A[j][E]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+u.toString(16));A[j][E]="##MEMO##"+(x?parseInt(M.trim(),10):L.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(A[j][E]=+M||0);break;case"@":A[j][E]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":A[j][E]=new Date((L.read_shift(4)-2440588)*864e5+L.read_shift(4));break;case"Y":A[j][E]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":A[j][E]=-L.read_shift(-8,"f");break;case"B":if(h&&w[E].len==8){A[j][E]=L.read_shift(8,"f");break}case"G":case"P":L.l+=w[E].len;break;case"0":if(w[E].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[E].type)}}}if(u!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(A=A.slice(0,c.sheetRows)),c.DBF=w,A}function n(l,c){var A=c||{};A.dateNF||(A.dateNF="yyyymmdd");var d=r0(r(l,A),A);return d["!cols"]=A.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete A.DBF,d}function s(l,c){try{return kA(n(l,c),c)}catch(A){if(c&&c.WTF)throw A}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var A=c||{};if(+A.codepage>=0&&Oo(+A.codepage),A.type=="string")throw new Error("Cannot write DBF to JS string");var d=Za(),u=G1(l,{header:1,raw:!0,cellDates:!0}),f=u[0],h=u.slice(1),x=l["!cols"]||[],m=0,g=0,p=0,v=1;for(m=0;m<f.length;++m){if(((x[m]||{}).DBF||{}).name){f[m]=x[m].DBF.name,++p;continue}if(f[m]!=null){if(++p,typeof f[m]=="number"&&(f[m]=f[m].toString(10)),typeof f[m]!="string")throw new Error("DBF Invalid column name "+f[m]+" |"+typeof f[m]+"|");if(f.indexOf(f[m])!==m){for(g=0;g<1024;++g)if(f.indexOf(f[m]+"_"+g)==-1){f[m]+="_"+g;break}}}}var w=Rr(l["!ref"]),B=[],T=[],_=[];for(m=0;m<=w.e.c-w.s.c;++m){var j="",E="",L=0,M=[];for(g=0;g<h.length;++g)h[g][m]!=null&&M.push(h[g][m]);if(M.length==0||f[m]==null){B[m]="?";continue}for(g=0;g<M.length;++g){switch(typeof M[g]){case"number":E="B";break;case"string":E="C";break;case"boolean":E="L";break;case"object":E=M[g]instanceof Date?"D":"C";break;default:E="C"}L=Math.max(L,String(M[g]).length),j=j&&j!=E?"C":E}L>250&&(L=250),E=((x[m]||{}).DBF||{}).type,E=="C"&&x[m].DBF.len>L&&(L=x[m].DBF.len),j=="B"&&E=="N"&&(j="N",_[m]=x[m].DBF.dec,L=x[m].DBF.len),T[m]=j=="C"||E=="N"?L:i[j]||0,v+=T[m],B[m]=j}var F=d.next(32);for(F.write_shift(4,318902576),F.write_shift(4,h.length),F.write_shift(2,296+32*p),F.write_shift(2,v),m=0;m<4;++m)F.write_shift(4,0);for(F.write_shift(4,0|(+t[i8]||3)<<8),m=0,g=0;m<f.length;++m)if(f[m]!=null){var D=d.next(32),G=(f[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,G,"sbcs"),D.write_shift(1,B[m]=="?"?"C":B[m],"sbcs"),D.write_shift(4,g),D.write_shift(1,T[m]||i[B[m]]||0),D.write_shift(1,_[m]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),g+=T[m]||i[B[m]]||0}var K=d.next(264);for(K.write_shift(4,13),m=0;m<65;++m)K.write_shift(4,0);for(m=0;m<h.length;++m){var ae=d.next(v);for(ae.write_shift(1,0),g=0;g<f.length;++g)if(f[g]!=null)switch(B[g]){case"L":ae.write_shift(1,h[m][g]==null?63:h[m][g]?84:70);break;case"B":ae.write_shift(8,h[m][g]||0,"f");break;case"N":var Z="0";for(typeof h[m][g]=="number"&&(Z=h[m][g].toFixed(_[g]||0)),p=0;p<T[g]-Z.length;++p)ae.write_shift(1,32);ae.write_shift(1,Z,"sbcs");break;case"D":h[m][g]?(ae.write_shift(4,("0000"+h[m][g].getFullYear()).slice(-4),"sbcs"),ae.write_shift(2,("00"+(h[m][g].getMonth()+1)).slice(-2),"sbcs"),ae.write_shift(2,("00"+h[m][g].getDate()).slice(-2),"sbcs")):ae.write_shift(8,"00000000","sbcs");break;case"C":var oe=String(h[m][g]!=null?h[m][g]:"").slice(0,T[g]);for(ae.write_shift(1,oe,"sbcs"),p=0;p<T[g]-oe.length;++p)ae.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:o}}(),gL=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Gn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,h){var x=e[h];return typeof x=="number"?vS(x):x},n=function(f,h,x){var m=h.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return m==59?f:vS(m)};e["|"]=254;function s(f,h){switch(h.type){case"base64":return i(ki(f),h);case"binary":return i(f,h);case"buffer":return i(Cr&&Buffer.isBuffer(f)?f.toString("binary"):EA(f),h);case"array":return i(kd(f),h)}throw new Error("Unrecognized type "+h.type)}function i(f,h){var x=f.split(/[\n\r]+/),m=-1,g=-1,p=0,v=0,w=[],B=[],T=null,_={},j=[],E=[],L=[],M=0,F;for(+h.codepage>=0&&Oo(+h.codepage);p!==x.length;++p){M=0;var D=x[p].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),G=D.replace(/;;/g,"\0").split(";").map(function(I){return I.replace(/\u0000/g,";")}),K=G[0],ae;if(D.length>0)switch(K){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":G[1].charAt(0)=="P"&&B.push(D.slice(3).replace(/;;/g,";"));break;case"C":var Z=!1,oe=!1,Y=!1,R=!1,z=-1,ee=-1;for(v=1;v<G.length;++v)switch(G[v].charAt(0)){case"A":break;case"X":g=parseInt(G[v].slice(1))-1,oe=!0;break;case"Y":for(m=parseInt(G[v].slice(1))-1,oe||(g=0),F=w.length;F<=m;++F)w[F]=[];break;case"K":ae=G[v].slice(1),ae.charAt(0)==='"'?ae=ae.slice(1,ae.length-1):ae==="TRUE"?ae=!0:ae==="FALSE"?ae=!1:isNaN(Ho(ae))?isNaN(Uf(ae).getDate())||(ae=Bn(ae)):(ae=Ho(ae),T!==null&&e0(T)&&(ae=fv(ae))),Z=!0;break;case"E":R=!0;var b=pf(G[v].slice(1),{r:m,c:g});w[m][g]=[w[m][g],b];break;case"S":Y=!0,w[m][g]=[w[m][g],"S5S"];break;case"G":break;case"R":z=parseInt(G[v].slice(1))-1;break;case"C":ee=parseInt(G[v].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+D)}if(Z&&(w[m][g]&&w[m][g].length==2?w[m][g][0]=ae:w[m][g]=ae,T=null),Y){if(R)throw new Error("SYLK shared formula cannot have own formula");var O=z>-1&&w[z][ee];if(!O||!O[1])throw new Error("SYLK shared formula cannot find base");w[m][g][1]=DL(O[1],{r:m-z,c:g-ee})}break;case"F":var S=0;for(v=1;v<G.length;++v)switch(G[v].charAt(0)){case"X":g=parseInt(G[v].slice(1))-1,++S;break;case"Y":for(m=parseInt(G[v].slice(1))-1,F=w.length;F<=m;++F)w[F]=[];break;case"M":M=parseInt(G[v].slice(1))/20;break;case"F":break;case"G":break;case"P":T=B[parseInt(G[v].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(L=G[v].slice(1).split(" "),F=parseInt(L[0],10);F<=parseInt(L[1],10);++F)M=parseInt(L[2],10),E[F-1]=M===0?{hidden:!0}:{wch:M},yA(E[F-1]);break;case"C":g=parseInt(G[v].slice(1))-1,E[g]||(E[g]={});break;case"R":m=parseInt(G[v].slice(1))-1,j[m]||(j[m]={}),M>0?(j[m].hpt=M,j[m].hpx=Pf(M)):M===0&&(j[m].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+D)}S<1&&(T=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+D)}}return j.length>0&&(_["!rows"]=j),E.length>0&&(_["!cols"]=E),h&&h.sheetRows&&(w=w.slice(0,h.sheetRows)),[w,_]}function o(f,h){var x=s(f,h),m=x[0],g=x[1],p=r0(m,h);return Gn(g).forEach(function(v){p[v]=g[v]}),p}function l(f,h){return kA(o(f,h),h)}function c(f,h,x,m){var g="C;Y"+(x+1)+";X"+(m+1)+";K";switch(f.t){case"n":g+=f.v||0,f.f&&!f.F&&(g+=";E"+RC(f.f,{r:x,c:m}));break;case"b":g+=f.v?"TRUE":"FALSE";break;case"e":g+=f.w||f.v;break;case"d":g+='"'+(f.w||f.v)+'"';break;case"s":g+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function A(f,h){h.forEach(function(x,m){var g="F;W"+(m+1)+" "+(m+1)+" ";x.hidden?g+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=Nm(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=Cm(x.wpx)),typeof x.wch=="number"&&(g+=Math.round(x.wch))),g.charAt(g.length-1)!=" "&&f.push(g)})}function d(f,h){h.forEach(function(x,m){var g="F;";x.hidden?g+="M0;":x.hpt?g+="M"+20*x.hpt+";":x.hpx&&(g+="M"+20*jm(x.hpx)+";"),g.length>2&&f.push(g+"R"+(m+1))})}function u(f,h){var x=["ID;PWXL;N;E"],m=[],g=Rr(f["!ref"]),p,v=Array.isArray(f),w=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),f["!cols"]&&A(x,f["!cols"]),f["!rows"]&&d(x,f["!rows"]),x.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var B=g.s.r;B<=g.e.r;++B)for(var T=g.s.c;T<=g.e.c;++T){var _=Ar({r:B,c:T});p=v?(f[B]||[])[T]:f[_],!(!p||p.v==null&&(!p.f||p.F))&&m.push(c(p,f,B,T))}return x.join(w)+w+m.join(w)+w+"E"+w}return{to_workbook:l,to_sheet:o,from_sheet:u}}(),yL=function(){function e(i,o){switch(o.type){case"base64":return t(ki(i),o);case"binary":return t(i,o);case"buffer":return t(Cr&&Buffer.isBuffer(i)?i.toString("binary"):EA(i),o);case"array":return t(kd(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var l=i.split(`
`),c=-1,A=-1,d=0,u=[];d!==l.length;++d){if(l[d].trim()==="BOT"){u[++c]=[],A=0;continue}if(!(c<0)){var f=l[d].trim().split(","),h=f[0],x=f[1];++d;for(var m=l[d]||"";(m.match(/["]/g)||[]).length&1&&d<l.length-1;)m+=`
`+l[++d];switch(m=m.trim(),+h){case-1:if(m==="BOT"){u[++c]=[],A=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?u[c][A]=!0:m==="FALSE"?u[c][A]=!1:isNaN(Ho(x))?isNaN(Uf(x).getDate())?u[c][A]=x:u[c][A]=Bn(x):u[c][A]=Ho(x),++A;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),u[c][A++]=m!==""?m:null;break}if(m==="EOD")break}}return o&&o.sheetRows&&(u=u.slice(0,o.sheetRows)),u}function r(i,o){return r0(e(i,o),o)}function n(i,o){return kA(r(i,o),o)}var s=function(){var i=function(c,A,d,u,f){c.push(A),c.push(d+","+u),c.push('"'+f.replace(/"/g,'""')+'"')},o=function(c,A,d,u){c.push(A+","+d),c.push(A==1?'"'+u.replace(/"/g,'""')+'"':u)};return function(c){var A=[],d=Rr(c["!ref"]),u,f=Array.isArray(c);i(A,"TABLE",0,1,"sheetjs"),i(A,"VECTORS",0,d.e.r-d.s.r+1,""),i(A,"TUPLES",0,d.e.c-d.s.c+1,""),i(A,"DATA",0,0,"");for(var h=d.s.r;h<=d.e.r;++h){o(A,-1,0,"BOT");for(var x=d.s.c;x<=d.e.c;++x){var m=Ar({r:h,c:x});if(u=f?(c[h]||[])[x]:c[m],!u){o(A,1,0,"");continue}switch(u.t){case"n":var g=u.w;!g&&u.v!=null&&(g=u.v),g==null?u.f&&!u.F?o(A,1,0,"="+u.f):o(A,1,0,""):o(A,0,g,"V");break;case"b":o(A,0,u.v?1:0,u.v?"TRUE":"FALSE");break;case"s":o(A,1,0,isNaN(u.v)?u.v:'="'+u.v+'"');break;case"d":u.w||(u.w=po(u.z||ar[14],Ns(Bn(u.v)))),o(A,0,u.w,"V");break;default:o(A,1,0,"")}}}o(A,-1,0,"EOD");var p=`\r
`,v=A.join(p);return v}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),vL=function(){function e(u){return u.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(u){return u.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(u,f){for(var h=u.split(`
`),x=-1,m=-1,g=0,p=[];g!==h.length;++g){var v=h[g].trim().split(":");if(v[0]==="cell"){var w=Pn(v[1]);if(p.length<=w.r)for(x=p.length;x<=w.r;++x)p[x]||(p[x]=[]);switch(x=w.r,m=w.c,v[2]){case"t":p[x][m]=e(v[3]);break;case"v":p[x][m]=+v[3];break;case"vtf":var B=v[v.length-1];case"vtc":switch(v[3]){case"nl":p[x][m]=!!+v[4];break;default:p[x][m]=+v[4];break}v[2]=="vtf"&&(p[x][m]=[p[x][m],B])}}}return f&&f.sheetRows&&(p=p.slice(0,f.sheetRows)),p}function n(u,f){return r0(r(u,f),f)}function s(u,f){return kA(n(u,f),f)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function A(u){if(!u||!u["!ref"])return"";for(var f=[],h=[],x,m="",g=ni(u["!ref"]),p=Array.isArray(u),v=g.s.r;v<=g.e.r;++v)for(var w=g.s.c;w<=g.e.c;++w)if(m=Ar({r:v,c:w}),x=p?(u[v]||[])[w]:u[m],!(!x||x.v==null||x.t==="z")){switch(h=["cell",m,"t"],x.t){case"s":case"str":h.push(t(x.v));break;case"n":x.f?(h[2]="vtf",h[3]="n",h[4]=x.v,h[5]=t(x.f)):(h[2]="v",h[3]=x.v);break;case"b":h[2]="vt"+(x.f?"f":"c"),h[3]="nl",h[4]=x.v?"1":"0",h[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var B=Ns(Bn(x.v));h[2]="vtc",h[3]="nd",h[4]=""+B,h[5]=x.w||po(x.z||ar[14],B);break;case"e":continue}f.push(h.join(":"))}return f.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function d(u){return[i,o,l,o,A(u),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}}(),Df=function(){function e(d,u,f,h,x){x.raw?u[f][h]=d:d===""||(d==="TRUE"?u[f][h]=!0:d==="FALSE"?u[f][h]=!1:isNaN(Ho(d))?isNaN(Uf(d).getDate())?u[f][h]=d:u[f][h]=Bn(d):u[f][h]=Ho(d))}function t(d,u){var f=u||{},h=[];if(!d||d.length===0)return h;for(var x=d.split(/[\r\n]/),m=x.length-1;m>=0&&x[m].length===0;)--m;for(var g=10,p=0,v=0;v<=m;++v)p=x[v].indexOf(" "),p==-1?p=x[v].length:p++,g=Math.max(g,p);for(v=0;v<=m;++v){h[v]=[];var w=0;for(e(x[v].slice(0,g).trim(),h,v,w,f),w=1;w<=(x[v].length-g)/10+1;++w)e(x[v].slice(g+(w-1)*10,g+w*10).trim(),h,v,w,f)}return f.sheetRows&&(h=h.slice(0,f.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var u={},f=!1,h=0,x=0;h<d.length;++h)(x=d.charCodeAt(h))==34?f=!f:!f&&x in r&&(u[x]=(u[x]||0)+1);x=[];for(h in u)Object.prototype.hasOwnProperty.call(u,h)&&x.push([u[h],h]);if(!x.length){u=n;for(h in u)Object.prototype.hasOwnProperty.call(u,h)&&x.push([u[h],h])}return x.sort(function(m,g){return m[0]-g[0]||n[m[1]]-n[g[1]]}),r[x.pop()[1]]||44}function i(d,u){var f=u||{},h="",x=f.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(h=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(h=d.charAt(4),d=d.slice(6)):h=s(d.slice(0,1024)):f&&f.FS?h=f.FS:h=s(d.slice(0,1024));var g=0,p=0,v=0,w=0,B=0,T=h.charCodeAt(0),_=!1,j=0,E=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var L=f.dateNF!=null?Wz(f.dateNF):null;function M(){var F=d.slice(w,B),D={};if(F.charAt(0)=='"'&&F.charAt(F.length-1)=='"'&&(F=F.slice(1,-1).replace(/""/g,'"')),F.length===0)D.t="z";else if(f.raw)D.t="s",D.v=F;else if(F.trim().length===0)D.t="s",D.v=F;else if(F.charCodeAt(0)==61)F.charCodeAt(1)==34&&F.charCodeAt(F.length-1)==34?(D.t="s",D.v=F.slice(2,-1).replace(/""/g,'"')):CZ(F)?(D.t="n",D.f=F.slice(1)):(D.t="s",D.v=F);else if(F=="TRUE")D.t="b",D.v=!0;else if(F=="FALSE")D.t="b",D.v=!1;else if(!isNaN(v=Ho(F)))D.t="n",f.cellText!==!1&&(D.w=F),D.v=v;else if(!isNaN(Uf(F).getDate())||L&&F.match(L)){D.z=f.dateNF||ar[14];var G=0;L&&F.match(L)&&(F=Xz(F,f.dateNF,F.match(L)||[]),G=1),f.cellDates?(D.t="d",D.v=Bn(F,G)):(D.t="n",D.v=Ns(Bn(F,G))),f.cellText!==!1&&(D.w=po(D.z,D.v instanceof Date?Ns(D.v):D.v)),f.cellNF||delete D.z}else D.t="s",D.v=F;if(D.t=="z"||(f.dense?(x[g]||(x[g]=[]),x[g][p]=D):x[Ar({c:p,r:g})]=D),w=B+1,E=d.charCodeAt(w),m.e.c<p&&(m.e.c=p),m.e.r<g&&(m.e.r=g),j==T)++p;else if(p=0,++g,f.sheetRows&&f.sheetRows<=g)return!0}e:for(;B<d.length;++B)switch(j=d.charCodeAt(B)){case 34:E===34&&(_=!_);break;case T:case 10:case 13:if(!_&&M())break e;break}return B-w>0&&M(),x["!ref"]=wr(m),x}function o(d,u){return!(u&&u.PRN)||u.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,u):r0(t(d,u),u)}function l(d,u){var f="",h=u.type=="string"?[0,0,0,0]:zC(d,u);switch(u.type){case"base64":f=ki(d);break;case"binary":f=d;break;case"buffer":u.codepage==65001?f=d.toString("utf8"):u.codepage&&typeof Kc<"u"?f=Kc.utils.decode(u.codepage,d):f=Cr&&Buffer.isBuffer(d)?d.toString("binary"):EA(d);break;case"array":f=kd(d);break;case"string":f=d;break;default:throw new Error("Unrecognized type "+u.type)}return h[0]==239&&h[1]==187&&h[2]==191?f=cn(f.slice(3)):u.type!="string"&&u.type!="buffer"&&u.codepage==65001?f=cn(f):u.type=="binary"&&typeof Kc<"u"&&u.codepage&&(f=Kc.utils.decode(u.codepage,Kc.utils.encode(28591,f))),f.slice(0,19)=="socialcalc:version:"?vL.to_sheet(u.type=="string"?f:cn(f),u):o(f,u)}function c(d,u){return kA(l(d,u),u)}function A(d){for(var u=[],f=Rr(d["!ref"]),h,x=Array.isArray(d),m=f.s.r;m<=f.e.r;++m){for(var g=[],p=f.s.c;p<=f.e.c;++p){var v=Ar({r:m,c:p});if(h=x?(d[m]||[])[p]:d[v],!h||h.v==null){g.push("          ");continue}for(var w=(h.w||(dc(h),h.w)||"").slice(0,10);w.length<10;)w+=" ";g.push(w+(p===0?" ":""))}u.push(g.join(""))}return u.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:A}}();function AY(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=gL.to_workbook(e,r);return r.WTF=n,s}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Df.to_workbook(e,t)}}var md=function(){function e(b,O,S){if(b){$s(b,b.l||0);for(var I=S.Enum||z;b.l<b.length;){var U=b.read_shift(2),Q=I[U]||I[65535],H=b.read_shift(2),X=b.l+H,V=Q.f&&Q.f(b,H,S);if(b.l=X,O(V,Q,U))return}}}function t(b,O){switch(O.type){case"base64":return r(gi(ki(b)),O);case"binary":return r(gi(b),O);case"buffer":case"array":return r(b,O)}throw"Unsupported type "+O.type}function r(b,O){if(!b)return b;var S=O||{},I=S.dense?[]:{},U="Sheet1",Q="",H=0,X={},V=[],Ae=[],W={s:{r:0,c:0},e:{r:0,c:0}},J=S.sheetRows||0;if(b[2]==0&&(b[3]==8||b[3]==9)&&b.length>=16&&b[14]==5&&b[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(b[2]==2)S.Enum=z,e(b,function(je,qe,He){switch(He){case 0:S.vers=je,je>=4096&&(S.qpro=!0);break;case 6:W=je;break;case 204:je&&(Q=je);break;case 222:Q=je;break;case 15:case 51:S.qpro||(je[1].v=je[1].v.slice(1));case 13:case 14:case 16:He==14&&(je[2]&112)==112&&(je[2]&15)>1&&(je[2]&15)<15&&(je[1].z=S.dateNF||ar[14],S.cellDates&&(je[1].t="d",je[1].v=fv(je[1].v))),S.qpro&&je[3]>H&&(I["!ref"]=wr(W),X[U]=I,V.push(U),I=S.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},H=je[3],U=Q||"Sheet"+(H+1),Q="");var Ze=S.dense?(I[je[0].r]||[])[je[0].c]:I[Ar(je[0])];if(Ze){Ze.t=je[1].t,Ze.v=je[1].v,je[1].z!=null&&(Ze.z=je[1].z),je[1].f!=null&&(Ze.f=je[1].f);break}S.dense?(I[je[0].r]||(I[je[0].r]=[]),I[je[0].r][je[0].c]=je[1]):I[Ar(je[0])]=je[1];break}},S);else if(b[2]==26||b[2]==14)S.Enum=ee,b[2]==14&&(S.qpro=!0,b.l=0),e(b,function(je,qe,He){switch(He){case 204:U=je;break;case 22:je[1].v=je[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(je[3]>H&&(I["!ref"]=wr(W),X[U]=I,V.push(U),I=S.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},H=je[3],U="Sheet"+(H+1)),J>0&&je[0].r>=J)break;S.dense?(I[je[0].r]||(I[je[0].r]=[]),I[je[0].r][je[0].c]=je[1]):I[Ar(je[0])]=je[1],W.e.c<je[0].c&&(W.e.c=je[0].c),W.e.r<je[0].r&&(W.e.r=je[0].r);break;case 27:je[14e3]&&(Ae[je[14e3][0]]=je[14e3][1]);break;case 1537:Ae[je[0]]=je[1],je[0]==H&&(U=je[1]);break}},S);else throw new Error("Unrecognized LOTUS BOF "+b[2]);if(I["!ref"]=wr(W),X[Q||U]=I,V.push(Q||U),!Ae.length)return{SheetNames:V,Sheets:X};for(var ve={},de=[],te=0;te<Ae.length;++te)X[V[te]]?(de.push(Ae[te]||V[te]),ve[Ae[te]]=X[Ae[te]]||X[V[te]]):(de.push(Ae[te]),ve[Ae[te]]={"!ref":"A1"});return{SheetNames:de,Sheets:ve}}function n(b,O){var S=O||{};if(+S.codepage>=0&&Oo(+S.codepage),S.type=="string")throw new Error("Cannot write WK1 to JS string");var I=Za(),U=Rr(b["!ref"]),Q=Array.isArray(b),H=[];kt(I,0,i(1030)),kt(I,6,c(U));for(var X=Math.min(U.e.r,8191),V=U.s.r;V<=X;++V)for(var Ae=is(V),W=U.s.c;W<=U.e.c;++W){V===U.s.r&&(H[W]=Dn(W));var J=H[W]+Ae,ve=Q?(b[V]||[])[W]:b[J];if(!(!ve||ve.t=="z"))if(ve.t=="n")(ve.v|0)==ve.v&&ve.v>=-32768&&ve.v<=32767?kt(I,13,h(V,W,ve.v)):kt(I,14,m(V,W,ve.v));else{var de=dc(ve);kt(I,15,u(V,W,de.slice(0,239)))}}return kt(I,1),I.end()}function s(b,O){var S=O||{};if(+S.codepage>=0&&Oo(+S.codepage),S.type=="string")throw new Error("Cannot write WK3 to JS string");var I=Za();kt(I,0,o(b));for(var U=0,Q=0;U<b.SheetNames.length;++U)(b.Sheets[b.SheetNames[U]]||{})["!ref"]&&kt(I,27,R(b.SheetNames[U],Q++));var H=0;for(U=0;U<b.SheetNames.length;++U){var X=b.Sheets[b.SheetNames[U]];if(!(!X||!X["!ref"])){for(var V=Rr(X["!ref"]),Ae=Array.isArray(X),W=[],J=Math.min(V.e.r,8191),ve=V.s.r;ve<=J;++ve)for(var de=is(ve),te=V.s.c;te<=V.e.c;++te){ve===V.s.r&&(W[te]=Dn(te));var je=W[te]+de,qe=Ae?(X[ve]||[])[te]:X[je];if(!(!qe||qe.t=="z"))if(qe.t=="n")kt(I,23,M(ve,te,H,qe.v));else{var He=dc(qe);kt(I,22,j(ve,te,H,He.slice(0,239)))}}++H}}return kt(I,1),I.end()}function i(b){var O=ot(2);return O.write_shift(2,b),O}function o(b){var O=ot(26);O.write_shift(2,4096),O.write_shift(2,4),O.write_shift(4,0);for(var S=0,I=0,U=0,Q=0;Q<b.SheetNames.length;++Q){var H=b.SheetNames[Q],X=b.Sheets[H];if(!(!X||!X["!ref"])){++U;var V=ni(X["!ref"]);S<V.e.r&&(S=V.e.r),I<V.e.c&&(I=V.e.c)}}return S>8191&&(S=8191),O.write_shift(2,S),O.write_shift(1,U),O.write_shift(1,I),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(1,1),O.write_shift(1,2),O.write_shift(4,0),O.write_shift(4,0),O}function l(b,O,S){var I={s:{c:0,r:0},e:{c:0,r:0}};return O==8&&S.qpro?(I.s.c=b.read_shift(1),b.l++,I.s.r=b.read_shift(2),I.e.c=b.read_shift(1),b.l++,I.e.r=b.read_shift(2),I):(I.s.c=b.read_shift(2),I.s.r=b.read_shift(2),O==12&&S.qpro&&(b.l+=2),I.e.c=b.read_shift(2),I.e.r=b.read_shift(2),O==12&&S.qpro&&(b.l+=2),I.s.c==65535&&(I.s.c=I.e.c=I.s.r=I.e.r=0),I)}function c(b){var O=ot(8);return O.write_shift(2,b.s.c),O.write_shift(2,b.s.r),O.write_shift(2,b.e.c),O.write_shift(2,b.e.r),O}function A(b,O,S){var I=[{c:0,r:0},{t:"n",v:0},0,0];return S.qpro&&S.vers!=20768?(I[0].c=b.read_shift(1),I[3]=b.read_shift(1),I[0].r=b.read_shift(2),b.l+=2):(I[2]=b.read_shift(1),I[0].c=b.read_shift(2),I[0].r=b.read_shift(2)),I}function d(b,O,S){var I=b.l+O,U=A(b,O,S);if(U[1].t="s",S.vers==20768){b.l++;var Q=b.read_shift(1);return U[1].v=b.read_shift(Q,"utf8"),U}return S.qpro&&b.l++,U[1].v=b.read_shift(I-b.l,"cstr"),U}function u(b,O,S){var I=ot(7+S.length);I.write_shift(1,255),I.write_shift(2,O),I.write_shift(2,b),I.write_shift(1,39);for(var U=0;U<I.length;++U){var Q=S.charCodeAt(U);I.write_shift(1,Q>=128?95:Q)}return I.write_shift(1,0),I}function f(b,O,S){var I=A(b,O,S);return I[1].v=b.read_shift(2,"i"),I}function h(b,O,S){var I=ot(7);return I.write_shift(1,255),I.write_shift(2,O),I.write_shift(2,b),I.write_shift(2,S,"i"),I}function x(b,O,S){var I=A(b,O,S);return I[1].v=b.read_shift(8,"f"),I}function m(b,O,S){var I=ot(13);return I.write_shift(1,255),I.write_shift(2,O),I.write_shift(2,b),I.write_shift(8,S,"f"),I}function g(b,O,S){var I=b.l+O,U=A(b,O,S);if(U[1].v=b.read_shift(8,"f"),S.qpro)b.l=I;else{var Q=b.read_shift(2);B(b.slice(b.l,b.l+Q),U),b.l+=Q}return U}function p(b,O,S){var I=O&32768;return O&=-32769,O=(I?b:0)+(O>=8192?O-16384:O),(I?"":"$")+(S?Dn(O):is(O))}var v={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function B(b,O){$s(b,0);for(var S=[],I=0,U="",Q="",H="",X="";b.l<b.length;){var V=b[b.l++];switch(V){case 0:S.push(b.read_shift(8,"f"));break;case 1:Q=p(O[0].c,b.read_shift(2),!0),U=p(O[0].r,b.read_shift(2),!1),S.push(Q+U);break;case 2:{var Ae=p(O[0].c,b.read_shift(2),!0),W=p(O[0].r,b.read_shift(2),!1);Q=p(O[0].c,b.read_shift(2),!0),U=p(O[0].r,b.read_shift(2),!1),S.push(Ae+W+":"+Q+U)}break;case 3:if(b.l<b.length){console.error("WK1 premature formula end");return}break;case 4:S.push("("+S.pop()+")");break;case 5:S.push(b.read_shift(2));break;case 6:{for(var J="";V=b[b.l++];)J+=String.fromCharCode(V);S.push('"'+J.replace(/"/g,'""')+'"')}break;case 8:S.push("-"+S.pop());break;case 23:S.push("+"+S.pop());break;case 22:S.push("NOT("+S.pop()+")");break;case 20:case 21:X=S.pop(),H=S.pop(),S.push(["AND","OR"][V-20]+"("+H+","+X+")");break;default:if(V<32&&w[V])X=S.pop(),H=S.pop(),S.push(H+w[V]+X);else if(v[V]){if(I=v[V][1],I==69&&(I=b[b.l++]),I>S.length){console.error("WK1 bad formula parse 0x"+V.toString(16)+":|"+S.join("|")+"|");return}var ve=S.slice(-I);S.length-=I,S.push(v[V][0]+"("+ve.join(",")+")")}else return V<=7?console.error("WK1 invalid opcode "+V.toString(16)):V<=24?console.error("WK1 unsupported op "+V.toString(16)):V<=30?console.error("WK1 invalid opcode "+V.toString(16)):V<=115?console.error("WK1 unsupported function opcode "+V.toString(16)):console.error("WK1 unrecognized opcode "+V.toString(16))}}S.length==1?O[1].f=""+S[0]:console.error("WK1 bad formula parse |"+S.join("|")+"|")}function T(b){var O=[{c:0,r:0},{t:"n",v:0},0];return O[0].r=b.read_shift(2),O[3]=b[b.l++],O[0].c=b[b.l++],O}function _(b,O){var S=T(b);return S[1].t="s",S[1].v=b.read_shift(O-4,"cstr"),S}function j(b,O,S,I){var U=ot(6+I.length);U.write_shift(2,b),U.write_shift(1,S),U.write_shift(1,O),U.write_shift(1,39);for(var Q=0;Q<I.length;++Q){var H=I.charCodeAt(Q);U.write_shift(1,H>=128?95:H)}return U.write_shift(1,0),U}function E(b,O){var S=T(b);S[1].v=b.read_shift(2);var I=S[1].v>>1;if(S[1].v&1)switch(I&7){case 0:I=(I>>3)*5e3;break;case 1:I=(I>>3)*500;break;case 2:I=(I>>3)/20;break;case 3:I=(I>>3)/200;break;case 4:I=(I>>3)/2e3;break;case 5:I=(I>>3)/2e4;break;case 6:I=(I>>3)/16;break;case 7:I=(I>>3)/64;break}return S[1].v=I,S}function L(b,O){var S=T(b),I=b.read_shift(4),U=b.read_shift(4),Q=b.read_shift(2);if(Q==65535)return I===0&&U===3221225472?(S[1].t="e",S[1].v=15):I===0&&U===3489660928?(S[1].t="e",S[1].v=42):S[1].v=0,S;var H=Q&32768;return Q=(Q&32767)-16446,S[1].v=(1-H*2)*(U*Math.pow(2,Q+32)+I*Math.pow(2,Q)),S}function M(b,O,S,I){var U=ot(14);if(U.write_shift(2,b),U.write_shift(1,S),U.write_shift(1,O),I==0)return U.write_shift(4,0),U.write_shift(4,0),U.write_shift(2,65535),U;var Q=0,H=0,X=0,V=0;return I<0&&(Q=1,I=-I),H=Math.log2(I)|0,I/=Math.pow(2,H-31),V=I>>>0,V&2147483648||(I/=2,++H,V=I>>>0),I-=V,V|=2147483648,V>>>=0,I*=Math.pow(2,32),X=I>>>0,U.write_shift(4,X),U.write_shift(4,V),H+=16383+(Q?32768:0),U.write_shift(2,H),U}function F(b,O){var S=L(b);return b.l+=O-14,S}function D(b,O){var S=T(b),I=b.read_shift(4);return S[1].v=I>>6,S}function G(b,O){var S=T(b),I=b.read_shift(8,"f");return S[1].v=I,S}function K(b,O){var S=G(b);return b.l+=O-10,S}function ae(b,O){return b[b.l+O-1]==0?b.read_shift(O,"cstr"):""}function Z(b,O){var S=b[b.l++];S>O-1&&(S=O-1);for(var I="";I.length<S;)I+=String.fromCharCode(b[b.l++]);return I}function oe(b,O,S){if(!(!S.qpro||O<21)){var I=b.read_shift(1);b.l+=17,b.l+=1,b.l+=2;var U=b.read_shift(O-21,"cstr");return[I,U]}}function Y(b,O){for(var S={},I=b.l+O;b.l<I;){var U=b.read_shift(2);if(U==14e3){for(S[U]=[0,""],S[U][0]=b.read_shift(2);b[b.l];)S[U][1]+=String.fromCharCode(b[b.l]),b.l++;b.l++}}return S}function R(b,O){var S=ot(5+b.length);S.write_shift(2,14e3),S.write_shift(2,O);for(var I=0;I<b.length;++I){var U=b.charCodeAt(I);S[S.l++]=U>127?95:U}return S[S.l++]=0,S}var z={0:{n:"BOF",f:hs},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ae},222:{n:"SHEETNAMELP",f:Z},65535:{n:""}},ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:_},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:E},25:{n:"FORMULA19",f:F},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Y},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:G},40:{n:"FORMULA28",f:K},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ae},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}();function dY(e){var t={},r=e.match(ba),n=0,s=!1;if(r)for(;n!=r.length;++n){var i=dr(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=AC[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return t}var uY=function(){var e=gm("t"),t=gm("rPr");function r(i){var o=i.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:Or(o[1])},c=i.match(t);return c&&(l.s=dY(c[1])),l}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(s).map(r).filter(function(l){return l.v})}}(),fY=function(){var t=/(\r\n|\n)/g;function r(s,i,o){var l=[];s.u&&l.push("text-decoration: underline;"),s.uval&&l.push("text-underline-style:"+s.uval+";"),s.sz&&l.push("font-size:"+s.sz+"pt;"),s.outline&&l.push("text-effect: outline;"),s.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),s.b&&(i.push("<b>"),o.push("</b>")),s.i&&(i.push("<i>"),o.push("</i>")),s.strike&&(i.push("<s>"),o.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),s}function n(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),hY=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,mY=/<(?:\w+:)?r>/,pY=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function LC(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Or(cn(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=cn(e),r&&(n.h=vC(n.t))):e.match(mY)&&(n.r=cn(e),n.t=Or(cn((e.replace(pY,"").match(hY)||[]).join("").replace(ba,""))),r&&(n.h=fY(uY(n.r)))),n):{t:""}}var xY=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,gY=/<(?:\w+:)?(?:si|sstItem)>/g,yY=/<\/(?:\w+:)?(?:si|sstItem)>/;function vY(e,t){var r=[],n="";if(!e)return r;var s=e.match(xY);if(s){n=s[2].replace(gY,"").split(yY);for(var i=0;i!=n.length;++i){var o=LC(n[i].trim(),t);o!=null&&(r[r.length]=o)}s=dr(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var wY=/^\s|\s$|[\t\n\r]/;function wL(e,t){if(!t.bookSST)return"";var r=[os];r[r.length]=Ft("sst",null,{xmlns:Hd[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(wY)&&(i+=' xml:space="preserve"'),i+=">"+nn(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function bY(e){return[e.read_shift(4),e.read_shift(4)]}function NY(e,t){var r=[],n=!1;return pc(e,function(i,o,l){switch(l){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function CY(e,t){return t||(t=ot(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var jY=UG;function BY(e){var t=Za();pt(t,159,CY(e));for(var r=0;r<e.length;++r)pt(t,19,jY(e[r]));return pt(t,160),t.end()}function bL(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function rc(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function SY(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=rc(e,4),t.U=rc(e,4),t.W=rc(e,4),t}function FY(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),i=[];s-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function EY(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(FY(e));return t}function kY(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function TY(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=rc(e,4),t.U=rc(e,4),t.W=rc(e,4),t}function _Y(e){var t=TY(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function NL(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function CL(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function IY(e){var t=rc(e);switch(t.Minor){case 2:return[t.Minor,LY(e)];case 3:return[t.Minor,UY()];case 4:return[t.Minor,DY(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function LY(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=NL(e,r),s=CL(e,e.length-e.l);return{t:"Std",h:n,v:s}}function UY(){throw new Error("File is password-protected: ECMA-376 Extensible")}function DY(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(ba,function(i){var o=dr(i);switch(Nl(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function PY(e,t){var r={},n=r.EncryptionVersionInfo=rc(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=NL(e,s),t-=s,r.EncryptionVerifier=CL(e,t),r}function OY(e){var t={},r=t.EncryptionVersionInfo=rc(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function UC(e){var t=0,r,n=bL(e),s=n.length+1,i,o,l,c,A;for(r=gA(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)o=r[i],l=t&16384?1:0,c=t<<1&32767,A=l|c,t=A^o;return t^52811}var jL=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},s=function(o,l){return n(o^l)},i=function(o){for(var l=t[o.length-1],c=104,A=o.length-1;A>=0;--A)for(var d=o[A],u=0;u!=7;++u)d&64&&(l^=r[c]),d*=2,--c;return l};return function(o){for(var l=bL(o),c=i(l),A=l.length,d=gA(16),u=0;u!=16;++u)d[u]=0;var f,h,x;for((A&1)===1&&(f=c>>8,d[A]=s(e[0],f),--A,f=c&255,h=l[l.length-1],d[A]=s(h,f));A>0;)--A,f=c>>8,d[A]=s(l[A],f),--A,f=c&255,d[A]=s(l[A],f);for(A=15,x=15-l.length;x>0;)f=c>>8,d[A]=s(e[x],f),--A,--x,f=c&255,d[A]=s(l[A],f),--A,--x;return d}}(),RY=function(e,t,r,n,s){s||(s=t),n||(n=jL(e));var i,o;for(i=0;i!=t.length;++i)o=t[i],o^=n[r],o=(o>>5|o<<3)&255,s[i]=o,++r;return[s,r,n]},QY=function(e){var t=0,r=jL(e);return function(n){var s=RY("",n,t,r);return t=s[1],s[0]}};function MY(e,t,r,n){var s={key:hs(e),verificationBytes:hs(e)};return r.password&&(s.verifier=UC(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=QY(r.password)),s}function HY(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=OY(e):n.Data=PY(e,t),n}function VY(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?HY(e,t-2,n):MY(e,r.biff>=8?t:t-2,r,n),n}var BL=function(){function e(s,i){switch(i.type){case"base64":return t(ki(s),i);case"binary":return t(s,i);case"buffer":return t(Cr&&Buffer.isBuffer(s)?s.toString("binary"):EA(s),i);case"array":return t(kd(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){var o=i||{},l=o.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var A={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,u){Array.isArray(l)&&(l[u]=[]);for(var f=/\\\w+\b/g,h=0,x,m=-1;x=f.exec(d);){switch(x[0]){case"\\cell":var g=d.slice(h,f.lastIndex-x[0].length);if(g[0]==" "&&(g=g.slice(1)),++m,g.length){var p={v:g,t:"s"};Array.isArray(l)?l[u][m]=p:l[Ar({r:u,c:m})]=p}break}h=f.lastIndex}m>A.e.c&&(A.e.c=m)}),l["!ref"]=wr(A),l}function r(s,i){return kA(e(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],o=Rr(s["!ref"]),l,c=Array.isArray(s),A=o.s.r;A<=o.e.r;++A){i.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var u=Ar({r:A,c:d});l=c?(s[A]||[])[d]:s[u],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(dc(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function $Y(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function bm(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function qY(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),i=Math.min(t,r,n),o=s-i;if(o===0)return[0,0,t];var l=0,c=0,A=s+i;switch(c=o/(A>1?2-A:A),s){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4;break}return[l/6,c,A/2]}function KY(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),i=n-s/2,o=[i,i,i],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=s*l,o[0]+=s,o[1]+=c;break;case 1:c=s*(2-l),o[0]+=c,o[1]+=s;break;case 2:c=s*(l-2),o[1]+=s,o[2]+=c;break;case 3:c=s*(4-l),o[1]+=c,o[2]+=s;break;case 4:c=s*(l-4),o[2]+=s,o[0]+=c;break;case 5:c=s*(6-l),o[2]+=c,o[0]+=s;break}for(var A=0;A!=3;++A)o[A]=Math.round(o[A]*255);return o}function K1(e,t){if(t===0)return e;var r=qY($Y(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),bm(KY(r))}var SL=6,zY=15,GY=1,ha=SL;function Nm(e){return Math.floor((e+Math.round(128/ha)/256)*ha)}function Cm(e){return Math.floor((e-5)/ha*100+.5)/100}function z1(e){return Math.round((e*ha+5)/ha*256)/256}function Nw(e){return z1(Cm(Nm(e)))}function DC(e){var t=Math.abs(e-Nw(e)),r=ha;if(t>.005)for(ha=GY;ha<zY;++ha)Math.abs(e-Nw(e))<=t&&(t=Math.abs(e-Nw(e)),r=ha);ha=r}function yA(e){e.width?(e.wpx=Nm(e.width),e.wch=Cm(e.wpx),e.MDW=ha):e.wpx?(e.wch=Cm(e.wpx),e.width=z1(e.wch),e.MDW=ha):typeof e.wch=="number"&&(e.width=z1(e.wch),e.wpx=Nm(e.width),e.MDW=ha),e.customWidth&&delete e.customWidth}var WY=96,FL=WY;function jm(e){return e*96/FL}function Pf(e){return e*FL/96}var XY={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function YY(e,t,r,n){t.Borders=[];var s={},i=!1;(e[0].match(ba)||[]).forEach(function(o){var l=dr(o);switch(Nl(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},l.diagonalUp&&(s.diagonalUp=Nn(l.diagonalUp)),l.diagonalDown&&(s.diagonalDown=Nn(l.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function JY(e,t,r,n){t.Fills=[];var s={},i=!1;(e[0].match(ba)||[]).forEach(function(o){var l=dr(o);switch(Nl(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":l.patternType&&(s.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),l.indexed&&(s.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(s.bgColor.theme=parseInt(l.theme,10)),l.tint&&(s.bgColor.tint=parseFloat(l.tint)),l.rgb&&(s.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),l.theme&&(s.fgColor.theme=parseInt(l.theme,10)),l.tint&&(s.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(s.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function ZY(e,t,r,n){t.Fonts=[];var s={},i=!1;(e[0].match(ba)||[]).forEach(function(o){var l=dr(o);switch(Nl(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":l.val&&(s.name=cn(l.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=l.val?Nn(l.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=l.val?Nn(l.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(l.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=l.val?Nn(l.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=l.val?Nn(l.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=l.val?Nn(l.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=l.val?Nn(l.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=l.val?Nn(l.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":l.val&&(s.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(s.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(s.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(s.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=AC[parseInt(l.val,10)];break;case"<color":if(s.color||(s.color={}),l.auto&&(s.color.auto=Nn(l.auto)),l.rgb)s.color.rgb=l.rgb.slice(-6);else if(l.indexed){s.color.index=parseInt(l.indexed,10);var c=fd[s.color.index];s.color.index==81&&(c=fd[1]),c||(c=fd[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(s.color.theme=parseInt(l.theme,10),l.tint&&(s.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=K1(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function eJ(e,t,r){t.NumberFmt=[];for(var n=Gn(ar),s=0;s<n.length;++s)t.NumberFmt[n[s]]=ar[n[s]];var i=e[0].match(ba);if(i)for(s=0;s<i.length;++s){var o=dr(i[s]);switch(Nl(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=Or(cn(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}tc(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function tJ(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Ft("numFmt",null,{numFmtId:n,formatCode:nn(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ft("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Ux=["numFmtId","fillId","fontId","borderId","xfId"],Dx=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function rJ(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(ba)||[]).forEach(function(i){var o=dr(i),l=0;switch(Nl(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<Ux.length;++l)n[Ux[l]]&&(n[Ux[l]]=parseInt(n[Ux[l]],10));for(l=0;l<Dx.length;++l)n[Dx[l]]&&(n[Dx[l]]=Nn(n[Dx[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=Nn(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function nJ(e){var t=[];return t[t.length]=Ft("cellXfs",null),e.forEach(function(r){t[t.length]=Ft("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ft("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var sJ=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,A){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var u;return(u=l.match(t))&&eJ(u,d,A),(u=l.match(s))&&ZY(u,d,c,A),(u=l.match(n))&&JY(u,d,c,A),(u=l.match(i))&&YY(u,d,c,A),(u=l.match(r))&&rJ(u,d,A),d}}();function EL(e,t){var r=[os,Ft("styleSheet",null,{xmlns:Hd[0],"xmlns:vt":ws.vt})],n;return e.SSF&&(n=tJ(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=nJ(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function aJ(e,t){var r=e.read_shift(2),n=ga(e);return[r,n]}function iJ(e,t,r){r||(r=ot(6+4*t.length)),r.write_shift(2,e),Is(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function oJ(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=HG(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=MG(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=ga(e),n}function lJ(e,t){t||(t=ot(25+4*32)),t.write_shift(2,e.sz*20),VG(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),V1(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),Is(e.name,t),t.length>t.l?t.slice(0,t.l):t}var cJ=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Cw,AJ=va;function AF(e,t){t||(t=ot(4*3+8*7+16*1)),Cw||(Cw=dv(cJ));var r=Cw[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(V1({auto:1},t),V1({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function dJ(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function kL(e,t,r){r||(r=ot(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function W0(e,t){return t||(t=ot(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var uJ=va;function fJ(e,t){return t||(t=ot(51)),t.write_shift(1,0),W0(null,t),W0(null,t),W0(null,t),W0(null,t),W0(null,t),t.length>t.l?t.slice(0,t.l):t}function hJ(e,t){return t||(t=ot(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),H1(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function mJ(e,t,r){var n=ot(2052);return n.write_shift(4,e),H1(t,n),H1(r,n),n.length>n.l?n.slice(0,n.l):n}function pJ(e,t,r){var n={};n.NumberFmt=[];for(var s in ar)n.NumberFmt[s]=ar[s];n.CellXf=[],n.Fonts=[];var i=[],o=!1;return pc(e,function(c,A,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],tc(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=K1(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(d),o=!0;break;case 38:i.pop(),o=!1;break;default:if(A.T>0)i.push(d);else if(A.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function xJ(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(pt(e,615,Vo(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&pt(e,44,iJ(s,t[s]))}),pt(e,616))}}function gJ(e){var t=1;pt(e,611,Vo(t)),pt(e,43,lJ({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),pt(e,612)}function yJ(e){var t=2;pt(e,603,Vo(t)),pt(e,45,AF({patternType:"none"})),pt(e,45,AF({patternType:"gray125"})),pt(e,604)}function vJ(e){var t=1;pt(e,613,Vo(t)),pt(e,46,fJ()),pt(e,614)}function wJ(e){var t=1;pt(e,626,Vo(t)),pt(e,47,kL({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),pt(e,627)}function bJ(e,t){pt(e,617,Vo(t.length)),t.forEach(function(r){pt(e,47,kL(r,0))}),pt(e,618)}function NJ(e){var t=1;pt(e,619,Vo(t)),pt(e,48,hJ({xfId:0,builtinId:0,name:"Normal"})),pt(e,620)}function CJ(e){var t=0;pt(e,505,Vo(t)),pt(e,506)}function jJ(e){var t=0;pt(e,508,mJ(t,"TableStyleMedium9","PivotStyleMedium4")),pt(e,509)}function BJ(e,t){var r=Za();return pt(r,278),xJ(r,e.SSF),gJ(r),yJ(r),vJ(r),wJ(r),bJ(r,t.cellXfs),NJ(r),CJ(r),jJ(r),pt(r,279),r.end()}var SJ=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function FJ(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(ba)||[]).forEach(function(s){var i=dr(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[SJ.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function EJ(){}function kJ(){}var TJ=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,_J=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,IJ=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function LJ(e,t,r){t.themeElements={};var n;[["clrScheme",TJ,FJ],["fontScheme",_J,EJ],["fmtScheme",IJ,kJ]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var UJ=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function TL(e,t){(!e||e.length===0)&&(e=PC());var r,n={};if(!(r=e.match(UJ)))throw new Error("themeElements not found in theme");return LJ(r[0],n,t),n.raw=e,n}function PC(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[os];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function DJ(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var o;try{o=N8(i,{type:"array"})}catch{return}var l=yi(o,"theme/theme/theme1.xml",!0);if(l)return TL(l,r)}}function PJ(e){return e.read_shift(4)}function OJ(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=RJ(e,4);break;case 2:t.xclrValue=AL(e);break;case 3:t.xclrValue=PJ(e);break;case 4:e.l+=4;break}return e.l+=8,t}function RJ(e,t){return va(e,t)}function QJ(e,t){return va(e,t)}function MJ(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=OJ(e);break;case 6:n[1]=QJ(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function HJ(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),i=[];s-- >0;)i.push(MJ(e,r-e.l));return{ixfe:n,ext:i}}function VJ(e,t){t.forEach(function(r){switch(r[0]){}})}function $J(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ga(e)}}function qJ(e){var t=ot(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Is(e.name,t),t.slice(0,t.l)}function KJ(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function zJ(e){var t=ot(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function GJ(e,t){var r=ot(8+2*t.length);return r.write_shift(4,e),Is(t,r),r.slice(0,r.l)}function WJ(e){return e.l+=4,e.read_shift(4)!=0}function XJ(e,t){var r=ot(8);return r.write_shift(4,e),r.write_shift(4,1),r}function YJ(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},i=[],o=!1,l=2;return pc(e,function(c,A,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(u){l==1?n.Cell.push({type:n.Types[u[0]-1].name,index:u[1]}):l==0&&n.Value.push({type:n.Types[u[0]-1].name,index:u[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:i.push(d),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!A.T){if(!o||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function JJ(){var e=Za();return pt(e,332),pt(e,334,Vo(1)),pt(e,335,qJ({name:"XLDAPR",version:12e4,flags:3496657072})),pt(e,336),pt(e,339,GJ(1,"XLDAPR")),pt(e,52),pt(e,35,Vo(514)),pt(e,4096,Vo(0)),pt(e,4097,eo(1)),pt(e,36),pt(e,53),pt(e,340),pt(e,337,XJ(1)),pt(e,51,zJ([[1,0]])),pt(e,338),pt(e,333),e.end()}function ZJ(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,i=2,o;return e.replace(ba,function(l){var c=dr(l);switch(Nl(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var A=0;A<n.Types.length;++A)n.Types[A].name==c.name&&(o=n.Types[A]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):i==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function _L(){var e=[os];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function eZ(e){var t=[];if(!e)return t;var r=1;return(e.match(ba)||[]).forEach(function(n){var s=dr(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function tZ(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ar(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function rZ(e,t,r){var n=[];return pc(e,function(i,o,l){switch(l){case 63:n.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function nZ(e,t,r,n){if(!e)return e;var s=n||{},i=!1;pc(e,function(l,c,A){switch(A){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}},s)}function sZ(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var sf=1024;function IL(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Ft("xml",null,{"xmlns:v":pi.v,"xmlns:o":pi.o,"xmlns:x":pi.x,"xmlns:mv":pi.mv}).replace(/\/>/,">"),Ft("o:shapelayout",Ft("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ft("v:shapetype",[Ft("v:stroke",null,{joinstyle:"miter"}),Ft("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];sf<e*1e3;)sf+=1e3;return t.forEach(function(i){var o=Pn(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?Ft("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,A=Ft("v:fill",c,l),d={on:"t",obscured:"t"};++sf,s=s.concat(["<v:shape"+ym({id:"_x0000_s"+sf,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",A,Ft("v:shadow",null,d),Ft("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ks("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Ks("x:AutoFill","False"),Ks("x:Row",String(o.r)),Ks("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function dF(e,t,r,n){var s=Array.isArray(e),i;t.forEach(function(o){var l=Pn(o.ref);if(s?(e[l.r]||(e[l.r]=[]),i=e[l.r][l.c]):i=e[o.ref],!i){i={t:"z"},s?e[l.r][l.c]=i:e[o.ref]=i;var c=Rr(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var A=wr(c);A!==e["!ref"]&&(e["!ref"]=A)}i.c||(i.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var u=i.c.length-1;u>=0;--u){if(!r&&i.c[u].T)return;r&&!i.c[u].T&&i.c.splice(u,1)}if(r&&n){for(u=0;u<n.length;++u)if(d.a==n[u].id){d.a=n[u].name||d.a;break}}i.c.push(d)})}function aZ(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=dr(l[0]),A={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=Pn(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var u=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!u&&!!u[1]&&LC(u[1])||{r:"",t:"",h:""};A.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),A.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(A.h=f.h),n.push(A)}}}}),n}function LL(e){var t=[os,Ft("comments",null,{xmlns:Hd[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var i=nn(s.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(nn(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),i.length<=1)t.push(Ks("t",nn(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)o+=`Reply:
    `+i[l]+`
`;t.push(Ks("t",nn(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function iZ(e,t){var r=[],n=!1,s={},i=0;return e.replace(ba,function(l,c){var A=dr(l);switch(Nl(A[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:A.personId,guid:A.id,ref:A.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=c+l.length;break;case"</text>":s.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+A[0]+" in threaded comments")}return l}),r}function oZ(e,t,r){var n=[os,Ft("ThreadedComments",null,{xmlns:ws.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var i="";(s[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(Ft("threadedComment",Ks("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function lZ(e,t){var r=[],n=!1;return e.replace(ba,function(i){var o=dr(i);switch(Nl(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function cZ(e){var t=[os,Ft("personList",null,{xmlns:ws.TCMNT,"xmlns:x":Hd[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Ft("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function AZ(e){var t={};t.iauthor=e.read_shift(4);var r=Kd(e);return t.rfx=r.s,t.ref=Ar(r.s),e.l+=16,t}function dZ(e,t){return t==null&&(t=ot(36)),t.write_shift(4,e[1].iauthor),n0(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var uZ=ga;function fZ(e){return Is(e.slice(0,54))}function hZ(e,t){var r=[],n=[],s={},i=!1;return pc(e,function(l,c,A){switch(A){case 632:n.push(l);break;case 635:s=l;break;case 637:s.t=l.t,s.h=l.h,s.r=l.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}}),r}function mZ(e){var t=Za(),r=[];return pt(t,628),pt(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),pt(t,632,fZ(s.a)))})}),pt(t,631),pt(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:Pn(n[0]),e:Pn(n[0])};pt(t,635,dZ([i,s])),s.t&&s.t.length>0&&pt(t,637,PG(s)),pt(t,636),delete s.iauthor})}),pt(t,634),pt(t,629),t.end()}var pZ="application/vnd.ms-office.vbaProject";function xZ(e){var t=Jt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Jt.utils.cfb_add(t,s,e.FileIndex[n].content)}}),Jt.write(t)}function gZ(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Jt.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var UL=["xlsb","xlsm","xlam","biff8","xla"];function yZ(){return{"!type":"dialog"}}function vZ(){return{"!type":"dialog"}}function wZ(){return{"!type":"macro"}}function bZ(){return{"!type":"macro"}}var pf=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,i,o){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var A=i.length>0?parseInt(i,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=t.c:--d,c?A+=t.r:--A,s+(l?"":"$")+Dn(d)+(c?"":"$")+is(A)}return function(s,i){return t=i,s.replace(e,r)}}(),OC=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,RC=function(){return function(t,r){return t.replace(OC,function(n,s,i,o,l,c){var A=jC(o)-(i?0:r.c),d=CC(c)-(l?0:r.r),u=d==0?"":l?d+1:"["+d+"]",f=A==0?"":i?A+1:"["+A+"]";return s+"R"+u+"C"+f})}}();function DL(e,t){return e.replace(OC,function(r,n,s,i,o,l){return n+(s=="$"?s+i:Dn(jC(i)+t.c))+(o=="$"?o+l:is(CC(l)+t.r))})}function NZ(e,t,r){var n=ni(t),s=n.s,i=Pn(r),o={r:i.r-s.r,c:i.c-s.c};return DL(e,o)}function CZ(e){return e.length!=1}function uF(e){return e.replace(/_xlfn\./g,"")}function us(e){e.l+=1}function vA(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function PL(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return OL(e);r.biff==12&&(n=4)}var s=e.read_shift(n),i=e.read_shift(n),o=vA(e),l=vA(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function OL(e){var t=vA(e),r=vA(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function jZ(e,t,r){if(r.biff<8)return OL(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),i=vA(e),o=vA(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function RL(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return BZ(e);var n=e.read_shift(r&&r.biff==12?4:2),s=vA(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function BZ(e){var t=vA(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function SZ(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function FZ(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return EZ(e);var s=e.read_shift(n>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;s>524287;)s-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:o,rRel:l}}function EZ(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function kZ(e,t,r){var n=(e[e.l++]&96)>>5,s=PL(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function TZ(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=PL(e,i,r);return[n,s,o]}function _Z(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function IZ(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,s]}function LZ(e,t,r){var n=(e[e.l++]&96)>>5,s=jZ(e,t-1,r);return[n,s]}function UZ(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function fF(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function DZ(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function PZ(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function OZ(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function RZ(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function QZ(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function QL(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function MZ(e){return e.read_shift(2),QL(e)}function HZ(e){return e.read_shift(2),QL(e)}function VZ(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=RL(e,0,r);return[n,s]}function $Z(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=FZ(e,0,r);return[n,s]}function qZ(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=RL(e,0,r);return[n,s,i]}function KZ(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[Wee[s],VL[s],n]}function zZ(e,t,r){var n=e[e.l++],s=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:GZ(e);return[s,(i[0]===0?VL:Gee)[i[1]]]}function GZ(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function WZ(e,t,r){e.l+=r&&r.biff==2?3:4}function XZ(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function YZ(e){return e.l++,xc[e.read_shift(1)]}function JZ(e){return e.l++,e.read_shift(2)}function ZZ(e){return e.l++,e.read_shift(1)!==0}function eee(e){return e.l++,pa(e)}function tee(e,t,r){return e.l++,sp(e,t-1,r)}function ree(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Jn(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=xc[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=pa(e);break;case 2:r[1]=zd(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function nee(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?Kd:hv)(e));return s}function see(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var l=0;l!=s;++l)o[i][l]=ree(e,r.biff);return o}function aee(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function iee(e,t,r){if(r.biff==5)return oee(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),i=e.read_shift(4);return[n,s,i]}function oee(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function lee(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function cee(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function Aee(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function dee(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,s]}var uee=va,fee=va,hee=va;function ip(e,t,r){return e.l+=2,[SZ(e)]}function QC(e){return e.l+=6,[]}var mee=ip,pee=QC,xee=QC,gee=ip;function ML(e){return e.l+=2,[hs(e),e.read_shift(2)&1]}var yee=ip,vee=ML,wee=QC,bee=ip,Nee=ip,Cee=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function jee(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),i=e.read_shift(2),o=Cee[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:s,C:i}}function Bee(e){return e.l+=2,[e.read_shift(4)]}function See(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Fee(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Eee(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function kee(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Tee(e){return e.l+=4,[0,0]}var hF={1:{n:"PtgExp",f:XZ},2:{n:"PtgTbl",f:hee},3:{n:"PtgAdd",f:us},4:{n:"PtgSub",f:us},5:{n:"PtgMul",f:us},6:{n:"PtgDiv",f:us},7:{n:"PtgPower",f:us},8:{n:"PtgConcat",f:us},9:{n:"PtgLt",f:us},10:{n:"PtgLe",f:us},11:{n:"PtgEq",f:us},12:{n:"PtgGe",f:us},13:{n:"PtgGt",f:us},14:{n:"PtgNe",f:us},15:{n:"PtgIsect",f:us},16:{n:"PtgUnion",f:us},17:{n:"PtgRange",f:us},18:{n:"PtgUplus",f:us},19:{n:"PtgUminus",f:us},20:{n:"PtgPercent",f:us},21:{n:"PtgParen",f:us},22:{n:"PtgMissArg",f:us},23:{n:"PtgStr",f:tee},26:{n:"PtgSheet",f:See},27:{n:"PtgEndSheet",f:Fee},28:{n:"PtgErr",f:YZ},29:{n:"PtgBool",f:ZZ},30:{n:"PtgInt",f:JZ},31:{n:"PtgNum",f:eee},32:{n:"PtgArray",f:UZ},33:{n:"PtgFunc",f:KZ},34:{n:"PtgFuncVar",f:zZ},35:{n:"PtgName",f:aee},36:{n:"PtgRef",f:VZ},37:{n:"PtgArea",f:kZ},38:{n:"PtgMemArea",f:lee},39:{n:"PtgMemErr",f:uee},40:{n:"PtgMemNoMem",f:fee},41:{n:"PtgMemFunc",f:cee},42:{n:"PtgRefErr",f:Aee},43:{n:"PtgAreaErr",f:_Z},44:{n:"PtgRefN",f:$Z},45:{n:"PtgAreaN",f:LZ},46:{n:"PtgMemAreaN",f:Eee},47:{n:"PtgMemNoMemN",f:kee},57:{n:"PtgNameX",f:iee},58:{n:"PtgRef3d",f:qZ},59:{n:"PtgArea3d",f:TZ},60:{n:"PtgRefErr3d",f:dee},61:{n:"PtgAreaErr3d",f:IZ},255:{}},_ee={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Iee={1:{n:"PtgElfLel",f:ML},2:{n:"PtgElfRw",f:bee},3:{n:"PtgElfCol",f:mee},6:{n:"PtgElfRwV",f:Nee},7:{n:"PtgElfColV",f:gee},10:{n:"PtgElfRadical",f:yee},11:{n:"PtgElfRadicalS",f:wee},13:{n:"PtgElfColS",f:pee},15:{n:"PtgElfColSV",f:xee},16:{n:"PtgElfRadicalLel",f:vee},25:{n:"PtgList",f:jee},29:{n:"PtgSxName",f:Bee},255:{}},Lee={0:{n:"PtgAttrNoop",f:Tee},1:{n:"PtgAttrSemi",f:QZ},2:{n:"PtgAttrIf",f:OZ},4:{n:"PtgAttrChoose",f:DZ},8:{n:"PtgAttrGoto",f:PZ},16:{n:"PtgAttrSum",f:WZ},32:{n:"PtgAttrBaxcel",f:fF},33:{n:"PtgAttrBaxcel",f:fF},64:{n:"PtgAttrSpace",f:MZ},65:{n:"PtgAttrSpaceSemi",f:HZ},128:{n:"PtgAttrIfError",f:RZ},255:{}};function op(e,t,r,n){if(n.biff<8)return va(e,t);for(var s=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=see(e,0,n),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=nee(e,r[o][1],n),i.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=s-e.l,t!==0&&i.push(va(e,t)),i}function lp(e,t,r){for(var n=e.l+t,s,i,o=[];n!=e.l;)t=n-e.l,i=e[e.l],s=hF[i]||hF[_ee[i]],(i===24||i===25)&&(s=(i===24?Iee:Lee)[e[e.l+1]]),!s||!s.f?va(e,t):o.push([s.n,s.f(e,t,r)]);return o}function Uee(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],i=0;i<n.length;++i){var o=n[i];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var Dee={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Pee(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function HL(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function mF(e,t,r){var n=HL(e,t,r);return n=="#REF"?n:Pee(n,r)}function da(e,t,r,n,s){var i=s&&s.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},l=[],c,A,d,u=0,f=0,h,x="";if(!e[0]||!e[0][0])return"";for(var m=-1,g="",p=0,v=e[0].length;p<v;++p){var w=e[0][p];switch(w[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),A=l.pop(),m>=0){switch(e[0][m][1][0]){case 0:g=qn(" ",e[0][m][1][1]);break;case 1:g=qn("\r",e[0][m][1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}A=A+g,m=-1}l.push(A+Dee[w[0]]+c);break;case"PtgIsect":c=l.pop(),A=l.pop(),l.push(A+" "+c);break;case"PtgUnion":c=l.pop(),A=l.pop(),l.push(A+","+c);break;case"PtgRange":c=l.pop(),A=l.pop(),l.push(A+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Lh(w[1][1],o,s),l.push(Uh(d,i));break;case"PtgRefN":d=r?Lh(w[1][1],r,s):w[1][1],l.push(Uh(d,i));break;case"PtgRef3d":u=w[1][1],d=Lh(w[1][2],o,s),x=mF(n,u,s),l.push(x+"!"+Uh(d,i));break;case"PtgFunc":case"PtgFuncVar":var B=w[1][0],T=w[1][1];B||(B=0),B&=127;var _=B==0?[]:l.slice(-B);l.length-=B,T==="User"&&(T=_.shift()),l.push(T+"("+_.join(",")+")");break;case"PtgBool":l.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(w[1]);break;case"PtgNum":l.push(String(w[1]));break;case"PtgStr":l.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(w[1]);break;case"PtgAreaN":h=$S(w[1][1],r?{s:r}:o,s),l.push(vw(h,s));break;case"PtgArea":h=$S(w[1][1],o,s),l.push(vw(h,s));break;case"PtgArea3d":u=w[1][1],h=w[1][2],x=mF(n,u,s),l.push(x+"!"+vw(h,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=w[1][2];var j=(n.names||[])[f-1]||(n[0]||[])[f],E=j?j.Name:"SH33TJSNAME"+String(f);E&&E.slice(0,6)=="_xlfn."&&!s.xlfn&&(E=E.slice(6)),l.push(E);break;case"PtgNameX":var L=w[1][1];f=w[1][2];var M;if(s.biff<=5)L<0&&(L=-L),n[L]&&(M=n[L][f]);else{var F="";if(((n[L]||[])[0]||[])[0]==14849||(((n[L]||[])[0]||[])[0]==1025?n[L][f]&&n[L][f].itab>0&&(F=n.SheetNames[n[L][f].itab-1]+"!"):F=n.SheetNames[f-1]+"!"),n[L]&&n[L][f])F+=n[L][f].Name;else if(n[0]&&n[0][f])F+=n[0][f].Name;else{var D=(HL(n,L,s)||"").split(";;");D[f-1]?F=D[f-1]:F+="SH33TJSERRX"}l.push(F);break}M||(M={Name:"SH33TJSERRY"}),l.push(M.Name);break;case"PtgParen":var G="(",K=")";if(m>=0){switch(g="",e[0][m][1][0]){case 2:G=qn(" ",e[0][m][1][1])+G;break;case 3:G=qn("\r",e[0][m][1][1])+G;break;case 4:K=qn(" ",e[0][m][1][1])+K;break;case 5:K=qn("\r",e[0][m][1][1])+K;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}l.push(G+l.pop()+K);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:w[1][1],r:w[1][0]};var ae={c:r.c,r:r.r};if(n.sharedf[Ar(d)]){var Z=n.sharedf[Ar(d)];l.push(da(Z,o,ae,n,s))}else{var oe=!1;for(c=0;c!=n.arrayf.length;++c)if(A=n.arrayf[c],!(d.c<A[0].s.c||d.c>A[0].e.c)&&!(d.r<A[0].s.r||d.r>A[0].e.r)){l.push(da(A[1],o,ae,n,s)),oe=!0;break}oe||l.push(w[1])}break;case"PtgArray":l.push("{"+Uee(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=p;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var Y=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&m>=0&&Y.indexOf(e[0][p][0])==-1){w=e[0][m];var R=!0;switch(w[1][0]){case 4:R=!1;case 0:g=qn(" ",w[1][1]);break;case 5:R=!1;case 1:g=qn("\r",w[1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}l.push((R?g:"")+l.pop()+(R?"":g)),m=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function Oee(e,t,r){var n=e.l+t,s=r.biff==2?1:2,i,o=e.read_shift(s);if(o==65535)return[[],va(e,t-2)];var l=lp(e,o,r);return t!==o+s&&(i=op(e,t-o-s,l,r)),e.l=n,[l,i]}function Ree(e,t,r){var n=e.l+t,s=r.biff==2?1:2,i,o=e.read_shift(s);if(o==65535)return[[],va(e,t-2)];var l=lp(e,o,r);return t!==o+s&&(i=op(e,t-o-s,l,r)),e.l=n,[l,i]}function Qee(e,t,r,n){var s=e.l+t,i=lp(e,n,r),o;return s!==e.l&&(o=op(e,s-e.l,i,r)),[i,o]}function Mee(e,t,r){var n=e.l+t,s,i=e.read_shift(2),o=lp(e,i,r);return i==65535?[[],va(e,t-2)]:(t!==i+2&&(s=op(e,n-i-2,o,r)),[o,s])}function Hee(e){var t;if(Xl(e,e.l+6)!==65535)return[pa(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Vee(e){if(e==null){var t=ot(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Td(e);return Td(0)}function jw(e,t,r){var n=e.l+t,s=Cl(e);r.biff==2&&++e.l;var i=Hee(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=Ree(e,n-e.l,r);return{cell:s,val:i[0],formula:l,shared:o>>3&1,tt:i[1]}}function $ee(e,t,r,n,s){var i=Id(t,r,s),o=Vee(e.v),l=ot(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var A=ot(e.bf.length),d=0;d<e.bf.length;++d)A[d]=e.bf[d];var u=_s([i,o,l,A]);return u}function mv(e,t,r){var n=e.read_shift(4),s=lp(e,n,r),i=e.read_shift(4),o=i>0?op(e,i,s,r):null;return[s,o]}var qee=mv,pv=mv,Kee=mv,zee=mv,Gee={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},VL={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Wee={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function pF(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Xee(e){var t="of:="+e.replace(OC,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Bw(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Yee(e){return e.replace(/\./,"!")}var Ph={},xf={},Oh=typeof Map<"u";function MC(e,t,r){var n=0,s=e.length;if(r){if(Oh?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Oh?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(Oh?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function xv(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(ha=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Cm(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=z1(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function pd(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function TA(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,i=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){tc(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=i;++s)if(e[s].numFmtId===n)return s;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function $L(e,t,r,n,s,i){try{n.cellNF&&(e.z=ar[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Bn(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(ar[t]==null&&tc(Gz[t]||"General",t),e.t==="e")e.w=e.w||xc[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=xm(e.v);else if(e.t==="d"){var o=Ns(e.v);(o|0)===o?e.w=o.toString(10):e.w=xm(o)}else{if(e.v===void 0)return"";e.w=Ed(e.v,xf)}else e.t==="d"?e.w=po(t,Ns(e.v),xf):e.w=po(t,e.v,xf)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=K1(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=K1(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&i.Fills)throw l}}}function Jee(e,t,r){if(e&&e["!ref"]){var n=Rr(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Zee(e,t){var r=Rr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=wr(r))}var ete=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,tte=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,rte=/<(?:\w:)?hyperlink [^>]*>/mg,nte=/"(\w*:\w*)"/,ste=/<(?:\w:)?col\b[^>]*[\/]?>/g,ate=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,ite=/<(?:\w:)?pageMargins[^>]*\/>/g,qL=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,ote=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,lte=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function cte(e,t,r,n,s,i,o){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},A="",d="",u=e.match(tte);u?(A=e.slice(0,u.index),d=e.slice(u.index+u[0].length)):A=d=e;var f=A.match(qL);f?HC(f[0],l,s,r):(f=A.match(ote))&&dte(f[0],f[1]||"",l,s,r);var h=(A.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var x=A.slice(h,h+50).match(nte);x&&Zee(l,x[1])}var m=A.match(lte);m&&m[1]&&Cte(m[1],s);var g=[];if(t.cellStyles){var p=A.match(ste);p&&yte(g,p)}u&&Ste(u[1],l,t,c,i,o);var v=d.match(ate);v&&(l["!autofilter"]=wte(v[0]));var w=[],B=d.match(ete);if(B)for(h=0;h!=B.length;++h)w[h]=Rr(B[h].slice(B[h].indexOf('"')+1));var T=d.match(rte);T&&pte(l,T,n);var _=d.match(ite);if(_&&(l["!margins"]=xte(dr(_[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=wr(c)),t.sheetRows>0&&l["!ref"]){var j=Rr(l["!ref"]);t.sheetRows<=+j.e.r&&(j.e.r=t.sheetRows-1,j.e.r>c.e.r&&(j.e.r=c.e.r),j.e.r<j.s.r&&(j.s.r=j.e.r),j.e.c>c.e.c&&(j.e.c=c.e.c),j.e.c<j.s.c&&(j.s.c=j.e.c),l["!fullref"]=l["!ref"],l["!ref"]=wr(j))}return g.length>0&&(l["!cols"]=g),w.length>0&&(l["!merges"]=w),l}function Ate(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+wr(e[r])+'"/>';return t+"</mergeCells>"}function HC(e,t,r,n){var s=dr(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=Or(cn(s.codeName)))}function dte(e,t,r,n,s){HC(e.slice(0,e.indexOf(">")),r,n,s)}function ute(e,t,r,n,s){var i=!1,o={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,o.codeName=hl(nn(c))}if(e&&e["!outline"]){var A={summaryBelow:1,summaryRight:1};e["!outline"].above&&(A.summaryBelow=0),e["!outline"].left&&(A.summaryRight=0),l=(l||"")+Ft("outlinePr",null,A)}!i&&!l||(s[s.length]=Ft("sheetPr",l,o))}var fte=["objects","scenarios","selectLockedCells","selectUnlockedCells"],hte=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function mte(e){var t={sheet:1};return fte.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),hte.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=UC(e.password).toString(16).toUpperCase()),Ft("sheetProtection",null,t)}function pte(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var i=dr(cn(t[s]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+Or(i.location))):(i.Target="#"+Or(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=Rr(i.ref),c=l.s.r;c<=l.e.r;++c)for(var A=l.s.c;A<=l.e.c;++A){var d=Ar({c:A,r:c});n?(e[c]||(e[c]=[]),e[c][A]||(e[c][A]={t:"z",v:void 0}),e[c][A].l=i):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=i)}}}function xte(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function gte(e){return pd(e),Ft("pageMargins",null,e)}function yte(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=dr(t[n],!0);s.hidden&&(s.hidden=Nn(s.hidden));var i=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,DC(s.width)),yA(s);i<=o;)e[i++]=Sn(s)}}function vte(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=Ft("col",null,xv(s,n)));return r[r.length]="</cols>",r.join("")}function wte(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function bte(e,t,r,n){var s=typeof e.ref=="string"?e.ref:wr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=ni(s);o.s.r==o.e.r&&(o.e.r=ni(t["!ref"]).e.r,s=wr(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Ft("autoFilter",null,{ref:s})}var Nte=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Cte(e,t){t.Views||(t.Views=[{}]),(e.match(Nte)||[]).forEach(function(r,n){var s=dr(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),Nn(s.rightToLeft)&&(t.Views[n].RTL=!0)})}function jte(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ft("sheetViews",Ft("sheetView",null,s),{})}function Bte(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",i=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=xc[e.v];break;case"d":n&&n.cellDates?s=Bn(e.v,-1).toISOString():(e=Sn(e),e.t="n",s=""+(e.v=Ns(Bn(e.v)))),typeof e.z>"u"&&(e.z=ar[14]);break;default:s=e.v;break}var l=Ks("v",nn(s)),c={r:t},A=TA(n.cellXfs,e,n);switch(A!==0&&(c.s=A),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=Ks("v",""+MC(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=o),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=Ft("f",nn(e.f),d)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Ft("c",l,c)}var Ste=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=gm("v"),o=gm("f");return function(c,A,d,u,f,h){for(var x=0,m="",g=[],p=[],v=0,w=0,B=0,T="",_,j,E=0,L=0,M,F,D=0,G=0,K=Array.isArray(h.CellXf),ae,Z=[],oe=[],Y=Array.isArray(A),R=[],z={},ee=!1,b=!!d.sheetStubs,O=c.split(t),S=0,I=O.length;S!=I;++S){m=O[S].trim();var U=m.length;if(U!==0){var Q=0;e:for(x=0;x<U;++x)switch(m[x]){case">":if(m[x-1]!="/"){++x;break e}if(d&&d.cellStyles){if(j=dr(m.slice(Q,x),!0),E=j.r!=null?parseInt(j.r,10):E+1,L=-1,d.sheetRows&&d.sheetRows<E)continue;z={},ee=!1,j.ht&&(ee=!0,z.hpt=parseFloat(j.ht),z.hpx=Pf(z.hpt)),j.hidden=="1"&&(ee=!0,z.hidden=!0),j.outlineLevel!=null&&(ee=!0,z.level=+j.outlineLevel),ee&&(R[E-1]=z)}break;case"<":Q=x;break}if(Q>=x)break;if(j=dr(m.slice(Q,x),!0),E=j.r!=null?parseInt(j.r,10):E+1,L=-1,!(d.sheetRows&&d.sheetRows<E)){u.s.r>E-1&&(u.s.r=E-1),u.e.r<E-1&&(u.e.r=E-1),d&&d.cellStyles&&(z={},ee=!1,j.ht&&(ee=!0,z.hpt=parseFloat(j.ht),z.hpx=Pf(z.hpt)),j.hidden=="1"&&(ee=!0,z.hidden=!0),j.outlineLevel!=null&&(ee=!0,z.level=+j.outlineLevel),ee&&(R[E-1]=z)),g=m.slice(x).split(e);for(var H=0;H!=g.length&&g[H].trim().charAt(0)=="<";++H);for(g=g.slice(H),x=0;x!=g.length;++x)if(m=g[x].trim(),m.length!==0){if(p=m.match(r),v=x,w=0,B=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,p!=null&&p.length===2){for(v=0,T=p[1],w=0;w!=T.length&&!((B=T.charCodeAt(w)-64)<1||B>26);++w)v=26*v+B;--v,L=v}else++L;for(w=0;w!=m.length&&m.charCodeAt(w)!==62;++w);if(++w,j=dr(m.slice(0,w),!0),j.r||(j.r=Ar({r:E-1,c:L})),T=m.slice(w),_={t:""},(p=T.match(i))!=null&&p[1]!==""&&(_.v=Or(p[1])),d.cellFormula){if((p=T.match(o))!=null&&p[1]!==""){if(_.f=Or(cn(p[1])).replace(/\r\n/g,`
`),d.xlfn||(_.f=uF(_.f)),p[0].indexOf('t="array"')>-1)_.F=(T.match(s)||[])[1],_.F.indexOf(":")>-1&&Z.push([Rr(_.F),_.F]);else if(p[0].indexOf('t="shared"')>-1){F=dr(p[0]);var X=Or(cn(p[1]));d.xlfn||(X=uF(X)),oe[parseInt(F.si,10)]=[F,X,j.r]}}else(p=T.match(/<f[^>]*\/>/))&&(F=dr(p[0]),oe[F.si]&&(_.f=NZ(oe[F.si][1],oe[F.si][2],j.r)));var V=Pn(j.r);for(w=0;w<Z.length;++w)V.r>=Z[w][0].s.r&&V.r<=Z[w][0].e.r&&V.c>=Z[w][0].s.c&&V.c<=Z[w][0].e.c&&(_.F=Z[w][1])}if(j.t==null&&_.v===void 0)if(_.f||_.F)_.v=0,_.t="n";else if(b)_.t="z";else continue;else _.t=j.t||"n";switch(u.s.c>L&&(u.s.c=L),u.e.c<L&&(u.e.c=L),_.t){case"n":if(_.v==""||_.v==null){if(!b)continue;_.t="z"}else _.v=parseFloat(_.v);break;case"s":if(typeof _.v>"u"){if(!b)continue;_.t="z"}else M=Ph[parseInt(_.v,10)],_.v=M.t,_.r=M.r,d.cellHTML&&(_.h=M.h);break;case"str":_.t="s",_.v=_.v!=null?cn(_.v):"",d.cellHTML&&(_.h=vC(_.v));break;case"inlineStr":p=T.match(n),_.t="s",p!=null&&(M=LC(p[1]))?(_.v=M.t,d.cellHTML&&(_.h=M.h)):_.v="";break;case"b":_.v=Nn(_.v);break;case"d":d.cellDates?_.v=Bn(_.v,1):(_.v=Ns(Bn(_.v,1)),_.t="n");break;case"e":(!d||d.cellText!==!1)&&(_.w=_.v),_.v=z8[_.v];break}if(D=G=0,ae=null,K&&j.s!==void 0&&(ae=h.CellXf[j.s],ae!=null&&(ae.numFmtId!=null&&(D=ae.numFmtId),d.cellStyles&&ae.fillId!=null&&(G=ae.fillId))),$L(_,D,G,d,f,h),d.cellDates&&K&&_.t=="n"&&e0(ar[D])&&(_.t="d",_.v=fv(_.v)),j.cm&&d.xlmeta){var Ae=(d.xlmeta.Cell||[])[+j.cm-1];Ae&&Ae.type=="XLDAPR"&&(_.D=!0)}if(Y){var W=Pn(j.r);A[W.r]||(A[W.r]=[]),A[W.r][W.c]=_}else A[j.r]=_}}}}R.length>0&&(A["!rows"]=R)}}();function Fte(e,t,r,n){var s=[],i=[],o=Rr(e["!ref"]),l="",c,A="",d=[],u=0,f=0,h=e["!rows"],x=Array.isArray(e),m={r:A},g,p=-1;for(f=o.s.c;f<=o.e.c;++f)d[f]=Dn(f);for(u=o.s.r;u<=o.e.r;++u){for(i=[],A=is(u),f=o.s.c;f<=o.e.c;++f){c=d[f]+A;var v=x?(e[u]||[])[f]:e[c];v!==void 0&&(l=Bte(v,c,e,t))!=null&&i.push(l)}(i.length>0||h&&h[u])&&(m={r:A},h&&h[u]&&(g=h[u],g.hidden&&(m.hidden=1),p=-1,g.hpx?p=jm(g.hpx):g.hpt&&(p=g.hpt),p>-1&&(m.ht=p,m.customHeight=1),g.level&&(m.outlineLevel=g.level)),s[s.length]=Ft("row",i.join(""),m))}if(h)for(;u<h.length;++u)h&&h[u]&&(m={r:u+1},g=h[u],g.hidden&&(m.hidden=1),p=-1,g.hpx?p=jm(g.hpx):g.hpt&&(p=g.hpt),p>-1&&(m.ht=p,m.customHeight=1),g.level&&(m.outlineLevel=g.level),s[s.length]=Ft("row","",m));return s.join("")}function KL(e,t,r,n){var s=[os,Ft("worksheet",null,{xmlns:Hd[0],"xmlns:r":ws.r})],i=r.SheetNames[e],o=0,l="",c=r.Sheets[i];c==null&&(c={});var A=c["!ref"]||"A1",d=Rr(A);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+A+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),A=wr(d)}n||(n={}),c["!comments"]=[];var u=[];ute(c,r,e,t,s),s[s.length]=Ft("dimension",null,{ref:A}),s[s.length]=jte(c,t,e,r),t.sheetFormat&&(s[s.length]=Ft("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=vte(c,c["!cols"])),s[o=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=Fte(c,t),l.length>0&&(s[s.length]=l)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),c["!protect"]&&(s[s.length]=mte(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=bte(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=Ate(c["!merges"]));var f=-1,h,x=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(m){m[1].Target&&(h={ref:m[0]},m[1].Target.charAt(0)!="#"&&(x=tn(n,-1,nn(m[1].Target).replace(/#.*$/,""),Br.HLINK),h["r:id"]="rId"+x),(f=m[1].Target.indexOf("#"))>-1&&(h.location=nn(m[1].Target.slice(f+1))),m[1].Tooltip&&(h.tooltip=nn(m[1].Tooltip)),s[s.length]=Ft("hyperlink",null,h))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=gte(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Ks("ignoredErrors",Ft("ignoredError",null,{numberStoredAsText:1,sqref:A}))),u.length>0&&(x=tn(n,-1,"../drawings/drawing"+(e+1)+".xml",Br.DRAW),s[s.length]=Ft("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=u),c["!comments"].length>0&&(x=tn(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Br.VML),s[s.length]=Ft("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function Ete(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function kte(e,t,r){var n=ot(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;s.hpx?i=jm(s.hpx)*20:s.hpt&&(i=s.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var A={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var u=-1,f=-1,h=d<<10;h<d+1<<10;++h){A.c=h;var x=Array.isArray(r)?(r[A.r]||[])[A.c]:r[Ar(A)];x&&(u<0&&(u=h),f=h)}u<0||(++l,n.write_shift(4,u),n.write_shift(4,f))}var m=n.l;return n.l=c,n.write_shift(4,l),n.l=m,n.length>n.l?n.slice(0,n.l):n}function Tte(e,t,r,n){var s=kte(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&pt(e,0,s)}var _te=Kd,Ite=n0;function Lte(){}function Ute(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=OG(e),r}function Dte(e,t,r){r==null&&(r=ot(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return V1({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),H8(e,r),r.slice(0,r.l)}function Pte(e){var t=wo(e);return[t]}function Ote(e,t,r){return r==null&&(r=ot(8)),Vd(t,r)}function Rte(e){var t=$d(e);return[t]}function Qte(e,t,r){return r==null&&(r=ot(4)),qd(t,r)}function Mte(e){var t=wo(e),r=e.read_shift(1);return[t,r,"b"]}function Hte(e,t,r){return r==null&&(r=ot(9)),Vd(t,r),r.write_shift(1,e.v?1:0),r}function Vte(e){var t=$d(e),r=e.read_shift(1);return[t,r,"b"]}function $te(e,t,r){return r==null&&(r=ot(5)),qd(t,r),r.write_shift(1,e.v?1:0),r}function qte(e){var t=wo(e),r=e.read_shift(1);return[t,r,"e"]}function Kte(e,t,r){return r==null&&(r=ot(9)),Vd(t,r),r.write_shift(1,e.v),r}function zte(e){var t=$d(e),r=e.read_shift(1);return[t,r,"e"]}function Gte(e,t,r){return r==null&&(r=ot(8)),qd(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Wte(e){var t=wo(e),r=e.read_shift(4);return[t,r,"s"]}function Xte(e,t,r){return r==null&&(r=ot(12)),Vd(t,r),r.write_shift(4,t.v),r}function Yte(e){var t=$d(e),r=e.read_shift(4);return[t,r,"s"]}function Jte(e,t,r){return r==null&&(r=ot(8)),qd(t,r),r.write_shift(4,t.v),r}function Zte(e){var t=wo(e),r=pa(e);return[t,r,"n"]}function ere(e,t,r){return r==null&&(r=ot(16)),Vd(t,r),Td(e.v,r),r}function zL(e){var t=$d(e),r=pa(e);return[t,r,"n"]}function tre(e,t,r){return r==null&&(r=ot(12)),qd(t,r),Td(e.v,r),r}function rre(e){var t=wo(e),r=EC(e);return[t,r,"n"]}function nre(e,t,r){return r==null&&(r=ot(12)),Vd(t,r),V8(e.v,r),r}function sre(e){var t=$d(e),r=EC(e);return[t,r,"n"]}function are(e,t,r){return r==null&&(r=ot(8)),qd(t,r),V8(e.v,r),r}function ire(e){var t=wo(e),r=BC(e);return[t,r,"is"]}function ore(e){var t=wo(e),r=ga(e);return[t,r,"str"]}function lre(e,t,r){return r==null&&(r=ot(12+4*e.v.length)),Vd(t,r),Is(e.v,r),r.length>r.l?r.slice(0,r.l):r}function cre(e){var t=$d(e),r=ga(e);return[t,r,"str"]}function Are(e,t,r){return r==null&&(r=ot(8+4*e.v.length)),qd(t,r),Is(e.v,r),r.length>r.l?r.slice(0,r.l):r}function dre(e,t,r){var n=e.l+t,s=wo(e);s.r=r["!row"];var i=e.read_shift(1),o=[s,i,"b"];if(r.cellFormula){e.l+=2;var l=pv(e,n-e.l,r);o[3]=da(l,null,s,r.supbooks,r)}else e.l=n;return o}function ure(e,t,r){var n=e.l+t,s=wo(e);s.r=r["!row"];var i=e.read_shift(1),o=[s,i,"e"];if(r.cellFormula){e.l+=2;var l=pv(e,n-e.l,r);o[3]=da(l,null,s,r.supbooks,r)}else e.l=n;return o}function fre(e,t,r){var n=e.l+t,s=wo(e);s.r=r["!row"];var i=pa(e),o=[s,i,"n"];if(r.cellFormula){e.l+=2;var l=pv(e,n-e.l,r);o[3]=da(l,null,s,r.supbooks,r)}else e.l=n;return o}function hre(e,t,r){var n=e.l+t,s=wo(e);s.r=r["!row"];var i=ga(e),o=[s,i,"str"];if(r.cellFormula){e.l+=2;var l=pv(e,n-e.l,r);o[3]=da(l,null,s,r.supbooks,r)}else e.l=n;return o}var mre=Kd,pre=n0;function xre(e,t){return t==null&&(t=ot(4)),t.write_shift(4,e),t}function gre(e,t){var r=e.l+t,n=Kd(e),s=SC(e),i=ga(e),o=ga(e),l=ga(e);e.l=r;var c={rfx:n,relId:s,loc:i,display:l};return o&&(c.Tooltip=o),c}function yre(e,t){var r=ot(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));n0({s:Pn(e[0]),e:Pn(e[0])},r),FC("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return Is(s||"",r),Is(e[1].Tooltip||"",r),Is("",r),r.slice(0,r.l)}function vre(){}function wre(e,t,r){var n=e.l+t,s=$8(e),i=e.read_shift(1),o=[s];if(o[2]=i,r.cellFormula){var l=qee(e,n-e.l,r);o[1]=l}else e.l=n;return o}function bre(e,t,r){var n=e.l+t,s=Kd(e),i=[s];if(r.cellFormula){var o=zee(e,n-e.l,r);i[1]=o,e.l=n}else e.l=n;return i}function Nre(e,t,r){r==null&&(r=ot(18));var n=xv(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var GL=["left","right","top","bottom","header","footer"];function Cre(e){var t={};return GL.forEach(function(r){t[r]=pa(e)}),t}function jre(e,t){return t==null&&(t=ot(6*8)),pd(e),GL.forEach(function(r){Td(e[r],t)}),t}function Bre(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Sre(e,t,r){r==null&&(r=ot(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Fre(e){var t=ot(24);return t.write_shift(4,4),t.write_shift(4,1),n0(e,t),t}function Ere(e,t){return t==null&&(t=ot(16*4+2)),t.write_shift(2,e.password?UC(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function kre(){}function Tre(){}function _re(e,t,r,n,s,i,o){if(!e)return e;var l=t||{};n||(n={"!id":{}});var c=l.dense?[]:{},A,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},u=!1,f=!1,h,x,m,g,p,v,w,B,T,_=[];l.biff=12,l["!row"]=0;var j=0,E=!1,L=[],M={},F=l.supbooks||s.supbooks||[[]];if(F.sharedf=M,F.arrayf=L,F.SheetNames=s.SheetNames||s.Sheets.map(function(Y){return Y.name}),!l.supbooks&&(l.supbooks=F,s.Names))for(var D=0;D<s.Names.length;++D)F[0][D+1]=s.Names[D];var G=[],K=[],ae=!1;Bm[16]={n:"BrtShortReal",f:zL};var Z;if(pc(e,function(R,z,ee){if(!f)switch(ee){case 148:A=R;break;case 0:h=R,l.sheetRows&&l.sheetRows<=h.r&&(f=!0),B=is(g=h.r),l["!row"]=h.r,(R.hidden||R.hpt||R.level!=null)&&(R.hpt&&(R.hpx=Pf(R.hpt)),K[R.r]=R);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:R[2]},R[2]){case"n":x.v=R[1];break;case"s":w=Ph[R[1]],x.v=w.t,x.r=w.r;break;case"b":x.v=!!R[1];break;case"e":x.v=R[1],l.cellText!==!1&&(x.w=xc[x.v]);break;case"str":x.t="s",x.v=R[1];break;case"is":x.t="s",x.v=R[1].t;break}if((m=o.CellXf[R[0].iStyleRef])&&$L(x,m.numFmtId,null,l,i,o),p=R[0].c==-1?p+1:R[0].c,l.dense?(c[g]||(c[g]=[]),c[g][p]=x):c[Dn(p)+B]=x,l.cellFormula){for(E=!1,j=0;j<L.length;++j){var b=L[j];h.r>=b[0].s.r&&h.r<=b[0].e.r&&p>=b[0].s.c&&p<=b[0].e.c&&(x.F=wr(b[0]),E=!0)}!E&&R.length>3&&(x.f=R[3])}if(d.s.r>h.r&&(d.s.r=h.r),d.s.c>p&&(d.s.c=p),d.e.r<h.r&&(d.e.r=h.r),d.e.c<p&&(d.e.c=p),l.cellDates&&m&&x.t=="n"&&e0(ar[m.numFmtId])){var O=id(x.v);O&&(x.t="d",x.v=new Date(O.y,O.m-1,O.d,O.H,O.M,O.S,O.u))}Z&&(Z.type=="XLDAPR"&&(x.D=!0),Z=void 0);break;case 1:case 12:if(!l.sheetStubs||u)break;x={t:"z",v:void 0},p=R[0].c==-1?p+1:R[0].c,l.dense?(c[g]||(c[g]=[]),c[g][p]=x):c[Dn(p)+B]=x,d.s.r>h.r&&(d.s.r=h.r),d.s.c>p&&(d.s.c=p),d.e.r<h.r&&(d.e.r=h.r),d.e.c<p&&(d.e.c=p),Z&&(Z.type=="XLDAPR"&&(x.D=!0),Z=void 0);break;case 176:_.push(R);break;case 49:Z=((l.xlmeta||{}).Cell||[])[R-1];break;case 494:var S=n["!id"][R.relId];for(S?(R.Target=S.Target,R.loc&&(R.Target+="#"+R.loc),R.Rel=S):R.relId==""&&(R.Target="#"+R.loc),g=R.rfx.s.r;g<=R.rfx.e.r;++g)for(p=R.rfx.s.c;p<=R.rfx.e.c;++p)l.dense?(c[g]||(c[g]=[]),c[g][p]||(c[g][p]={t:"z",v:void 0}),c[g][p].l=R):(v=Ar({c:p,r:g}),c[v]||(c[v]={t:"z",v:void 0}),c[v].l=R);break;case 426:if(!l.cellFormula)break;L.push(R),T=l.dense?c[g][p]:c[Dn(p)+B],T.f=da(R[1],d,{r:h.r,c:p},F,l),T.F=wr(R[0]);break;case 427:if(!l.cellFormula)break;M[Ar(R[0].s)]=R[1],T=l.dense?c[g][p]:c[Dn(p)+B],T.f=da(R[1],d,{r:h.r,c:p},F,l);break;case 60:if(!l.cellStyles)break;for(;R.e>=R.s;)G[R.e--]={width:R.w/256,hidden:!!(R.flags&1),level:R.level},ae||(ae=!0,DC(R.w/256)),yA(G[R.e+1]);break;case 161:c["!autofilter"]={ref:wr(R)};break;case 476:c["!margins"]=R;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),R.name&&(s.Sheets[r].CodeName=R.name),(R.above||R.left)&&(c["!outline"]={above:R.above,left:R.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),R.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:u=!0;break;case 36:u=!1;break;case 37:u=!0;break;case 38:u=!1;break;default:if(!z.T){if(!u||l.WTF)throw new Error("Unexpected record 0x"+ee.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(d.s.r<2e6||A&&(A.e.r>0||A.e.c>0||A.s.r>0||A.s.c>0))&&(c["!ref"]=wr(A||d)),l.sheetRows&&c["!ref"]){var oe=Rr(c["!ref"]);l.sheetRows<=+oe.e.r&&(oe.e.r=l.sheetRows-1,oe.e.r>d.e.r&&(oe.e.r=d.e.r),oe.e.r<oe.s.r&&(oe.s.r=oe.e.r),oe.e.c>d.e.c&&(oe.e.c=d.e.c),oe.e.c<oe.s.c&&(oe.s.c=oe.e.c),c["!fullref"]=c["!ref"],c["!ref"]=wr(oe))}return _.length>0&&(c["!merges"]=_),G.length>0&&(c["!cols"]=G),K.length>0&&(c["!rows"]=K),c}function Ire(e,t,r,n,s,i,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=Sn(t),t.z=t.z||ar[14],t.v=Ns(Bn(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:n};switch(c.s=TA(s.cellXfs,t,s),t.l&&i["!links"].push([Ar(c),t.l]),t.c&&i["!comments"].push([Ar(c),t.c]),t.t){case"s":case"str":return s.bookSST?(l=MC(s.Strings,t.v,s.revStrings),c.t="s",c.v=l,o?pt(e,18,Jte(t,c)):pt(e,7,Xte(t,c))):(c.t="str",o?pt(e,17,Are(t,c)):pt(e,6,lre(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?pt(e,13,are(t,c)):pt(e,2,nre(t,c)):o?pt(e,16,tre(t,c)):pt(e,5,ere(t,c)),!0;case"b":return c.t="b",o?pt(e,15,$te(t,c)):pt(e,4,Hte(t,c)),!0;case"e":return c.t="e",o?pt(e,14,Gte(t,c)):pt(e,3,Kte(t,c)),!0}return o?pt(e,12,Qte(t,c)):pt(e,1,Ote(t,c)),!0}function Lre(e,t,r,n){var s=Rr(t["!ref"]||"A1"),i,o="",l=[];pt(e,145);var c=Array.isArray(t),A=s.e.r;t["!rows"]&&(A=Math.max(s.e.r,t["!rows"].length-1));for(var d=s.s.r;d<=A;++d){o=is(d),Tte(e,t,s,d);var u=!1;if(d<=s.e.r)for(var f=s.s.c;f<=s.e.c;++f){d===s.s.r&&(l[f]=Dn(f)),i=l[f]+o;var h=c?(t[d]||[])[f]:t[i];if(!h){u=!1;continue}u=Ire(e,h,d,f,n,t,u)}}pt(e,146)}function Ure(e,t){!t||!t["!merges"]||(pt(e,177,xre(t["!merges"].length)),t["!merges"].forEach(function(r){pt(e,176,pre(r))}),pt(e,178))}function Dre(e,t){!t||!t["!cols"]||(pt(e,390),t["!cols"].forEach(function(r,n){r&&pt(e,60,Nre(n,r))}),pt(e,391))}function Pre(e,t){!t||!t["!ref"]||(pt(e,648),pt(e,649,Fre(Rr(t["!ref"]))),pt(e,650))}function Ore(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=tn(r,-1,n[1].Target.replace(/#.*$/,""),Br.HLINK);pt(e,494,yre(n,s))}}),delete t["!links"]}function Rre(e,t,r,n){if(t["!comments"].length>0){var s=tn(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Br.VML);pt(e,551,FC("rId"+s)),t["!legacy"]=s}}function Qre(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],i=typeof s.ref=="string"?s.ref:wr(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=ni(i);l.s.r==l.e.r&&(l.e.r=ni(t["!ref"]).e.r,i=wr(l));for(var c=0;c<o.length;++c){var A=o[c];if(A.Name=="_xlnm._FilterDatabase"&&A.Sheet==n){A.Ref="'"+r.SheetNames[n]+"'!"+i;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),pt(e,161,n0(Rr(i))),pt(e,162)}}function Mre(e,t,r){pt(e,133),pt(e,137,Sre(t,r)),pt(e,138),pt(e,134)}function Hre(e,t){t["!protect"]&&pt(e,535,Ere(t["!protect"]))}function Vre(e,t,r,n){var s=Za(),i=r.SheetNames[e],o=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=Rr(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],pt(s,129),(r.vbaraw||o["!outline"])&&pt(s,147,Dte(l,o["!outline"])),pt(s,148,Ite(c)),Mre(s,o,r.Workbook),Dre(s,o),Lre(s,o,e,t),Hre(s,o),Qre(s,o,r,e),Ure(s,o),Ore(s,o,n),o["!margins"]&&pt(s,476,jre(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Pre(s,o),Rre(s,o,e,n),pt(s,130),s.end()}function $re(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var s=Or((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,s,n]}function qre(e,t,r,n,s,i){var o=i||{"!type":"chart"};if(!e)return i;var l=0,c=0,A="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(u){var f=$re(u);d.s.r=d.s.c=0,d.e.c=l,A=Dn(l),f[0].forEach(function(h,x){o[A+is(x)]={t:"n",v:h,z:f[1]},c=x}),d.e.r<c&&(d.e.r=c),++l}),l>0&&(o["!ref"]=wr(d)),o}function Kre(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(qL);return l&&HC(l[0],i,s,r),(o=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function zre(e,t){e.l+=10;var r=ga(e);return{name:r}}function Gre(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return pc(e,function(c,A,d){switch(d){case 550:i["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(A.T>0)){if(!(A.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var VC=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Wre=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Xre=[],Yre=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function xF(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var i=t[s];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Nn(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function gF(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Nn(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function WL(e){gF(e.WBProps,VC),gF(e.CalcPr,Yre),xF(e.WBView,Wre),xF(e.Sheets,Xre),xf.date1904=Nn(e.WBProps.date1904)}function Jre(e){return!e.Workbook||!e.Workbook.WBProps?"false":Nn(e.Workbook.WBProps.date1904)?"true":"false"}var Zre="][*?/\\".split("");function XL(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Zre.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function ene(e,t,r){e.forEach(function(n,s){XL(n);for(var i=0;i<s;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[s]&&t[s].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function tne(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];ene(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Jee(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var rne=/<\w+:workbook/;function nne(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",i={},o=0;if(e.replace(ba,function(c,A){var d=dr(c);switch(Nl(d[0])){case"<?xml":break;case"<workbook":c.match(rne)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[s];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":VC.forEach(function(u){if(d[u[0]]!=null)switch(u[2]){case"bool":r.WBProps[u[0]]=Nn(d[u[0]]);break;case"int":r.WBProps[u[0]]=parseInt(d[u[0]],10);break;default:r.WBProps[u[0]]=d[u[0]]}}),d.codeName&&(r.WBProps.CodeName=cn(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Or(cn(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=cn(d.name),d.comment&&(i.Comment=d.comment),d.localSheetId&&(i.Sheet=+d.localSheetId),Nn(d.hidden||"0")&&(i.Hidden=!0),o=A+c.length;break;case"</definedName>":i.Ref=Or(cn(e.slice(o,A))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),Hd.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return WL(r),r}function YL(e){var t=[os];t[t.length]=Ft("workbook",null,{xmlns:Hd[0],"xmlns:r":ws.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(VC.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Ft("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:nn(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Ft("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=Ft("definedName",nn(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function sne(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=IN(e),r.name=ga(e),r}function ane(e,t){return t||(t=ot(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),FC(e.strRelID,t),Is(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function ine(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?ga(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function one(e,t){t||(t=ot(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),H8(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function lne(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function cne(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),i=RG(e),o=Kee(e,0,r),l=SC(e);e.l=n;var c={Name:i,Ptg:o};return s<268435455&&(c.Sheet=s),l&&(c.Comment=l),c}function Ane(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],Bm[16]={n:"BrtFRTArchID$",f:lne},pc(e,function(c,A,d){switch(d){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=da(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,c]):o[0]=[d,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(d),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!A.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),WL(r),r.Names=i,r.supbooks=o,r}function dne(e,t){pt(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};pt(e,156,ane(s))}pt(e,144)}function une(e,t){t||(t=ot(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Is("SheetJS",t),Is(D1.version,t),Is(D1.version,t),Is("7262",t),t.length>t.l?t.slice(0,t.l):t}function fne(e,t){t||(t=ot(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function hne(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&i==-1&&(i=n);i>s||(pt(e,135),pt(e,158,fne(s)),pt(e,136))}}function mne(e,t){var r=Za();return pt(r,131),pt(r,128,une()),pt(r,153,one(e.Workbook&&e.Workbook.WBProps||null)),hne(r,e),dne(r,e),pt(r,132),r.end()}function pne(e,t,r){return t.slice(-4)===".bin"?Ane(e,r):nne(e,r)}function xne(e,t,r,n,s,i,o,l){return t.slice(-4)===".bin"?_re(e,n,r,s,i,o,l):cte(e,n,r,s,i,o,l)}function gne(e,t,r,n,s,i,o,l){return t.slice(-4)===".bin"?Gre(e,n,r,s,i):Kre(e,n,r,s,i)}function yne(e,t,r,n,s,i,o,l){return t.slice(-4)===".bin"?wZ():bZ()}function vne(e,t,r,n,s,i,o,l){return t.slice(-4)===".bin"?yZ():vZ()}function wne(e,t,r,n){return t.slice(-4)===".bin"?pJ(e,r,n):sJ(e,r,n)}function bne(e,t,r){return TL(e,r)}function Nne(e,t,r){return t.slice(-4)===".bin"?NY(e,r):vY(e,r)}function Cne(e,t,r){return t.slice(-4)===".bin"?hZ(e,r):aZ(e,r)}function jne(e,t,r){return t.slice(-4)===".bin"?rZ(e):eZ(e)}function Bne(e,t,r,n){return r.slice(-4)===".bin"?nZ(e,t,r,n):void 0}function Sne(e,t,r){return t.slice(-4)===".bin"?YJ(e,t,r):ZJ(e,t,r)}function Fne(e,t,r){return(t.slice(-4)===".bin"?mne:YL)(e)}function Ene(e,t,r,n,s){return(t.slice(-4)===".bin"?Vre:KL)(e,r,n,s)}function kne(e,t,r){return(t.slice(-4)===".bin"?BJ:EL)(e,r)}function Tne(e,t,r){return(t.slice(-4)===".bin"?BY:wL)(e,r)}function _ne(e,t,r){return(t.slice(-4)===".bin"?mZ:LL)(e)}function Ine(e){return(e.slice(-4)===".bin"?JJ:_L)()}var JL=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,ZL=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Fo(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(JL),i,o,l,c;if(s)for(c=0;c!=s.length;++c)i=s[c].match(ZL),(o=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(o+1),n[l]=i[2].slice(1,i[2].length-1));return n}function Lne(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(JL),s,i,o,l;if(n)for(l=0;l!=n.length;++l)s=n[l].match(ZL),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),r[o]=s[2].slice(1,s[2].length-1));return r}var Rh;function Une(e,t){var r=Rh[e]||Or(e);return r==="General"?Ed(t):po(r,t)}function Dne(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Nn(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Bn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Or(t)]=s}function Pne(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||xc[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=xm(e.v):e.w=Ed(e.v):e.w=Une(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Rh[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&e0(n)){var s=id(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function One(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=XY[n.Pattern]||n.Pattern)}e[t.ID]=t}function Rne(e,t,r,n,s,i,o,l,c,A){var d="General",u=n.StyleID,f={};A=A||{};var h=[],x=0;for(u===void 0&&l&&(u=l.StyleID),u===void 0&&o&&(u=o.StyleID);i[u]!==void 0&&(i[u].nf&&(d=i[u].nf),i[u].Interior&&h.push(i[u].Interior),!!i[u].Parent);)u=i[u].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Nn(e);break;case"String":n.t="s",n.r=US(Or(e)),n.v=e.indexOf("<")>-1?Or(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Bn(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Or(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=z8[e],A.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=US(t||e));break}if(Pne(n,d,A),A.cellFormula!==!1)if(n.Formula){var m=Or(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=pf(m,s),delete n.Formula,n.ArrayRange=="RC"?n.F=pf("RC:RC",s):n.ArrayRange&&(n.F=pf(n.ArrayRange,s),c.push([Rr(n.F),n.F]))}else for(x=0;x<c.length;++x)s.r>=c[x][0].s.r&&s.r<=c[x][0].e.r&&s.c>=c[x][0].s.c&&s.c<=c[x][0].e.c&&(n.F=c[x][1]);A.cellStyles&&(h.forEach(function(g){!f.patternType&&g.patternType&&(f.patternType=g.patternType)}),n.s=f),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Qne(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Sw(e,t){var r=t||{};t0();var n=dh(wC(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=cn(n));var s=n.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=Sn(r);return o.type="string",Df.to_workbook(n,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(qe){s.indexOf("<"+qe)>=0&&(i=!0)}),i)return jse(n,r);Rh={"General Number":"General","General Date":ar[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ar[15],"Short Date":ar[14],"Long Time":ar[19],"Medium Time":ar[18],"Short Time":ar[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ar[2],Standard:ar[4],Percent:ar[10],Scientific:ar[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],A,d={},u=[],f=r.dense?[]:{},h="",x={},m={},g=Fo('<Data ss:Type="String">'),p=0,v=0,w=0,B={s:{r:2e6,c:2e6},e:{r:0,c:0}},T={},_={},j="",E=0,L=[],M={},F={},D=0,G=[],K=[],ae={},Z=[],oe,Y=!1,R=[],z=[],ee={},b=0,O=0,S={Sheets:[],WBProps:{date1904:!1}},I={};vm.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var U="";l=vm.exec(n);)switch(l[3]=(U=l[3]).toLowerCase()){case"data":if(U=="data"){if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?Rne(n.slice(p,l.index),j,g,c[c.length-1][0]=="comment"?ae:x,{c:v,r:w},T,Z[v],m,R,r):(j="",g=Fo(l[0]),p=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(K.length>0&&(x.c=K),(!r.sheetRows||r.sheetRows>w)&&x.v!==void 0&&(r.dense?(f[w]||(f[w]=[]),f[w][v]=x):f[Dn(v)+is(w)]=x),x.HRef&&(x.l={Target:Or(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(b=v+(parseInt(x.MergeAcross,10)|0),O=w+(parseInt(x.MergeDown,10)|0),L.push({s:{c:v,r:w},e:{c:b,r:O}})),!r.sheetStubs)x.MergeAcross?v=b+1:++v;else if(x.MergeAcross||x.MergeDown){for(var Q=v;Q<=b;++Q)for(var H=w;H<=O;++H)(Q>v||H>w)&&(r.dense?(f[H]||(f[H]=[]),f[H][Q]={t:"z"}):f[Dn(Q)+is(H)]={t:"z"});v=b+1}else++v;else x=Lne(l[0]),x.Index&&(v=+x.Index-1),v<B.s.c&&(B.s.c=v),v>B.e.c&&(B.e.c=v),l[0].slice(-2)==="/>"&&++v,K=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(w<B.s.r&&(B.s.r=w),w>B.e.r&&(B.e.r=w),l[0].slice(-2)==="/>"&&(m=Fo(l[0]),m.Index&&(w=+m.Index-1)),v=0,++w):(m=Fo(l[0]),m.Index&&(w=+m.Index-1),ee={},(m.AutoFitHeight=="0"||m.Height)&&(ee.hpx=parseInt(m.Height,10),ee.hpt=jm(ee.hpx),z[w]=ee),m.Hidden=="1"&&(ee.hidden=!0,z[w]=ee));break;case"worksheet":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"));u.push(h),B.s.r<=B.e.r&&B.s.c<=B.e.c&&(f["!ref"]=wr(B),r.sheetRows&&r.sheetRows<=B.e.r&&(f["!fullref"]=f["!ref"],B.e.r=r.sheetRows-1,f["!ref"]=wr(B))),L.length&&(f["!merges"]=L),Z.length>0&&(f["!cols"]=Z),z.length>0&&(f["!rows"]=z),d[h]=f}else B={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=v=0,c.push([l[3],!1]),A=Fo(l[0]),h=Or(A.Name),f=r.dense?[]:{},L=[],R=[],z=[],I={name:h,Hidden:0},S.Sheets.push(I);break;case"table":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),Z=[],Y=!1}break;case"style":l[1]==="/"?One(T,_,r):_=Fo(l[0]);break;case"numberformat":_.nf=Or(Fo(l[0]).Format||"General"),Rh[_.nf]&&(_.nf=Rh[_.nf]);for(var X=0;X!=392&&ar[X]!=_.nf;++X);if(X==392){for(X=57;X!=392;++X)if(ar[X]==null){tc(_.nf,X);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(oe=Fo(l[0]),oe.Hidden&&(oe.hidden=!0,delete oe.Hidden),oe.Width&&(oe.wpx=parseInt(oe.Width,10)),!Y&&oe.wpx>10){Y=!0,ha=SL;for(var V=0;V<Z.length;++V)Z[V]&&yA(Z[V])}Y&&yA(oe),Z[oe.Index-1||Z.length]=oe;for(var Ae=0;Ae<+oe.Span;++Ae)Z[Z.length]=Sn(oe);break;case"namedrange":if(l[1]==="/")break;S.Names||(S.Names=[]);var W=dr(l[0]),J={Name:W.Name,Ref:pf(W.RefersTo.slice(1),{r:0,c:0})};S.Sheets.length>0&&(J.Sheet=S.Sheets.length-1),S.Names.push(J);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?j+=n.slice(E,l.index):E=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;_.Interior=Fo(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?AW(M,U,n.slice(D,l.index)):D=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"));Qne(ae),K.push(ae)}else c.push([l[3],!1]),A=Fo(l[0]),ae={a:A.Author};break;case"autofilter":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var ve=Fo(l[0]);f["!autofilter"]={ref:pf(ve.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return NF(n,r);var de=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:de=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:de=!1}break;case"excelworkbook":switch(l[3]){case"date1904":S.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:de=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:de=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(D,l.index)){case"SheetHidden":I.Hidden=1;break;case"SheetVeryHidden":I.Hidden=2;break}else D=l.index+l[0].length;break;case"header":f["!margins"]||pd(f["!margins"]={},"xlml"),isNaN(+dr(l[0]).Margin)||(f["!margins"].header=+dr(l[0]).Margin);break;case"footer":f["!margins"]||pd(f["!margins"]={},"xlml"),isNaN(+dr(l[0]).Margin)||(f["!margins"].footer=+dr(l[0]).Margin);break;case"pagemargins":var te=dr(l[0]);f["!margins"]||pd(f["!margins"]={},"xlml"),isNaN(+te.Top)||(f["!margins"].top=+te.Top),isNaN(+te.Left)||(f["!margins"].left=+te.Left),isNaN(+te.Right)||(f["!margins"].right=+te.Right),isNaN(+te.Bottom)||(f["!margins"].bottom=+te.Bottom);break;case"displayrighttoleft":S.Views||(S.Views=[]),S.Views[0]||(S.Views[0]={}),S.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:de=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:de=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:de=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:de=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:de=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:de=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:de=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:de=!1}break;case"smarttags":break;default:de=!1;break}if(de||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?Dne(F,U,G,n.slice(D,l.index)):(G=l,D=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var je={};return!r.bookSheets&&!r.bookProps&&(je.Sheets=d),je.SheetNames=u,je.Workbook=S,je.SSF=Sn(ar),je.Props=M,je.Custprops=F,je}function QN(e,t){switch(qC(t=t||{}),t.type||"base64"){case"base64":return Sw(ki(e),t);case"binary":case"buffer":case"file":return Sw(e,t);case"array":return Sw(EA(e),t)}}function Mne(e,t){var r=[];return e.Props&&r.push(dW(e.Props,t)),e.Custprops&&r.push(uW(e.Props,e.Custprops)),r.join("")}function Hne(){return""}function Vne(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var i=[];i.push(Ft("NumberFormat",null,{"ss:Format":nn(ar[n.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(Ft("Style",i.join(""),o))}),Ft("Styles",r.join(""))}function eU(e){return Ft("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+RC(e.Ref,{r:0,c:0})})}function $ne(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(eU(s)))}return Ft("Names",r.join(""))}function qne(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,i=[],o=0;o<s.length;++o){var l=s[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(eU(l)))}return i.join("")}function Kne(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Ft("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Ft("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Ft("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(Ft("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Ks("ProtectContents","True")),e["!protect"].objects&&s.push(Ks("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Ks("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Ks("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Ks("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":Ft("WorksheetOptions",s.join(""),{xmlns:pi.x})}function zne(e){return e.map(function(t){var r=hG(t.t||""),n=Ft("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ft("Comment",n,{"ss:Author":t.a})}).join("")}function Gne(e,t,r,n,s,i,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+nn(RC(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=Pn(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=nn(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=nn(e.l.Tooltip))),r["!merges"])for(var A=r["!merges"],d=0;d!=A.length;++d)A[d].s.c!=o.c||A[d].s.r!=o.r||(A[d].e.c>A[d].s.c&&(l["ss:MergeAcross"]=A[d].e.c-A[d].s.c),A[d].e.r>A[d].s.r&&(l["ss:MergeDown"]=A[d].e.r-A[d].s.r));var u="",f="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":u="Number",f=String(e.v);break;case"b":u="Boolean",f=e.v?"1":"0";break;case"e":u="Error",f=xc[e.v];break;case"d":u="DateTime",f=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ar[14]);break;case"s":u="String",f=fG(e.v||"");break}var h=TA(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+h),l["ss:Index"]=o.c+1;var x=e.v!=null?f:"",m=e.t=="z"?"":'<Data ss:Type="'+u+'">'+x+"</Data>";return(e.c||[]).length>0&&(m+=zne(e.c)),Ft("Cell",m,l)}function Wne(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Pf(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Xne(e,t,r,n){if(!e["!ref"])return"";var s=Rr(e["!ref"]),i=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(g,p){yA(g);var v=!!g.width,w=xv(p,g),B={"ss:Index":p+1};v&&(B["ss:Width"]=Nm(w.width)),g.hidden&&(B["ss:Hidden"]="1"),l.push(Ft("Column",null,B))});for(var c=Array.isArray(e),A=s.s.r;A<=s.e.r;++A){for(var d=[Wne(A,(e["!rows"]||[])[A])],u=s.s.c;u<=s.e.c;++u){var f=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>u)&&!(i[o].s.r>A)&&!(i[o].e.c<u)&&!(i[o].e.r<A)){(i[o].s.c!=u||i[o].s.r!=A)&&(f=!0);break}if(!f){var h={r:A,c:u},x=Ar(h),m=c?(e[A]||[])[u]:e[x];d.push(Gne(m,x,e,t,r,n,h))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function Yne(e,t,r){var n=[],s=r.SheetNames[e],i=r.Sheets[s],o=i?qne(i,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=i?Xne(i,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(Kne(i,t,e,r)),n.join("")}function Jne(e,t){t||(t={}),e.SSF||(e.SSF=Sn(ar)),e.SSF&&(t0(),Av(e.SSF),t.revssf=uv(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],TA(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Mne(e,t)),r.push(Hne()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Ft("Worksheet",Yne(n,t,e),{"ss:Name":nn(e.SheetNames[n])}));return r[2]=Vne(e,t),r[3]=$ne(e),os+Ft("Workbook",r.join(""),{xmlns:pi.ss,"xmlns:o":pi.o,"xmlns:x":pi.x,"xmlns:ss":pi.ss,"xmlns:dt":pi.dt,"xmlns:html":pi.html})}function Zne(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=$G(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=qG(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var ese=[60,1084,2066,2165,2175];function tse(e,t,r,n,s){var i=n,o=[],l=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(l)}o.push(l),r.l+=i;for(var c=Xl(r,r.l),A=MN[c],d=0;A!=null&&ese.indexOf(c)>-1;)i=Xl(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),l=r.slice(d,r.l+4+i),o.push(l),r.l+=4+i,A=MN[c=Xl(r,r.l)];var u=_s(o);$s(u,0);var f=0;u.lens=[];for(var h=0;h<o.length;++h)u.lens.push(f),f+=o[h].length;if(u.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+u.length+" < "+n;return t.f(u,u.length,s)}function rl(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ar[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||xc[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=xm(e.v):e.w=Ed(e.v):e.w=po(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&e0(ar[n]||String(n))){var s=id(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Px(e,t,r){return{v:e,ixfe:t,t:r}}function rse(e,t){var r={opts:{}},n={},s=t.dense?[]:{},i={},o={},l=null,c=[],A="",d={},u,f="",h,x,m,g,p={},v=[],w,B,T=[],_=[],j={Sheets:[],WBProps:{date1904:!1},Views:[{}]},E={},L=function(Be){return Be<8?fd[Be]:Be<64&&_[Be-8]||fd[Be]},M=function(Be,Pe,Bt){var tt=Pe.XF.data;if(!(!tt||!tt.patternType||!Bt||!Bt.cellStyles)){Pe.s={},Pe.s.patternType=tt.patternType;var Ot;(Ot=bm(L(tt.icvFore)))&&(Pe.s.fgColor={rgb:Ot}),(Ot=bm(L(tt.icvBack)))&&(Pe.s.bgColor={rgb:Ot})}},F=function(Be,Pe,Bt){if(!(ee>1)&&!(Bt.sheetRows&&Be.r>=Bt.sheetRows)){if(Bt.cellStyles&&Pe.XF&&Pe.XF.data&&M(Be,Pe,Bt),delete Pe.ixfe,delete Pe.XF,u=Be,f=Ar(Be),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Be.r<o.s.r&&(o.s.r=Be.r),Be.c<o.s.c&&(o.s.c=Be.c),Be.r+1>o.e.r&&(o.e.r=Be.r+1),Be.c+1>o.e.c&&(o.e.c=Be.c+1),Bt.cellFormula&&Pe.f){for(var tt=0;tt<v.length;++tt)if(!(v[tt][0].s.c>Be.c||v[tt][0].s.r>Be.r)&&!(v[tt][0].e.c<Be.c||v[tt][0].e.r<Be.r)){Pe.F=wr(v[tt][0]),(v[tt][0].s.c!=Be.c||v[tt][0].s.r!=Be.r)&&delete Pe.f,Pe.f&&(Pe.f=""+da(v[tt][1],o,Be,R,D));break}}Bt.dense?(s[Be.r]||(s[Be.r]=[]),s[Be.r][Be.c]=Pe):s[f]=Pe}},D={enc:!1,sbcch:0,snames:[],sharedf:p,arrayf:v,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(D.password=t.password);var G,K=[],ae=[],Z=[],oe=[],Y=!1,R=[];R.SheetNames=D.snames,R.sharedf=D.sharedf,R.arrayf=D.arrayf,R.names=[],R.XTI=[];var z=0,ee=0,b=0,O=[],S=[],I;D.codepage=1200,Oo(1200);for(var U=!1;e.l<e.length-1;){var Q=e.l,H=e.read_shift(2);if(H===0&&z===10)break;var X=e.l===e.length?0:e.read_shift(2),V=MN[H];if(V&&V.f){if(t.bookSheets&&z===133&&H!==133)break;if(z=H,V.r===2||V.r==12){var Ae=e.read_shift(2);if(X-=2,!D.enc&&Ae!==H&&((Ae&255)<<8|Ae>>8)!==H)throw new Error("rt mismatch: "+Ae+"!="+H);V.r==12&&(e.l+=10,X-=10)}var W={};if(H===10?W=V.f(e,X,D):W=tse(H,V,e,X,D),ee==0&&[9,521,1033,2057].indexOf(z)===-1)continue;switch(H){case 34:r.opts.Date1904=j.WBProps.date1904=W;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(e.l=0),D.enc=W,!t.password)throw new Error("File is password-protected");if(W.valid==null)throw new Error("Encryption scheme unsupported");if(!W.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=W;break;case 66:var J=Number(W);switch(J){case 21010:J=1200;break;case 32768:J=1e4;break;case 32769:J=1252;break}Oo(D.codepage=J),U=!0;break;case 317:D.rrtabid=W;break;case 25:D.winlocked=W;break;case 439:r.opts.RefreshAll=W;break;case 12:r.opts.CalcCount=W;break;case 16:r.opts.CalcDelta=W;break;case 17:r.opts.CalcIter=W;break;case 13:r.opts.CalcMode=W;break;case 14:r.opts.CalcPrecision=W;break;case 95:r.opts.CalcSaveRecalc=W;break;case 15:D.CalcRefMode=W;break;case 2211:r.opts.FullCalc=W;break;case 129:W.fDialog&&(s["!type"]="dialog"),W.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),W.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:T.push(W);break;case 430:R.push([W]),R[R.length-1].XTI=[];break;case 35:case 547:R[R.length-1].push(W);break;case 24:case 536:I={Name:W.Name,Ref:da(W.rgce,o,null,R,D)},W.itab>0&&(I.Sheet=W.itab-1),R.names.push(I),R[0]||(R[0]=[],R[0].XTI=[]),R[R.length-1].push(W),W.Name=="_xlnm._FilterDatabase"&&W.itab>0&&W.rgce&&W.rgce[0]&&W.rgce[0][0]&&W.rgce[0][0][0]=="PtgArea3d"&&(S[W.itab-1]={ref:wr(W.rgce[0][0][1][2])});break;case 22:D.ExternCount=W;break;case 23:R.length==0&&(R[0]=[],R[0].XTI=[]),R[R.length-1].XTI=R[R.length-1].XTI.concat(W),R.XTI=R.XTI.concat(W);break;case 2196:if(D.biff<8)break;I!=null&&(I.Comment=W[1]);break;case 18:s["!protect"]=W;break;case 19:W!==0&&D.WTF&&console.error("Password verifier: "+W);break;case 133:i[W.pos]=W,D.snames.push(W.name);break;case 10:{if(--ee)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=wr(o),t.sheetRows&&t.sheetRows<=o.e.r){var ve=o.e.r;o.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=wr(o),o.e.r=ve}o.e.r++,o.e.c++}K.length>0&&(s["!merges"]=K),ae.length>0&&(s["!objects"]=ae),Z.length>0&&(s["!cols"]=Z),oe.length>0&&(s["!rows"]=oe),j.Sheets.push(E)}A===""?d=s:n[A]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[H]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[W.BIFFVer]||8),D.biffguess=W.BIFFVer==0,W.BIFFVer==0&&W.dt==4096&&(D.biff=5,U=!0,Oo(D.codepage=28591)),D.biff==8&&W.BIFFVer==0&&W.dt==16&&(D.biff=2),ee++)break;if(s=t.dense?[]:{},D.biff<8&&!U&&(U=!0,Oo(D.codepage=t.codepage||1252)),D.biff<5||W.BIFFVer==0&&W.dt==4096){A===""&&(A="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var de={pos:e.l-X,name:A};i[de.pos]=de,D.snames.push(A)}else A=(i[Q]||{name:""}).name;W.dt==32&&(s["!type"]="chart"),W.dt==64&&(s["!type"]="macro"),K=[],ae=[],D.arrayf=v=[],Z=[],oe=[],Y=!1,E={Hidden:(i[Q]||{hs:0}).hs,name:A}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[W.r]||[])[W.c]:s[Ar({c:W.c,r:W.r})])&&++W.c,w={ixfe:W.ixfe,XF:T[W.ixfe]||{},v:W.val,t:"n"},b>0&&(w.z=O[w.ixfe>>8&63]),rl(w,t,r.opts.Date1904),F({c:W.c,r:W.r},w,t);break;case 5:case 517:w={ixfe:W.ixfe,XF:T[W.ixfe],v:W.val,t:W.t},b>0&&(w.z=O[w.ixfe>>8&63]),rl(w,t,r.opts.Date1904),F({c:W.c,r:W.r},w,t);break;case 638:w={ixfe:W.ixfe,XF:T[W.ixfe],v:W.rknum,t:"n"},b>0&&(w.z=O[w.ixfe>>8&63]),rl(w,t,r.opts.Date1904),F({c:W.c,r:W.r},w,t);break;case 189:for(var te=W.c;te<=W.C;++te){var je=W.rkrec[te-W.c][0];w={ixfe:je,XF:T[je],v:W.rkrec[te-W.c][1],t:"n"},b>0&&(w.z=O[w.ixfe>>8&63]),rl(w,t,r.opts.Date1904),F({c:te,r:W.r},w,t)}break;case 6:case 518:case 1030:{if(W.val=="String"){l=W;break}if(w=Px(W.val,W.cell.ixfe,W.tt),w.XF=T[w.ixfe],t.cellFormula){var qe=W.formula;if(qe&&qe[0]&&qe[0][0]&&qe[0][0][0]=="PtgExp"){var He=qe[0][0][1][0],Ze=qe[0][0][1][1],xe=Ar({r:He,c:Ze});p[xe]?w.f=""+da(W.formula,o,W.cell,R,D):w.F=((t.dense?(s[He]||[])[Ze]:s[xe])||{}).F}else w.f=""+da(W.formula,o,W.cell,R,D)}b>0&&(w.z=O[w.ixfe>>8&63]),rl(w,t,r.opts.Date1904),F(W.cell,w,t),l=W}break;case 7:case 519:if(l)l.val=W,w=Px(W,l.cell.ixfe,"s"),w.XF=T[w.ixfe],t.cellFormula&&(w.f=""+da(l.formula,o,l.cell,R,D)),b>0&&(w.z=O[w.ixfe>>8&63]),rl(w,t,r.opts.Date1904),F(l.cell,w,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{v.push(W);var ue=Ar(W[0].s);if(h=t.dense?(s[W[0].s.r]||[])[W[0].s.c]:s[ue],t.cellFormula&&h){if(!l||!ue||!h)break;h.f=""+da(W[1],o,W[0],R,D),h.F=wr(W[0])}}break;case 1212:{if(!t.cellFormula)break;if(f){if(!l)break;p[Ar(l.cell)]=W[0],h=t.dense?(s[l.cell.r]||[])[l.cell.c]:s[Ar(l.cell)],(h||{}).f=""+da(W[0],o,u,R,D)}}break;case 253:w=Px(c[W.isst].t,W.ixfe,"s"),c[W.isst].h&&(w.h=c[W.isst].h),w.XF=T[w.ixfe],b>0&&(w.z=O[w.ixfe>>8&63]),rl(w,t,r.opts.Date1904),F({c:W.c,r:W.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:W.ixfe,XF:T[W.ixfe],t:"z"},b>0&&(w.z=O[w.ixfe>>8&63]),rl(w,t,r.opts.Date1904),F({c:W.c,r:W.r},w,t));break;case 190:if(t.sheetStubs)for(var Fe=W.c;Fe<=W.C;++Fe){var ke=W.ixfe[Fe-W.c];w={ixfe:ke,XF:T[ke],t:"z"},b>0&&(w.z=O[w.ixfe>>8&63]),rl(w,t,r.opts.Date1904),F({c:Fe,r:W.r},w,t)}break;case 214:case 516:case 4:w=Px(W.val,W.ixfe,"s"),w.XF=T[w.ixfe],b>0&&(w.z=O[w.ixfe>>8&63]),rl(w,t,r.opts.Date1904),F({c:W.c,r:W.r},w,t);break;case 0:case 512:ee===1&&(o=W);break;case 252:c=W;break;case 1054:if(D.biff==4){O[b++]=W[1];for(var Te=0;Te<b+163&&ar[Te]!=W[1];++Te);Te>=163&&tc(W[1],b+163)}else tc(W[1],W[0]);break;case 30:{O[b++]=W;for(var Ne=0;Ne<b+163&&ar[Ne]!=W;++Ne);Ne>=163&&tc(W,b+163)}break;case 229:K=K.concat(W);break;case 93:ae[W.cmo[0]]=D.lastobj=W;break;case 438:D.lastobj.TxO=W;break;case 127:D.lastobj.ImData=W;break;case 440:for(g=W[0].s.r;g<=W[0].e.r;++g)for(m=W[0].s.c;m<=W[0].e.c;++m)h=t.dense?(s[g]||[])[m]:s[Ar({c:m,r:g})],h&&(h.l=W[1]);break;case 2048:for(g=W[0].s.r;g<=W[0].e.r;++g)for(m=W[0].s.c;m<=W[0].e.c;++m)h=t.dense?(s[g]||[])[m]:s[Ar({c:m,r:g})],h&&h.l&&(h.l.Tooltip=W[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;h=t.dense?(s[W[0].r]||[])[W[0].c]:s[Ar(W[0])];var et=ae[W[2]];h||(t.dense?(s[W[0].r]||(s[W[0].r]=[]),h=s[W[0].r][W[0].c]={t:"z"}):h=s[Ar(W[0])]={t:"z"},o.e.r=Math.max(o.e.r,W[0].r),o.s.r=Math.min(o.s.r,W[0].r),o.e.c=Math.max(o.e.c,W[0].c),o.s.c=Math.min(o.s.c,W[0].c)),h.c||(h.c=[]),x={a:W[1],t:et.TxO.t},h.c.push(x)}break;case 2173:VJ(T[W.ixfe],W.ext);break;case 125:{if(!D.cellStyles)break;for(;W.e>=W.s;)Z[W.e--]={width:W.w/256,level:W.level||0,hidden:!!(W.flags&1)},Y||(Y=!0,DC(W.w/256)),yA(Z[W.e+1])}break;case 520:{var Se={};W.level!=null&&(oe[W.r]=Se,Se.level=W.level),W.hidden&&(oe[W.r]=Se,Se.hidden=!0),W.hpt&&(oe[W.r]=Se,Se.hpt=W.hpt,Se.hpx=Pf(W.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||pd(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[H]]=W;break;case 161:s["!margins"]||pd(s["!margins"]={}),s["!margins"].header=W.header,s["!margins"].footer=W.footer;break;case 574:W.RTL&&(j.Views[0].RTL=!0);break;case 146:_=W;break;case 2198:G=W;break;case 140:B=W;break;case 442:A?E.CodeName=W||E.name:j.WBProps.CodeName=W||"ThisWorkbook";break}}else V||console.error("Missing Info for XLS Record 0x"+H.toString(16)),e.l+=X}return r.SheetNames=Gn(i).sort(function(Ce,Be){return Number(Ce)-Number(Be)}).map(function(Ce){return i[Ce].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&S.forEach(function(Ce,Be){r.Sheets[r.SheetNames[Be]]["!autofilter"]=Ce}),r.Strings=c,r.SSF=Sn(ar),D.enc&&(r.Encryption=D.enc),G&&(r.Themes=G),r.Metadata={},B!==void 0&&(r.Metadata.Country=B),R.names.length>0&&(j.Names=R.names),r.Workbook=j,r}var Qh={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function nse(e,t,r){var n=Jt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=ZS(n,LN,Qh.DSI);for(var i in s)t[i]=s[i]}catch(A){if(r.WTF)throw A}var o=Jt.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=ZS(o,UN,Qh.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(A){if(r.WTF)throw A}t.HeadingPairs&&t.TitlesOfParts&&(Z8(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function sse(e,t){var r=[],n=[],s=[],i=0,o,l=ES(LN,"n"),c=ES(UN,"n");if(e.Props)for(o=Gn(e.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?n:s).push([o[i],e.Props[o[i]]]);if(e.Custprops)for(o=Gn(e.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?n:s).push([o[i],e.Custprops[o[i]]]);var A=[];for(i=0;i<s.length;++i)iL.indexOf(s[i][0])>-1||J8.indexOf(s[i][0])>-1||s[i][1]!=null&&A.push(s[i]);n.length&&Jt.utils.cfb_add(t,"/SummaryInformation",eF(n,Qh.SI,c,UN)),(r.length||A.length)&&Jt.utils.cfb_add(t,"/DocumentSummaryInformation",eF(r,Qh.DSI,l,LN,A.length?A:null,Qh.UDI))}function tU(e,t){t||(t={}),qC(t),uC(),t.codepage&&dC(t.codepage);var r,n;if(e.FullPaths){if(Jt.find(e,"/encryption"))throw new Error("File is password-protected");r=Jt.find(e,"!CompObj"),n=Jt.find(e,"/Workbook")||Jt.find(e,"/Book")}else{switch(t.type){case"base64":e=gi(ki(e));break;case"binary":e=gi(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}$s(e,0),n={content:e}}var s,i;if(r&&Zne(r),t.bookProps&&!t.bookSheets)s={};else{var o=Cr?"buffer":"array";if(n&&n.content)s=rse(n.content,t);else if((i=Jt.find(e,"PerfectOffice_MAIN"))&&i.content)s=md.to_workbook(i.content,(t.type=o,t));else if((i=Jt.find(e,"NativeContent_MAIN"))&&i.content)s=md.to_workbook(i.content,(t.type=o,t));else throw(i=Jt.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Jt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=xZ(e))}var l={};return e.FullPaths&&nse(e,l,t),s.Props=s.Custprops=l,t.bookFiles&&(s.cfb=e),s}function ase(e,t){var r=t||{},n=Jt.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Jt.utils.cfb_add(n,s,rU(e,r)),r.biff==8&&(e.Props||e.Custprops)&&sse(e,n),r.biff==8&&e.vbaraw&&gZ(n,Jt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Bm={0:{f:Ete},1:{f:Pte},2:{f:rre},3:{f:qte},4:{f:Mte},5:{f:Zte},6:{f:ore},7:{f:Wte},8:{f:hre},9:{f:fre},10:{f:dre},11:{f:ure},12:{f:Rte},13:{f:sre},14:{f:zte},15:{f:Vte},16:{f:zL},17:{f:cre},18:{f:Yte},19:{f:BC},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:cne},40:{},42:{},43:{f:oJ},44:{f:aJ},45:{f:AJ},46:{f:uJ},47:{f:dJ},48:{},49:{f:_G},50:{},51:{f:KJ},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:xL},62:{f:ire},63:{f:tZ},64:{f:kre},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:va,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Bre},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Ute},148:{f:_te,p:16},151:{f:vre},152:{},153:{f:ine},154:{},155:{},156:{f:sne},157:{},158:{},159:{T:1,f:bY},160:{T:-1},161:{T:1,f:Kd},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:mre},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:$J},336:{T:-1},337:{f:WJ,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:IN},357:{},358:{},359:{},360:{T:1},361:{},362:{f:pL},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:wre},427:{f:bre},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Cre},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Lte},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:gre},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:IN},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:uZ},633:{T:1},634:{T:-1},635:{T:1,f:AZ},636:{T:-1},637:{f:DG},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:zre},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Tre},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},MN={6:{f:jw},10:{f:Uc},12:{f:hs},13:{f:hs},14:{f:Jn},15:{f:Jn},16:{f:pa},17:{f:Jn},18:{f:Jn},19:{f:hs},20:{f:iF},21:{f:iF},23:{f:pL},24:{f:lF},25:{f:Jn},26:{},27:{},28:{f:TX},29:{},34:{f:Jn},35:{f:oF},38:{f:pa},39:{f:pa},40:{f:pa},41:{f:pa},42:{f:Jn},43:{f:Jn},47:{f:VY},49:{f:sX},51:{f:hs},60:{},61:{f:ZW},64:{f:Jn},65:{f:nX},66:{f:hs},77:{},80:{},81:{},82:{},85:{f:hs},89:{},90:{},91:{},92:{f:HW},93:{f:LX},94:{},95:{f:Jn},96:{},97:{},99:{f:Jn},125:{f:xL},128:{f:yX},129:{f:$W},130:{f:hs},131:{f:Jn},132:{f:Jn},133:{f:qW},134:{},140:{f:HX},141:{f:hs},144:{},146:{f:qX},151:{},152:{},153:{},154:{},155:{},156:{f:hs},157:{},158:{},160:{f:JX},161:{f:GX},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:mX},190:{f:pX},193:{f:Uc},197:{},198:{},199:{},200:{},201:{},202:{f:Jn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:hs},220:{},221:{f:Jn},222:{},224:{f:gX},225:{f:MW},226:{f:Uc},227:{},229:{f:_X},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:zW},253:{f:iX},255:{f:WW},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:oL},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Jn},353:{f:Uc},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:CX},431:{f:Jn},432:{},433:{},434:{},437:{},438:{f:PX},439:{f:Jn},440:{f:OX},441:{},442:{f:ap},443:{},444:{f:hs},445:{},446:{},448:{f:Uc},449:{f:JW,r:2},450:{f:Uc},512:{f:nF},513:{f:YX},515:{f:bX},516:{f:lX},517:{f:aF},519:{f:ZX},520:{f:XW},523:{},545:{f:cF},549:{f:rF},566:{},574:{f:tX},638:{f:hX},659:{},1048:{},1054:{f:AX},1084:{},1212:{f:FX},2048:{f:QX},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Lx},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Uc},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:KX,r:12},2173:{f:HJ,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Jn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:SX,r:12},2197:{},2198:{f:DJ,r:12},2199:{},2200:{},2201:{},2202:{f:EX,r:12},2203:{f:Uc},2204:{},2205:{},2206:{},2207:{},2211:{f:YW},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:hs},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:WX},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:$X},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:nF},1:{},2:{f:sY},3:{f:rY},4:{f:tY},5:{f:aF},7:{f:iY},8:{},9:{f:Lx},11:{},22:{f:hs},30:{f:uX},31:{},32:{},33:{f:cF},36:{},37:{f:rF},50:{f:oY},62:{},52:{},67:{},68:{f:hs},69:{},86:{},126:{},127:{f:eY},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:lY},223:{},234:{},354:{},421:{},518:{f:jw},521:{f:Lx},536:{f:lF},547:{f:oF},561:{},579:{},1030:{f:jw},1033:{f:Lx},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function kt(e,t,r,n){var s=t;if(!isNaN(s)){var i=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,i),i>0&&NC(r)&&e.push(r)}}function ise(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return kt(e,t,r,s);var i=t;if(!isNaN(i)){for(var o=r.parts||[],l=0,c=0,A=0;A+(o[l]||8224)<=8224;)A+=o[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,i),d.write_shift(2,A),e.push(r.slice(c,c+A)),c+=A;c<s;){for(d=e.next(4),d.write_shift(2,60),A=0;A+(o[l]||8224)<=8224;)A+=o[l]||8224,l++;d.write_shift(2,A),e.push(r.slice(c,c+A)),c+=A}}}function cp(e,t,r){return e||(e=ot(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function ose(e,t,r,n){var s=ot(9);return cp(s,e,t),lL(r,n||"b",s),s}function lse(e,t,r){var n=ot(8+2*r.length);return cp(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function cse(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Ns(Bn(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?kt(e,2,aY(r,n,s)):kt(e,3,nY(r,n,s));return;case"b":case"e":kt(e,5,ose(r,n,t.v,t.t));return;case"s":case"str":kt(e,4,lse(r,n,(t.v||"").slice(0,255)));return}kt(e,1,cp(null,r,n))}function Ase(e,t,r,n){var s=Array.isArray(t),i=Rr(t["!ref"]||"A1"),o,l="",c=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=wr(i)}for(var A=i.s.r;A<=i.e.r;++A){l=is(A);for(var d=i.s.c;d<=i.e.c;++d){A===i.s.r&&(c[d]=Dn(d)),o=c[d]+l;var u=s?(t[A]||[])[d]:t[o];u&&cse(e,u,A,d)}}}function dse(e,t){for(var r=t||{},n=Za(),s=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return kt(n,r.biff==4?1033:r.biff==3?521:9,IC(e,16,r)),Ase(n,e.Sheets[e.SheetNames[s]],s,r),kt(n,10),n.end()}function use(e,t,r){kt(e,49,aX({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function fse(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&kt(e,1054,dX(s,t[s],r))})}function hse(e,t){var r=ot(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),kt(e,2151,r),r=ot(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),fL(Rr(t["!ref"]||"A1"),r),r.write_shift(4,4),kt(e,2152,r)}function mse(e,t){for(var r=0;r<16;++r)kt(e,224,sF({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){kt(e,224,sF(n,0,t))})}function pse(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];kt(e,440,RX(n)),n[1].Tooltip&&kt(e,2048,MX(n))}delete t["!links"]}function xse(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&kt(e,125,zX(xv(s,n),s))})}}function gse(e,t,r,n,s){var i=16+TA(s.cellXfs,t,s);if(t.v==null&&!t.bf){kt(e,513,Id(r,n,i));return}if(t.bf)kt(e,6,$ee(t,r,n,s,i));else switch(t.t){case"d":case"n":var o=t.t=="d"?Ns(Bn(t.v)):t.v;kt(e,515,NX(r,n,o,i));break;case"b":case"e":kt(e,517,wX(r,n,t.v,i,s,t.t));break;case"s":case"str":if(s.bookSST){var l=MC(s.Strings,t.v,s.revStrings);kt(e,253,oX(r,n,l,i))}else kt(e,516,cX(r,n,(t.v||"").slice(0,255),i,s));break;default:kt(e,513,Id(r,n,i))}}function yse(e,t,r){var n=Za(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(i),A=t.biff==8,d,u="",f=[],h=Rr(i["!ref"]||"A1"),x=A?65536:16384;if(h.e.c>255||h.e.r>=x){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,x-1)}kt(n,2057,IC(r,16,t)),kt(n,13,eo(1)),kt(n,12,eo(100)),kt(n,15,Ta(!0)),kt(n,17,Ta(!1)),kt(n,16,Td(.001)),kt(n,95,Ta(!0)),kt(n,42,Ta(!1)),kt(n,43,Ta(!1)),kt(n,130,eo(1)),kt(n,128,vX()),kt(n,131,Ta(!1)),kt(n,132,Ta(!1)),A&&xse(n,i["!cols"]),kt(n,512,fX(h,t)),A&&(i["!links"]=[]);for(var m=h.s.r;m<=h.e.r;++m){u=is(m);for(var g=h.s.c;g<=h.e.c;++g){m===h.s.r&&(f[g]=Dn(g)),d=f[g]+u;var p=c?(i[m]||[])[g]:i[d];p&&(gse(n,p,m,g,t),A&&p.l&&i["!links"].push([d,p.l]))}}var v=l.CodeName||l.name||s;return A&&kt(n,574,rX((o.Views||[])[0])),A&&(i["!merges"]||[]).length&&kt(n,229,IX(i["!merges"])),A&&pse(n,i),kt(n,442,cL(v)),A&&hse(n,i),kt(n,10),n.end()}function vse(e,t,r){var n=Za(),s=(e||{}).Workbook||{},i=s.Sheets||[],o=s.WBProps||{},l=r.biff==8,c=r.biff==5;if(kt(n,2057,IC(e,5,r)),r.bookType=="xla"&&kt(n,135),kt(n,225,l?eo(1200):null),kt(n,193,wW(2)),c&&kt(n,191),c&&kt(n,192),kt(n,226),kt(n,92,VW("SheetJS",r)),kt(n,66,eo(l?1200:1252)),l&&kt(n,353,eo(0)),l&&kt(n,448),kt(n,317,XX(e.SheetNames.length)),l&&e.vbaraw&&kt(n,211),l&&e.vbaraw){var A=o.CodeName||"ThisWorkbook";kt(n,442,cL(A))}kt(n,156,eo(17)),kt(n,25,Ta(!1)),kt(n,18,Ta(!1)),kt(n,19,eo(0)),l&&kt(n,431,Ta(!1)),l&&kt(n,444,eo(0)),kt(n,61,eX()),kt(n,64,Ta(!1)),kt(n,141,eo(0)),kt(n,34,Ta(Jre(e)=="true")),kt(n,14,Ta(!0)),l&&kt(n,439,Ta(!1)),kt(n,218,eo(0)),use(n,e,r),fse(n,e.SSF,r),mse(n,r),l&&kt(n,352,Ta(!1));var d=n.end(),u=Za();l&&kt(u,140,VX()),l&&r.Strings&&ise(u,252,GW(r.Strings)),kt(u,10);var f=u.end(),h=Za(),x=0,m=0;for(m=0;m<e.SheetNames.length;++m)x+=(l?12:11)+(l?2:1)*e.SheetNames[m].length;var g=d.length+x+f.length;for(m=0;m<e.SheetNames.length;++m){var p=i[m]||{};kt(h,133,KW({pos:g,hs:p.Hidden||0,dt:0,name:e.SheetNames[m]},r)),g+=t[m].length}var v=h.end();if(x!=v.length)throw new Error("BS8 "+x+" != "+v.length);var w=[];return d.length&&w.push(d),v.length&&w.push(v),f.length&&w.push(f),_s(w)}function wse(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Sn(ar)),e&&e.SSF&&(t0(),Av(e.SSF),r.revssf=uv(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,KC(r),r.cellXfs=[],TA(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=yse(s,r,e);return n.unshift(vse(e,n,r)),_s(n)}function rU(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=ni(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return wse(e,t);case 4:case 3:case 2:return dse(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function yF(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=s.index,l=i&&i.index||e.length,c=aG(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),A=-1,d=0,u=0,f=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(o=0;o<c.length;++o){var m=c[o].trim(),g=m.slice(0,3).toLowerCase();if(g=="<tr"){if(++A,r.sheetRows&&r.sheetRows<=A){--A;break}d=0;continue}if(!(g!="<td"&&g!="<th")){var p=m.split(/<\/t[dh]>/i);for(l=0;l<p.length;++l){var v=p[l].trim();if(v.match(/<t[dh]/i)){for(var w=v,B=0;w.charAt(0)=="<"&&(B=w.indexOf(">"))>-1;)w=w.slice(B+1);for(var T=0;T<x.length;++T){var _=x[T];_.s.c==d&&_.s.r<A&&A<=_.e.r&&(d=_.e.c+1,T=-1)}var j=dr(v.slice(0,v.indexOf(">")));f=j.colspan?+j.colspan:1,((u=+j.rowspan)>1||f>1)&&x.push({s:{r:A,c:d},e:{r:A+(u||1)-1,c:d+f-1}});var E=j.t||j["data-t"]||"";if(!w.length){d+=f;continue}if(w=B8(w),h.s.r>A&&(h.s.r=A),h.e.r<A&&(h.e.r=A),h.s.c>d&&(h.s.c=d),h.e.c<d&&(h.e.c=d),!w.length){d+=f;continue}var L={t:"s",v:w};r.raw||!w.trim().length||E=="s"||(w==="TRUE"?L={t:"b",v:!0}:w==="FALSE"?L={t:"b",v:!1}:isNaN(Ho(w))?isNaN(Uf(w).getDate())||(L={t:"d",v:Bn(w)},r.cellDates||(L={t:"n",v:Ns(L.v)}),L.z=r.dateNF||ar[14]):L={t:"n",v:Ho(w)}),r.dense?(n[A]||(n[A]=[]),n[A][d]=L):n[Ar({r:A,c:d})]=L,d+=f}}}}return n["!ref"]=wr(h),x.length&&(n["!merges"]=x),n}function bse(e,t,r,n){for(var s=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,A=0;A<s.length;++A)if(!(s[A].s.r>r||s[A].s.c>o)&&!(s[A].e.r<r||s[A].e.c<o)){if(s[A].s.r<r||s[A].s.c<o){l=-1;break}l=s[A].e.r-s[A].s.r+1,c=s[A].e.c-s[A].s.c+1;break}if(!(l<0)){var d=Ar({r,c:o}),u=n.dense?(e[r]||[])[o]:e[d],f=u&&u.v!=null&&(u.h||vC(u.w||(dc(u),u.w)||""))||"",h={};l>1&&(h.rowspan=l),c>1&&(h.colspan=c),n.editable?f='<span contenteditable="true">'+f+"</span>":u&&(h["data-t"]=u&&u.t||"z",u.v!=null&&(h["data-v"]=u.v),u.z!=null&&(h["data-z"]=u.z),u.l&&(u.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+u.l.Target+'">'+f+"</a>")),h.id=(n.id||"sjs")+"-"+d,i.push(Ft("td",f,h))}}var x="<tr>";return x+i.join("")+"</tr>"}var Nse='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Cse="</body></html>";function jse(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return kA(yF(r[0],t),t);var n=WC();return r.forEach(function(s,i){XC(n,yF(s,t),"Sheet"+(i+1))}),n}function Bse(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function nU(e,t){var r=t||{},n=r.header!=null?r.header:Nse,s=r.footer!=null?r.footer:Cse,i=[n],o=ni(e["!ref"]);r.dense=Array.isArray(e),i.push(Bse(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)i.push(bse(e,o,l,r));return i.push("</table>"+s),i.join("")}function sU(e,t,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var o=typeof n.origin=="string"?Pn(n.origin):n.origin;s=o.r,i=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),A={s:{r:0,c:0},e:{r:s,c:i}};if(e["!ref"]){var d=ni(e["!ref"]);A.s.r=Math.min(A.s.r,d.s.r),A.s.c=Math.min(A.s.c,d.s.c),A.e.r=Math.max(A.e.r,d.e.r),A.e.c=Math.max(A.e.c,d.e.c),s==-1&&(A.e.r=s=d.e.r+1)}var u=[],f=0,h=e["!rows"]||(e["!rows"]=[]),x=0,m=0,g=0,p=0,v=0,w=0;for(e["!cols"]||(e["!cols"]=[]);x<l.length&&m<c;++x){var B=l[x];if(vF(B)){if(n.display)continue;h[m]={hidden:!0}}var T=B.children;for(g=p=0;g<T.length;++g){var _=T[g];if(!(n.display&&vF(_))){var j=_.hasAttribute("data-v")?_.getAttribute("data-v"):_.hasAttribute("v")?_.getAttribute("v"):B8(_.innerHTML),E=_.getAttribute("data-z")||_.getAttribute("z");for(f=0;f<u.length;++f){var L=u[f];L.s.c==p+i&&L.s.r<m+s&&m+s<=L.e.r&&(p=L.e.c+1-i,f=-1)}w=+_.getAttribute("colspan")||1,((v=+_.getAttribute("rowspan")||1)>1||w>1)&&u.push({s:{r:m+s,c:p+i},e:{r:m+s+(v||1)-1,c:p+i+(w||1)-1}});var M={t:"s",v:j},F=_.getAttribute("data-t")||_.getAttribute("t")||"";j!=null&&(j.length==0?M.t=F||"z":n.raw||j.trim().length==0||F=="s"||(j==="TRUE"?M={t:"b",v:!0}:j==="FALSE"?M={t:"b",v:!1}:isNaN(Ho(j))?isNaN(Uf(j).getDate())||(M={t:"d",v:Bn(j)},n.cellDates||(M={t:"n",v:Ns(M.v)}),M.z=n.dateNF||ar[14]):M={t:"n",v:Ho(j)})),M.z===void 0&&E!=null&&(M.z=E);var D="",G=_.getElementsByTagName("A");if(G&&G.length)for(var K=0;K<G.length&&!(G[K].hasAttribute("href")&&(D=G[K].getAttribute("href"),D.charAt(0)!="#"));++K);D&&D.charAt(0)!="#"&&(M.l={Target:D}),n.dense?(e[m+s]||(e[m+s]=[]),e[m+s][p+i]=M):e[Ar({c:p+i,r:m+s})]=M,A.e.c<p+i&&(A.e.c=p+i),p+=w}}++m}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),A.e.r=Math.max(A.e.r,m-1+s),e["!ref"]=wr(A),m>=c&&(e["!fullref"]=wr((A.e.r=l.length-x+m-1+s,A))),e}function aU(e,t){var r=t||{},n=r.dense?[]:{};return sU(n,e,t)}function Sse(e,t){return kA(aU(e,t),t)}function vF(e){var t="",r=Fse(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Fse(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Ese(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Or(t.replace(/<[^>]*>/g,""));return[r]}var wF={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function iU(e,t){var r=t||{},n=wC(e),s=[],i,o,l={name:""},c="",A=0,d,u,f={},h=[],x=r.dense?[]:{},m,g,p={value:""},v="",w=0,B=[],T=-1,_=-1,j={s:{r:1e6,c:1e7},e:{r:0,c:0}},E=0,L={},M=[],F={},D=0,G=0,K=[],ae=1,Z=1,oe=[],Y={Names:[]},R={},z=["",""],ee=[],b={},O="",S=0,I=!1,U=!1,Q=0;for(vm.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=vm.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(j.e.c>=j.s.c&&j.e.r>=j.s.r?x["!ref"]=wr(j):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=j.e.r&&(x["!fullref"]=x["!ref"],j.e.r=r.sheetRows-1,x["!ref"]=wr(j)),M.length&&(x["!merges"]=M),K.length&&(x["!rows"]=K),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),h.push(d.name),f[d.name]=x,U=!1):m[0].charAt(m[0].length-2)!=="/"&&(d=dr(m[0],!1),T=_=-1,j.s.r=j.s.c=1e7,j.e.r=j.e.c=0,x=r.dense?[]:{},M=[],K=[],U=!0);break;case"table-row-group":m[1]==="/"?--E:++E;break;case"table-row":case"":if(m[1]==="/"){T+=ae,ae=1;break}if(u=dr(m[0],!1),u.?T=u.-1:T==-1&&(T=0),ae=+u["number-rows-repeated"]||1,ae<10)for(Q=0;Q<ae;++Q)E>0&&(K[T+Q]={level:E});_=-1;break;case"covered-table-cell":m[1]!=="/"&&++_,r.sheetStubs&&(r.dense?(x[T]||(x[T]=[]),x[T][_]={t:"z"}):x[Ar({r:T,c:_})]={t:"z"}),v="",B=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++_,p=dr(m[0],!1),Z=parseInt(p["number-columns-repeated"]||"1",10),g={t:"z",v:null},p.formula&&r.cellFormula!=!1&&(g.f=pF(Or(p.formula))),(p.||p["value-type"])=="string"&&(g.t="s",g.v=Or(p["string-value"]||""),r.dense?(x[T]||(x[T]=[]),x[T][_]=g):x[Ar({r:T,c:_})]=g),_+=Z-1;else if(m[1]!=="/"){++_,v="",w=0,B=[],Z=1;var H=ae?T+ae-1:T;if(_>j.e.c&&(j.e.c=_),_<j.s.c&&(j.s.c=_),T<j.s.r&&(j.s.r=T),H>j.e.r&&(j.e.r=H),p=dr(m[0],!1),ee=[],b={},g={t:p.||p["value-type"],v:null},r.cellFormula)if(p.formula&&(p.formula=Or(p.formula)),p["number-matrix-columns-spanned"]&&p["number-matrix-rows-spanned"]&&(D=parseInt(p["number-matrix-rows-spanned"],10)||0,G=parseInt(p["number-matrix-columns-spanned"],10)||0,F={s:{r:T,c:_},e:{r:T+D-1,c:_+G-1}},g.F=wr(F),oe.push([F,g.F])),p.formula)g.f=pF(p.formula);else for(Q=0;Q<oe.length;++Q)T>=oe[Q][0].s.r&&T<=oe[Q][0].e.r&&_>=oe[Q][0].s.c&&_<=oe[Q][0].e.c&&(g.F=oe[Q][1]);switch((p["number-columns-spanned"]||p["number-rows-spanned"])&&(D=parseInt(p["number-rows-spanned"],10)||0,G=parseInt(p["number-columns-spanned"],10)||0,F={s:{r:T,c:_},e:{r:T+D-1,c:_+G-1}},M.push(F)),p["number-columns-repeated"]&&(Z=parseInt(p["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=Nn(p["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(p.value);break;case"percentage":g.t="n",g.v=parseFloat(p.value);break;case"currency":g.t="n",g.v=parseFloat(p.value);break;case"date":g.t="d",g.v=Bn(p["date-value"]),r.cellDates||(g.t="n",g.v=Ns(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=rG(p["time-value"])/86400,r.cellDates&&(g.t="d",g.v=fv(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(p.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",p["string-value"]!=null&&(v=Or(p["string-value"]),B=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(I=!1,g.t==="s"&&(g.v=v||"",B.length&&(g.R=B),I=w==0),R.Target&&(g.l=R),ee.length>0&&(g.c=ee,ee=[]),v&&r.cellText!==!1&&(g.w=v),I&&(g.t="z",delete g.v),(!I||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=T))for(var X=0;X<ae;++X){if(Z=parseInt(p["number-columns-repeated"]||"1",10),r.dense)for(x[T+X]||(x[T+X]=[]),x[T+X][_]=X==0?g:Sn(g);--Z>0;)x[T+X][_+Z]=Sn(g);else for(x[Ar({r:T+X,c:_})]=g;--Z>0;)x[Ar({r:T+X,c:_+Z})]=Sn(g);j.e.c<=_&&(j.e.c=_)}Z=parseInt(p["number-columns-repeated"]||"1",10),_+=Z-1,Z=0,g={},v="",B=[]}R={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((i=s.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((i=s.pop())[0]!==m[3])throw"Bad state: "+i;b.t=v,B.length&&(b.R=B),b.a=O,ee.push(b)}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!1]);O="",S=0,v="",w=0,B=[];break;case"creator":m[1]==="/"?O=n.slice(S,m.index):S=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((i=s.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!1]);v="",w=0,B=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(L[l.name]=c,(i=s.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&(c="",l=dr(m[0],!1),s.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=dr(m[0],!1),c+=wF[m[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=dr(m[0],!1),c+=wF[m[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(A,m.index);break}else A=m.index+m[0].length;break;case"named-range":o=dr(m[0],!1),z=Bw(o["cell-range-address"]);var V={Name:o.name,Ref:z[0]+"!"+z[1]};U&&(V.Sheet=h.length),Y.Names.push(V);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(m[1]==="/"&&(!p||!p["string-value"])){var Ae=Ese(n.slice(w,m.index));v=(v.length>0?v+`
`:"")+Ae[0]}else dr(m[0],!1),w=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{z=Bw(dr(m[0])["target-range-address"]),f[z[0]]["!autofilter"]={ref:z[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(R=dr(m[0],!1),!R.href)break;R.Target=Or(R.href),delete R.href,R.Target.charAt(0)=="#"&&R.Target.indexOf(".")>-1?(z=Bw(R.Target.slice(1)),R.Target="#"+z[0]+"!"+z[1]):R.Target.match(/^\.\.[\\\/]/)&&(R.Target=R.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var W={Sheets:f,SheetNames:h,Workbook:Y};return r.bookSheets&&delete W.Sheets,W}function bF(e,t){t=t||{},Ji(e,"META-INF/manifest.xml")&&rW(fs(e,"META-INF/manifest.xml"),t);var r=yi(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=iU(cn(r),t);return Ji(e,"meta.xml")&&(n.Props=X8(fs(e,"meta.xml"))),n}function NF(e,t){return iU(e,t)}var kse=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+ym({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return os+t}}(),CF=function(){var e=function(i){return nn(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,o,l){var c=[];c.push('      <table:table table:name="'+nn(o.SheetNames[l])+`" table:style-name="ta1">
`);var A=0,d=0,u=ni(i["!ref"]||"A1"),f=i["!merges"]||[],h=0,x=Array.isArray(i);if(i["!cols"])for(d=0;d<=u.e.c;++d)c.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var m="",g=i["!rows"]||[];for(A=0;A<u.s.r;++A)m=g[A]?' table:style-name="ro'+g[A].ods+'"':"",c.push("        <table:table-row"+m+`></table:table-row>
`);for(;A<=u.e.r;++A){for(m=g[A]?' table:style-name="ro'+g[A].ods+'"':"",c.push("        <table:table-row"+m+`>
`),d=0;d<u.s.c;++d)c.push(t);for(;d<=u.e.c;++d){var p=!1,v={},w="";for(h=0;h!=f.length;++h)if(!(f[h].s.c>d)&&!(f[h].s.r>A)&&!(f[h].e.c<d)&&!(f[h].e.r<A)){(f[h].s.c!=d||f[h].s.r!=A)&&(p=!0),v["table:number-columns-spanned"]=f[h].e.c-f[h].s.c+1,v["table:number-rows-spanned"]=f[h].e.r-f[h].s.r+1;break}if(p){c.push(r);continue}var B=Ar({r:A,c:d}),T=x?(i[A]||[])[d]:i[B];if(T&&T.f&&(v["table:formula"]=nn(Xee(T.f)),T.F&&T.F.slice(0,B.length)==B)){var _=ni(T.F);v["table:number-matrix-columns-spanned"]=_.e.c-_.s.c+1,v["table:number-matrix-rows-spanned"]=_.e.r-_.s.r+1}if(!T){c.push(t);continue}switch(T.t){case"b":w=T.v?"TRUE":"FALSE",v["office:value-type"]="boolean",v["office:boolean-value"]=T.v?"true":"false";break;case"n":w=T.w||String(T.v||0),v["office:value-type"]="float",v["office:value"]=T.v||0;break;case"s":case"str":w=T.v==null?"":T.v,v["office:value-type"]="string";break;case"d":w=T.w||Bn(T.v).toISOString(),v["office:value-type"]="date",v["office:date-value"]=Bn(T.v).toISOString(),v["table:style-name"]="ce1";break;default:c.push(t);continue}var j=e(w);if(T.l&&T.l.Target){var E=T.l.Target;E=E.charAt(0)=="#"?"#"+Yee(E.slice(1)):E,E.charAt(0)!="#"&&!E.match(/^\w+:/)&&(E="../"+E),j=Ft("text:a",j,{"xlink:href":E.replace(/&/g,"&amp;")})}c.push("          "+Ft("table:table-cell",Ft("text:p",j,{}),v)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(A){return o.Sheets[A]}).forEach(function(A){if(A&&A["!cols"]){for(var d=0;d<A["!cols"].length;++d)if(A["!cols"][d]){var u=A["!cols"][d];if(u.width==null&&u.wpx==null&&u.wch==null)continue;yA(u),u.ods=l;var f=A["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),i.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(A){return o.Sheets[A]}).forEach(function(A){if(A&&A["!rows"]){for(var d=0;d<A["!rows"].length;++d)if(A["!rows"][d]){A["!rows"][d].ods=c;var u=A["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+u+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,l){var c=[os],A=ym({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=ym({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+A+d+`>
`),c.push(W8().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+A+`>
`),s(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var u=0;u!=o.SheetNames.length;++u)c.push(n(o.Sheets[o.SheetNames[u]],o,u));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function oU(e,t){if(t.bookType=="fods")return CF(e,t);var r=xC(),n="",s=[],i=[];return n="mimetype",br(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",br(r,n,CF(e,t)),s.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",br(r,n,kse(e,t)),s.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",br(r,n,os+W8()),s.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",br(r,n,aW(i)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",br(r,n,nW(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ld(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function HN(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):cn(EA(e))}function Tse(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):gi(hl(e))}function _se(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function wA(e){var t=e.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function jF(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Ise(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Lse(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;s>=1;++i,s/=256)e[t+i]=s&255;e[t+15]|=r>=0?0:128}function Sm(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function en(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Kn(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Hr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=Sm(e,r),i=s&7;s=Math.floor(s/8);var o=0,l;if(s==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Sm(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var A={data:l,type:i};t[s]==null?t[s]=[A]:t[s].push(A)}return t}function Ms(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(en(n*8+s.type)),s.type==2&&t.push(en(s.data.length)),t.push(s.data))})}),wA(t)}function $C(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Wi(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=Sm(e,n),i=Hr(e.slice(n[0],n[0]+s));n[0]+=s;var o={id:Kn(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=Hr(l.data),A=Kn(c[3][0].data);o.messages.push({meta:c,data:e.slice(n[0],n[0]+A)}),n[0]+=A}),(t=i[3])!=null&&t[0]&&(o.merge=Kn(i[3][0].data)>>>0>0),r.push(o)}return r}function Bu(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:en(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:en(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:en(o.data.length)}],n[2].push({data:Ms(o.meta),type:2})});var i=Ms(n);t.push(en(i.length)),t.push(i),s.forEach(function(o){return t.push(o)})}),wA(t)}function Use(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Sm(t,r),s=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}s.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,A=0;if(i==1?(A=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(A=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[wA(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(A>=c)for(s.push(s[0].slice(-c)),A-=c;A>=s[s.length-1].length;)s.push(s[s.length-1]),A-=s[s.length-1].length;s.push(s[0].slice(-c,-c+A))}}var d=wA(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Xi(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Use(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return wA(t)}function Su(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var i=en(n),o=i.length;t.push(i),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=n}return wA(t)}function Dse(e,t,r,n){var s=Ld(e),i=s.getUint32(4,!0),o=(n>1?12:8)+jF(i&(n>1?3470:398))*4,l=-1,c=-1,A=NaN,d=new Date(2001,0,1);i&512&&(l=s.getUint32(o,!0),o+=4),o+=jF(i&(n>1?12288:4096))*4,i&16&&(c=s.getUint32(o,!0),o+=4),i&32&&(A=s.getFloat64(o,!0),o+=8),i&64&&(d.setTime(d.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var u;switch(e[2]){case 0:break;case 2:u={t:"n",v:A};break;case 3:u={t:"s",v:t[c]};break;case 5:u={t:"d",v:d};break;case 6:u={t:"b",v:A>0};break;case 7:u={t:"n",v:A/86400};break;case 8:u={t:"e",v:0};break;case 9:if(l>-1)u={t:"s",v:r[l]};else if(c>-1)u={t:"s",v:t[c]};else if(!isNaN(A))u={t:"n",v:A};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return u}function Pse(e,t,r){var n=Ld(e),s=n.getUint32(8,!0),i=12,o=-1,l=-1,c=NaN,A=NaN,d=new Date(2001,0,1);s&1&&(c=Ise(e,i),i+=16),s&2&&(A=n.getFloat64(i,!0),i+=8),s&4&&(d.setTime(d.getTime()+n.getFloat64(i,!0)*1e3),i+=8),s&8&&(l=n.getUint32(i,!0),i+=4),s&16&&(o=n.getUint32(i,!0),i+=4);var u;switch(e[1]){case 0:break;case 2:u={t:"n",v:c};break;case 3:u={t:"s",v:t[l]};break;case 5:u={t:"d",v:d};break;case 6:u={t:"b",v:A>0};break;case 7:u={t:"n",v:A/86400};break;case 8:u={t:"e",v:0};break;case 9:if(o>-1)u={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:u={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return u}function Fw(e,t){var r=new Uint8Array(32),n=Ld(r),s=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,Lse(r,s,e.v),i|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),i|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,s)}function Ew(e,t){var r=new Uint8Array(32),n=Ld(r),s=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),i|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),i|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,s)}function Ose(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Dse(e,t,r,e[0]);case 5:return Pse(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Aa(e){var t=Hr(e);return Sm(t[1][0].data)}function BF(e,t){var r=Hr(t.data),n=Kn(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(o){var l=Hr(o.data),c=Kn(l[1][0].data)>>>0;switch(n){case 1:i[c]=HN(l[3][0].data);break;case 8:{var A=e[Aa(l[9][0].data)][0],d=Hr(A.data),u=e[Aa(d[1][0].data)][0],f=Kn(u.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var h=Hr(u.data);i[c]=h[3].map(function(x){return HN(x.data)}).join("")}break}}),i}function Rse(e,t){var r,n,s,i,o,l,c,A,d,u,f,h,x,m,g=Hr(e),p=Kn(g[1][0].data)>>>0,v=Kn(g[2][0].data)>>>0,w=((n=(r=g[8])==null?void 0:r[0])==null?void 0:n.data)&&Kn(g[8][0].data)>0||!1,B,T;if((i=(s=g[7])==null?void 0:s[0])!=null&&i.data&&t!=0)B=(l=(o=g[7])==null?void 0:o[0])==null?void 0:l.data,T=(A=(c=g[6])==null?void 0:c[0])==null?void 0:A.data;else if((u=(d=g[4])==null?void 0:d[0])!=null&&u.data&&t!=1)B=(h=(f=g[4])==null?void 0:f[0])==null?void 0:h.data,T=(m=(x=g[3])==null?void 0:x[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var _=w?4:1,j=Ld(B),E=[],L=0;L<B.length/2;++L){var M=j.getUint16(L*2,!0);M<65535&&E.push([L,M])}if(E.length!=v)throw"Expected ".concat(v," cells, found ").concat(E.length);var F=[];for(L=0;L<E.length-1;++L)F[E[L][0]]=T.subarray(E[L][1]*_,E[L+1][1]*_);return E.length>=1&&(F[E[E.length-1][0]]=T.subarray(E[E.length-1][1]*_)),{R:p,cells:F}}function Qse(e,t){var r,n=Hr(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Kn(n[7][0].data)>>>0>0?1:0:-1,i=$C(n[5],function(o){return Rse(o,s)});return{nrows:Kn(n[4][0].data)>>>0,data:i.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,A){if(o[l.R][A])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(A));o[l.R][A]=c}),o},[])}}function Mse(e,t,r){var n,s=Hr(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Kn(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(Kn(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=wr(i);var o=Hr(s[4][0].data),l=BF(e,e[Aa(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?BF(e,e[Aa(o[17][0].data)][0]):[],A=Hr(o[3][0].data),d=0;A[1].forEach(function(u){var f=Hr(u.data),h=e[Aa(f[2][0].data)][0],x=Kn(h.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var m=Qse(e,h);m.data.forEach(function(g,p){g.forEach(function(v,w){var B=Ar({r:d+p,c:w}),T=Ose(v,l,c);T&&(r[B]=T)})}),d+=m.nrows})}function Hse(e,t){var r=Hr(t.data),n={"!ref":"A1"},s=e[Aa(r[2][0].data)],i=Kn(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return Mse(e,s[0],n),n}function Vse(e,t){var r,n=Hr(t.data),s={name:(r=n[1])!=null&&r[0]?HN(n[1][0].data):"",sheets:[]},i=$C(n[2],Aa);return i.forEach(function(o){e[o].forEach(function(l){var c=Kn(l.meta[1][0].data);c==6e3&&s.sheets.push(Hse(e,l))})}),s}function $se(e,t){var r=WC(),n=Hr(t.data),s=$C(n[1],Aa);if(s.forEach(function(i){e[i].forEach(function(o){var l=Kn(o.meta[1][0].data);if(l==2){var c=Vse(e,o);c.sheets.forEach(function(A,d){XC(r,A,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function kw(e){var t,r,n,s,i={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var A;try{A=Xi(c.content)}catch(u){return console.log("?? "+c.content.length+" "+(u.message||u))}var d;try{d=Wi(A)}catch(u){return console.log("## "+(u.message||u))}d.forEach(function(u){i[u.id]=u.messages,o.push(u.id)})}}),!o.length)throw new Error("File has no messages");var l=((s=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Kn(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||o.forEach(function(c){i[c].forEach(function(A){var d=Kn(A.meta[1][0].data)>>>0;if(d==1)if(!l)l=A;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return $se(i,l)}function qse(e,t,r){var n,s,i,o;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(i=e[8])==null?void 0:i[0])==null?void 0:o.data)&&Kn(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,A=Ld(e[7][0].data),d=0,u=[],f=Ld(e[4][0].data),h=0,x=[],m=0;m<t.length;++m){if(t[m]==null){A.setUint16(m*2,65535,!0),f.setUint16(m*2,65535);continue}A.setUint16(m*2,d,!0),f.setUint16(m*2,h,!0);var g,p;switch(typeof t[m]){case"string":g=Fw({t:"s",v:t[m]},r),p=Ew({t:"s",v:t[m]},r);break;case"number":g=Fw({t:"n",v:t[m]},r),p=Ew({t:"n",v:t[m]},r);break;case"boolean":g=Fw({t:"b",v:t[m]},r),p=Ew({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}u.push(g),d+=g.length,x.push(p),h+=p.length,++c}for(e[2][0].data=en(c);m<e[7][0].data.length/2;++m)A.setUint16(m*2,65535,!0),f.setUint16(m*2,65535,!0);return e[6][0].data=wA(u),e[3][0].data=wA(x),c}function Kse(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ni(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(wr(n)));var i=G1(r,{range:n,header:1}),o=["~Sh33tJ5~"];i.forEach(function(O){return O.forEach(function(S){typeof S=="string"&&o.push(S)})});var l={},c=[],A=Jt.read(t.numbers,{type:"base64"});A.FileIndex.map(function(O,S){return[O,A.FullPaths[S]]}).forEach(function(O){var S=O[0],I=O[1];if(S.type==2&&S.name.match(/\.iwa/)){var U=S.content,Q=Xi(U),H=Wi(Q);H.forEach(function(X){c.push(X.id),l[X.id]={deps:[],location:I,type:Kn(X.messages[0].meta[1][0].data)}})}}),c.sort(function(O,S){return O-S});var d=c.filter(function(O){return O>1}).map(function(O){return[O,en(O)]});A.FileIndex.map(function(O,S){return[O,A.FullPaths[S]]}).forEach(function(O){var S=O[0];if(O[1],!!S.name.match(/\.iwa/)){var I=Wi(Xi(S.content));I.forEach(function(U){U.messages.forEach(function(Q){d.forEach(function(H){U.messages.some(function(X){return Kn(X.meta[1][0].data)!=11006&&_se(X.data,H[1])})&&l[H[0]].deps.push(U.id)})})})}});for(var u=Jt.find(A,l[1].location),f=Wi(Xi(u.content)),h,x=0;x<f.length;++x){var m=f[x];m.id==1&&(h=m)}var g=Aa(Hr(h.messages[0].data)[1][0].data);for(u=Jt.find(A,l[g].location),f=Wi(Xi(u.content)),x=0;x<f.length;++x)m=f[x],m.id==g&&(h=m);for(g=Aa(Hr(h.messages[0].data)[2][0].data),u=Jt.find(A,l[g].location),f=Wi(Xi(u.content)),x=0;x<f.length;++x)m=f[x],m.id==g&&(h=m);for(g=Aa(Hr(h.messages[0].data)[2][0].data),u=Jt.find(A,l[g].location),f=Wi(Xi(u.content)),x=0;x<f.length;++x)m=f[x],m.id==g&&(h=m);var p=Hr(h.messages[0].data);{p[6][0].data=en(n.e.r+1),p[7][0].data=en(n.e.c+1);var v=Aa(p[46][0].data),w=Jt.find(A,l[v].location),B=Wi(Xi(w.content));{for(var T=0;T<B.length&&B[T].id!=v;++T);if(B[T].id!=v)throw"Bad ColumnRowUIDMapArchive";var _=Hr(B[T].messages[0].data);_[1]=[],_[2]=[],_[3]=[];for(var j=0;j<=n.e.c;++j){var E=[];E[1]=E[2]=[{type:0,data:en(j+420690)}],_[1].push({type:2,data:Ms(E)}),_[2].push({type:0,data:en(j)}),_[3].push({type:0,data:en(j)})}_[4]=[],_[5]=[],_[6]=[];for(var L=0;L<=n.e.r;++L)E=[],E[1]=E[2]=[{type:0,data:en(L+726270)}],_[4].push({type:2,data:Ms(E)}),_[5].push({type:0,data:en(L)}),_[6].push({type:0,data:en(L)});B[T].messages[0].data=Ms(_)}w.content=Su(Bu(B)),w.size=w.content.length,delete p[46];var M=Hr(p[4][0].data);{M[7][0].data=en(n.e.r+1);var F=Hr(M[1][0].data),D=Aa(F[2][0].data);w=Jt.find(A,l[D].location),B=Wi(Xi(w.content));{if(B[0].id!=D)throw"Bad HeaderStorageBucket";var G=Hr(B[0].messages[0].data);for(L=0;L<i.length;++L){var K=Hr(G[2][0].data);K[1][0].data=en(L),K[4][0].data=en(i[L].length),G[2][L]={type:G[2][0].type,data:Ms(K)}}B[0].messages[0].data=Ms(G)}w.content=Su(Bu(B)),w.size=w.content.length;var ae=Aa(M[2][0].data);w=Jt.find(A,l[ae].location),B=Wi(Xi(w.content));{if(B[0].id!=ae)throw"Bad HeaderStorageBucket";for(G=Hr(B[0].messages[0].data),j=0;j<=n.e.c;++j)K=Hr(G[2][0].data),K[1][0].data=en(j),K[4][0].data=en(n.e.r+1),G[2][j]={type:G[2][0].type,data:Ms(K)};B[0].messages[0].data=Ms(G)}w.content=Su(Bu(B)),w.size=w.content.length;var Z=Aa(M[4][0].data);(function(){for(var O=Jt.find(A,l[Z].location),S=Wi(Xi(O.content)),I,U=0;U<S.length;++U){var Q=S[U];Q.id==Z&&(I=Q)}var H=Hr(I.messages[0].data);{H[3]=[];var X=[];o.forEach(function(W,J){X[1]=[{type:0,data:en(J)}],X[2]=[{type:0,data:en(1)}],X[3]=[{type:2,data:Tse(W)}],H[3].push({type:2,data:Ms(X)})})}I.messages[0].data=Ms(H);var V=Bu(S),Ae=Su(V);O.content=Ae,O.size=O.content.length})();var oe=Hr(M[3][0].data);{var Y=oe[1][0];delete oe[2];var R=Hr(Y.data);{var z=Aa(R[2][0].data);(function(){for(var O=Jt.find(A,l[z].location),S=Wi(Xi(O.content)),I,U=0;U<S.length;++U){var Q=S[U];Q.id==z&&(I=Q)}var H=Hr(I.messages[0].data);{delete H[6],delete oe[7];var X=new Uint8Array(H[5][0].data);H[5]=[];for(var V=0,Ae=0;Ae<=n.e.r;++Ae){var W=Hr(X);V+=qse(W,i[Ae],o),W[1][0].data=en(Ae),H[5].push({data:Ms(W),type:2})}H[1]=[{type:0,data:en(n.e.c+1)}],H[2]=[{type:0,data:en(n.e.r+1)}],H[3]=[{type:0,data:en(V)}],H[4]=[{type:0,data:en(n.e.r+1)}]}I.messages[0].data=Ms(H);var J=Bu(S),ve=Su(J);O.content=ve,O.size=O.content.length})()}Y.data=Ms(R)}M[3][0].data=Ms(oe)}p[4][0].data=Ms(M)}h.messages[0].data=Ms(p);var ee=Bu(f),b=Su(ee);return u.content=b,u.size=u.content.length,A}function lU(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function qC(e){lU([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function KC(e){lU([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function zse(e){return Br.WS.indexOf(e)>-1?"sheet":e==Br.CS?"chart":e==Br.DS?"dialog":e==Br.MS?"macro":e&&e.length?e:"sheet"}function Gse(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,zse(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Wse(e,t,r,n,s,i,o,l,c,A,d,u){try{i[n]=Dh(yi(e,r,!0),t);var f=fs(e,t),h;switch(l){case"sheet":h=xne(f,t,s,c,i[n],A,d,u);break;case"chart":if(h=gne(f,t,s,c,i[n],A,d,u),!h||!h["!drawel"])break;var x=fh(h["!drawel"].Target,t),m=wm(x),g=sZ(yi(e,x,!0),Dh(yi(e,m,!0),x)),p=fh(g,x),v=wm(p);h=qre(yi(e,p,!0),p,c,Dh(yi(e,v,!0),p),A,h);break;case"macro":h=yne(f,t,s,c,i[n],A,d,u);break;case"dialog":h=vne(f,t,s,c,i[n],A,d,u);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=h;var w=[];i&&i[n]&&Gn(i[n]).forEach(function(B){var T="";if(i[n][B].Type==Br.CMNT){T=fh(i[n][B].Target,t);var _=Cne(fs(e,T,!0),T,c);if(!_||!_.length)return;dF(h,_,!1)}i[n][B].Type==Br.TCMNT&&(T=fh(i[n][B].Target,t),w=w.concat(iZ(fs(e,T,!0),c)))}),w&&w.length&&dF(h,w,!0,c.people||[])}catch(B){if(c.WTF)throw B}}function Ki(e){return e.charAt(0)=="/"?e.slice(1):e}function Xse(e,t){if(t0(),t=t||{},qC(t),Ji(e,"META-INF/manifest.xml")||Ji(e,"objectdata.xml"))return bF(e,t);if(Ji(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof kw<"u"){if(e.FileIndex)return kw(e);var r=Jt.utils.cfb_new();return _S(e).forEach(function(K){br(r,K,oG(e,K))}),kw(r)}throw new Error("Unsupported NUMBERS file")}if(!Ji(e,"[Content_Types].xml"))throw Ji(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ji(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=_S(e),s=eW(yi(e,"[Content_Types].xml")),i=!1,o,l;if(s.workbooks.length===0&&(l="xl/workbook.xml",fs(e,l,!0)&&s.workbooks.push(l)),s.workbooks.length===0){if(l="xl/workbook.bin",!fs(e,l,!0))throw new Error("Could not find workbook");s.workbooks.push(l),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},A={};if(!t.bookSheets&&!t.bookProps){if(Ph=[],s.sst)try{Ph=Nne(fs(e,Ki(s.sst)),s.sst,t)}catch(K){if(t.WTF)throw K}t.cellStyles&&s.themes.length&&(c=bne(yi(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(A=wne(fs(e,Ki(s.style)),s.style,c,t))}s.links.map(function(K){try{var ae=Dh(yi(e,wm(Ki(K))),K);return Bne(fs(e,Ki(K)),ae,K,t)}catch{}});var d=pne(fs(e,Ki(s.workbooks[0])),s.workbooks[0],t),u={},f="";s.coreprops.length&&(f=fs(e,Ki(s.coreprops[0]),!0),f&&(u=X8(f)),s.extprops.length!==0&&(f=fs(e,Ki(s.extprops[0]),!0),f&&oW(f,u,t)));var h={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(f=yi(e,Ki(s.custprops[0]),!0),f&&(h=cW(f,t)));var x={};if((t.bookSheets||t.bookProps)&&(d.Sheets?o=d.Sheets.map(function(ae){return ae.name}):u.Worksheets&&u.SheetNames.length>0&&(o=u.SheetNames),t.bookProps&&(x.Props=u,x.Custprops=h),t.bookSheets&&typeof o<"u"&&(x.SheetNames=o),t.bookSheets?x.SheetNames:t.bookProps))return x;o={};var m={};t.bookDeps&&s.calcchain&&(m=jne(fs(e,Ki(s.calcchain)),s.calcchain));var g=0,p={},v,w;{var B=d.Sheets;u.Worksheets=B.length,u.SheetNames=[];for(var T=0;T!=B.length;++T)u.SheetNames[T]=B[T].name}var _=i?"bin":"xml",j=s.workbooks[0].lastIndexOf("/"),E=(s.workbooks[0].slice(0,j+1)+"_rels/"+s.workbooks[0].slice(j+1)+".rels").replace(/^\//,"");Ji(e,E)||(E="xl/_rels/workbook."+_+".rels");var L=Dh(yi(e,E,!0),E.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=Sne(fs(e,Ki(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=lZ(fs(e,Ki(s.people[0])),t)),L&&(L=Gse(L,d.Sheets));var M=fs(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=u.Worksheets;++g){var F="sheet";if(L&&L[g]?(v="xl/"+L[g][1].replace(/[\/]?xl\//,""),Ji(e,v)||(v=L[g][1]),Ji(e,v)||(v=E.replace(/_rels\/.*$/,"")+L[g][1]),F=L[g][2]):(v="xl/worksheets/sheet"+(g+1-M)+"."+_,v=v.replace(/sheet0\./,"sheet.")),w=v.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(u.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var D=!1,G=0;G!=t.sheets.length;++G)typeof t.sheets[G]=="number"&&t.sheets[G]==g&&(D=1),typeof t.sheets[G]=="string"&&t.sheets[G].toLowerCase()==u.SheetNames[g].toLowerCase()&&(D=1);if(!D)continue e}}Wse(e,v,w,u.SheetNames[g],g,p,o,F,t,d,c,A)}return x={Directory:s,Workbook:d,Props:u,Custprops:h,Deps:m,Sheets:o,SheetNames:u.SheetNames,Strings:Ph,Styles:A,Themes:c,SSF:Sn(ar)},t&&t.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(K,ae){K=K.replace(/^Root Entry[\/]/,""),x.keys.push(K),x.files[K]=e.FileIndex[ae]}))),t&&t.bookVBA&&(s.vba.length>0?x.vbaraw=fs(e,Ki(s.vba[0]),!0):s.defaults&&s.defaults.bin===pZ&&(x.vbaraw=fs(e,"xl/vbaProject.bin",!0))),x}function Yse(e,t){var r=t||{},n="Workbook",s=Jt.find(e,n);try{if(n="/!DataSpaces/Version",s=Jt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(SY(s.content),n="/!DataSpaces/DataSpaceMap",s=Jt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=EY(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Jt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=kY(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Jt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);_Y(s.content)}catch{}if(n="/EncryptionInfo",s=Jt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=IY(s.content);if(n="/EncryptedPackage",s=Jt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],s.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function Jse(e,t){return t.bookType=="ods"?oU(e,t):t.bookType=="numbers"?Kse(e,t):t.bookType=="xlsb"?Zse(e,t):eae(e,t)}function Zse(e,t){sf=1024,e&&!e.SSF&&(e.SSF=Sn(ar)),e&&e.SSF&&(t0(),Av(e.SSF),t.revssf=uv(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Oh?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=UL.indexOf(t.bookType)>-1,s=TC();KC(t=t||{});var i=xC(),o="",l=0;if(t.cellXfs=[],TA(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",br(i,o,Y8(e.Props,t)),s.coreprops.push(o),tn(t.rels,2,o,Br.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],A=0;A<e.SheetNames.length;++A)(e.Workbook.Sheets[A]||{}).Hidden!=2&&c.push(e.SheetNames[A]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,br(i,o,eL(e.Props)),s.extprops.push(o),tn(t.rels,3,o,Br.EXT_PROPS),e.Custprops!==e.Props&&Gn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",br(i,o,tL(e.Custprops)),s.custprops.push(o),tn(t.rels,4,o,Br.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},u=e.Sheets[e.SheetNames[l-1]],f=(u||{})["!type"]||"sheet";switch(f){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,br(i,o,Ene(l-1,o,t,e,d)),s.sheets.push(o),tn(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Br.WS[0])}if(u){var h=u["!comments"],x=!1,m="";h&&h.length>0&&(m="xl/comments"+l+"."+r,br(i,m,_ne(h,m)),s.comments.push(m),tn(d,-1,"../comments"+l+"."+r,Br.CMNT),x=!0),u["!legacy"]&&x&&br(i,"xl/drawings/vmlDrawing"+l+".vml",IL(l,u["!comments"])),delete u["!comments"],delete u["!legacy"]}d["!id"].rId1&&br(i,wm(o),mf(d))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,br(i,o,Tne(t.Strings,o,t)),s.strs.push(o),tn(t.wbrels,-1,"sharedStrings."+r,Br.SST)),o="xl/workbook."+r,br(i,o,Fne(e,o)),s.workbooks.push(o),tn(t.rels,1,o,Br.WB),o="xl/theme/theme1.xml",br(i,o,PC(e.Themes,t)),s.themes.push(o),tn(t.wbrels,-1,"theme/theme1.xml",Br.THEME),o="xl/styles."+r,br(i,o,kne(e,o,t)),s.styles.push(o),tn(t.wbrels,-1,"styles."+r,Br.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",br(i,o,e.vbaraw),s.vba.push(o),tn(t.wbrels,-1,"vbaProject.bin",Br.VBA)),o="xl/metadata."+r,br(i,o,Ine(o)),s.metadata.push(o),tn(t.wbrels,-1,"metadata."+r,Br.XLMETA),br(i,"[Content_Types].xml",G8(s,t)),br(i,"_rels/.rels",mf(t.rels)),br(i,"xl/_rels/workbook."+r+".rels",mf(t.wbrels)),delete t.revssf,delete t.ssf,i}function eae(e,t){sf=1024,e&&!e.SSF&&(e.SSF=Sn(ar)),e&&e.SSF&&(t0(),Av(e.SSF),t.revssf=uv(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Oh?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=UL.indexOf(t.bookType)>-1,s=TC();KC(t=t||{});var i=xC(),o="",l=0;if(t.cellXfs=[],TA(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",br(i,o,Y8(e.Props,t)),s.coreprops.push(o),tn(t.rels,2,o,Br.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],A=0;A<e.SheetNames.length;++A)(e.Workbook.Sheets[A]||{}).Hidden!=2&&c.push(e.SheetNames[A]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,br(i,o,eL(e.Props)),s.extprops.push(o),tn(t.rels,3,o,Br.EXT_PROPS),e.Custprops!==e.Props&&Gn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",br(i,o,tL(e.Custprops)),s.custprops.push(o),tn(t.rels,4,o,Br.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var u={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,br(i,o,KL(l-1,t,e,u)),s.sheets.push(o),tn(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Br.WS[0])}if(f){var x=f["!comments"],m=!1,g="";if(x&&x.length>0){var p=!1;x.forEach(function(v){v[1].forEach(function(w){w.T==!0&&(p=!0)})}),p&&(g="xl/threadedComments/threadedComment"+l+"."+r,br(i,g,oZ(x,d,t)),s.threadedcomments.push(g),tn(u,-1,"../threadedComments/threadedComment"+l+"."+r,Br.TCMNT)),g="xl/comments"+l+"."+r,br(i,g,LL(x)),s.comments.push(g),tn(u,-1,"../comments"+l+"."+r,Br.CMNT),m=!0}f["!legacy"]&&m&&br(i,"xl/drawings/vmlDrawing"+l+".vml",IL(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&br(i,wm(o),mf(u))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,br(i,o,wL(t.Strings,t)),s.strs.push(o),tn(t.wbrels,-1,"sharedStrings."+r,Br.SST)),o="xl/workbook."+r,br(i,o,YL(e)),s.workbooks.push(o),tn(t.rels,1,o,Br.WB),o="xl/theme/theme1.xml",br(i,o,PC(e.Themes,t)),s.themes.push(o),tn(t.wbrels,-1,"theme/theme1.xml",Br.THEME),o="xl/styles."+r,br(i,o,EL(e,t)),s.styles.push(o),tn(t.wbrels,-1,"styles."+r,Br.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",br(i,o,e.vbaraw),s.vba.push(o),tn(t.wbrels,-1,"vbaProject.bin",Br.VBA)),o="xl/metadata."+r,br(i,o,_L()),s.metadata.push(o),tn(t.wbrels,-1,"metadata."+r,Br.XLMETA),d.length>1&&(o="xl/persons/person.xml",br(i,o,cZ(d)),s.people.push(o),tn(t.wbrels,-1,"persons/person.xml",Br.PEOPLE)),br(i,"[Content_Types].xml",G8(s,t)),br(i,"_rels/.rels",mf(t.rels)),br(i,"xl/_rels/workbook."+r+".rels",mf(t.wbrels)),delete t.revssf,delete t.ssf,i}function zC(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ki(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function tae(e,t){return Jt.find(e,"EncryptedPackage")?Yse(e,t):tU(e,t)}function rae(e,t){var r,n=e,s=t||{};return s.type||(s.type=Cr&&Buffer.isBuffer(e)?"buffer":"base64"),r=N8(n,s),Xse(r,s)}function cU(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return QN(e.slice(r),t);default:break e}return Df.to_workbook(e,t)}function nae(e,t){var r="",n=zC(e,t);switch(t.type){case"base64":r=ki(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=kd(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=cn(r)),t.type="binary",cU(r,t)}function sae(e,t){var r=e;return t.type=="base64"&&(r=ki(r)),r=Kc.utils.decode(1200,r.slice(2),"str"),t.type="binary",cU(r,t)}function aae(e){return e.match(/[^\x00-\x7F]/)?hl(e):e}function Tw(e,t,r,n){return n?(r.type="string",Df.to_workbook(e,r)):Df.to_workbook(t,r)}function Fm(e,t){uC();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Fm(new Uint8Array(e),(r=Sn(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),xf={},r.dateNF&&(xf.dateNF=r.dateNF),r.type||(r.type=Cr&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Cr?"buffer":"binary",n=Zz(e),typeof Uint8Array<"u"&&!Cr&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=aae(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=Sn(r),r.type="array",Fm(fC(n),r)}switch((s=zC(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return tae(Jt.read(n,r),r);break;case 9:if(s[1]<=8)return tU(n,r);break;case 60:return QN(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return AY(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return yL.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?rae(n,r):Tw(e,n,r,i);case 239:return s[3]===60?QN(n,r):Tw(e,n,r,i);case 255:if(s[1]===254)return sae(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return md.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return md.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return RN.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return BL.to_workbook(n,r);break;case 10:case 13:case 32:return nae(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return cY.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?RN.to_workbook(n,r):Tw(e,n,r,i)}function AU(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return rp(t.file,Jt.write(e,{type:Cr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Jt.write(e,t)}function iae(e,t){var r=Sn(t||{}),n=Jse(e,r);return oae(n,r)}function oae(e,t){var r={},n=Cr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Jt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(cv(s))}return t.password&&typeof encrypt_agile<"u"?AU(encrypt_agile(s,t.password),t):t.type==="file"?rp(t.file,s):t.type=="string"?cn(s):s}function lae(e,t){var r=t||{},n=ase(e,r);return AU(n,r)}function al(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return pm(hl(n));case"binary":return hl(n);case"string":return e;case"file":return rp(t.file,n,"utf8");case"buffer":return Cr?mc(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):al(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function cae(e,t){switch(t.type){case"base64":return pm(e);case"binary":return e;case"string":return e;case"file":return rp(t.file,e,"binary");case"buffer":return Cr?mc(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Ox(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?pm(r):t.type=="string"?cn(r):r;case"file":return rp(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function dU(e,t){uC(),tne(e);var r=Sn(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=dU(e,r);return r.type="array",cv(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return al(Jne(e,r),r);case"slk":case"sylk":return al(gL.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return al(nU(e.Sheets[e.SheetNames[s]],r),r);case"txt":return cae(uU(e.Sheets[e.SheetNames[s]],r),r);case"csv":return al(GC(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return al(yL.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return Ox(RN.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return al(Df.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return al(BL.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return al(vL.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return al(oU(e,r),r);case"wk1":return Ox(md.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return Ox(md.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Ox(rU(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),lae(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return iae(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Aae(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function s0(e,t,r){var n={};return n.type="file",n.file=t,Aae(n),dU(e,n)}function dae(e,t,r,n,s,i,o,l){var c=is(r),A=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),u=!0,f=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!o||e[r])for(var h=t.s.c;h<=t.e.c;++h){var x=o?e[r][h]:e[n[h]+c];if(x===void 0||x.t===void 0){if(A===void 0)continue;i[h]!=null&&(f[i[h]]=A);continue}var m=x.v;switch(x.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[h]!=null){if(m==null)if(x.t=="e"&&m===null)f[i[h]]=null;else if(A!==void 0)f[i[h]]=A;else if(d&&m===null)f[i[h]]=null;else continue;else f[i[h]]=d&&(x.t!=="n"||x.t==="n"&&l.rawNumbers!==!1)?m:dc(x,m,l);m!=null&&(u=!1)}}return{row:f,isempty:u}}function G1(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},A=t||{},d=A.range!=null?A.range:e["!ref"];switch(A.header===1?n=1:A.header==="A"?n=2:Array.isArray(A.header)?n=3:A.header==null&&(n=0),typeof d){case"string":c=Rr(d);break;case"number":c=Rr(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(s=0);var u=is(c.s.r),f=[],h=[],x=0,m=0,g=Array.isArray(e),p=c.s.r,v=0,w={};g&&!e[p]&&(e[p]=[]);var B=A.skipHidden&&e["!cols"]||[],T=A.skipHidden&&e["!rows"]||[];for(v=c.s.c;v<=c.e.c;++v)if(!(B[v]||{}).hidden)switch(f[v]=Dn(v),r=g?e[p][v]:e[f[v]+u],n){case 1:i[v]=v-c.s.c;break;case 2:i[v]=f[v];break;case 3:i[v]=A.header[v-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=dc(r,null,A),m=w[o]||0,!m)w[o]=1;else{do l=o+"_"+m++;while(w[l]);w[o]=m,w[l]=1}i[v]=l}for(p=c.s.r+s;p<=c.e.r;++p)if(!(T[p]||{}).hidden){var _=dae(e,c,p,f,n,i,g,A);(_.isempty===!1||(n===1?A.blankrows!==!1:A.blankrows))&&(h[x++]=_.row)}return h.length=x,h}var SF=/"/g;function uae(e,t,r,n,s,i,o,l){for(var c=!0,A=[],d="",u=is(r),f=t.s.c;f<=t.e.c;++f)if(n[f]){var h=l.dense?(e[r]||[])[f]:e[n[f]+u];if(h==null)d="";else if(h.v!=null){c=!1,d=""+(l.rawNumbers&&h.t=="n"?h.v:dc(h,null,l));for(var x=0,m=0;x!==d.length;++x)if((m=d.charCodeAt(x))===s||m===i||m===34||l.forceQuotes){d='"'+d.replace(SF,'""')+'"';break}d=="ID"&&(d='"ID"')}else h.f!=null&&!h.F?(c=!1,d="="+h.f,d.indexOf(",")>=0&&(d='"'+d.replace(SF,'""')+'"')):d="";A.push(d)}return l.blankrows===!1&&c?null:A.join(o)}function GC(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=Rr(e["!ref"]),i=n.FS!==void 0?n.FS:",",o=i.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),A=new RegExp((i=="|"?"\\|":i)+"+$"),d="",u=[];n.dense=Array.isArray(e);for(var f=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(f[x]||{}).hidden||(u[x]=Dn(x));for(var m=0,g=s.s.r;g<=s.e.r;++g)(h[g]||{}).hidden||(d=uae(e,s,g,u,o,c,i,n),d!=null&&(n.strip&&(d=d.replace(A,"")),(d||n.blankrows!==!1)&&r.push((m++?l:"")+d)));return delete n.dense,r.join("")}function uU(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=GC(e,t);return r}function fae(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=Rr(e["!ref"]),i="",o=[],l,c=[],A=Array.isArray(e);for(l=s.s.c;l<=s.e.c;++l)o[l]=Dn(l);for(var d=s.s.r;d<=s.e.r;++d)for(i=is(d),l=s.s.c;l<=s.e.c;++l)if(t=o[l]+i,r=A?(e[d]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function fU(e,t,r){var n=r||{},s=+!n.skipHeader,i=e||{},o=0,l=0;if(i&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Pn(n.origin):n.origin;o=c.r,l=c.c}var A,d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+s}};if(i["!ref"]){var u=Rr(i["!ref"]);d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),o==-1&&(o=u.e.r+1,d.e.r=o+t.length-1+s)}else o==-1&&(o=0,d.e.r=t.length-1+s);var f=n.header||[],h=0;t.forEach(function(m,g){Gn(m).forEach(function(p){(h=f.indexOf(p))==-1&&(f[h=f.length]=p);var v=m[p],w="z",B="",T=Ar({c:l+h,r:o+g+s});A=Em(i,T),v&&typeof v=="object"&&!(v instanceof Date)?i[T]=v:(typeof v=="number"?w="n":typeof v=="boolean"?w="b":typeof v=="string"?w="s":v instanceof Date?(w="d",n.cellDates||(w="n",v=Ns(v)),B=n.dateNF||ar[14]):v===null&&n.nullError&&(w="e",v=0),A?(A.t=w,A.v=v,delete A.w,delete A.R,B&&(A.z=B)):i[T]=A={t:w,v},B&&(A.z=B))})}),d.e.c=Math.max(d.e.c,l+f.length-1);var x=is(o);if(s)for(h=0;h<f.length;++h)i[Dn(h+l)+x]={t:"s",v:f[h]};return i["!ref"]=wr(d),i}function hae(e,t){return fU(null,e,t)}function Em(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Pn(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Em(e,Ar(t)):Em(e,Ar({r:t,c:r||0}))}function mae(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function WC(){return{SheetNames:[],Sheets:{}}}function XC(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var o=i&&i[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=o+s)!=-1;++s);}if(XL(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function pae(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=mae(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function xae(e,t){return e.z=t,e}function hU(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function gae(e,t,r){return hU(e,"#"+t,r)}function yae(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function vae(e,t,r,n){for(var s=typeof t!="string"?t:Rr(t),i=typeof t=="string"?t:wr(t),o=s.s.r;o<=s.e.r;++o)for(var l=s.s.c;l<=s.e.c;++l){var c=Em(e,o,l);c.t="n",c.F=i,delete c.v,o==s.s.r&&l==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var as={encode_col:Dn,encode_row:is,encode_cell:Ar,encode_range:wr,decode_col:jC,decode_row:CC,split_cell:TG,decode_cell:Pn,decode_range:ni,format_cell:dc,sheet_add_aoa:M8,sheet_add_json:fU,sheet_add_dom:sU,aoa_to_sheet:r0,json_to_sheet:hae,table_to_sheet:aU,table_to_book:Sse,sheet_to_csv:GC,sheet_to_txt:uU,sheet_to_json:G1,sheet_to_html:nU,sheet_to_formulae:fae,sheet_to_row_object_array:G1,sheet_get_cell:Em,book_new:WC,book_append_sheet:XC,book_set_sheet_visibility:pae,cell_set_number_format:xae,cell_set_hyperlink:hU,cell_set_internal_link:gae,cell_add_comment:yae,sheet_set_array_formula:vae,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Ud=e=>{console.log("Exporting requests:",e);const t=e.map(o=>{var h,x,m,g,p,v,w,B,T,_,j,E,L,M,F,D,G,K,ae,Z;let l="NA",c="NA";if(((x=(h=o.commercials)==null?void 0:h.paymentTerms)==null?void 0:x.length)>0){const oe=o.commercials.paymentTerms[0];l=oe.percentageTerm?`${oe.percentageTerm}%`:"NA",c=oe.paymentType||"NA"}const A=oe=>{if(!oe)return"NA";try{return new Date(oe).toLocaleDateString("en-GB")}catch{return oe}};let d="NA";((g=(m=o.supplies)==null?void 0:m.services)==null?void 0:g.length)>0&&(d=o.supplies.services.map(oe=>oe.productDescription||oe.productName).filter(Boolean).join(", "));const u=(p=o.procurements)!=null&&p.servicePeriod?"No":"Yes",f=(v=o.supplies)!=null&&v.totalValue?`${o.supplies.selectedCurrency||""} ${o.supplies.totalValue.toLocaleString()}`:"NA";return{"Status of Request":o.status||"NA","Request Date":o.createdAt?A(o.createdAt):"NA","Request ID":o.reqid||"NA",BU:((w=o.commercials)==null?void 0:w.businessUnit)||"NA",Entity:((B=o.commercials)==null?void 0:B.entity)||"NA",City:((T=o.commercials)==null?void 0:T.city)||"NA",Requestor:o.userName||"NA","Requestor Department":o.empDepartment||"NA","Cost Center":((_=o.commercials)==null?void 0:_.costCentre)||"NA",HOD:((j=o.commercials)==null?void 0:j.hod)||"NA","Vendor ID & Name":(E=o.procurements)!=null&&E.vendorName?`${o.procurements.vendor||""} - ${o.procurements.vendorName}`:"NA","Payment Percentage":l,"Payment Term":c,"Payment Type":((L=o.commercials)==null?void 0:L.paymentMode)||"NA","Service Description":d,"One Time":u,"PO Valid from":(M=o.procurements)!=null&&M.poValidFrom?A(o.procurements.poValidFrom):"NA","PO Valid To":(F=o.procurements)!=null&&F.poValidTo?A(o.procurements.poValidTo):"NA","PO Expiry Date":(D=o.procurements)!=null&&D.poExpiryDate?A(o.procurements.poExpiryDate):"NA","PO Total Value with Currency":f,"Project Code":((G=o.procurements)==null?void 0:G.projectCode)||"NA","Client Name":((K=o.procurements)==null?void 0:K.clientName)||"NA",Remarks:((ae=o.procurements)==null?void 0:ae.remarks)||((Z=o.supplies)==null?void 0:Z.remarks)||"NA"}}),r=as.json_to_sheet(t),n=Object.keys(t[0]||{}).map(o=>({wch:Math.max(o.length,...t.map(l=>String(l[o]||"").length))+2}));r["!cols"]=n;const s=as.book_new();as.book_append_sheet(s,r,"Requests");const i=`Request_Export_${new Date().toISOString().split("T")[0]}.xlsx`;s0(s,i),console.log("Export completed successfully")},wae=({setIsShowModal:e,sendEditMail:t})=>a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-lg shadow-lg w-full max-w-sm md:max-w-md",children:[a.jsx("h3",{className:"text-lg md:text-xl font-semibold mb-4",children:"Send Edit Request"}),a.jsx("p",{className:"mb-6 text-sm md:text-base",children:"Do you want to send a edit request email to the Head of Department?"}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx("button",{onClick:()=>e(!1),className:"px-3 py-1.5 md:px-4 md:py-2 border rounded-lg text-sm hover:bg-gray-100",children:"Cancel"}),a.jsx("button",{onClick:()=>{e(!1),t()},className:"bg-primary text-white px-3 py-1.5 md:px-4 md:py-2 rounded-lg text-sm hover:bg-primary/90",children:"Send Request"})]})]})}),bae=({setIsDelete:e,handleDelete:t,reqId:r})=>a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-lg shadow-lg w-full max-w-sm md:max-w-md",children:[a.jsx("h3",{className:"text-lg md:text-xl font-semibold mb-4",children:"Do you really want to delete this request?"}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx("button",{onClick:()=>e(!1),className:"px-3 py-1.5 md:px-4 md:py-2 border rounded-lg text-sm hover:bg-gray-100",children:"Cancel"}),a.jsx("button",{onClick:()=>t(r),className:"bg-primary text-white px-3 py-1.5 md:px-4 md:py-2 rounded-lg text-sm hover:bg-primary/90",children:"Yes, Delete"})]})]})}),Nae=({filteredUsers:e,currentUsers:t,navigate:r,currentPage:n,itemsPerPage:s,handleCopyReqId:i,handleOpenInNewTab:o,formatCurrency:l,Pagination:c,totalPages:A,renderActionColumn:d,handlePageChange:u})=>a.jsx("div",{className:"border border-gray-200 rounded-lg w-full",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsx("div",{className:"inline-block min-w-full align-middle",children:a.jsxs("div",{className:"overflow-hidden",children:[a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-primary",children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",className:"sticky top-0 px-2 py-2 md:px-6 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[5%]",children:"SNo"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-2 py-2 md:px-6 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[15%]",children:"ReqId"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-2 py-2 md:px-6 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[15%] hidden md:table-cell",children:"Entity"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-2 py-2 md:px-6 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[15%] hidden md:table-cell",children:"Vendor"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-2 py-2 md:px-6 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[9%]",children:"Amount"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-2 py-2 md:px-6 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[13%]",children:"Status"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-2 py-2 md:px-6 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[10%]",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(e==null?void 0:e.length)>0?t.map((f,h)=>{var x,m,g,p,v,w,B,T;return a.jsxs("tr",{className:"hover:bg-gray-100 cursor-pointer",onClick:()=>r(`/req-list-table/preview-one-req/${f._id}`),children:[a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-xs md:text-sm font-medium text-gray-900",children:(n-1)*s+h+1}),a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-xs md:text-sm text-gray-500",children:a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"block font-medium",children:f.reqid}),a.jsxs("div",{className:"flex space-x-1",children:[a.jsx("button",{onClick:_=>i(f.reqid,_),className:"text-gray-400 hover:text-blue-500 transition-colors",title:"Copy Request ID",children:a.jsx(Gl,{className:"h-3 w-3 md:h-4 md:w-4"})}),a.jsx("button",{onClick:_=>o(f._id,_),className:"text-gray-400 hover:text-green-500 transition-colors",title:"Open in new tab",children:a.jsx(Xf,{className:"h-3 w-3 md:h-4 md:w-4"})})]})]}),a.jsx("span",{className:"block font-medium",children:f.userName||"Employee"}),a.jsx("span",{className:"block text-xs md:text-sm",children:(x=f.commercials)==null?void 0:x.department})]})}),a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-xs md:text-sm text-gray-500 hidden md:table-cell",children:a.jsxs("div",{children:[a.jsx("span",{className:"block",children:((m=f.commercials)==null?void 0:m.businessUnit)||"NA"}),a.jsx("span",{className:"block font-medium",children:((g=f.commercials)==null?void 0:g.entity)||"NA"}),a.jsx("span",{className:"block",children:((p=f.commercials)==null?void 0:p.site)||"NA"})]})}),a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-xs md:text-sm text-gray-500 hidden md:table-cell",children:a.jsxs("div",{children:[a.jsx("span",{className:"block font-medium",children:(v=f.procurements)==null?void 0:v.vendor}),a.jsx("span",{className:"block",children:(w=f.procurements)==null?void 0:w.vendorName})]})}),a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-xs md:text-sm text-gray-500",children:l((B=f.supplies)==null?void 0:B.totalValue,(T=f.supplies)==null?void 0:T.selectedCurrency)}),a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-xs md:text-sm text-gray-500",children:f.isCompleted?a.jsxs(a.Fragment,{children:[f.status!=="Approved"&&a.jsxs(a.Fragment,{children:[f.nextDepartment," ",a.jsx("br",{})]}),f.status||"Pending"]}):a.jsx("span",{className:"text-red-500",children:"Draft"})}),d(f)]},f._id)}):a.jsx("tr",{children:a.jsx("td",{colSpan:"13",className:"px-2 py-2 md:px-6 md:py-4 text-center text-xs md:text-sm text-gray-500",children:"No matching results found."})})})]}),a.jsx("div",{className:"mt-4 px-2 md:px-0",children:a.jsx(c,{currentPage:n,totalPages:A,handlePageChange:u,itemsPerPage:s,totalItems:e.length})})]})})})}),Cae=()=>{const e=localStorage.getItem("capEmpId"),t=localStorage.getItem("role"),r=localStorage.getItem("multiRole"),n=Sr(),[s,i]=C.useState([]),[o,l]=C.useState([]),[c,A]=C.useState(null),[d,u]=C.useState(1),[f,h]=C.useState(!1),[x,m]=C.useState(""),[g,p]=C.useState(!1),[v,w]=C.useState(!0),[B,T]=C.useState(!1);C.useState(!1),C.useState(!1);const[_,j]=C.useState([]),[E,L]=C.useState(null),[M,F]=C.useState(!1),[D,G]=C.useState(null),[K,ae]=C.useState({fromDate:"",toDate:""}),[Z,oe]=C.useState(""),[Y,R]=C.useState(""),[z,ee]=C.useState(!1),[b,O]=C.useState([]),[S,I]=C.useState({statusFilter:"",departmentFilter:"",dateFilters:{fromDate:"",toDate:""}}),U=20,Q=["Pending","Rejected","Hold"],H=(Se,Ce)=>{if(!Q.includes(Se))return console.log(`Status "${Se}" doesn't support department filtering`),[];console.log(`
=== GETTING DEPARTMENTS FOR STATUS: ${Se} ===`),console.log(`Total data records: ${Ce.length}`);const Be=Ce.filter(tt=>tt.status===Se);if(console.log(`Records with status "${Se}": ${Be.length}`),Be.length===0)return console.log(` No records found with status "${Se}"`),[];const Pe=Be.map(tt=>({reqid:tt.reqid,nextDepartment:tt.nextDepartment}));console.log(`Sample nextDepartment values for ${Se}:`,Pe.slice(0,10));const Bt=Be.map(tt=>tt.nextDepartment).filter(tt=>tt&&tt.trim()!=="").filter((tt,Ot,vt)=>vt.indexOf(tt)===Ot).sort();return console.log(`Final unique departments for "${Se}":`,Bt),console.log(`Department count: ${Bt.length}`),Bt};C.useEffect(()=>{if(Z&&Q.includes(Z)){const Se=H(Z,s);O(Se),Y&&!Se.includes(Y)&&R("")}else O([])},[Z,s,Y]),C.useEffect(()=>{(async()=>{const Ce=await mo();Ce.status===200&&j(Ce.data.data)})()},[]),C.useEffect(()=>{(async()=>{w(!0);try{let Ce;console.log("Fetching initial data for role:",t),t==="Admin"?Ce=await rf():Ce=await tf(e),Ce&&Ce.data&&(i(Ce.data.data),l(Ce.data.data))}catch(Ce){console.error("Error fetching initial data:",Ce)}finally{setTimeout(()=>{w(!1)},500)}})()},[e,t]),C.useEffect(()=>{(async()=>{const Ce=await ev();Ce.status===200&&A(Ce.data.data)})()},[]);const X=async()=>{F(!0),w(!0),console.log("=== FILTER APPLICATION START ==="),console.log("User Role:",t),console.log("Filters being applied:",{statusFilter:Z,departmentFilter:Y,dateFilters:K});try{let Se;if(Z||Y||K.fromDate||K.toDate){if(console.log("Has filters - proceeding with filtering..."),console.log("Getting all admin data first..."),t==="Admin"?Se=await rf():Se=await tf(e),Se&&Se.data){let Be=Se.data.data;console.log("=== DATA ANALYSIS ==="),console.log("Total records received:",Be.length),Se.data.poPolicyFileLink&&A(Se.data.poPolicyFileLink),Be.length>0&&console.log("Sample record structure:",{reqid:Be[0].reqid,status:Be[0].status,nextDepartment:Be[0].nextDepartment,userName:Be[0].userName,createdAt:Be[0].createdAt});const Pe=[...new Set(Be.map(tt=>tt.status))];console.log("Available statuses in data:",Pe);const Bt=[...new Set(Be.map(tt=>tt.nextDepartment))].filter(tt=>tt);if(console.log("Available nextDepartments in data:",Bt),Z){const tt=Be.length;if(console.log(`
=== APPLYING STATUS FILTER: ${Z} ===`),Be=Be.filter(Ot=>Ot.status===Z),console.log(`Status filter result: ${tt} -> ${Be.length} records`),Be.length>0){console.log("Sample records after status filter:",Be.slice(0,3).map(vt=>({reqid:vt.reqid,status:vt.status,nextDepartment:vt.nextDepartment})));const Ot=[...new Set(Be.map(vt=>vt.nextDepartment))].filter(vt=>vt);console.log(`Available departments for ${Z}:`,Ot)}else console.log(" No records found for status:",Z)}if(Y){const tt=Be.length;console.log(`
=== APPLYING DEPARTMENT FILTER: ${Y} ===`);const Ot=[...new Set(Be.map(vt=>vt.nextDepartment))].filter(vt=>vt);console.log("Available departments before dept filter:",Ot),Be=Be.filter(vt=>{const Vt=vt.nextDepartment,pr=Vt===Y;return!pr&&Vt?console.log(`Excluding: reqid=${vt.reqid}, nextDept="${Vt}" (looking for "${Y}")`):pr&&console.log(`Including: reqid=${vt.reqid}, nextDept="${Vt}"`),pr}),console.log(`Department filter result: ${tt} -> ${Be.length} records`),Be.length===0&&Y&&(console.log(" No records found for department:",Y),console.log("This might indicate:"),console.log("1. No requests have nextDepartment =",Y),console.log("2. Case sensitivity issue"),console.log("3. Data inconsistency"))}if(K.fromDate){const tt=Be.length;console.log(`
=== APPLYING FROM DATE FILTER: ${K.fromDate} ===`),Be=Be.filter(Ot=>{const vt=new Date(Ot.createdAt),Vt=new Date(K.fromDate);return vt>=Vt}),console.log(`From date filter result: ${tt} -> ${Be.length} records`)}if(K.toDate){const tt=Be.length;console.log(`
=== APPLYING TO DATE FILTER: ${K.toDate} ===`),Be=Be.filter(Ot=>{const vt=new Date(Ot.createdAt),Vt=new Date(K.toDate);return Vt.setHours(23,59,59,999),vt<=Vt}),console.log(`To date filter result: ${tt} -> ${Be.length} records`)}console.log(`
=== FINAL RESULTS ===`),console.log("Final filtered data count:",Be.length),Be.length>0?console.log("Final sample records:",Be.slice(0,5).map(tt=>({reqid:tt.reqid,status:tt.status,nextDepartment:tt.nextDepartment,userName:tt.userName,createdAt:tt.createdAt}))):(console.log(" No records match the applied filters"),console.log("Applied filters summary:",{status:Z||"Any",department:Y||"Any",fromDate:K.fromDate||"Any",toDate:K.toDate||"Any"})),Se.data.data=Be}}else console.log("No filters applied - getting all data"),t==="Admin"?Se=await rf():Se=await tf(e);Se&&Se.data&&(i(Se.data.data),l(Se.data.data),Se.data.poPolicyFileLink&&A(Se.data.poPolicyFileLink),I({statusFilter:Z,departmentFilter:Y,dateFilters:{...K}}),u(1),p(!1))}catch(Se){console.error(" Error applying filters:",Se)}finally{F(!1),setTimeout(()=>{w(!1)},500),console.log(`=== FILTER APPLICATION END ===
`)}};C.useEffect(()=>{let Se=[...s];x.trim()&&(Se=Se.filter(Ce=>{var Pe,Bt,tt,Ot,vt,Vt,pr,$t,Qr,ir,Gr,un,Nr,Wt;const Be=x.toLowerCase().trim();return((Pe=Ce.reqid)==null?void 0:Pe.toLowerCase().includes(Be))||((Bt=Ce.userName)==null?void 0:Bt.toLowerCase().includes(Be))||((Ot=(tt=Ce.commercials)==null?void 0:tt.department)==null?void 0:Ot.toLowerCase().includes(Be))||((Vt=(vt=Ce.commercials)==null?void 0:vt.businessUnit)==null?void 0:Vt.toLowerCase().includes(Be))||(($t=(pr=Ce.commercials)==null?void 0:pr.entity)==null?void 0:$t.toLowerCase().includes(Be))||((ir=(Qr=Ce.procurements)==null?void 0:Qr.vendor)==null?void 0:ir.toLowerCase().includes(Be))||((un=(Gr=Ce.procurements)==null?void 0:Gr.vendorName)==null?void 0:un.toLowerCase().includes(Be))||((Nr=Ce.status)==null?void 0:Nr.toLowerCase().includes(Be))||((Wt=Ce.nextDepartment)==null?void 0:Wt.toLowerCase().includes(Be))})),l(Se),u(1)},[x,s]);const V=Se=>{m(Se.target.value)},Ae=Se=>{const{name:Ce,value:Be}=Se.target;ae(Pe=>({...Pe,[Ce]:Be}))},W=Se=>{const Ce=Se.target.value;console.log("Status filter changed to:",Ce),oe(Ce),R(""),ee(Q.includes(Ce))},J=Se=>{const Ce=Se.target.value;console.log("Department filter changed to:",Ce),R(Ce)},ve=()=>{console.log("Clearing all filters"),ae({fromDate:"",toDate:""}),oe(""),R(""),m(""),ee(!1),O([]),I({statusFilter:"",departmentFilter:"",dateFilters:{fromDate:"",toDate:""}}),(async()=>{w(!0);try{let Ce;t==="Admin"?Ce=await rf():Ce=await tf(e),Ce&&Ce.data&&(i(Ce.data.data),l(Ce.data.data),Ce.data.poPolicyFileLink&&A(Ce.data.poPolicyFileLink))}catch(Ce){console.error("Error fetching all data:",Ce)}finally{w(!1)}})()},de=async(Se,Ce)=>{Ce.stopPropagation();try{await navigator.clipboard.writeText(Se),L(Se),setTimeout(()=>{L(null)},2e3)}catch(Be){console.error("Failed to copy: ",Be);const Pe=document.createElement("textarea");Pe.value=Se,document.body.appendChild(Pe),Pe.focus(),Pe.select();try{document.execCommand("copy"),L(Se),setTimeout(()=>{L(null)},2e3)}catch(Bt){console.error("Fallback copy failed: ",Bt)}document.body.removeChild(Pe)}},te=(Se,Ce)=>{Ce.stopPropagation();const Be=`/req-list-table/preview-one-req/${Se}`;window.open(Be,"_blank")},je=(Se,Ce)=>{if(!Se)return"N/A";const Be=_.find(Pe=>Pe.code===Ce);if(!Be)return Se;try{return new Intl.NumberFormat(Be.locale,{style:"currency",currency:Be.code,minimumFractionDigits:2,maximumFractionDigits:2}).format(Se)}catch(Pe){return console.error("Currency formatting error:",Pe),Se}},qe=Math.ceil(o.length/U),He=(d-1)*U,Ze=He+U,xe=o.slice(He,Ze),ue=Se=>{Se>=1&&Se<=qe&&u(Se)},Fe=(Se,Ce)=>{Se.stopPropagation(),n(`/req-list-table/edit-req/${Ce}`)},ke=async Se=>{try{await Zm(Se)&&(i(s==null?void 0:s.filter(Be=>(Be==null?void 0:Be._id)!==Se)),l(o==null?void 0:o.filter(Be=>(Be==null?void 0:Be._id)!==Se)),T(!1))}catch(Ce){console.error("Error deleting request:",Ce)}},Te=Se=>Se.status==="Approved"?a.jsx("td",{className:"text-sm text-gray-500 text-center md:px-6 md:py-4 px-2 py-2",children:a.jsx("span",{className:"text-xs text-gray-400",children:"No actions"})}):Se.isCompleted?t==="Admin"||t==="Head of Finance"||t==="HOD Department"||r==1?a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-sm text-gray-500",children:a.jsxs("div",{className:"flex justify-center items-center space-x-2",children:[a.jsx("button",{className:"text-blue-500 hover:text-blue-700",onClick:Ce=>Fe(Ce,Se._id),children:a.jsx(Us,{className:"h-4 w-4 md:h-5 md:w-5"})}),t==="Admin"&&a.jsx("button",{className:"text-red-500 hover:text-red-700",onClick:Ce=>{Ce.stopPropagation(),G(Se._id),T(!0)},children:a.jsx($r,{className:"h-4 w-4 md:h-5 md:w-5"})})]})}):a.jsx("td",{className:"text-sm text-gray-500 text-center md:px-6 md:py-4 px-2 py-2",children:a.jsx("button",{className:"px-2 py-1 bg-primary text-white rounded-md hover:bg-primary text-xs md:text-sm",onClick:Ce=>{Ce.stopPropagation(),h(!0),G(Se._id)},children:"Request Edit"})}):a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-sm text-gray-500",children:a.jsxs("div",{className:"flex justify-center items-center space-x-2",children:[a.jsx("button",{className:"text-blue-500 hover:text-blue-700",onClick:Ce=>Fe(Ce,Se._id),children:a.jsx(Us,{className:"h-4 w-4 md:h-5 md:w-5"})}),a.jsx("button",{className:"text-red-500 hover:text-red-700",onClick:Ce=>{Ce.stopPropagation(),G(Se._id),T(!0)},children:a.jsx($r,{className:"h-4 w-4 md:h-5 md:w-5"})})]})}),Ne=async()=>{try{console.log("Sending...");const Se=await wI(e,D);console.log(Se)}catch(Se){console.error("Error sending mail",Se)}},et=S.statusFilter||S.departmentFilter||S.dateFilters.fromDate||S.dateFilters.toDate;return a.jsxs(a.Fragment,{children:[v&&a.jsx(Fd,{}),E&&a.jsx("div",{className:"fixed top-4 right-4 z-50",children:a.jsxs("div",{className:"bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg flex items-center space-x-2",children:[a.jsx(ho,{className:"h-4 w-4"}),a.jsxs("span",{className:"text-sm font-medium",children:['ReqID "',E,'" copied successfully!']})]})}),a.jsxs("div",{className:"p-3 md:p-4 bg-white rounded-lg shadow-sm h-full",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h2",{className:"text-xl md:text-2xl font-bold text-gray-900 mb-4 md:mb-6",children:"Request List"}),et&&a.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Active Filters:"}),S.statusFilter&&a.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs",children:[S.statusFilter,S.departmentFilter&&` (${S.departmentFilter})`]}),(S.dateFilters.fromDate||S.dateFilters.toDate)&&a.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs",children:["Date:"," ",S.dateFilters.fromDate||"Any"," ","to"," ",S.dateFilters.toDate||"Any"]})]}),a.jsx("button",{onClick:ve,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",disabled:M,children:"Clear All"})]})}),a.jsxs("div",{className:"block lg:hidden mb-4",children:[a.jsxs("button",{className:"w-full flex justify-center items-center px-3 py-2 bg-primary text-white rounded-lg text-sm font-medium hover:bg-primary/90 mb-2",onClick:()=>n("/req-list-table/create-request"),children:[a.jsx(yn,{className:"h-4 w-4 mr-1"}),"Add Request"]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("button",{className:"flex-1 mr-2 flex justify-center items-center px-2 py-2 border border-gray-300 rounded-lg text-xs font-medium text-gray-700 bg-white hover:bg-gray-50",onClick:()=>p(!g),children:[a.jsx(ti,{className:"h-3 w-3 mr-1"}),"Filter"]}),a.jsxs("button",{className:"flex-1 flex justify-center items-center px-2 py-2 border border-gray-300 rounded-lg text-xs font-medium text-gray-700 bg-white hover:bg-gray-50",onClick:()=>Ud(s),children:[a.jsx(_n,{className:"h-3 w-3 mr-1"}),"Export"]}),c&&a.jsxs("a",{href:c,target:"_blank",rel:"noopener noreferrer",className:"flex-1 flex justify-center items-center px-2 py-2 border border-blue-300 rounded-lg text-xs font-medium text-blue-700 bg-blue-50 hover:bg-blue-100",children:[a.jsx(jr,{className:"h-3 w-3 mr-1"}),"PO Policy"]})]})]}),a.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-3 lg:gap-6",children:[a.jsxs("div",{className:"relative w-full lg:flex-1 lg:min-w-[300px] lg:max-w-md",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:a.jsx(rn,{className:"h-4 w-4 md:h-5 md:w-5 text-gray-400"})}),a.jsx("input",{type:"text",value:x,onChange:V,placeholder:"Search by ID, name, department, or next department...",className:"w-full pl-10 pr-4 py-2 md:py-2.5 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),a.jsxs("div",{className:"hidden lg:flex items-center gap-4",children:[a.jsxs("button",{className:"inline-flex items-center px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",onClick:()=>p(!g),children:[a.jsx(ti,{className:"h-4 w-4 mr-2"}),"Filter",g?a.jsx(bl,{className:"h-4 w-4 ml-1"}):a.jsx(vo,{className:"h-4 w-4 ml-1"})]}),a.jsxs("button",{className:"inline-flex items-center px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",onClick:()=>Ud(s),children:[a.jsx(_n,{className:"h-4 w-4 mr-2"}),"Export"]}),c&&a.jsxs("a",{href:c,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2.5 border border-blue-300 rounded-lg text-sm font-medium text-blue-700 bg-blue-50 hover:bg-blue-100",children:[a.jsx(jr,{className:"h-4 w-4 mr-2"}),"View PO Policy"]}),a.jsxs("button",{className:"inline-flex items-center px-4 py-2.5 bg-primary text-white rounded-lg text-sm font-medium hover:bg-primary/90",onClick:()=>n("/req-list-table/create-request"),children:[a.jsx(yn,{className:"h-4 w-4 mr-2"}),"Add Request"]})]})]}),g&&a.jsxs("div",{className:"mt-4 w-full md:w-80 p-4 bg-white rounded-lg shadow-lg border border-gray-200 absolute right-0 md:right-8 z-20",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:"Filters"}),a.jsx("button",{onClick:()=>p(!1),className:"text-gray-500 hover:text-gray-700",children:a.jsx(_r,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Status"}),a.jsxs("select",{value:Z,onChange:W,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary",children:[a.jsx("option",{value:"",children:"All Statuses"}),a.jsx("option",{value:"Pending",children:"Pending"}),a.jsx("option",{value:"Hold",children:"Hold"}),a.jsx("option",{value:"Rejected",children:"Rejected"}),a.jsx("option",{value:"PO-Pending",children:"PO-Pending"}),a.jsx("option",{value:"Invoice-Pending",children:"Invoice-Pending"}),a.jsx("option",{value:"Approved",children:"Approved"})]})]}),Q.includes(Z)&&b.length>0&&a.jsxs("div",{className:"mb-4",children:[a.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:["Next Department (",Z,")"]}),a.jsxs("select",{value:Y,onChange:J,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary",children:[a.jsx("option",{value:"",children:"All Departments"}),b.map(Se=>a.jsx("option",{value:Se,children:Se},Se))]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Showing"," ",b.length," ","departments for ",Z," ","status"]})]}),Q.includes(Z)&&b.length===0&&a.jsxs("div",{className:"mb-4",children:[a.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:["Next Department (",Z,")"]}),a.jsxs("div",{className:"px-3 py-2 text-sm text-gray-500 bg-gray-50 rounded-md border",children:["No departments available for"," ",Z," status"]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Date Range"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:"From"}),a.jsx("input",{type:"date",name:"fromDate",value:K.fromDate,onChange:Ae,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:"To"}),a.jsx("input",{type:"date",name:"toDate",value:K.toDate,onChange:Ae,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary"})]})]})]}),a.jsxs("div",{className:"flex justify-between pt-3 border-t border-gray-200",children:[a.jsx("button",{onClick:()=>p(!1),className:"px-3 py-1.5 text-sm text-gray-600 hover:text-gray-800 font-medium",children:"Close"}),a.jsxs("button",{onClick:X,disabled:M,className:"px-4 py-1.5 bg-primary text-white text-sm font-medium rounded-md hover:bg-primary/90 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[M&&a.jsx("div",{className:"w-3 h-3 border border-white border-t-transparent rounded-full animate-spin"}),"Apply Filters"]})]})]})]}),a.jsx(Nae,{filteredUsers:o,currentUsers:xe,navigate:n,currentPage:d,itemsPerPage:U,handleCopyReqId:de,handleOpenInNewTab:te,formatCurrency:je,Pagination:tp,totalPages:qe,renderActionColumn:Te,handlePageChange:ue}),f&&a.jsx(wae,{setIsShowModal:h,sendEditMail:Ne}),B&&a.jsx(bae,{setIsDelete:T,handleDelete:ke,reqId:D})]})]})};var jae=function(t){return Bae(t)&&!Sae(t)};function Bae(e){return!!e&&typeof e=="object"}function Sae(e){var t=Object.prototype.toString.call(e);return t==="[object RegExp]"||t==="[object Date]"||kae(e)}var Fae=typeof Symbol=="function"&&Symbol.for,Eae=Fae?Symbol.for("react.element"):60103;function kae(e){return e.$$typeof===Eae}function Tae(e){return Array.isArray(e)?[]:{}}function W1(e,t){return t.clone!==!1&&t.isMergeableObject(e)?km(Tae(e),e,t):e}function _ae(e,t,r){return e.concat(t).map(function(n){return W1(n,r)})}function Iae(e,t,r){var n={};return r.isMergeableObject(e)&&Object.keys(e).forEach(function(s){n[s]=W1(e[s],r)}),Object.keys(t).forEach(function(s){!r.isMergeableObject(t[s])||!e[s]?n[s]=W1(t[s],r):n[s]=km(e[s],t[s],r)}),n}function km(e,t,r){r=r||{},r.arrayMerge=r.arrayMerge||_ae,r.isMergeableObject=r.isMergeableObject||jae;var n=Array.isArray(t),s=Array.isArray(e),i=n===s;return i?n?r.arrayMerge(e,t,r):Iae(e,t,r):W1(t,r)}km.all=function(t,r){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(n,s){return km(n,s,r)},{})};var VN=km,mU=typeof global=="object"&&global&&global.Object===Object&&global,Lae=typeof self=="object"&&self&&self.Object===Object&&self,jl=mU||Lae||Function("return this")(),bA=jl.Symbol,pU=Object.prototype,Uae=pU.hasOwnProperty,Dae=pU.toString,X0=bA?bA.toStringTag:void 0;function Pae(e){var t=Uae.call(e,X0),r=e[X0];try{e[X0]=void 0;var n=!0}catch{}var s=Dae.call(e);return n&&(t?e[X0]=r:delete e[X0]),s}var Oae=Object.prototype,Rae=Oae.toString;function Qae(e){return Rae.call(e)}var Mae="[object Null]",Hae="[object Undefined]",FF=bA?bA.toStringTag:void 0;function Gd(e){return e==null?e===void 0?Hae:Mae:FF&&FF in Object(e)?Pae(e):Qae(e)}function xU(e,t){return function(r){return e(t(r))}}var YC=xU(Object.getPrototypeOf,Object);function Wd(e){return e!=null&&typeof e=="object"}var Vae="[object Object]",$ae=Function.prototype,qae=Object.prototype,gU=$ae.toString,Kae=qae.hasOwnProperty,zae=gU.call(Object);function EF(e){if(!Wd(e)||Gd(e)!=Vae)return!1;var t=YC(e);if(t===null)return!0;var r=Kae.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&gU.call(r)==zae}function Gae(){this.__data__=[],this.size=0}function yU(e,t){return e===t||e!==e&&t!==t}function gv(e,t){for(var r=e.length;r--;)if(yU(e[r][0],t))return r;return-1}var Wae=Array.prototype,Xae=Wae.splice;function Yae(e){var t=this.__data__,r=gv(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():Xae.call(t,r,1),--this.size,!0}function Jae(e){var t=this.__data__,r=gv(t,e);return r<0?void 0:t[r][1]}function Zae(e){return gv(this.__data__,e)>-1}function eie(e,t){var r=this.__data__,n=gv(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}function gc(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}gc.prototype.clear=Gae;gc.prototype.delete=Yae;gc.prototype.get=Jae;gc.prototype.has=Zae;gc.prototype.set=eie;function tie(){this.__data__=new gc,this.size=0}function rie(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}function nie(e){return this.__data__.get(e)}function sie(e){return this.__data__.has(e)}function Ap(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var aie="[object AsyncFunction]",iie="[object Function]",oie="[object GeneratorFunction]",lie="[object Proxy]";function vU(e){if(!Ap(e))return!1;var t=Gd(e);return t==iie||t==oie||t==aie||t==lie}var _w=jl["__core-js_shared__"],kF=function(){var e=/[^.]+$/.exec(_w&&_w.keys&&_w.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function cie(e){return!!kF&&kF in e}var Aie=Function.prototype,die=Aie.toString;function Xd(e){if(e!=null){try{return die.call(e)}catch{}try{return e+""}catch{}}return""}var uie=/[\\^$.*+?()[\]{}|]/g,fie=/^\[object .+?Constructor\]$/,hie=Function.prototype,mie=Object.prototype,pie=hie.toString,xie=mie.hasOwnProperty,gie=RegExp("^"+pie.call(xie).replace(uie,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function yie(e){if(!Ap(e)||cie(e))return!1;var t=vU(e)?gie:fie;return t.test(Xd(e))}function vie(e,t){return e==null?void 0:e[t]}function Yd(e,t){var r=vie(e,t);return yie(r)?r:void 0}var Tm=Yd(jl,"Map"),_m=Yd(Object,"create");function wie(){this.__data__=_m?_m(null):{},this.size=0}function bie(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Nie="__lodash_hash_undefined__",Cie=Object.prototype,jie=Cie.hasOwnProperty;function Bie(e){var t=this.__data__;if(_m){var r=t[e];return r===Nie?void 0:r}return jie.call(t,e)?t[e]:void 0}var Sie=Object.prototype,Fie=Sie.hasOwnProperty;function Eie(e){var t=this.__data__;return _m?t[e]!==void 0:Fie.call(t,e)}var kie="__lodash_hash_undefined__";function Tie(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=_m&&t===void 0?kie:t,this}function Dd(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Dd.prototype.clear=wie;Dd.prototype.delete=bie;Dd.prototype.get=Bie;Dd.prototype.has=Eie;Dd.prototype.set=Tie;function _ie(){this.size=0,this.__data__={hash:new Dd,map:new(Tm||gc),string:new Dd}}function Iie(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function yv(e,t){var r=e.__data__;return Iie(t)?r[typeof t=="string"?"string":"hash"]:r.map}function Lie(e){var t=yv(this,e).delete(e);return this.size-=t?1:0,t}function Uie(e){return yv(this,e).get(e)}function Die(e){return yv(this,e).has(e)}function Pie(e,t){var r=yv(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}function _A(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}_A.prototype.clear=_ie;_A.prototype.delete=Lie;_A.prototype.get=Uie;_A.prototype.has=Die;_A.prototype.set=Pie;var Oie=200;function Rie(e,t){var r=this.__data__;if(r instanceof gc){var n=r.__data__;if(!Tm||n.length<Oie-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new _A(n)}return r.set(e,t),this.size=r.size,this}function a0(e){var t=this.__data__=new gc(e);this.size=t.size}a0.prototype.clear=tie;a0.prototype.delete=rie;a0.prototype.get=nie;a0.prototype.has=sie;a0.prototype.set=Rie;function Qie(e,t){for(var r=-1,n=e==null?0:e.length;++r<n&&t(e[r],r,e)!==!1;);return e}var TF=function(){try{var e=Yd(Object,"defineProperty");return e({},"",{}),e}catch{}}();function wU(e,t,r){t=="__proto__"&&TF?TF(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var Mie=Object.prototype,Hie=Mie.hasOwnProperty;function bU(e,t,r){var n=e[t];(!(Hie.call(e,t)&&yU(n,r))||r===void 0&&!(t in e))&&wU(e,t,r)}function vv(e,t,r,n){var s=!r;r||(r={});for(var i=-1,o=t.length;++i<o;){var l=t[i],c=void 0;c===void 0&&(c=e[l]),s?wU(r,l,c):bU(r,l,c)}return r}function Vie(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var $ie="[object Arguments]";function _F(e){return Wd(e)&&Gd(e)==$ie}var NU=Object.prototype,qie=NU.hasOwnProperty,Kie=NU.propertyIsEnumerable,zie=_F(function(){return arguments}())?_F:function(e){return Wd(e)&&qie.call(e,"callee")&&!Kie.call(e,"callee")},dp=Array.isArray;function Gie(){return!1}var CU=typeof exports=="object"&&exports&&!exports.nodeType&&exports,IF=CU&&typeof module=="object"&&module&&!module.nodeType&&module,Wie=IF&&IF.exports===CU,LF=Wie?jl.Buffer:void 0,Xie=LF?LF.isBuffer:void 0,jU=Xie||Gie,Yie=9007199254740991,Jie=/^(?:0|[1-9]\d*)$/;function Zie(e,t){var r=typeof e;return t=t??Yie,!!t&&(r=="number"||r!="symbol"&&Jie.test(e))&&e>-1&&e%1==0&&e<t}var eoe=9007199254740991;function BU(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=eoe}var toe="[object Arguments]",roe="[object Array]",noe="[object Boolean]",soe="[object Date]",aoe="[object Error]",ioe="[object Function]",ooe="[object Map]",loe="[object Number]",coe="[object Object]",Aoe="[object RegExp]",doe="[object Set]",uoe="[object String]",foe="[object WeakMap]",hoe="[object ArrayBuffer]",moe="[object DataView]",poe="[object Float32Array]",xoe="[object Float64Array]",goe="[object Int8Array]",yoe="[object Int16Array]",voe="[object Int32Array]",woe="[object Uint8Array]",boe="[object Uint8ClampedArray]",Noe="[object Uint16Array]",Coe="[object Uint32Array]",bn={};bn[poe]=bn[xoe]=bn[goe]=bn[yoe]=bn[voe]=bn[woe]=bn[boe]=bn[Noe]=bn[Coe]=!0;bn[toe]=bn[roe]=bn[hoe]=bn[noe]=bn[moe]=bn[soe]=bn[aoe]=bn[ioe]=bn[ooe]=bn[loe]=bn[coe]=bn[Aoe]=bn[doe]=bn[uoe]=bn[foe]=!1;function joe(e){return Wd(e)&&BU(e.length)&&!!bn[Gd(e)]}function JC(e){return function(t){return e(t)}}var SU=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Mh=SU&&typeof module=="object"&&module&&!module.nodeType&&module,Boe=Mh&&Mh.exports===SU,Iw=Boe&&mU.process,Of=function(){try{var e=Mh&&Mh.require&&Mh.require("util").types;return e||Iw&&Iw.binding&&Iw.binding("util")}catch{}}(),UF=Of&&Of.isTypedArray,Soe=UF?JC(UF):joe,Foe=Object.prototype,Eoe=Foe.hasOwnProperty;function FU(e,t){var r=dp(e),n=!r&&zie(e),s=!r&&!n&&jU(e),i=!r&&!n&&!s&&Soe(e),o=r||n||s||i,l=o?Vie(e.length,String):[],c=l.length;for(var A in e)(t||Eoe.call(e,A))&&!(o&&(A=="length"||s&&(A=="offset"||A=="parent")||i&&(A=="buffer"||A=="byteLength"||A=="byteOffset")||Zie(A,c)))&&l.push(A);return l}var koe=Object.prototype;function ZC(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||koe;return e===r}var Toe=xU(Object.keys,Object),_oe=Object.prototype,Ioe=_oe.hasOwnProperty;function Loe(e){if(!ZC(e))return Toe(e);var t=[];for(var r in Object(e))Ioe.call(e,r)&&r!="constructor"&&t.push(r);return t}function EU(e){return e!=null&&BU(e.length)&&!vU(e)}function ej(e){return EU(e)?FU(e):Loe(e)}function Uoe(e,t){return e&&vv(t,ej(t),e)}function Doe(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var Poe=Object.prototype,Ooe=Poe.hasOwnProperty;function Roe(e){if(!Ap(e))return Doe(e);var t=ZC(e),r=[];for(var n in e)n=="constructor"&&(t||!Ooe.call(e,n))||r.push(n);return r}function tj(e){return EU(e)?FU(e,!0):Roe(e)}function Qoe(e,t){return e&&vv(t,tj(t),e)}var kU=typeof exports=="object"&&exports&&!exports.nodeType&&exports,DF=kU&&typeof module=="object"&&module&&!module.nodeType&&module,Moe=DF&&DF.exports===kU,PF=Moe?jl.Buffer:void 0,OF=PF?PF.allocUnsafe:void 0;function Hoe(e,t){if(t)return e.slice();var r=e.length,n=OF?OF(r):new e.constructor(r);return e.copy(n),n}function TU(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}function Voe(e,t){for(var r=-1,n=e==null?0:e.length,s=0,i=[];++r<n;){var o=e[r];t(o,r,e)&&(i[s++]=o)}return i}function _U(){return[]}var $oe=Object.prototype,qoe=$oe.propertyIsEnumerable,RF=Object.getOwnPropertySymbols,rj=RF?function(e){return e==null?[]:(e=Object(e),Voe(RF(e),function(t){return qoe.call(e,t)}))}:_U;function Koe(e,t){return vv(e,rj(e),t)}function IU(e,t){for(var r=-1,n=t.length,s=e.length;++r<n;)e[s+r]=t[r];return e}var zoe=Object.getOwnPropertySymbols,LU=zoe?function(e){for(var t=[];e;)IU(t,rj(e)),e=YC(e);return t}:_U;function Goe(e,t){return vv(e,LU(e),t)}function UU(e,t,r){var n=t(e);return dp(e)?n:IU(n,r(e))}function Woe(e){return UU(e,ej,rj)}function Xoe(e){return UU(e,tj,LU)}var $N=Yd(jl,"DataView"),qN=Yd(jl,"Promise"),KN=Yd(jl,"Set"),zN=Yd(jl,"WeakMap"),QF="[object Map]",Yoe="[object Object]",MF="[object Promise]",HF="[object Set]",VF="[object WeakMap]",$F="[object DataView]",Joe=Xd($N),Zoe=Xd(Tm),ele=Xd(qN),tle=Xd(KN),rle=Xd(zN),$l=Gd;($N&&$l(new $N(new ArrayBuffer(1)))!=$F||Tm&&$l(new Tm)!=QF||qN&&$l(qN.resolve())!=MF||KN&&$l(new KN)!=HF||zN&&$l(new zN)!=VF)&&($l=function(e){var t=Gd(e),r=t==Yoe?e.constructor:void 0,n=r?Xd(r):"";if(n)switch(n){case Joe:return $F;case Zoe:return QF;case ele:return MF;case tle:return HF;case rle:return VF}return t});var nle=Object.prototype,sle=nle.hasOwnProperty;function ale(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&sle.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var qF=jl.Uint8Array;function nj(e){var t=new e.constructor(e.byteLength);return new qF(t).set(new qF(e)),t}function ile(e,t){var r=t?nj(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var ole=/\w*$/;function lle(e){var t=new e.constructor(e.source,ole.exec(e));return t.lastIndex=e.lastIndex,t}var KF=bA?bA.prototype:void 0,zF=KF?KF.valueOf:void 0;function cle(e){return zF?Object(zF.call(e)):{}}function Ale(e,t){var r=t?nj(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var dle="[object Boolean]",ule="[object Date]",fle="[object Map]",hle="[object Number]",mle="[object RegExp]",ple="[object Set]",xle="[object String]",gle="[object Symbol]",yle="[object ArrayBuffer]",vle="[object DataView]",wle="[object Float32Array]",ble="[object Float64Array]",Nle="[object Int8Array]",Cle="[object Int16Array]",jle="[object Int32Array]",Ble="[object Uint8Array]",Sle="[object Uint8ClampedArray]",Fle="[object Uint16Array]",Ele="[object Uint32Array]";function kle(e,t,r){var n=e.constructor;switch(t){case yle:return nj(e);case dle:case ule:return new n(+e);case vle:return ile(e,r);case wle:case ble:case Nle:case Cle:case jle:case Ble:case Sle:case Fle:case Ele:return Ale(e,r);case fle:return new n;case hle:case xle:return new n(e);case mle:return lle(e);case ple:return new n;case gle:return cle(e)}}var GF=Object.create,Tle=function(){function e(){}return function(t){if(!Ap(t))return{};if(GF)return GF(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();function _le(e){return typeof e.constructor=="function"&&!ZC(e)?Tle(YC(e)):{}}var Ile="[object Map]";function Lle(e){return Wd(e)&&$l(e)==Ile}var WF=Of&&Of.isMap,Ule=WF?JC(WF):Lle,Dle="[object Set]";function Ple(e){return Wd(e)&&$l(e)==Dle}var XF=Of&&Of.isSet,Ole=XF?JC(XF):Ple,Rle=1,Qle=2,Mle=4,DU="[object Arguments]",Hle="[object Array]",Vle="[object Boolean]",$le="[object Date]",qle="[object Error]",PU="[object Function]",Kle="[object GeneratorFunction]",zle="[object Map]",Gle="[object Number]",OU="[object Object]",Wle="[object RegExp]",Xle="[object Set]",Yle="[object String]",Jle="[object Symbol]",Zle="[object WeakMap]",ece="[object ArrayBuffer]",tce="[object DataView]",rce="[object Float32Array]",nce="[object Float64Array]",sce="[object Int8Array]",ace="[object Int16Array]",ice="[object Int32Array]",oce="[object Uint8Array]",lce="[object Uint8ClampedArray]",cce="[object Uint16Array]",Ace="[object Uint32Array]",pn={};pn[DU]=pn[Hle]=pn[ece]=pn[tce]=pn[Vle]=pn[$le]=pn[rce]=pn[nce]=pn[sce]=pn[ace]=pn[ice]=pn[zle]=pn[Gle]=pn[OU]=pn[Wle]=pn[Xle]=pn[Yle]=pn[Jle]=pn[oce]=pn[lce]=pn[cce]=pn[Ace]=!0;pn[qle]=pn[PU]=pn[Zle]=!1;function Hh(e,t,r,n,s,i){var o,l=t&Rle,c=t&Qle,A=t&Mle;if(o!==void 0)return o;if(!Ap(e))return e;var d=dp(e);if(d){if(o=ale(e),!l)return TU(e,o)}else{var u=$l(e),f=u==PU||u==Kle;if(jU(e))return Hoe(e,l);if(u==OU||u==DU||f&&!s){if(o=c||f?{}:_le(e),!l)return c?Goe(e,Qoe(o,e)):Koe(e,Uoe(o,e))}else{if(!pn[u])return s?e:{};o=kle(e,u,l)}}i||(i=new a0);var h=i.get(e);if(h)return h;i.set(e,o),Ole(e)?e.forEach(function(g){o.add(Hh(g,t,r,g,e,i))}):Ule(e)&&e.forEach(function(g,p){o.set(p,Hh(g,t,r,p,e,i))});var x=A?c?Xoe:Woe:c?tj:ej,m=d?void 0:x(e);return Qie(m||e,function(g,p){m&&(p=g,g=e[p]),bU(o,p,Hh(g,t,r,p,e,i))}),o}var dce=1,uce=4;function Rx(e){return Hh(e,dce|uce)}var YF=Array.isArray,JF=Object.keys,fce=Object.prototype.hasOwnProperty,hce=typeof Element<"u";function GN(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var r=YF(e),n=YF(t),s,i,o;if(r&&n){if(i=e.length,i!=t.length)return!1;for(s=i;s--!==0;)if(!GN(e[s],t[s]))return!1;return!0}if(r!=n)return!1;var l=e instanceof Date,c=t instanceof Date;if(l!=c)return!1;if(l&&c)return e.getTime()==t.getTime();var A=e instanceof RegExp,d=t instanceof RegExp;if(A!=d)return!1;if(A&&d)return e.toString()==t.toString();var u=JF(e);if(i=u.length,i!==JF(t).length)return!1;for(s=i;s--!==0;)if(!fce.call(t,u[s]))return!1;if(hce&&e instanceof Element&&t instanceof Element)return e===t;for(s=i;s--!==0;)if(o=u[s],!(o==="_owner"&&e.$$typeof)&&!GN(e[o],t[o]))return!1;return!0}return e!==e&&t!==t}var mce=function(t,r){try{return GN(t,r)}catch(n){if(n.message&&n.message.match(/stack|recursion/i)||n.number===-2146828260)return console.warn("Warning: react-fast-compare does not handle circular references.",n.name,n.message),!1;throw n}};const WA=M5(mce);var pce=4;function ZF(e){return Hh(e,pce)}function RU(e,t){for(var r=-1,n=e==null?0:e.length,s=Array(n);++r<n;)s[r]=t(e[r],r,e);return s}var xce="[object Symbol]";function sj(e){return typeof e=="symbol"||Wd(e)&&Gd(e)==xce}var gce="Expected a function";function aj(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(gce);var r=function(){var n=arguments,s=t?t.apply(this,n):n[0],i=r.cache;if(i.has(s))return i.get(s);var o=e.apply(this,n);return r.cache=i.set(s,o)||i,o};return r.cache=new(aj.Cache||_A),r}aj.Cache=_A;var yce=500;function vce(e){var t=aj(e,function(n){return r.size===yce&&r.clear(),n}),r=t.cache;return t}var wce=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,bce=/\\(\\)?/g,Nce=vce(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(wce,function(r,n,s,i){t.push(s?i.replace(bce,"$1"):n||r)}),t}),Cce=1/0;function jce(e){if(typeof e=="string"||sj(e))return e;var t=e+"";return t=="0"&&1/e==-Cce?"-0":t}var Bce=1/0,eE=bA?bA.prototype:void 0,tE=eE?eE.toString:void 0;function QU(e){if(typeof e=="string")return e;if(dp(e))return RU(e,QU)+"";if(sj(e))return tE?tE.call(e):"";var t=e+"";return t=="0"&&1/e==-Bce?"-0":t}function Sce(e){return e==null?"":QU(e)}function MU(e){return dp(e)?RU(e,jce):sj(e)?[e]:TU(Nce(Sce(e)))}var HU={exports:{}},an={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Os=typeof Symbol=="function"&&Symbol.for,ij=Os?Symbol.for("react.element"):60103,oj=Os?Symbol.for("react.portal"):60106,wv=Os?Symbol.for("react.fragment"):60107,bv=Os?Symbol.for("react.strict_mode"):60108,Nv=Os?Symbol.for("react.profiler"):60114,Cv=Os?Symbol.for("react.provider"):60109,jv=Os?Symbol.for("react.context"):60110,lj=Os?Symbol.for("react.async_mode"):60111,Bv=Os?Symbol.for("react.concurrent_mode"):60111,Sv=Os?Symbol.for("react.forward_ref"):60112,Fv=Os?Symbol.for("react.suspense"):60113,Fce=Os?Symbol.for("react.suspense_list"):60120,Ev=Os?Symbol.for("react.memo"):60115,kv=Os?Symbol.for("react.lazy"):60116,Ece=Os?Symbol.for("react.block"):60121,kce=Os?Symbol.for("react.fundamental"):60117,Tce=Os?Symbol.for("react.responder"):60118,_ce=Os?Symbol.for("react.scope"):60119;function Li(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case ij:switch(e=e.type,e){case lj:case Bv:case wv:case Nv:case bv:case Fv:return e;default:switch(e=e&&e.$$typeof,e){case jv:case Sv:case kv:case Ev:case Cv:return e;default:return t}}case oj:return t}}}function VU(e){return Li(e)===Bv}an.AsyncMode=lj;an.ConcurrentMode=Bv;an.ContextConsumer=jv;an.ContextProvider=Cv;an.Element=ij;an.ForwardRef=Sv;an.Fragment=wv;an.Lazy=kv;an.Memo=Ev;an.Portal=oj;an.Profiler=Nv;an.StrictMode=bv;an.Suspense=Fv;an.isAsyncMode=function(e){return VU(e)||Li(e)===lj};an.isConcurrentMode=VU;an.isContextConsumer=function(e){return Li(e)===jv};an.isContextProvider=function(e){return Li(e)===Cv};an.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===ij};an.isForwardRef=function(e){return Li(e)===Sv};an.isFragment=function(e){return Li(e)===wv};an.isLazy=function(e){return Li(e)===kv};an.isMemo=function(e){return Li(e)===Ev};an.isPortal=function(e){return Li(e)===oj};an.isProfiler=function(e){return Li(e)===Nv};an.isStrictMode=function(e){return Li(e)===bv};an.isSuspense=function(e){return Li(e)===Fv};an.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===wv||e===Bv||e===Nv||e===bv||e===Fv||e===Fce||typeof e=="object"&&e!==null&&(e.$$typeof===kv||e.$$typeof===Ev||e.$$typeof===Cv||e.$$typeof===jv||e.$$typeof===Sv||e.$$typeof===kce||e.$$typeof===Tce||e.$$typeof===_ce||e.$$typeof===Ece)};an.typeOf=Li;HU.exports=an;var Ice=HU.exports,$U=Ice,Lce={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Uce={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},qU={};qU[$U.ForwardRef]=Lce;qU[$U.Memo]=Uce;function Fs(){return Fs=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fs.apply(this,arguments)}function KU(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,i;for(i=0;i<n.length;i++)s=n[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}var Tv=C.createContext(void 0);Tv.displayName="FormikContext";Tv.Provider;Tv.Consumer;function Dce(){var e=C.useContext(Tv);return e}var To=function(t){return typeof t=="function"},_v=function(t){return t!==null&&typeof t=="object"},Pce=function(t){return String(Math.floor(Number(t)))===t},Lw=function(t){return Object.prototype.toString.call(t)==="[object String]"},Uw=function(t){return _v(t)&&To(t.then)};function hi(e,t,r,n){n===void 0&&(n=0);for(var s=MU(t);e&&n<s.length;)e=e[s[n++]];return n!==s.length&&!e||e===void 0?r:e}function xd(e,t,r){for(var n=ZF(e),s=n,i=0,o=MU(t);i<o.length-1;i++){var l=o[i],c=hi(e,o.slice(0,i+1));if(c&&(_v(c)||Array.isArray(c)))s=s[l]=ZF(c);else{var A=o[i+1];s=s[l]=Pce(A)&&Number(A)>=0?[]:{}}}return(i===0?e:s)[o[i]]===r?e:(r===void 0?delete s[o[i]]:s[o[i]]=r,i===0&&r===void 0&&delete n[o[i]],n)}function zU(e,t,r,n){r===void 0&&(r=new WeakMap),n===void 0&&(n={});for(var s=0,i=Object.keys(e);s<i.length;s++){var o=i[s],l=e[o];_v(l)?r.get(l)||(r.set(l,!0),n[o]=Array.isArray(l)?[]:{},zU(l,t,r,n[o])):n[o]=t}return n}function Oce(e,t){switch(t.type){case"SET_VALUES":return Fs({},e,{values:t.payload});case"SET_TOUCHED":return Fs({},e,{touched:t.payload});case"SET_ERRORS":return WA(e.errors,t.payload)?e:Fs({},e,{errors:t.payload});case"SET_STATUS":return Fs({},e,{status:t.payload});case"SET_ISSUBMITTING":return Fs({},e,{isSubmitting:t.payload});case"SET_ISVALIDATING":return Fs({},e,{isValidating:t.payload});case"SET_FIELD_VALUE":return Fs({},e,{values:xd(e.values,t.payload.field,t.payload.value)});case"SET_FIELD_TOUCHED":return Fs({},e,{touched:xd(e.touched,t.payload.field,t.payload.value)});case"SET_FIELD_ERROR":return Fs({},e,{errors:xd(e.errors,t.payload.field,t.payload.value)});case"RESET_FORM":return Fs({},e,t.payload);case"SET_FORMIK_STATE":return t.payload(e);case"SUBMIT_ATTEMPT":return Fs({},e,{touched:zU(e.values,!0),isSubmitting:!0,submitCount:e.submitCount+1});case"SUBMIT_FAILURE":return Fs({},e,{isSubmitting:!1});case"SUBMIT_SUCCESS":return Fs({},e,{isSubmitting:!1});default:return e}}var $A={},Qx={};function up(e){var t=e.validateOnChange,r=t===void 0?!0:t,n=e.validateOnBlur,s=n===void 0?!0:n,i=e.validateOnMount,o=i===void 0?!1:i,l=e.isInitialValid,c=e.enableReinitialize,A=c===void 0?!1:c,d=e.onSubmit,u=KU(e,["validateOnChange","validateOnBlur","validateOnMount","isInitialValid","enableReinitialize","onSubmit"]),f=Fs({validateOnChange:r,validateOnBlur:s,validateOnMount:o,onSubmit:d},u),h=C.useRef(f.initialValues),x=C.useRef(f.initialErrors||$A),m=C.useRef(f.initialTouched||Qx),g=C.useRef(f.initialStatus),p=C.useRef(!1),v=C.useRef({});C.useEffect(function(){return p.current=!0,function(){p.current=!1}},[]);var w=C.useState(0),B=w[1],T=C.useRef({values:Rx(f.initialValues),errors:Rx(f.initialErrors)||$A,touched:Rx(f.initialTouched)||Qx,status:Rx(f.initialStatus),isSubmitting:!1,isValidating:!1,submitCount:0}),_=T.current,j=C.useCallback(function(ue){var Fe=T.current;T.current=Oce(Fe,ue),Fe!==T.current&&B(function(ke){return ke+1})},[]),E=C.useCallback(function(ue,Fe){return new Promise(function(ke,Te){var Ne=f.validate(ue,Fe);Ne==null?ke($A):Uw(Ne)?Ne.then(function(et){ke(et||$A)},function(et){Te(et)}):ke(Ne)})},[f.validate]),L=C.useCallback(function(ue,Fe){var ke=f.validationSchema,Te=To(ke)?ke(Fe):ke,Ne=Fe&&Te.validateAt?Te.validateAt(Fe,ue):Qce(ue,Te);return new Promise(function(et,Se){Ne.then(function(){et($A)},function(Ce){Ce.name==="ValidationError"?et(Rce(Ce)):Se(Ce)})})},[f.validationSchema]),M=C.useCallback(function(ue,Fe){return new Promise(function(ke){return ke(v.current[ue].validate(Fe))})},[]),F=C.useCallback(function(ue){var Fe=Object.keys(v.current).filter(function(Te){return To(v.current[Te].validate)}),ke=Fe.length>0?Fe.map(function(Te){return M(Te,hi(ue,Te))}):[Promise.resolve("DO_NOT_DELETE_YOU_WILL_BE_FIRED")];return Promise.all(ke).then(function(Te){return Te.reduce(function(Ne,et,Se){return et==="DO_NOT_DELETE_YOU_WILL_BE_FIRED"||et&&(Ne=xd(Ne,Fe[Se],et)),Ne},{})})},[M]),D=C.useCallback(function(ue){return Promise.all([F(ue),f.validationSchema?L(ue):{},f.validate?E(ue):{}]).then(function(Fe){var ke=Fe[0],Te=Fe[1],Ne=Fe[2],et=VN.all([ke,Te,Ne],{arrayMerge:Mce});return et})},[f.validate,f.validationSchema,F,E,L]),G=zi(function(ue){return ue===void 0&&(ue=_.values),j({type:"SET_ISVALIDATING",payload:!0}),D(ue).then(function(Fe){return p.current&&(j({type:"SET_ISVALIDATING",payload:!1}),j({type:"SET_ERRORS",payload:Fe})),Fe})});C.useEffect(function(){o&&p.current===!0&&WA(h.current,f.initialValues)&&G(h.current)},[o,G]);var K=C.useCallback(function(ue){var Fe=ue&&ue.values?ue.values:h.current,ke=ue&&ue.errors?ue.errors:x.current?x.current:f.initialErrors||{},Te=ue&&ue.touched?ue.touched:m.current?m.current:f.initialTouched||{},Ne=ue&&ue.status?ue.status:g.current?g.current:f.initialStatus;h.current=Fe,x.current=ke,m.current=Te,g.current=Ne;var et=function(){j({type:"RESET_FORM",payload:{isSubmitting:!!ue&&!!ue.isSubmitting,errors:ke,touched:Te,status:Ne,values:Fe,isValidating:!!ue&&!!ue.isValidating,submitCount:ue&&ue.submitCount&&typeof ue.submitCount=="number"?ue.submitCount:0}})};if(f.onReset){var Se=f.onReset(_.values,J);Uw(Se)?Se.then(et):et()}else et()},[f.initialErrors,f.initialStatus,f.initialTouched,f.onReset]);C.useEffect(function(){p.current===!0&&!WA(h.current,f.initialValues)&&A&&(h.current=f.initialValues,K(),o&&G(h.current))},[A,f.initialValues,K,o,G]),C.useEffect(function(){A&&p.current===!0&&!WA(x.current,f.initialErrors)&&(x.current=f.initialErrors||$A,j({type:"SET_ERRORS",payload:f.initialErrors||$A}))},[A,f.initialErrors]),C.useEffect(function(){A&&p.current===!0&&!WA(m.current,f.initialTouched)&&(m.current=f.initialTouched||Qx,j({type:"SET_TOUCHED",payload:f.initialTouched||Qx}))},[A,f.initialTouched]),C.useEffect(function(){A&&p.current===!0&&!WA(g.current,f.initialStatus)&&(g.current=f.initialStatus,j({type:"SET_STATUS",payload:f.initialStatus}))},[A,f.initialStatus,f.initialTouched]);var ae=zi(function(ue){if(v.current[ue]&&To(v.current[ue].validate)){var Fe=hi(_.values,ue),ke=v.current[ue].validate(Fe);return Uw(ke)?(j({type:"SET_ISVALIDATING",payload:!0}),ke.then(function(Te){return Te}).then(function(Te){j({type:"SET_FIELD_ERROR",payload:{field:ue,value:Te}}),j({type:"SET_ISVALIDATING",payload:!1})})):(j({type:"SET_FIELD_ERROR",payload:{field:ue,value:ke}}),Promise.resolve(ke))}else if(f.validationSchema)return j({type:"SET_ISVALIDATING",payload:!0}),L(_.values,ue).then(function(Te){return Te}).then(function(Te){j({type:"SET_FIELD_ERROR",payload:{field:ue,value:hi(Te,ue)}}),j({type:"SET_ISVALIDATING",payload:!1})});return Promise.resolve()}),Z=C.useCallback(function(ue,Fe){var ke=Fe.validate;v.current[ue]={validate:ke}},[]),oe=C.useCallback(function(ue){delete v.current[ue]},[]),Y=zi(function(ue,Fe){j({type:"SET_TOUCHED",payload:ue});var ke=Fe===void 0?s:Fe;return ke?G(_.values):Promise.resolve()}),R=C.useCallback(function(ue){j({type:"SET_ERRORS",payload:ue})},[]),z=zi(function(ue,Fe){var ke=To(ue)?ue(_.values):ue;j({type:"SET_VALUES",payload:ke});var Te=Fe===void 0?r:Fe;return Te?G(ke):Promise.resolve()}),ee=C.useCallback(function(ue,Fe){j({type:"SET_FIELD_ERROR",payload:{field:ue,value:Fe}})},[]),b=zi(function(ue,Fe,ke){j({type:"SET_FIELD_VALUE",payload:{field:ue,value:Fe}});var Te=ke===void 0?r:ke;return Te?G(xd(_.values,ue,Fe)):Promise.resolve()}),O=C.useCallback(function(ue,Fe){var ke=Fe,Te=ue,Ne;if(!Lw(ue)){ue.persist&&ue.persist();var et=ue.target?ue.target:ue.currentTarget,Se=et.type,Ce=et.name,Be=et.id,Pe=et.value,Bt=et.checked,tt=et.outerHTML,Ot=et.options,vt=et.multiple;ke=Fe||Ce||Be,Te=/number|range/.test(Se)?(Ne=parseFloat(Pe),isNaN(Ne)?"":Ne):/checkbox/.test(Se)?Vce(hi(_.values,ke),Bt,Pe):Ot&&vt?Hce(Ot):Pe}ke&&b(ke,Te)},[b,_.values]),S=zi(function(ue){if(Lw(ue))return function(Fe){return O(Fe,ue)};O(ue)}),I=zi(function(ue,Fe,ke){Fe===void 0&&(Fe=!0),j({type:"SET_FIELD_TOUCHED",payload:{field:ue,value:Fe}});var Te=ke===void 0?s:ke;return Te?G(_.values):Promise.resolve()}),U=C.useCallback(function(ue,Fe){ue.persist&&ue.persist();var ke=ue.target,Te=ke.name,Ne=ke.id,et=ke.outerHTML,Se=Fe||Te||Ne;I(Se,!0)},[I]),Q=zi(function(ue){if(Lw(ue))return function(Fe){return U(Fe,ue)};U(ue)}),H=C.useCallback(function(ue){To(ue)?j({type:"SET_FORMIK_STATE",payload:ue}):j({type:"SET_FORMIK_STATE",payload:function(){return ue}})},[]),X=C.useCallback(function(ue){j({type:"SET_STATUS",payload:ue})},[]),V=C.useCallback(function(ue){j({type:"SET_ISSUBMITTING",payload:ue})},[]),Ae=zi(function(){return j({type:"SUBMIT_ATTEMPT"}),G().then(function(ue){var Fe=ue instanceof Error,ke=!Fe&&Object.keys(ue).length===0;if(ke){var Te;try{if(Te=ve(),Te===void 0)return}catch(Ne){throw Ne}return Promise.resolve(Te).then(function(Ne){return p.current&&j({type:"SUBMIT_SUCCESS"}),Ne}).catch(function(Ne){if(p.current)throw j({type:"SUBMIT_FAILURE"}),Ne})}else if(p.current&&(j({type:"SUBMIT_FAILURE"}),Fe))throw ue})}),W=zi(function(ue){ue&&ue.preventDefault&&To(ue.preventDefault)&&ue.preventDefault(),ue&&ue.stopPropagation&&To(ue.stopPropagation)&&ue.stopPropagation(),Ae().catch(function(Fe){console.warn("Warning: An unhandled error was caught from submitForm()",Fe)})}),J={resetForm:K,validateForm:G,validateField:ae,setErrors:R,setFieldError:ee,setFieldTouched:I,setFieldValue:b,setStatus:X,setSubmitting:V,setTouched:Y,setValues:z,setFormikState:H,submitForm:Ae},ve=zi(function(){return d(_.values,J)}),de=zi(function(ue){ue&&ue.preventDefault&&To(ue.preventDefault)&&ue.preventDefault(),ue&&ue.stopPropagation&&To(ue.stopPropagation)&&ue.stopPropagation(),K()}),te=C.useCallback(function(ue){return{value:hi(_.values,ue),error:hi(_.errors,ue),touched:!!hi(_.touched,ue),initialValue:hi(h.current,ue),initialTouched:!!hi(m.current,ue),initialError:hi(x.current,ue)}},[_.errors,_.touched,_.values]),je=C.useCallback(function(ue){return{setValue:function(ke,Te){return b(ue,ke,Te)},setTouched:function(ke,Te){return I(ue,ke,Te)},setError:function(ke){return ee(ue,ke)}}},[b,I,ee]),qe=C.useCallback(function(ue){var Fe=_v(ue),ke=Fe?ue.name:ue,Te=hi(_.values,ke),Ne={name:ke,value:Te,onChange:S,onBlur:Q};if(Fe){var et=ue.type,Se=ue.value,Ce=ue.as,Be=ue.multiple;et==="checkbox"?Se===void 0?Ne.checked=!!Te:(Ne.checked=!!(Array.isArray(Te)&&~Te.indexOf(Se)),Ne.value=Se):et==="radio"?(Ne.checked=Te===Se,Ne.value=Se):Ce==="select"&&Be&&(Ne.value=Ne.value||[],Ne.multiple=!0)}return Ne},[Q,S,_.values]),He=C.useMemo(function(){return!WA(h.current,_.values)},[h.current,_.values]),Ze=C.useMemo(function(){return typeof l<"u"?He?_.errors&&Object.keys(_.errors).length===0:l!==!1&&To(l)?l(f):l:_.errors&&Object.keys(_.errors).length===0},[l,He,_.errors,f]),xe=Fs({},_,{initialValues:h.current,initialErrors:x.current,initialTouched:m.current,initialStatus:g.current,handleBlur:Q,handleChange:S,handleReset:de,handleSubmit:W,resetForm:K,setErrors:R,setFormikState:H,setFieldTouched:I,setFieldValue:b,setFieldError:ee,setStatus:X,setSubmitting:V,setTouched:Y,setValues:z,submitForm:Ae,validateForm:G,validateField:ae,isValid:Ze,dirty:He,unregisterField:oe,registerField:Z,getFieldProps:qe,getFieldMeta:te,getFieldHelpers:je,validateOnBlur:s,validateOnChange:r,validateOnMount:o});return xe}function Rce(e){var t={};if(e.inner){if(e.inner.length===0)return xd(t,e.path,e.message);for(var s=e.inner,r=Array.isArray(s),n=0,s=r?s:s[Symbol.iterator]();;){var i;if(r){if(n>=s.length)break;i=s[n++]}else{if(n=s.next(),n.done)break;i=n.value}var o=i;hi(t,o.path)||(t=xd(t,o.path,o.message))}}return t}function Qce(e,t,r,n){r===void 0&&(r=!1);var s=WN(e);return t[r?"validateSync":"validate"](s,{abortEarly:!1,context:s})}function WN(e){var t=Array.isArray(e)?[]:{};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=String(r);Array.isArray(e[n])===!0?t[n]=e[n].map(function(s){return Array.isArray(s)===!0||EF(s)?WN(s):s!==""?s:void 0}):EF(e[n])?t[n]=WN(e[n]):t[n]=e[n]!==""?e[n]:void 0}return t}function Mce(e,t,r){var n=e.slice();return t.forEach(function(i,o){if(typeof n[o]>"u"){var l=r.clone!==!1,c=l&&r.isMergeableObject(i);n[o]=c?VN(Array.isArray(i)?[]:{},i,r):i}else r.isMergeableObject(i)?n[o]=VN(e[o],i,r):e.indexOf(i)===-1&&n.push(i)}),n}function Hce(e){return Array.from(e).filter(function(t){return t.selected}).map(function(t){return t.value})}function Vce(e,t,r){if(typeof e=="boolean")return!!t;var n=[],s=!1,i=-1;if(Array.isArray(e))n=e,i=e.indexOf(r),s=i>=0;else if(!r||r=="true"||r=="false")return!!t;return t&&r&&!s?n.concat(r):s?n.slice(0,i).concat(n.slice(i+1)):n}var $ce=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?C.useLayoutEffect:C.useEffect;function zi(e){var t=C.useRef(e);return $ce(function(){t.current=e}),C.useCallback(function(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return t.current.apply(void 0,n)},[])}var qce=C.forwardRef(function(e,t){var r=e.action,n=KU(e,["action"]),s=r??"#",i=Dce(),o=i.handleReset,l=i.handleSubmit;return C.createElement("form",Fs({onSubmit:l,ref:t,onReset:o,action:s},n))});qce.displayName="Form";const JA=async(e,t)=>{try{console.log("files",e);const r=new FormData;r.append("files",e),r.append("fileType",t);const n=await Fn.post("https://porequests-sandbox.corp.capillarytech.com/upload-s3/upload-vendor-details",r,{headers:{"Content-Type":"multipart/form-data"}}),{fileUrls:s}=n.data;return console.log("response",n),console.log("Uploaded file URLs:",s),n}catch(r){throw console.error("Error uploading files:",r),new Error("Failed to upload files")}},Kce=ri({vendorId:St().required("Vendor ID is required"),entity:St().required("Entity is required"),category:St().required("Category is required"),vendorName:St().required("Company Name is required"),email:St().email("Invalid email format").required("Email is required"),phone:St().required("Phone Number is required"),billingAddress:St().required("Address is required"),taxNumber:St().required("PAN/Tax Registration/W9 is required"),gstin:St().required("GST is required"),msme:St().required("MSME is required"),bankAccountNumber:St().required("Bank Account Number is required"),ifscSwiftCode:St().required("IFSC/SWIFT CODE is required"),bankName:St().required("Bank Name is required"),natureOfService:St().required("Nature of Service is required")}),zce=()=>{const e=Sr(),t=localStorage.getItem("capEmpId"),r=localStorage.getItem("userId"),[n,s]=C.useState([]),[i,o]=C.useState(!0),l=up({initialValues:{vendorId:"",entity:"",category:"",vendorName:"",email:"",phone:"",billingAddress:"",shippingAddress:"",taxNumber:"",gstin:"",msme:"",bankAccountNumber:"",ifscSwiftCode:"",bankName:"",hasAgreement:"yes",natureOfService:"",primarySubsidiary:"",empId:t},validationSchema:Kce,onSubmit:async c=>{var A,d;try{const u={vendorId:c.vendorId,entity:c.entity,category:c.category,vendorName:c.vendorName,email:c.email,phone:c.phone,billingAddress:c.billingAddress,shippingAddress:c.shippingAddress,taxNumber:c.taxNumber,gstin:c.gstin,msme:c.msme,bankAccountNumber:c.bankAccountNumber,ifscSwiftCode:c.ifscSwiftCode,bankName:c.bankName,natureOfService:c.natureOfService,primarySubsidiary:c.primarySubsidiary,empId:c.empId,hasAgreement:c.hasAgreement};console.log("Submitting vendor data:",u);const f=await CI(u);f.status===201&&(Ie.success(f.data.message||"Vendor registered successfully!"),setTimeout(()=>{e("/vendor-list-table")},1500))}catch(u){console.error("Registration failed:",u),Ie.error(((d=(A=u.response)==null?void 0:A.data)==null?void 0:d.message)||"Registration failed. Please try again.")}finally{}}});return C.useEffect(()=>{const c=d=>d?d.toLowerCase().split(" ").map(u=>u.charAt(0).toUpperCase()+u.slice(1)).join(" "):"";(async()=>{try{const u=((await Zf(r)).data.entities||[]).map(f=>({...f,displayName:c(f.entityName),originalName:f.entityName})).sort((f,h)=>f.displayName.localeCompare(h.displayName));s(u),o(!1)}catch(d){console.error("Failed to fetch entities:",d),o(!1)}})()},[r]),a.jsxs("form",{onSubmit:l.handleSubmit,className:"max-w-6xl bg-white mx-auto p-6 space-y-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Vendor Registration"}),a.jsx("div",{className:"p-4 border rounded-lg border-primary",children:a.jsxs("div",{className:"mb-4",children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Vendor ID ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"vendorId",value:l.values.vendorId,onChange:l.handleChange,onBlur:l.handleBlur,className:`mt-1 block w-full px-3 py-2 border ${l.touched.vendorId&&l.errors.vendorId?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm`,placeholder:"Enter Vendor ID"}),l.touched.vendorId&&l.errors.vendorId&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.errors.vendorId})]})}),a.jsxs("div",{className:"p-4 border rounded-lg border-primary",children:[a.jsx("h3",{className:"text-lg font-semibold text-primary mb-4",children:"Basic Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"entity",className:"block mb-2 font-medium",children:["Entity ",a.jsx("span",{className:"text-red-500",children:"*"})]}),i?a.jsx("select",{className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary text-gray-500",disabled:!0,children:a.jsx("option",{children:"Loading entities..."})}):a.jsxs("select",{name:"entity",value:l.values.entity,onChange:l.handleChange,onBlur:l.handleBlur,className:`w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary ${l.touched.entity&&l.errors.entity?"border-red-500":"border-gray-300"}`,children:[a.jsx("option",{value:"",children:"Select an entity"}),n.map(c=>a.jsx("option",{value:c.originalName,children:c.displayName},c._id||c.entityId))]}),l.touched.entity&&l.errors.entity&&a.jsx("span",{className:"text-red-500 text-sm",children:l.errors.entity})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"category",className:"block mb-2 font-medium",children:["Category ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"category",placeholder:"Enter Category",value:l.values.category,onChange:l.handleChange,onBlur:l.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),l.touched.category&&l.errors.category&&a.jsx("span",{className:"text-red-500 text-sm",children:l.errors.category})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"vendorName",className:"block mb-2 font-medium",children:["Company Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"vendorName",placeholder:"Enter Company Name",value:l.values.vendorName,onChange:l.handleChange,onBlur:l.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),l.touched.vendorName&&l.errors.vendorName&&a.jsx("span",{className:"text-red-500 text-sm",children:l.errors.vendorName})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"email",className:"block mb-2 font-medium",children:["Email-ID ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"email",name:"email",placeholder:"Enter Email",value:l.values.email,onChange:l.handleChange,onBlur:l.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),l.touched.email&&l.errors.email&&a.jsx("span",{className:"text-red-500 text-sm",children:l.errors.email})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"phone",className:"block mb-2 font-medium",children:["Phone Number ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"tel",name:"phone",placeholder:"Enter Phone Number",value:l.values.phone,onChange:l.handleChange,onBlur:l.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),l.touched.phone&&l.errors.phone&&a.jsx("span",{className:"text-red-500 text-sm",children:l.errors.phone})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"natureOfService",className:"block mb-2 font-medium",children:["Nature of Service ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"natureOfService",placeholder:"Enter Nature of Service",value:l.values.natureOfService,onChange:l.handleChange,onBlur:l.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),l.touched.natureOfService&&l.errors.natureOfService&&a.jsx("span",{className:"text-red-500 text-sm",children:l.errors.natureOfService})]})]})]}),a.jsxs("div",{className:"p-4 border rounded-lg border-primary",children:[a.jsx("h3",{className:"text-lg font-semibold text-primary mb-4",children:"Address Details"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"billingAddress",className:"block mb-2 font-medium",children:["Address ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{name:"billingAddress",placeholder:"Enter Address",value:l.values.billingAddress,onChange:l.handleChange,onBlur:l.handleBlur,rows:"3",className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),l.touched.billingAddress&&l.errors.billingAddress&&a.jsx("span",{className:"text-red-500 text-sm",children:l.errors.billingAddress})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"shippingAddress",className:"block mb-2 font-medium",children:"Shipping Address"}),a.jsx("textarea",{name:"shippingAddress",placeholder:"Enter Shipping Address",value:l.values.shippingAddress,onChange:l.handleChange,rows:"3",className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})]})]})]}),a.jsxs("div",{className:"p-4 border rounded-lg border-primary",children:[a.jsx("h3",{className:"text-lg font-semibold text-primary mb-4",children:"Tax & Registration Details"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"taxNumber",className:"block mb-2 font-medium",children:["PAN/Tax Registration/W9 ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"taxNumber",placeholder:"Enter PAN/Tax Registration/W9",value:l.values.taxNumber,onChange:l.handleChange,onBlur:l.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),l.touched.taxNumber&&l.errors.taxNumber&&a.jsx("span",{className:"text-red-500 text-sm",children:l.errors.taxNumber})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"gstin",className:"block mb-2 font-medium",children:["GST ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"gstin",placeholder:"Enter GST Number",value:l.values.gstin,onChange:l.handleChange,onBlur:l.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),l.touched.gstin&&l.errors.gstin&&a.jsx("span",{className:"text-red-500 text-sm",children:l.errors.gstin})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"msme",className:"block mb-2 font-medium",children:["MSME ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"msme",placeholder:"Enter MSME Number",value:l.values.msme,onChange:l.handleChange,onBlur:l.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),l.touched.msme&&l.errors.msme&&a.jsx("span",{className:"text-red-500 text-sm",children:l.errors.msme})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"primarySubsidiary",className:"block mb-2 font-medium",children:"Primary Subsidiary"}),a.jsx("input",{type:"text",name:"primarySubsidiary",placeholder:"Enter Primary Subsidiary",value:l.values.primarySubsidiary,onChange:l.handleChange,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})]})]})]}),a.jsxs("div",{className:"p-4 border rounded-lg border-primary",children:[a.jsx("h3",{className:"text-lg font-semibold text-primary mb-4",children:"Bank Details"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"bankAccountNumber",className:"block mb-2 font-medium",children:["Bank Account Number ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"bankAccountNumber",placeholder:"Enter Bank Account Number",value:l.values.bankAccountNumber,onChange:l.handleChange,onBlur:l.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),l.touched.bankAccountNumber&&l.errors.bankAccountNumber&&a.jsx("span",{className:"text-red-500 text-sm",children:l.errors.bankAccountNumber})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"ifscSwiftCode",className:"block mb-2 font-medium",children:["IFSC/SWIFT CODE ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"ifscSwiftCode",placeholder:"Enter IFSC/SWIFT CODE",value:l.values.ifscSwiftCode,onChange:l.handleChange,onBlur:l.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),l.touched.ifscSwiftCode&&l.errors.ifscSwiftCode&&a.jsx("span",{className:"text-red-500 text-sm",children:l.errors.ifscSwiftCode})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"bankName",className:"block mb-2 font-medium",children:["Bank Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"bankName",placeholder:"Enter Bank Name",value:l.values.bankName,onChange:l.handleChange,onBlur:l.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),l.touched.bankName&&l.errors.bankName&&a.jsx("span",{className:"text-red-500 text-sm",children:l.errors.bankName})]})]})]}),a.jsx("div",{className:"p-4 text-end",children:a.jsx("button",{type:"submit",className:"px-6 py-2 bg-primary text-white rounded hover:bg-primary-dark disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",disabled:l.isSubmitting||!l.isValid,children:l.isSubmitting?"Registering...":"Register Vendor"})}),a.jsx(In,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,pauseOnFocusLoss:!0})]})},cj=({currentPage:e,totalPages:t,handlePageChange:r,itemsPerPage:n,totalItems:s})=>{const i=()=>{const h=[],x=[];let m;for(let g=1;g<=t;g++)(g===1||g===t||g>=e-2&&g<=e+2)&&h.push(g);return h.forEach(g=>{m&&(g-m===2?x.push(m+1):g-m!==1&&x.push("...")),x.push(g),m=g}),x},o=(e-1)*n,l=Math.min(o+n,s),c="flex items-center justify-center px-3 py-2 text-sm font-medium transition-colors duration-200",A="bg-primary text-white hover:bg-primary/90",d="text-gray-500 hover:bg-gray-100",u="text-gray-300 cursor-not-allowed hover:bg-transparent";return a.jsxs("div",{className:"flex items-center justify-between px-6 py-4 bg-gray-50 border-t border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[a.jsx("span",{children:"Showing"}),a.jsx("span",{className:"font-medium",children:o+1}),a.jsx("span",{children:"to"}),a.jsx("span",{className:"font-medium",children:l}),a.jsx("span",{children:"of"}),a.jsx("span",{className:"font-medium",children:s}),a.jsx("span",{children:"entries"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>r(1),disabled:e===1,className:`${c} rounded-l-lg ${e===1?u:d}`,children:a.jsx(Gm,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>r(e-1),disabled:e===1,className:`${c} ${e===1?u:d}`,children:a.jsx(zm,{className:"h-4 w-4"})}),a.jsx("div",{className:"flex items-center",children:i().map((f,h)=>a.jsx("button",{onClick:()=>typeof f=="number"&&r(f),className:`${c} ${f===e?A:typeof f=="number"?d:u}`,disabled:typeof f!="number",children:f},h))}),a.jsx("button",{onClick:()=>r(e+1),disabled:e===t,className:`${c} ${e===t?u:d}`,children:a.jsx(Wf,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>r(t),disabled:e===t,className:`${c} rounded-r-lg ${e===t?u:d}`,children:a.jsx(Wm,{className:"h-4 w-4"})})]})]})},Gce=()=>{const e=localStorage.getItem("capEmpId"),t=localStorage.getItem("role"),r=Sr(),[n,s]=C.useState([]),[i,o]=C.useState(null),[l,c]=C.useState(1),[A,d]=C.useState(""),[u,f]=C.useState("all"),[h,x]=C.useState(!1),[m,g]=C.useState([]),[p,v]=C.useState(null),w=C.useRef(null),B=C.useRef(null),T=10,[_,j]=C.useState(!0),[E,L]=C.useState("pending"),[M,F]=C.useState(null),[D,G]=C.useState("");C.useEffect(()=>{(async()=>{j(!0);try{const ve=await tC();console.log("response",ve),s(ve.data.vendors||[]),ve.data.vendorPolicyFiles&&ve.data.vendorPolicyFiles.length>0&&o(ve.data.vendorPolicyFiles[0])}catch(ve){Ie.error("Error fetching vendor data"),console.error("Error in fetching the vendor data",ve)}finally{j(!1)}})()},[]);const K=n==null?void 0:n.filter(J=>{var je,qe;const ve=Object.values(J).some(He=>String(He).toLowerCase().includes(A.toLowerCase())),de=u==="all"?!0:u==="active"?((je=J.Inactive)==null?void 0:je.toLowerCase())==="no":((qe=J.Inactive)==null?void 0:qe.toLowerCase())==="yes",te=E==="all"?!0:E==="pending"?J.isLegalTeamVerified===!0&&J.isVendorTeamVerified===!1:!0;return ve&&de&&te}),ae=Math.ceil(((K==null?void 0:K.length)||0)/T),Z=(l-1)*T,oe=Z+T,Y=K==null?void 0:K.slice(Z,oe),R=J=>{c(J)},z=async J=>{try{const ve=await rC(J);ve.status===200?(s(n==null?void 0:n.filter(de=>(de==null?void 0:de._id)!==J)),Ie.success(ve.data.message)):Ie.error(ve.data.message)}catch{Ie.error("Error deleting vendor")}},ee=async J=>{const ve=n==null?void 0:n.find(de=>de._id===J);F({type:"approve",vendorId:J,vendorName:(ve==null?void 0:ve.vendorName)||(ve==null?void 0:ve.Name)})},b=async J=>{const ve=n==null?void 0:n.find(de=>de._id===J);F({type:"reject",vendorId:J,vendorName:(ve==null?void 0:ve.vendorName)||(ve==null?void 0:ve.Name)})},O=J=>{r(`/vendor-preview/${J}`)},S=async()=>{try{const J=await II(M.vendorId,e);J.status===200?(s(n==null?void 0:n.map(ve=>ve._id===M.vendorId?{...ve,isVendorTeamVerified:!0}:ve)),Ie.success(J.data.message)):Ie.error("Failed to approve vendor")}catch{Ie.error("Error approving vendor")}finally{F(null)}},I=async()=>{if(!D.trim()){Ie.error("Please provide a reason for rejection");return}try{(await LI(M.vendorId,e,D)).status===200?(s(n==null?void 0:n.map(ve=>ve._id===M.vendorId?{...ve,isVendorTeamVerified:!1,isLegalTeamVerified:!1}:ve)),Ie.success("Vendor rejected successfully")):Ie.error("Failed to reject vendor")}catch{Ie.error("Error rejecting vendor")}finally{F(null),G("")}},U=()=>{F(null),G("")},Q=C.useCallback(J=>{G(J.target.value)},[]);C.useEffect(()=>{M&&M.type==="reject"&&B.current&&setTimeout(()=>{B.current.focus()},100)},[M]);const H=()=>{const J=[{ID:"V001",Name:"Sample Vendor Ltd","Primary Subsidiary":"Main Office",Category:"Supplier",Entity:"Private Limited","Tax Number":"ABCDE1234F",GSTIN:"22ABCDE1234F1Z5","Billing Address":"123 Main Street, City, State - 123456","Shipping Address":"456 Warehouse Road, City, State - 123456",Phone:"9876543210",Email:"vendor@example.com",Status:"Active","Bank Account Number":"1234567890","IFSC/SWIFT Code":"ABCD0123456","Bank Name":"Sample Bank","Has Agreement":"yes","Agreement File":"(File upload handled separately after vendor creation)","Questionnaire Answer":"(Fill only if Has Agreement = no)","Nature of Service":"Product Supply",MSME:"MSME123456"},{ID:"V002",Name:"Example Services Inc","Primary Subsidiary":"Branch Office",Category:"Service Provider",Entity:"Corporation","Tax Number":"FGHIJ5678K",GSTIN:"27FGHIJ5678K1Z8","Billing Address":"789 Business Park, City, State - 654321","Shipping Address":"789 Business Park, City, State - 654321",Phone:"9123456789",Email:"contact@exampleservices.com",Status:"Active","Bank Account Number":"9876543210","IFSC/SWIFT Code":"EFGH0987654","Bank Name":"Example Bank","Has Agreement":"no","Agreement File":"","Questionnaire Answer":"We provide consulting services and have been in business for 5 years","Nature of Service":"Consulting",MSME:"MSME789012"}],ve=as.book_new(),de=as.json_to_sheet(J),te=[{wch:10},{wch:25},{wch:20},{wch:15},{wch:15},{wch:15},{wch:18},{wch:40},{wch:40},{wch:15},{wch:25},{wch:12},{wch:20},{wch:18},{wch:20},{wch:15},{wch:45},{wch:45},{wch:20},{wch:15}];de["!cols"]=te,as.book_append_sheet(ve,de,"Vendor Template"),s0(ve,"Vendor_Upload_Template.xlsx"),Ie.success("Sample template downloaded successfully!")},X=async J=>{const ve=J.target.files[0];if(ve){const de=new FileReader;de.onload=async te=>{try{const je=Fm(te.target.result,{type:"array"}),qe=je.SheetNames[0],He=je.Sheets[qe],Ze=as.sheet_to_json(He);console.log("Imported data:",Ze),g(Ze),Ie.info('File imported. Click "Upload File" to proceed.'),w.current&&(w.current.value="")}catch(je){console.error("Complete Import Error:",je),Ie.error(`Error importing file: ${je.message}`)}},de.readAsArrayBuffer(ve)}},V=async()=>{try{if(m.length===0){Ie.error("No vendors to upload. Please import a file first.");return}const J=t==="Vendor Management",ve=m.map(te=>{const je={...te};return J&&(je.status="Active"),(!je.hasAgreement||je.hasAgreement.trim()==="")&&(je.hasAgreement="yes"),je}),de=await nC(ve,e);if(de.status===201){Ie.success("Vendors uploaded successfully");const te=await eC();s(te.data.data||[]),g([]),x(!1)}else Ie.error(de.data.message||"Failed to upload vendors")}catch(J){console.error("Upload Error:",J),Ie.error("Error uploading vendors")}},Ae=(J,ve)=>{ve.stopPropagation(),v(p===J?null:J)},W=()=>h?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg p-4 sm:p-6 w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Import Vendors"}),a.jsx("button",{onClick:()=>x(!1),className:"text-gray-500 hover:text-gray-700","aria-label":"Close modal",children:a.jsx(_r,{className:"h-5 w-5"})})]}),a.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsxs("h4",{className:"font-semibold text-blue-900 mb-3 flex items-center",children:[a.jsx(K4,{className:"h-5 w-5 mr-2"}),"Required Excel Format"]}),a.jsxs("div",{className:"text-sm text-blue-800 space-y-2",children:[a.jsx("p",{className:"font-medium",children:"Your Excel file must include these columns:"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 text-xs",children:[a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"ID"})," - Vendor ID"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Name"})," - Company Name"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Entity"})," - Entity Type"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Category"})," - Vendor Category"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Email"})," - Email Address"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Phone"})," - Phone Number"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Billing Address"})," - Address"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Tax Number"})," - PAN/Tax/W9"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"GSTIN"})," - GST Number"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"MSME"})," - MSME Number"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsx("span",{children:a.jsx("strong",{children:"Bank Account Number"})})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsx("span",{children:a.jsx("strong",{children:"IFSC/SWIFT Code"})})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsx("span",{children:a.jsx("strong",{children:"Bank Name"})})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Has Agreement"})," (yes/no)"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsx("span",{children:a.jsx("strong",{children:"Nature of Service"})})]})]}),a.jsx("div",{className:"mt-3 pt-3 border-t border-blue-300",children:a.jsxs("p",{className:"text-xs text-blue-700",children:[a.jsx("strong",{children:"Note:"}),' Agreement files must be uploaded separately after vendor creation. If "Has Agreement" is "no", fill the "Questionnaire Answer" column.']})})]})]}),a.jsx("div",{className:"mb-4",children:a.jsxs("button",{onClick:H,className:"w-full flex items-center justify-center px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium",children:[a.jsx(_n,{className:"h-5 w-5 mr-2"}),"Download Sample Template"]})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:[a.jsx("label",{htmlFor:"file-upload",className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload Your Excel File"}),a.jsx("input",{id:"file-upload",type:"file",ref:w,onChange:X,accept:".xlsx,.xls,.csv",className:"w-full text-sm file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-primary file:text-white hover:file:bg-primary/90"}),a.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Supported formats: .xlsx, .xls, .csv"}),m.length>0&&a.jsx("div",{className:"mt-3 p-2 bg-green-50 border border-green-200 rounded",children:a.jsxs("p",{className:"text-sm text-green-700 font-medium",children:[" ",m.length," vendor",m.length>1?"s":""," ready to upload"]})})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-end space-y-2 sm:space-y-0 sm:space-x-3",children:[a.jsx("button",{onClick:()=>{x(!1),g([])},className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 order-2 sm:order-1",children:"Cancel"}),a.jsx("button",{onClick:V,disabled:m.length===0,className:`w-full sm:w-auto px-4 py-2 text-sm font-medium text-white rounded-lg order-1 sm:order-2 transition-colors
            ${m.length>0?"bg-primary hover:bg-primary/90":"bg-gray-400 cursor-not-allowed"}`,children:"Upload File"})]})]})]})}):null;return a.jsxs("div",{className:"p-4 md:p-8 bg-white rounded-lg shadow-sm h-full",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-xl md:text-2xl font-bold text-gray-900 mb-4 md:mb-6",children:"Vendor Information"}),a.jsxs("div",{className:"flex space-x-1 mb-6 border-b border-gray-200",children:[a.jsx("button",{className:`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors ${E==="pending"?"bg-primary text-white border-b-2 border-primary":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,onClick:()=>L("pending"),children:"Pending Approvals"}),a.jsx("button",{className:`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors ${E==="all"?"bg-primary text-white border-b-2 border-primary":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,onClick:()=>L("all"),children:"All Vendors"})]}),a.jsxs("div",{className:"md:hidden space-y-3",children:[a.jsxs("button",{className:"w-full inline-flex items-center justify-center px-4 py-2.5 bg-primary text-white rounded-lg text-sm font-medium hover:bg-primary/90",onClick:()=>r("/vendor-list-table/vendor-registration"),children:[a.jsx(yn,{className:"h-4 w-4 mr-2"}),"Add Vendor"]}),a.jsxs("div",{className:"relative w-full",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none",children:a.jsx(rn,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{type:"text",placeholder:"Search vendors...",value:A,onChange:J=>{d(J.target.value),c(1)},className:"w-full pl-11 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("select",{value:u,onChange:J=>{f(J.target.value),c(1)},className:"px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"active",children:"Active"}),a.jsx("option",{value:"inactive",children:"Inactive"})]}),a.jsxs("button",{onClick:()=>x(!0),className:"inline-flex items-center justify-center px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[a.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Import"]})]})]}),a.jsx("div",{className:"hidden md:block",children:a.jsxs("div",{className:"flex flex-wrap md:flex-nowrap gap-3 mb-4",children:[a.jsxs("div",{className:"relative flex-grow",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none",children:a.jsx(rn,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{type:"text",placeholder:"Search vendors...",value:A,onChange:J=>{d(J.target.value),c(1)},className:"w-full pl-11 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),a.jsxs("select",{value:u,onChange:J=>{f(J.target.value),c(1)},className:"px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"active",children:"Active"}),a.jsx("option",{value:"inactive",children:"Inactive"})]}),a.jsxs("button",{onClick:()=>x(!0),className:"inline-flex items-center justify-center px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[a.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Import"]}),a.jsxs("button",{className:"inline-flex items-center justify-center px-4 py-2.5 bg-primary text-white rounded-lg text-sm font-medium hover:bg-primary/90",onClick:()=>r("/vendor-list-table/vendor-registration"),children:[a.jsx(yn,{className:"h-4 w-4 mr-2"}),"Add Vendor"]}),i&&a.jsxs("a",{href:i.policyFile,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center px-4 py-2.5 border border-blue-300 rounded-lg text-sm font-medium text-blue-700 bg-blue-50 hover:bg-blue-100",children:[a.jsx(jr,{className:"h-4 w-4 mr-2"}),"View Vendor Policy"]})]})})]}),_?a.jsx("div",{className:"flex justify-center items-center py-10",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary"})}):(K==null?void 0:K.length)===0?a.jsxs("div",{className:"text-center py-10 text-gray-500",children:[a.jsx("p",{className:"text-lg font-medium",children:"No vendors found"}),a.jsx("p",{className:"text-sm mt-2",children:"Try adjusting your search or filters"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"md:hidden space-y-3 mb-4",children:Y==null?void 0:Y.map((J,ve)=>{var de,te;return a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-white hover:bg-gray-50",children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-xs text-gray-500",children:(J==null?void 0:J.vendorId)||J.ID}),a.jsx("h3",{className:"font-semibold text-gray-900",children:(J==null?void 0:J.vendorName)||J.Name})]}),a.jsxs("div",{className:"flex space-x-2",children:[t==="Legal Team"?a.jsx("button",{className:"text-primary hover:text-primary/80",onClick:je=>{je.stopPropagation(),O(J._id)},title:"View More",children:a.jsx(Po,{className:"h-4 w-4"})}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"text-primary hover:text-primary/80",onClick:je=>{je.stopPropagation(),r(`/vendor-list-table/edit-vendor/${J._id}`)},children:a.jsx(Us,{className:"h-4 w-4"})}),a.jsx("button",{className:"text-red-600 hover:text-red-800",onClick:je=>{je.stopPropagation(),z(J==null?void 0:J._id)},children:a.jsx($r,{className:"h-4 w-4"})})]}),t==="Vendor Management"&&J.isLegalTeamVerified===!0&&((de=J.Inactive)==null?void 0:de.toLowerCase())==="no"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"px-3 py-1 text-xs font-medium text-white bg-green-600 hover:bg-green-700 rounded",onClick:je=>{je.stopPropagation(),ee(J._id)},title:"Approve Vendor",children:"Approve"}),a.jsx("button",{className:"px-3 py-1 text-xs font-medium text-white bg-red-600 hover:bg-red-700 rounded",onClick:je=>{je.stopPropagation(),b(J._id)},title:"Reject Vendor",children:"Reject"})]}),a.jsx("button",{className:"text-gray-500 hover:text-gray-700",onClick:je=>Ae(J._id,je),"aria-expanded":p===J._id,children:p===J._id?a.jsx(bl,{className:"h-4 w-4"}):a.jsx(vo,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{className:"text-xs text-gray-900 mb-1",children:["Tax ID: ",(J==null?void 0:J.taxNumber)||J["Tax Number"]]}),a.jsxs("div",{className:"text-xs text-gray-500 mb-1",children:["Phone: ",J==null?void 0:J.phone]}),p===J._id&&a.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 text-xs text-gray-500",children:[a.jsxs("div",{className:"mb-1",children:[a.jsx("span",{className:"font-medium",children:"Address:"})," ",(J==null?void 0:J.shippingAddress)||J["Shipping Address"]]}),a.jsxs("div",{className:"mb-1",children:[a.jsx("span",{className:"font-medium",children:"Status:"})," ",((te=J==null?void 0:J.Inactive)==null?void 0:te.toLowerCase())==="no"?"Active":"Inactive"]})]}),a.jsx("button",{className:"w-full mt-3 text-sm text-primary hover:text-primary/80 text-center",onClick:()=>r(`/vendor-list-table/get-vendor/${J._id}`),children:"View Details"})]},J._id)})}),a.jsx("div",{className:"hidden md:block border border-gray-200 rounded-lg overflow-hidden mb-4",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-primary",children:a.jsxs("tr",{children:[a.jsx("th",{className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Sno"}),a.jsx("th",{className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Vendor"}),a.jsx("th",{className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Phone"}),a.jsx("th",{className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Address"}),a.jsx("th",{className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Y==null?void 0:Y.map((J,ve)=>{var de;return a.jsxs("tr",{onClick:()=>r(`/vendor-list-table/get-vendor/${J._id}`),className:"hover:bg-gray-50 cursor-pointer",children:[a.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:Z+ve+1}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"block text-sm text-gray-500",children:(J==null?void 0:J.vendorId)||J.ID}),a.jsx("span",{className:"block font-semibold text-gray-900",children:(J==null?void 0:J.vendorName)||J.Name}),a.jsxs("span",{className:"block text-sm text-gray-900",children:["Tax ID: ",(J==null?void 0:J.taxNumber)||J["Tax Number"]]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:J==null?void 0:J.phone}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs lg:max-w-md break-words whitespace-normal",children:(J==null?void 0:J.shippingAddress)||J["Shipping Address"]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex space-x-2",children:[t==="Legal Team"?a.jsx("button",{className:"text-primary hover:text-primary/80",onClick:te=>{te.stopPropagation(),O(J._id)},title:"View More",children:a.jsx(Po,{className:"h-5 w-5"})}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"text-primary hover:text-primary/80",onClick:te=>{te.stopPropagation(),r(`/vendor-list-table/edit-vendor/${J._id}`)},children:a.jsx(Us,{className:"h-5 w-5"})}),a.jsx("button",{className:"text-red-600 hover:text-red-800",onClick:te=>{te.stopPropagation(),z(J==null?void 0:J._id)},children:a.jsx($r,{className:"h-5 w-5"})})]}),t==="Vendor Management"&&J.isLegalTeamVerified===!0&&((de=J.Inactive)==null?void 0:de.toLowerCase())==="no"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"px-3 py-1 text-xs font-medium text-white bg-green-600 hover:bg-green-700 rounded",onClick:te=>{te.stopPropagation(),ee(J._id)},title:"Approve Vendor",children:"Approve"}),a.jsx("button",{className:"px-3 py-1 text-xs font-medium text-white bg-red-600 hover:bg-red-700 rounded",onClick:te=>{te.stopPropagation(),b(J._id)},title:"Reject Vendor",children:"Reject"})]})]})})]},J._id)})})]})})})]}),a.jsx(cj,{currentPage:l,totalPages:ae,handlePageChange:R,itemsPerPage:T,totalItems:(K==null?void 0:K.length)||0}),a.jsx(W,{}),M&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:M.type==="approve"?"Approve Vendor":"Reject Vendor"}),a.jsx("p",{className:"text-gray-600 mb-6",children:M.type==="approve"?`Are you sure you want to approve ${M.vendorName}?`:`Are you sure you want to reject ${M.vendorName}?`}),M.type==="reject"&&a.jsxs("div",{className:"mb-6",children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Reason for Rejection ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{ref:B,value:D,onChange:Q,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",rows:3,placeholder:"Please provide a reason for rejection..."})]}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{onClick:U,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),a.jsx("button",{onClick:M.type==="approve"?S:I,className:`px-4 py-2 text-sm font-medium text-white rounded-lg ${M.type==="approve"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"}`,children:M.type==="approve"?"Approve":"Reject"})]})]})}),a.jsx(In,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,pauseOnFocusLoss:!0})]})},Dw=[{id:"T-1001",topic:"Login Issue",description:"Unable to access account",status:"open",lastUpdate:"2024-11-15",priority:"high"},{id:"T-1002",topic:"Payment Failed",description:"Transaction error on checkout",status:"in-progress",lastUpdate:"2024-11-14",priority:"medium"},{id:"T-1003",topic:"Feature Request",description:"Dark mode suggestion",status:"resolved",lastUpdate:"2024-11-13",priority:"low"},{id:"T-1004",topic:"Mobile App Crash",description:"App crashes on startup",status:"open",lastUpdate:"2024-11-15",priority:"high"}],Wce={"T-1001":[{sender:"user",message:"I can't log into my account since yesterday",time:"09:00",avatar:Pu},{sender:"agent",message:"I'm sorry to hear that. Can you tell me what error message you're seeing?",time:"09:05",avatar:Pu},{sender:"user",message:"It says 'Invalid credentials' but I'm sure my password is correct",time:"09:07",avatar:Pu}],"T-1002":[{sender:"user",message:"Payment keeps failing on checkout",time:"14:20",avatar:Pu},{sender:"agent",message:"Let me check the transaction logs. Could you provide the order number?",time:"14:25",avatar:Pu}]},Xce=()=>{var w;const[e,t]=C.useState(null),[r,n]=C.useState(""),[s,i]=C.useState(""),[o,l]=C.useState("all"),[c,A]=C.useState(!1),[d,u]=C.useState(!1),[f,h]=C.useState(""),[x,m]=C.useState(""),g=B=>{switch(B){case"open":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"in-progress":return"text-purple-600 bg-purple-50 border-purple-200";case"resolved":return"text-green-600 bg-green-50 border-green-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},p=Dw.filter(B=>{const T=B.id.toLowerCase().includes(s.toLowerCase())||B.topic.toLowerCase().includes(s.toLowerCase())||B.description.toLowerCase().includes(s.toLowerCase());return o==="all"?T:T&&B.status===o}),v=()=>{if(!f.trim()||!x.trim())return;const B={id:`T-${(Dw.length+1).toString().padStart(4,"0")}`,topic:f,description:x,status:"open",lastUpdate:new Date().toLocaleDateString(),priority:"medium"};Dw.push(B),h(""),m(""),A(!1)};return a.jsxs("div",{className:"relative flex h-[600px] bg-gray-50 rounded-xl shadow-xl overflow-hidden",children:[a.jsxs("div",{className:"w-80 bg-white border-r flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-xl font-bold text-primary",children:"Support Tickets"}),a.jsx("div",{className:"flex items-center space-x-2",children:a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>u(!d),className:"p-2 hover:bg-gray-100 rounded-full transition-colors duration-200",children:a.jsx(ti,{size:16,className:"text-gray-600"})}),d&&a.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-1 z-10 border",children:[a.jsx("button",{onClick:()=>{l("open"),u(!1)},className:"w-full px-4 py-2 text-left hover:bg-gray-100",children:"Open"}),a.jsx("button",{onClick:()=>{l("in-progress"),u(!1)},className:"w-full px-4 py-2 text-left hover:bg-gray-100",children:"In-progress"}),a.jsx("button",{onClick:()=>{l("resolved"),u(!1)},className:"w-full px-4 py-2 text-left hover:bg-gray-100",children:"Resolved"})]})]})})]}),a.jsxs("div",{className:"relative",children:[a.jsx(rn,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search tickets...",className:"w-full pl-10 pr-4 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200",value:s,onChange:B=>i(B.target.value)})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto",children:p.map(B=>a.jsxs("div",{onClick:()=>t(B),className:`p-4 border-b cursor-pointer transition-all duration-200 hover:bg-purple-50
                ${(e==null?void 0:e.id)===B.id?"bg-purple-50 border-l-4 border-l-primary":""}`,children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:B.id}),a.jsx("div",{className:"text-sm font-medium text-gray-800",children:B.topic})]}),a.jsx("div",{className:`text-xs px-2 py-1 rounded-full border ${g(B.status)}`,children:B.status})]}),a.jsx("div",{className:"text-sm text-gray-500 line-clamp-2",children:B.description}),a.jsxs("div",{className:"flex items-center mt-2 text-xs text-gray-400",children:[a.jsx(ql,{className:"w-3 h-3 mr-1"}),B.lastUpdate]})]},B.id))})]}),a.jsxs("div",{className:"flex-1 flex flex-col bg-gray-50",children:[a.jsxs("button",{onClick:()=>A(!0),className:"absolute top-4 right-4 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary transition-colors duration-200 flex items-center space-x-2",children:[a.jsx(yn,{size:16,className:"rounded-full bg-white text-primary"}),a.jsx("span",{children:"Raise New Ticket"})]}),e?a.jsxs("div",{className:"flex-1 flex flex-col h-full",children:[a.jsx("div",{className:"p-6 border-b bg-white",children:a.jsx("div",{className:"flex justify-between items-center",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-primary",children:e.topic}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Ticket ID: ",e.id," "]})]})})}),a.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:a.jsx("div",{className:"space-y-4",children:(w=Wce[e.id])==null?void 0:w.map((B,T)=>a.jsx("div",{className:`flex ${B.sender==="user"?"justify-end":"justify-start"}`,children:a.jsxs("div",{className:`flex items-start max-w-md ${B.sender==="user"?"flex-row-reverse":"flex-row"}`,children:[a.jsx("img",{src:B.avatar,alt:B.sender,className:"w-8 h-8 rounded-full"}),a.jsxs("div",{className:`mx-2 p-3 rounded-lg ${B.sender==="user"?"bg-primary text-white":"bg-white text-gray-700"}`,children:[a.jsx("p",{className:"text-sm",children:B.message}),a.jsx("p",{className:"text-xs mt-1 opacity-70",children:B.time})]})]})},T))})}),a.jsx("div",{className:"p-4 bg-white border-t",children:e.status==="resolved"?a.jsx("div",{className:"text-center py-3 bg-gray-50 rounded-lg text-gray-500",children:"This ticket has been resolved and is closed for new messages"}):a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("textarea",{value:r,onChange:B=>n(B.target.value),className:"flex-1 p-3 h-20 border rounded-lg resize-none focus:outline-none focus:ring-2 focus:primary focus:border-transparent",placeholder:"Type your message..."}),a.jsx("button",{onClick:()=>console.log("Message sent:",r),className:"p-3 bg-primary text-white rounded-full hover:bg-primary transition-colors duration-200",children:a.jsx(W4,{className:"w-5 h-5"})})]})})]}):a.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:"Select a ticket to view the conversation"})]}),c&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md mx-4 overflow-hidden",children:[a.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[a.jsx("h3",{className:"text-xl font-semibold text-primary",children:"Create New Ticket"}),a.jsx("button",{onClick:()=>A(!1),className:"text-gray-400 hover:text-gray-500 transition-colors duration-200",children:a.jsx(_r,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Topic"}),a.jsx("input",{type:"text",value:f,onChange:B=>h(B.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Enter ticket topic"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:x,onChange:B=>m(B.target.value),className:"w-full px-3 py-2 border rounded-lg h-32 resize-none focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Describe your issue"})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 p-6 bg-gray-50 border-t",children:[a.jsx("button",{onClick:()=>A(!1),className:"px-4 py-2 text-gray-700 bg-white border rounded-lg hover:bg-gray-50 transition-colors duration-200",children:"Cancel"}),a.jsx("button",{onClick:v,disabled:!f.trim()||!x.trim(),className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Create Ticket"})]})]})})]})},Yce=()=>{const e=Sr(),[t,r]=C.useState({employee_id:"",full_name:"",company_email_id:"",direct_manager:"",direct_manager_email:"",hod:"",hod_email_id:"",department:"",business_unit:""}),n=i=>{const{name:o,value:l}=i.target;r(c=>({...c,[o]:l}))},s=async i=>{i.preventDefault();try{(await m$(t)).status===201&&(Ie.success("Employee added successfully"),setTimeout(()=>{e("/employee-list-table")},1500))}catch{Ie.error("Error adding employee")}};return a.jsxs("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[a.jsx("div",{children:a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Add Employee"})}),a.jsxs("form",{onSubmit:s,children:[a.jsxs("div",{className:"p-4 border rounded-lg border-primary",children:[a.jsx("div",{children:a.jsx("input",{name:"employee_id",value:t.employee_id,type:"text",placeholder:"Employee ID (CAP-XXXX)",onChange:n,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary mb-3"})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx("div",{children:a.jsx("input",{name:"full_name",type:"text",placeholder:"Full Name",value:t.full_name,onChange:n,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})}),a.jsx("div",{children:a.jsx("input",{name:"company_email_id",type:"email",placeholder:"Company Email",value:t.company_email_id,onChange:n,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})}),a.jsx("div",{children:a.jsx("input",{name:"direct_manager",type:"text",placeholder:"Direct Manager",value:t.direct_manager,onChange:n,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})})]})]}),a.jsxs("div",{className:"mt-6",children:[a.jsx("h2",{className:"text-lg text-primary mb-2",children:"Management Details"}),a.jsx("div",{className:"p-4 border rounded-lg border-primary",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx("div",{children:a.jsx("input",{name:"direct_manager_email",type:"email",placeholder:"Manager's Email",value:t.direct_manager_email,onChange:n,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})}),a.jsx("div",{children:a.jsx("input",{name:"hod",type:"text",placeholder:"Head of Department",value:t.hod,onChange:n,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})}),a.jsx("div",{children:a.jsx("input",{name:"hod_email_id",type:"email",placeholder:"HOD Email",value:t.hod_email_id,onChange:n,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})})]})})]}),a.jsxs("div",{className:"mt-6",children:[a.jsx("h2",{className:"text-lg text-primary mb-2",children:"Department Details"}),a.jsx("div",{className:"p-4 border rounded-lg border-primary",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx("div",{children:a.jsx("input",{name:"department",type:"text",placeholder:"Department",value:t.department,onChange:n,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})}),a.jsx("div",{children:a.jsx("input",{name:"business_unit",type:"text",placeholder:"Business Unit",value:t.business_unit,onChange:n,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})})]})})]}),a.jsx("div",{className:"flex justify-end mt-6",children:a.jsx("button",{type:"submit",className:"px-6 py-2 bg-primary text-white rounded hover:bg-primary focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",children:"SUBMIT"})})]}),a.jsx(In,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,pauseOnFocusLoss:!0})]})};function Ur(e){"@babel/helpers - typeof";return Ur=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ur(e)}function Jce(e,t){if(Ur(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ur(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function GU(e){var t=Jce(e,"string");return Ur(t)=="symbol"?t:t+""}function hh(e,t,r){return(t=GU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function rr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rE(Object(r),!0).forEach(function(n){hh(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Zce(e){if(Array.isArray(e))return e}function eAe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,i,o,l=[],c=!0,A=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){A=!0,s=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(A)throw s}}return l}}function XN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function WU(e,t){if(e){if(typeof e=="string")return XN(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?XN(e,t):void 0}}function tAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nc(e,t){return Zce(e)||eAe(e,t)||WU(e,t)||tAe()}function rAe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}function yc(e,t){if(e==null)return{};var r,n,s=rAe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}var nAe=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function sAe(e){var t=e.defaultInputValue,r=t===void 0?"":t,n=e.defaultMenuIsOpen,s=n===void 0?!1:n,i=e.defaultValue,o=i===void 0?null:i,l=e.inputValue,c=e.menuIsOpen,A=e.onChange,d=e.onInputChange,u=e.onMenuClose,f=e.onMenuOpen,h=e.value,x=yc(e,nAe),m=C.useState(l!==void 0?l:r),g=nc(m,2),p=g[0],v=g[1],w=C.useState(c!==void 0?c:s),B=nc(w,2),T=B[0],_=B[1],j=C.useState(h!==void 0?h:o),E=nc(j,2),L=E[0],M=E[1],F=C.useCallback(function(Y,R){typeof A=="function"&&A(Y,R),M(Y)},[A]),D=C.useCallback(function(Y,R){var z;typeof d=="function"&&(z=d(Y,R)),v(z!==void 0?z:Y)},[d]),G=C.useCallback(function(){typeof f=="function"&&f(),_(!0)},[f]),K=C.useCallback(function(){typeof u=="function"&&u(),_(!1)},[u]),ae=l!==void 0?l:p,Z=c!==void 0?c:T,oe=h!==void 0?h:L;return rr(rr({},x),{},{inputValue:ae,menuIsOpen:Z,onChange:F,onInputChange:D,onMenuClose:K,onMenuOpen:G,value:oe})}function sr(){return sr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sr.apply(null,arguments)}function aAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nE(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GU(n.key),n)}}function iAe(e,t,r){return t&&nE(e.prototype,t),r&&nE(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YN(e,t){return YN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},YN(e,t)}function oAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YN(e,t)}function X1(e){return X1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},X1(e)}function XU(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(XU=function(){return!!e})()}function lAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cAe(e,t){if(t&&(Ur(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lAe(e)}function AAe(e){var t=XU();return function(){var r,n=X1(e);if(t){var s=X1(this).constructor;r=Reflect.construct(n,arguments,s)}else r=n.apply(this,arguments);return cAe(this,r)}}function dAe(e){if(Array.isArray(e))return XN(e)}function uAe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fAe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Aj(e){return dAe(e)||uAe(e)||WU(e)||fAe()}var hAe=!1;function mAe(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function pAe(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var xAe=function(){function e(r){var n=this;this._insertTag=function(s){var i;n.tags.length===0?n.insertionPoint?i=n.insertionPoint.nextSibling:n.prepend?i=n.container.firstChild:i=n.before:i=n.tags[n.tags.length-1].nextSibling,n.container.insertBefore(s,i),n.tags.push(s)},this.isSpeedy=r.speedy===void 0?!hAe:r.speedy,this.tags=[],this.ctr=0,this.nonce=r.nonce,this.key=r.key,this.container=r.container,this.prepend=r.prepend,this.insertionPoint=r.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(n){n.forEach(this._insertTag)},t.insert=function(n){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(pAe(this));var s=this.tags[this.tags.length-1];if(this.isSpeedy){var i=mAe(s);try{i.insertRule(n,i.cssRules.length)}catch{}}else s.appendChild(document.createTextNode(n));this.ctr++},t.flush=function(){this.tags.forEach(function(n){var s;return(s=n.parentNode)==null?void 0:s.removeChild(n)}),this.tags=[],this.ctr=0},e}(),oa="-ms-",Y1="-moz-",Kr="-webkit-",YU="comm",dj="rule",uj="decl",gAe="@import",JU="@keyframes",yAe="@layer",vAe=Math.abs,Iv=String.fromCharCode,wAe=Object.assign;function bAe(e,t){return qs(e,0)^45?(((t<<2^qs(e,0))<<2^qs(e,1))<<2^qs(e,2))<<2^qs(e,3):0}function ZU(e){return e.trim()}function NAe(e,t){return(e=t.exec(e))?e[0]:e}function zr(e,t,r){return e.replace(t,r)}function JN(e,t){return e.indexOf(t)}function qs(e,t){return e.charCodeAt(t)|0}function Im(e,t,r){return e.slice(t,r)}function Al(e){return e.length}function fj(e){return e.length}function Mx(e,t){return t.push(e),e}function CAe(e,t){return e.map(t).join("")}var Lv=1,Rf=1,eD=0,si=0,ms=0,i0="";function Uv(e,t,r,n,s,i,o){return{value:e,root:t,parent:r,type:n,props:s,children:i,line:Lv,column:Rf,length:o,return:""}}function Y0(e,t){return wAe(Uv("",null,null,"",null,null,0),e,{length:-e.length},t)}function jAe(){return ms}function BAe(){return ms=si>0?qs(i0,--si):0,Rf--,ms===10&&(Rf=1,Lv--),ms}function Bi(){return ms=si<eD?qs(i0,si++):0,Rf++,ms===10&&(Rf=1,Lv++),ms}function gl(){return qs(i0,si)}function Mg(){return si}function fp(e,t){return Im(i0,e,t)}function Lm(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function tD(e){return Lv=Rf=1,eD=Al(i0=e),si=0,[]}function rD(e){return i0="",e}function Hg(e){return ZU(fp(si-1,ZN(e===91?e+2:e===40?e+1:e)))}function SAe(e){for(;(ms=gl())&&ms<33;)Bi();return Lm(e)>2||Lm(ms)>3?"":" "}function FAe(e,t){for(;--t&&Bi()&&!(ms<48||ms>102||ms>57&&ms<65||ms>70&&ms<97););return fp(e,Mg()+(t<6&&gl()==32&&Bi()==32))}function ZN(e){for(;Bi();)switch(ms){case e:return si;case 34:case 39:e!==34&&e!==39&&ZN(ms);break;case 40:e===41&&ZN(e);break;case 92:Bi();break}return si}function EAe(e,t){for(;Bi()&&e+ms!==57;)if(e+ms===84&&gl()===47)break;return"/*"+fp(t,si-1)+"*"+Iv(e===47?e:Bi())}function kAe(e){for(;!Lm(gl());)Bi();return fp(e,si)}function TAe(e){return rD(Vg("",null,null,null,[""],e=tD(e),0,[0],e))}function Vg(e,t,r,n,s,i,o,l,c){for(var A=0,d=0,u=o,f=0,h=0,x=0,m=1,g=1,p=1,v=0,w="",B=s,T=i,_=n,j=w;g;)switch(x=v,v=Bi()){case 40:if(x!=108&&qs(j,u-1)==58){JN(j+=zr(Hg(v),"&","&\f"),"&\f")!=-1&&(p=-1);break}case 34:case 39:case 91:j+=Hg(v);break;case 9:case 10:case 13:case 32:j+=SAe(x);break;case 92:j+=FAe(Mg()-1,7);continue;case 47:switch(gl()){case 42:case 47:Mx(_Ae(EAe(Bi(),Mg()),t,r),c);break;default:j+="/"}break;case 123*m:l[A++]=Al(j)*p;case 125*m:case 59:case 0:switch(v){case 0:case 125:g=0;case 59+d:p==-1&&(j=zr(j,/\f/g,"")),h>0&&Al(j)-u&&Mx(h>32?aE(j+";",n,r,u-1):aE(zr(j," ","")+";",n,r,u-2),c);break;case 59:j+=";";default:if(Mx(_=sE(j,t,r,A,d,s,l,w,B=[],T=[],u),i),v===123)if(d===0)Vg(j,t,_,_,B,i,u,l,T);else switch(f===99&&qs(j,3)===110?100:f){case 100:case 108:case 109:case 115:Vg(e,_,_,n&&Mx(sE(e,_,_,0,0,s,l,w,s,B=[],u),T),s,T,u,l,n?B:T);break;default:Vg(j,_,_,_,[""],T,0,l,T)}}A=d=h=0,m=p=1,w=j="",u=o;break;case 58:u=1+Al(j),h=x;default:if(m<1){if(v==123)--m;else if(v==125&&m++==0&&BAe()==125)continue}switch(j+=Iv(v),v*m){case 38:p=d>0?1:(j+="\f",-1);break;case 44:l[A++]=(Al(j)-1)*p,p=1;break;case 64:gl()===45&&(j+=Hg(Bi())),f=gl(),d=u=Al(w=j+=kAe(Mg())),v++;break;case 45:x===45&&Al(j)==2&&(m=0)}}return i}function sE(e,t,r,n,s,i,o,l,c,A,d){for(var u=s-1,f=s===0?i:[""],h=fj(f),x=0,m=0,g=0;x<n;++x)for(var p=0,v=Im(e,u+1,u=vAe(m=o[x])),w=e;p<h;++p)(w=ZU(m>0?f[p]+" "+v:zr(v,/&\f/g,f[p])))&&(c[g++]=w);return Uv(e,t,r,s===0?dj:l,c,A,d)}function _Ae(e,t,r){return Uv(e,t,r,YU,Iv(jAe()),Im(e,2,-2),0)}function aE(e,t,r,n){return Uv(e,t,r,uj,Im(e,0,n),Im(e,n+1,-1),n)}function gf(e,t){for(var r="",n=fj(e),s=0;s<n;s++)r+=t(e[s],s,e,t)||"";return r}function IAe(e,t,r,n){switch(e.type){case yAe:if(e.children.length)break;case gAe:case uj:return e.return=e.return||e.value;case YU:return"";case JU:return e.return=e.value+"{"+gf(e.children,n)+"}";case dj:e.value=e.props.join(",")}return Al(r=gf(e.children,n))?e.return=e.value+"{"+r+"}":""}function LAe(e){var t=fj(e);return function(r,n,s,i){for(var o="",l=0;l<t;l++)o+=e[l](r,n,s,i)||"";return o}}function UAe(e){return function(t){t.root||(t=t.return)&&e(t)}}function DAe(e){var t=Object.create(null);return function(r){return t[r]===void 0&&(t[r]=e(r)),t[r]}}var PAe=function(t,r,n){for(var s=0,i=0;s=i,i=gl(),s===38&&i===12&&(r[n]=1),!Lm(i);)Bi();return fp(t,si)},OAe=function(t,r){var n=-1,s=44;do switch(Lm(s)){case 0:s===38&&gl()===12&&(r[n]=1),t[n]+=PAe(si-1,r,n);break;case 2:t[n]+=Hg(s);break;case 4:if(s===44){t[++n]=gl()===58?"&\f":"",r[n]=t[n].length;break}default:t[n]+=Iv(s)}while(s=Bi());return t},RAe=function(t,r){return rD(OAe(tD(t),r))},iE=new WeakMap,QAe=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var r=t.value,n=t.parent,s=t.column===n.column&&t.line===n.line;n.type!=="rule";)if(n=n.parent,!n)return;if(!(t.props.length===1&&r.charCodeAt(0)!==58&&!iE.get(n))&&!s){iE.set(t,!0);for(var i=[],o=RAe(r,i),l=n.props,c=0,A=0;c<o.length;c++)for(var d=0;d<l.length;d++,A++)t.props[A]=i[c]?o[c].replace(/&\f/g,l[d]):l[d]+" "+o[c]}}},MAe=function(t){if(t.type==="decl"){var r=t.value;r.charCodeAt(0)===108&&r.charCodeAt(2)===98&&(t.return="",t.value="")}};function nD(e,t){switch(bAe(e,t)){case 5103:return Kr+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Kr+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Kr+e+Y1+e+oa+e+e;case 6828:case 4268:return Kr+e+oa+e+e;case 6165:return Kr+e+oa+"flex-"+e+e;case 5187:return Kr+e+zr(e,/(\w+).+(:[^]+)/,Kr+"box-$1$2"+oa+"flex-$1$2")+e;case 5443:return Kr+e+oa+"flex-item-"+zr(e,/flex-|-self/,"")+e;case 4675:return Kr+e+oa+"flex-line-pack"+zr(e,/align-content|flex-|-self/,"")+e;case 5548:return Kr+e+oa+zr(e,"shrink","negative")+e;case 5292:return Kr+e+oa+zr(e,"basis","preferred-size")+e;case 6060:return Kr+"box-"+zr(e,"-grow","")+Kr+e+oa+zr(e,"grow","positive")+e;case 4554:return Kr+zr(e,/([^-])(transform)/g,"$1"+Kr+"$2")+e;case 6187:return zr(zr(zr(e,/(zoom-|grab)/,Kr+"$1"),/(image-set)/,Kr+"$1"),e,"")+e;case 5495:case 3959:return zr(e,/(image-set\([^]*)/,Kr+"$1$`$1");case 4968:return zr(zr(e,/(.+:)(flex-)?(.*)/,Kr+"box-pack:$3"+oa+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Kr+e+e;case 4095:case 3583:case 4068:case 2532:return zr(e,/(.+)-inline(.+)/,Kr+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Al(e)-1-t>6)switch(qs(e,t+1)){case 109:if(qs(e,t+4)!==45)break;case 102:return zr(e,/(.+:)(.+)-([^]+)/,"$1"+Kr+"$2-$3$1"+Y1+(qs(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~JN(e,"stretch")?nD(zr(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(qs(e,t+1)!==115)break;case 6444:switch(qs(e,Al(e)-3-(~JN(e,"!important")&&10))){case 107:return zr(e,":",":"+Kr)+e;case 101:return zr(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Kr+(qs(e,14)===45?"inline-":"")+"box$3$1"+Kr+"$2$3$1"+oa+"$2box$3")+e}break;case 5936:switch(qs(e,t+11)){case 114:return Kr+e+oa+zr(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Kr+e+oa+zr(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Kr+e+oa+zr(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Kr+e+oa+e+e}return e}var HAe=function(t,r,n,s){if(t.length>-1&&!t.return)switch(t.type){case uj:t.return=nD(t.value,t.length);break;case JU:return gf([Y0(t,{value:zr(t.value,"@","@"+Kr)})],s);case dj:if(t.length)return CAe(t.props,function(i){switch(NAe(i,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return gf([Y0(t,{props:[zr(i,/:(read-\w+)/,":"+Y1+"$1")]})],s);case"::placeholder":return gf([Y0(t,{props:[zr(i,/:(plac\w+)/,":"+Kr+"input-$1")]}),Y0(t,{props:[zr(i,/:(plac\w+)/,":"+Y1+"$1")]}),Y0(t,{props:[zr(i,/:(plac\w+)/,oa+"input-$1")]})],s)}return""})}},VAe=[HAe],$Ae=function(t){var r=t.key;if(r==="css"){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,function(m){var g=m.getAttribute("data-emotion");g.indexOf(" ")!==-1&&(document.head.appendChild(m),m.setAttribute("data-s",""))})}var s=t.stylisPlugins||VAe,i={},o,l=[];o=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+r+' "]'),function(m){for(var g=m.getAttribute("data-emotion").split(" "),p=1;p<g.length;p++)i[g[p]]=!0;l.push(m)});var c,A=[QAe,MAe];{var d,u=[IAe,UAe(function(m){d.insert(m)})],f=LAe(A.concat(s,u)),h=function(g){return gf(TAe(g),f)};c=function(g,p,v,w){d=v,h(g?g+"{"+p.styles+"}":p.styles),w&&(x.inserted[p.name]=!0)}}var x={key:r,sheet:new xAe({key:r,container:o,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:i,registered:{},insert:c};return x.sheet.hydrate(l),x},qAe=!0;function KAe(e,t,r){var n="";return r.split(" ").forEach(function(s){e[s]!==void 0?t.push(e[s]+";"):s&&(n+=s+" ")}),n}var sD=function(t,r,n){var s=t.key+"-"+r.name;(n===!1||qAe===!1)&&t.registered[s]===void 0&&(t.registered[s]=r.styles)},zAe=function(t,r,n){sD(t,r,n);var s=t.key+"-"+r.name;if(t.inserted[r.name]===void 0){var i=r;do t.insert(r===i?"."+s:"",i,t.sheet,!0),i=i.next;while(i!==void 0)}};function GAe(e){for(var t=0,r,n=0,s=e.length;s>=4;++n,s-=4)r=e.charCodeAt(n)&255|(e.charCodeAt(++n)&255)<<8|(e.charCodeAt(++n)&255)<<16|(e.charCodeAt(++n)&255)<<24,r=(r&65535)*1540483477+((r>>>16)*59797<<16),r^=r>>>24,t=(r&65535)*1540483477+((r>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(s){case 3:t^=(e.charCodeAt(n+2)&255)<<16;case 2:t^=(e.charCodeAt(n+1)&255)<<8;case 1:t^=e.charCodeAt(n)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var WAe={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},XAe=!1,YAe=/[A-Z]|^ms/g,JAe=/_EMO_([^_]+?)_([^]*?)_EMO_/g,aD=function(t){return t.charCodeAt(1)===45},oE=function(t){return t!=null&&typeof t!="boolean"},Pw=DAe(function(e){return aD(e)?e:e.replace(YAe,"-$&").toLowerCase()}),lE=function(t,r){switch(t){case"animation":case"animationName":if(typeof r=="string")return r.replace(JAe,function(n,s,i){return dl={name:s,styles:i,next:dl},s})}return WAe[t]!==1&&!aD(t)&&typeof r=="number"&&r!==0?r+"px":r},ZAe="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function Um(e,t,r){if(r==null)return"";var n=r;if(n.__emotion_styles!==void 0)return n;switch(typeof r){case"boolean":return"";case"object":{var s=r;if(s.anim===1)return dl={name:s.name,styles:s.styles,next:dl},s.name;var i=r;if(i.styles!==void 0){var o=i.next;if(o!==void 0)for(;o!==void 0;)dl={name:o.name,styles:o.styles,next:dl},o=o.next;var l=i.styles+";";return l}return ede(e,t,r)}case"function":{if(e!==void 0){var c=dl,A=r(e);return dl=c,Um(e,t,A)}break}}var d=r;return d}function ede(e,t,r){var n="";if(Array.isArray(r))for(var s=0;s<r.length;s++)n+=Um(e,t,r[s])+";";else for(var i in r){var o=r[i];if(typeof o!="object"){var l=o;oE(l)&&(n+=Pw(i)+":"+lE(i,l)+";")}else{if(i==="NO_COMPONENT_SELECTOR"&&XAe)throw new Error(ZAe);if(Array.isArray(o)&&typeof o[0]=="string"&&t==null)for(var c=0;c<o.length;c++)oE(o[c])&&(n+=Pw(i)+":"+lE(i,o[c])+";");else{var A=Um(e,t,o);switch(i){case"animation":case"animationName":{n+=Pw(i)+":"+A+";";break}default:n+=i+"{"+A+"}"}}}}return n}var cE=/label:\s*([^\s;{]+)\s*(;|$)/g,dl;function iD(e,t,r){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var n=!0,s="";dl=void 0;var i=e[0];if(i==null||i.raw===void 0)n=!1,s+=Um(r,t,i);else{var o=i;s+=o[0]}for(var l=1;l<e.length;l++)if(s+=Um(r,t,e[l]),n){var c=i;s+=c[l]}cE.lastIndex=0;for(var A="",d;(d=cE.exec(s))!==null;)A+="-"+d[1];var u=GAe(s)+A;return{name:u,styles:s,next:dl}}var tde=function(t){return t()},rde=NB.useInsertionEffect?NB.useInsertionEffect:!1,nde=rde||tde,sde=!1,oD=C.createContext(typeof HTMLElement<"u"?$Ae({key:"css"}):null);oD.Provider;var ade=function(t){return C.forwardRef(function(r,n){var s=C.useContext(oD);return t(r,s,n)})},ide=C.createContext({}),hj={}.hasOwnProperty,e5="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",ode=function(t,r){var n={};for(var s in r)hj.call(r,s)&&(n[s]=r[s]);return n[e5]=t,n},lde=function(t){var r=t.cache,n=t.serialized,s=t.isStringTag;return sD(r,n,s),nde(function(){return zAe(r,n,s)}),null},cde=ade(function(e,t,r){var n=e.css;typeof n=="string"&&t.registered[n]!==void 0&&(n=t.registered[n]);var s=e[e5],i=[n],o="";typeof e.className=="string"?o=KAe(t.registered,i,e.className):e.className!=null&&(o=e.className+" ");var l=iD(i,void 0,C.useContext(ide));o+=t.key+"-"+l.name;var c={};for(var A in e)hj.call(e,A)&&A!=="css"&&A!==e5&&!sde&&(c[A]=e[A]);return c.className=o,r&&(c.ref=r),C.createElement(C.Fragment,null,C.createElement(lde,{cache:t,serialized:l,isStringTag:typeof s=="string"}),C.createElement(s,c))}),Ade=cde,Zt=function(t,r){var n=arguments;if(r==null||!hj.call(r,"css"))return C.createElement.apply(void 0,n);var s=n.length,i=new Array(s);i[0]=Ade,i[1]=ode(t,r);for(var o=2;o<s;o++)i[o]=n[o];return C.createElement.apply(null,i)};(function(e){var t;t||(t=e.JSX||(e.JSX={}))})(Zt||(Zt={}));function mj(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return iD(t)}function dde(){var e=mj.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function ude(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}const fde=Math.min,hde=Math.max,J1=Math.round,Hx=Math.floor,Z1=e=>({x:e,y:e});function mde(e){const{x:t,y:r,width:n,height:s}=e;return{width:n,height:s,top:r,left:t,right:t+n,bottom:r+s,x:t,y:r}}function Dv(){return typeof window<"u"}function lD(e){return AD(e)?(e.nodeName||"").toLowerCase():"#document"}function uc(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function cD(e){var t;return(t=(AD(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function AD(e){return Dv()?e instanceof Node||e instanceof uc(e).Node:!1}function pde(e){return Dv()?e instanceof Element||e instanceof uc(e).Element:!1}function pj(e){return Dv()?e instanceof HTMLElement||e instanceof uc(e).HTMLElement:!1}function AE(e){return!Dv()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof uc(e).ShadowRoot}function dD(e){const{overflow:t,overflowX:r,overflowY:n,display:s}=xj(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!["inline","contents"].includes(s)}function xde(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function gde(e){return["html","body","#document"].includes(lD(e))}function xj(e){return uc(e).getComputedStyle(e)}function yde(e){if(lD(e)==="html")return e;const t=e.assignedSlot||e.parentNode||AE(e)&&e.host||cD(e);return AE(t)?t.host:t}function uD(e){const t=yde(e);return gde(t)?e.ownerDocument?e.ownerDocument.body:e.body:pj(t)&&dD(t)?t:uD(t)}function ey(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const s=uD(e),i=s===((n=e.ownerDocument)==null?void 0:n.body),o=uc(s);if(i){const l=t5(o);return t.concat(o,o.visualViewport||[],dD(s)?s:[],l&&r?ey(l):[])}return t.concat(s,ey(s,[],r))}function t5(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function vde(e){const t=xj(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const s=pj(e),i=s?e.offsetWidth:r,o=s?e.offsetHeight:n,l=J1(r)!==i||J1(n)!==o;return l&&(r=i,n=o),{width:r,height:n,$:l}}function gj(e){return pde(e)?e:e.contextElement}function dE(e){const t=gj(e);if(!pj(t))return Z1(1);const r=t.getBoundingClientRect(),{width:n,height:s,$:i}=vde(t);let o=(i?J1(r.width):r.width)/n,l=(i?J1(r.height):r.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const wde=Z1(0);function bde(e){const t=uc(e);return!xde()||!t.visualViewport?wde:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Nde(e,t,r){return!1}function uE(e,t,r,n){t===void 0&&(t=!1);const s=e.getBoundingClientRect(),i=gj(e);let o=Z1(1);t&&(o=dE(e));const l=Nde()?bde(i):Z1(0);let c=(s.left+l.x)/o.x,A=(s.top+l.y)/o.y,d=s.width/o.x,u=s.height/o.y;if(i){const f=uc(i),h=n;let x=f,m=t5(x);for(;m&&n&&h!==x;){const g=dE(m),p=m.getBoundingClientRect(),v=xj(m),w=p.left+(m.clientLeft+parseFloat(v.paddingLeft))*g.x,B=p.top+(m.clientTop+parseFloat(v.paddingTop))*g.y;c*=g.x,A*=g.y,d*=g.x,u*=g.y,c+=w,A+=B,x=uc(m),m=t5(x)}}return mde({width:d,height:u,x:c,y:A})}function Cde(e,t){let r=null,n;const s=cD(e);function i(){var l;clearTimeout(n),(l=r)==null||l.disconnect(),r=null}function o(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),i();const{left:A,top:d,width:u,height:f}=e.getBoundingClientRect();if(l||t(),!u||!f)return;const h=Hx(d),x=Hx(s.clientWidth-(A+u)),m=Hx(s.clientHeight-(d+f)),g=Hx(A),v={rootMargin:-h+"px "+-x+"px "+-m+"px "+-g+"px",threshold:hde(0,fde(1,c))||1};let w=!0;function B(T){const _=T[0].intersectionRatio;if(_!==c){if(!w)return o();_?o(!1,_):n=setTimeout(()=>{o(!1,1e-7)},1e3)}w=!1}try{r=new IntersectionObserver(B,{...v,root:s.ownerDocument})}catch{r=new IntersectionObserver(B,v)}r.observe(e)}return o(!0),i}function jde(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,A=gj(e),d=s||i?[...A?ey(A):[],...ey(t)]:[];d.forEach(p=>{s&&p.addEventListener("scroll",r,{passive:!0}),i&&p.addEventListener("resize",r)});const u=A&&l?Cde(A,r):null;let f=-1,h=null;o&&(h=new ResizeObserver(p=>{let[v]=p;v&&v.target===A&&h&&(h.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var w;(w=h)==null||w.observe(t)})),r()}),A&&!c&&h.observe(A),h.observe(t));let x,m=c?uE(e):null;c&&g();function g(){const p=uE(e);m&&(p.x!==m.x||p.y!==m.y||p.width!==m.width||p.height!==m.height)&&r(),m=p,x=requestAnimationFrame(g)}return r(),()=>{var p;d.forEach(v=>{s&&v.removeEventListener("scroll",r),i&&v.removeEventListener("resize",r)}),u==null||u(),(p=h)==null||p.disconnect(),h=null,c&&cancelAnimationFrame(x)}}var r5=C.useLayoutEffect,Bde=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],ty=function(){};function Sde(e,t){return t?t[0]==="-"?e+t:e+"__"+t:e}function Fde(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),s=2;s<r;s++)n[s-2]=arguments[s];var i=[].concat(n);if(t&&e)for(var o in t)t.hasOwnProperty(o)&&t[o]&&i.push("".concat(Sde(e,o)));return i.filter(function(l){return l}).map(function(l){return String(l).trim()}).join(" ")}var fE=function(t){return Pde(t)?t.filter(Boolean):Ur(t)==="object"&&t!==null?[t]:[]},fD=function(t){t.className,t.clearValue,t.cx,t.getStyles,t.getClassNames,t.getValue,t.hasValue,t.isMulti,t.isRtl,t.options,t.selectOption,t.selectProps,t.setValue,t.theme;var r=yc(t,Bde);return rr({},r)},zn=function(t,r,n){var s=t.cx,i=t.getStyles,o=t.getClassNames,l=t.className;return{css:i(r,t),className:s(n??{},o(r,t),l)}};function Pv(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function Ede(e){return Pv(e)?window.innerHeight:e.clientHeight}function hD(e){return Pv(e)?window.pageYOffset:e.scrollTop}function ry(e,t){if(Pv(e)){window.scrollTo(0,t);return}e.scrollTop=t}function kde(e){var t=getComputedStyle(e),r=t.position==="absolute",n=/(auto|scroll)/;if(t.position==="fixed")return document.documentElement;for(var s=e;s=s.parentElement;)if(t=getComputedStyle(s),!(r&&t.position==="static")&&n.test(t.overflow+t.overflowY+t.overflowX))return s;return document.documentElement}function Tde(e,t,r,n){return r*((e=e/n-1)*e*e+1)+t}function Vx(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:ty,s=hD(e),i=t-s,o=10,l=0;function c(){l+=o;var A=Tde(l,s,i,r);ry(e,A),l<r?window.requestAnimationFrame(c):n(e)}c()}function hE(e,t){var r=e.getBoundingClientRect(),n=t.getBoundingClientRect(),s=t.offsetHeight/3;n.bottom+s>r.bottom?ry(e,Math.min(t.offsetTop+t.clientHeight-e.offsetHeight+s,e.scrollHeight)):n.top-s<r.top&&ry(e,Math.max(t.offsetTop-s,0))}function _de(e){var t=e.getBoundingClientRect();return{bottom:t.bottom,height:t.height,left:t.left,right:t.right,top:t.top,width:t.width}}function mE(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function Ide(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var mD=!1,Lde={get passive(){return mD=!0}},$x=typeof window<"u"?window:{};$x.addEventListener&&$x.removeEventListener&&($x.addEventListener("p",ty,Lde),$x.removeEventListener("p",ty,!1));var Ude=mD;function Dde(e){return e!=null}function Pde(e){return Array.isArray(e)}function qx(e,t,r){return e?t:r}var Ode=function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];var i=Object.entries(t).filter(function(o){var l=nc(o,1),c=l[0];return!n.includes(c)});return i.reduce(function(o,l){var c=nc(l,2),A=c[0],d=c[1];return o[A]=d,o},{})},Rde=["children","innerProps"],Qde=["children","innerProps"];function Mde(e){var t=e.maxHeight,r=e.menuEl,n=e.minHeight,s=e.placement,i=e.shouldScroll,o=e.isFixedPosition,l=e.controlHeight,c=kde(r),A={placement:"bottom",maxHeight:t};if(!r||!r.offsetParent)return A;var d=c.getBoundingClientRect(),u=d.height,f=r.getBoundingClientRect(),h=f.bottom,x=f.height,m=f.top,g=r.offsetParent.getBoundingClientRect(),p=g.top,v=o?window.innerHeight:Ede(c),w=hD(c),B=parseInt(getComputedStyle(r).marginBottom,10),T=parseInt(getComputedStyle(r).marginTop,10),_=p-T,j=v-m,E=_+w,L=u-w-m,M=h-v+w+B,F=w+m-T,D=160;switch(s){case"auto":case"bottom":if(j>=x)return{placement:"bottom",maxHeight:t};if(L>=x&&!o)return i&&Vx(c,M,D),{placement:"bottom",maxHeight:t};if(!o&&L>=n||o&&j>=n){i&&Vx(c,M,D);var G=o?j-B:L-B;return{placement:"bottom",maxHeight:G}}if(s==="auto"||o){var K=t,ae=o?_:E;return ae>=n&&(K=Math.min(ae-B-l,t)),{placement:"top",maxHeight:K}}if(s==="bottom")return i&&ry(c,M),{placement:"bottom",maxHeight:t};break;case"top":if(_>=x)return{placement:"top",maxHeight:t};if(E>=x&&!o)return i&&Vx(c,F,D),{placement:"top",maxHeight:t};if(!o&&E>=n||o&&_>=n){var Z=t;return(!o&&E>=n||o&&_>=n)&&(Z=o?_-T:E-T),i&&Vx(c,F,D),{placement:"top",maxHeight:Z}}return{placement:"bottom",maxHeight:t};default:throw new Error('Invalid placement provided "'.concat(s,'".'))}return A}function Hde(e){var t={bottom:"top",top:"bottom"};return e?t[e]:"bottom"}var pD=function(t){return t==="auto"?"bottom":t},Vde=function(t,r){var n,s=t.placement,i=t.theme,o=i.borderRadius,l=i.spacing,c=i.colors;return rr((n={label:"menu"},hh(n,Hde(s),"100%"),hh(n,"position","absolute"),hh(n,"width","100%"),hh(n,"zIndex",1),n),r?{}:{backgroundColor:c.neutral0,borderRadius:o,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:l.menuGutter,marginTop:l.menuGutter})},xD=C.createContext(null),$de=function(t){var r=t.children,n=t.minMenuHeight,s=t.maxMenuHeight,i=t.menuPlacement,o=t.menuPosition,l=t.menuShouldScrollIntoView,c=t.theme,A=C.useContext(xD)||{},d=A.setPortalPlacement,u=C.useRef(null),f=C.useState(s),h=nc(f,2),x=h[0],m=h[1],g=C.useState(null),p=nc(g,2),v=p[0],w=p[1],B=c.spacing.controlHeight;return r5(function(){var T=u.current;if(T){var _=o==="fixed",j=l&&!_,E=Mde({maxHeight:s,menuEl:T,minHeight:n,placement:i,shouldScroll:j,isFixedPosition:_,controlHeight:B});m(E.maxHeight),w(E.placement),d==null||d(E.placement)}},[s,i,o,l,n,d,B]),r({ref:u,placerProps:rr(rr({},t),{},{placement:v||pD(i),maxHeight:x})})},qde=function(t){var r=t.children,n=t.innerRef,s=t.innerProps;return Zt("div",sr({},zn(t,"menu",{menu:!0}),{ref:n},s),r)},Kde=qde,zde=function(t,r){var n=t.maxHeight,s=t.theme.spacing.baseUnit;return rr({maxHeight:n,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},r?{}:{paddingBottom:s,paddingTop:s})},Gde=function(t){var r=t.children,n=t.innerProps,s=t.innerRef,i=t.isMulti;return Zt("div",sr({},zn(t,"menuList",{"menu-list":!0,"menu-list--is-multi":i}),{ref:s},n),r)},gD=function(t,r){var n=t.theme,s=n.spacing.baseUnit,i=n.colors;return rr({textAlign:"center"},r?{}:{color:i.neutral40,padding:"".concat(s*2,"px ").concat(s*3,"px")})},Wde=gD,Xde=gD,Yde=function(t){var r=t.children,n=r===void 0?"No options":r,s=t.innerProps,i=yc(t,Rde);return Zt("div",sr({},zn(rr(rr({},i),{},{children:n,innerProps:s}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),s),n)},Jde=function(t){var r=t.children,n=r===void 0?"Loading...":r,s=t.innerProps,i=yc(t,Qde);return Zt("div",sr({},zn(rr(rr({},i),{},{children:n,innerProps:s}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),s),n)},Zde=function(t){var r=t.rect,n=t.offset,s=t.position;return{left:r.left,position:s,top:n,width:r.width,zIndex:1}},eue=function(t){var r=t.appendTo,n=t.children,s=t.controlElement,i=t.innerProps,o=t.menuPlacement,l=t.menuPosition,c=C.useRef(null),A=C.useRef(null),d=C.useState(pD(o)),u=nc(d,2),f=u[0],h=u[1],x=C.useMemo(function(){return{setPortalPlacement:h}},[]),m=C.useState(null),g=nc(m,2),p=g[0],v=g[1],w=C.useCallback(function(){if(s){var j=_de(s),E=l==="fixed"?0:window.pageYOffset,L=j[f]+E;(L!==(p==null?void 0:p.offset)||j.left!==(p==null?void 0:p.rect.left)||j.width!==(p==null?void 0:p.rect.width))&&v({offset:L,rect:j})}},[s,l,f,p==null?void 0:p.offset,p==null?void 0:p.rect.left,p==null?void 0:p.rect.width]);r5(function(){w()},[w]);var B=C.useCallback(function(){typeof A.current=="function"&&(A.current(),A.current=null),s&&c.current&&(A.current=jde(s,c.current,w,{elementResize:"ResizeObserver"in window}))},[s,w]);r5(function(){B()},[B]);var T=C.useCallback(function(j){c.current=j,B()},[B]);if(!r&&l!=="fixed"||!p)return null;var _=Zt("div",sr({ref:T},zn(rr(rr({},t),{},{offset:p.offset,position:l,rect:p.rect}),"menuPortal",{"menu-portal":!0}),i),n);return Zt(xD.Provider,{value:x},r?B_.createPortal(_,r):_)},tue=function(t){var r=t.isDisabled,n=t.isRtl;return{label:"container",direction:n?"rtl":void 0,pointerEvents:r?"none":void 0,position:"relative"}},rue=function(t){var r=t.children,n=t.innerProps,s=t.isDisabled,i=t.isRtl;return Zt("div",sr({},zn(t,"container",{"--is-disabled":s,"--is-rtl":i}),n),r)},nue=function(t,r){var n=t.theme.spacing,s=t.isMulti,i=t.hasValue,o=t.selectProps.controlShouldRenderValue;return rr({alignItems:"center",display:s&&i&&o?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},r?{}:{padding:"".concat(n.baseUnit/2,"px ").concat(n.baseUnit*2,"px")})},sue=function(t){var r=t.children,n=t.innerProps,s=t.isMulti,i=t.hasValue;return Zt("div",sr({},zn(t,"valueContainer",{"value-container":!0,"value-container--is-multi":s,"value-container--has-value":i}),n),r)},aue=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},iue=function(t){var r=t.children,n=t.innerProps;return Zt("div",sr({},zn(t,"indicatorsContainer",{indicators:!0}),n),r)},pE,oue=["size"],lue=["innerProps","isRtl","size"],cue={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},yD=function(t){var r=t.size,n=yc(t,oue);return Zt("svg",sr({height:r,width:r,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:cue},n))},yj=function(t){return Zt(yD,sr({size:20},t),Zt("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},vD=function(t){return Zt(yD,sr({size:20},t),Zt("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},wD=function(t,r){var n=t.isFocused,s=t.theme,i=s.spacing.baseUnit,o=s.colors;return rr({label:"indicatorContainer",display:"flex",transition:"color 150ms"},r?{}:{color:n?o.neutral60:o.neutral20,padding:i*2,":hover":{color:n?o.neutral80:o.neutral40}})},Aue=wD,due=function(t){var r=t.children,n=t.innerProps;return Zt("div",sr({},zn(t,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),n),r||Zt(vD,null))},uue=wD,fue=function(t){var r=t.children,n=t.innerProps;return Zt("div",sr({},zn(t,"clearIndicator",{indicator:!0,"clear-indicator":!0}),n),r||Zt(yj,null))},hue=function(t,r){var n=t.isDisabled,s=t.theme,i=s.spacing.baseUnit,o=s.colors;return rr({label:"indicatorSeparator",alignSelf:"stretch",width:1},r?{}:{backgroundColor:n?o.neutral10:o.neutral20,marginBottom:i*2,marginTop:i*2})},mue=function(t){var r=t.innerProps;return Zt("span",sr({},r,zn(t,"indicatorSeparator",{"indicator-separator":!0})))},pue=dde(pE||(pE=ude([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),xue=function(t,r){var n=t.isFocused,s=t.size,i=t.theme,o=i.colors,l=i.spacing.baseUnit;return rr({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:s,lineHeight:1,marginRight:s,textAlign:"center",verticalAlign:"middle"},r?{}:{color:n?o.neutral60:o.neutral20,padding:l*2})},Ow=function(t){var r=t.delay,n=t.offset;return Zt("span",{css:mj({animation:"".concat(pue," 1s ease-in-out ").concat(r,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:n?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},gue=function(t){var r=t.innerProps,n=t.isRtl,s=t.size,i=s===void 0?4:s,o=yc(t,lue);return Zt("div",sr({},zn(rr(rr({},o),{},{innerProps:r,isRtl:n,size:i}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),r),Zt(Ow,{delay:0,offset:n}),Zt(Ow,{delay:160,offset:!0}),Zt(Ow,{delay:320,offset:!n}))},yue=function(t,r){var n=t.isDisabled,s=t.isFocused,i=t.theme,o=i.colors,l=i.borderRadius,c=i.spacing;return rr({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:c.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},r?{}:{backgroundColor:n?o.neutral5:o.neutral0,borderColor:n?o.neutral10:s?o.primary:o.neutral20,borderRadius:l,borderStyle:"solid",borderWidth:1,boxShadow:s?"0 0 0 1px ".concat(o.primary):void 0,"&:hover":{borderColor:s?o.primary:o.neutral30}})},vue=function(t){var r=t.children,n=t.isDisabled,s=t.isFocused,i=t.innerRef,o=t.innerProps,l=t.menuIsOpen;return Zt("div",sr({ref:i},zn(t,"control",{control:!0,"control--is-disabled":n,"control--is-focused":s,"control--menu-is-open":l}),o,{"aria-disabled":n||void 0}),r)},wue=vue,bue=["data"],Nue=function(t,r){var n=t.theme.spacing;return r?{}:{paddingBottom:n.baseUnit*2,paddingTop:n.baseUnit*2}},Cue=function(t){var r=t.children,n=t.cx,s=t.getStyles,i=t.getClassNames,o=t.Heading,l=t.headingProps,c=t.innerProps,A=t.label,d=t.theme,u=t.selectProps;return Zt("div",sr({},zn(t,"group",{group:!0}),c),Zt(o,sr({},l,{selectProps:u,theme:d,getStyles:s,getClassNames:i,cx:n}),A),Zt("div",null,r))},jue=function(t,r){var n=t.theme,s=n.colors,i=n.spacing;return rr({label:"group",cursor:"default",display:"block"},r?{}:{color:s.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:i.baseUnit*3,paddingRight:i.baseUnit*3,textTransform:"uppercase"})},Bue=function(t){var r=fD(t);r.data;var n=yc(r,bue);return Zt("div",sr({},zn(t,"groupHeading",{"group-heading":!0}),n))},Sue=Cue,Fue=["innerRef","isDisabled","isHidden","inputClassName"],Eue=function(t,r){var n=t.isDisabled,s=t.value,i=t.theme,o=i.spacing,l=i.colors;return rr(rr({visibility:n?"hidden":"visible",transform:s?"translateZ(0)":""},kue),r?{}:{margin:o.baseUnit/2,paddingBottom:o.baseUnit/2,paddingTop:o.baseUnit/2,color:l.neutral80})},bD={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},kue={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":rr({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},bD)},Tue=function(t){return rr({label:"input",color:"inherit",background:0,opacity:t?0:1,width:"100%"},bD)},_ue=function(t){var r=t.cx,n=t.value,s=fD(t),i=s.innerRef,o=s.isDisabled,l=s.isHidden,c=s.inputClassName,A=yc(s,Fue);return Zt("div",sr({},zn(t,"input",{"input-container":!0}),{"data-value":n||""}),Zt("input",sr({className:r({input:!0},c),ref:i,style:Tue(l),disabled:o},A)))},Iue=_ue,Lue=function(t,r){var n=t.theme,s=n.spacing,i=n.borderRadius,o=n.colors;return rr({label:"multiValue",display:"flex",minWidth:0},r?{}:{backgroundColor:o.neutral10,borderRadius:i/2,margin:s.baseUnit/2})},Uue=function(t,r){var n=t.theme,s=n.borderRadius,i=n.colors,o=t.cropWithEllipsis;return rr({overflow:"hidden",textOverflow:o||o===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},r?{}:{borderRadius:s/2,color:i.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},Due=function(t,r){var n=t.theme,s=n.spacing,i=n.borderRadius,o=n.colors,l=t.isFocused;return rr({alignItems:"center",display:"flex"},r?{}:{borderRadius:i/2,backgroundColor:l?o.dangerLight:void 0,paddingLeft:s.baseUnit,paddingRight:s.baseUnit,":hover":{backgroundColor:o.dangerLight,color:o.danger}})},ND=function(t){var r=t.children,n=t.innerProps;return Zt("div",n,r)},Pue=ND,Oue=ND;function Rue(e){var t=e.children,r=e.innerProps;return Zt("div",sr({role:"button"},r),t||Zt(yj,{size:14}))}var Que=function(t){var r=t.children,n=t.components,s=t.data,i=t.innerProps,o=t.isDisabled,l=t.removeProps,c=t.selectProps,A=n.Container,d=n.Label,u=n.Remove;return Zt(A,{data:s,innerProps:rr(rr({},zn(t,"multiValue",{"multi-value":!0,"multi-value--is-disabled":o})),i),selectProps:c},Zt(d,{data:s,innerProps:rr({},zn(t,"multiValueLabel",{"multi-value__label":!0})),selectProps:c},r),Zt(u,{data:s,innerProps:rr(rr({},zn(t,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(r||"option")},l),selectProps:c}))},Mue=Que,Hue=function(t,r){var n=t.isDisabled,s=t.isFocused,i=t.isSelected,o=t.theme,l=o.spacing,c=o.colors;return rr({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},r?{}:{backgroundColor:i?c.primary:s?c.primary25:"transparent",color:n?c.neutral20:i?c.neutral0:"inherit",padding:"".concat(l.baseUnit*2,"px ").concat(l.baseUnit*3,"px"),":active":{backgroundColor:n?void 0:i?c.primary:c.primary50}})},Vue=function(t){var r=t.children,n=t.isDisabled,s=t.isFocused,i=t.isSelected,o=t.innerRef,l=t.innerProps;return Zt("div",sr({},zn(t,"option",{option:!0,"option--is-disabled":n,"option--is-focused":s,"option--is-selected":i}),{ref:o,"aria-disabled":n},l),r)},$ue=Vue,que=function(t,r){var n=t.theme,s=n.spacing,i=n.colors;return rr({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},r?{}:{color:i.neutral50,marginLeft:s.baseUnit/2,marginRight:s.baseUnit/2})},Kue=function(t){var r=t.children,n=t.innerProps;return Zt("div",sr({},zn(t,"placeholder",{placeholder:!0}),n),r)},zue=Kue,Gue=function(t,r){var n=t.isDisabled,s=t.theme,i=s.spacing,o=s.colors;return rr({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},r?{}:{color:n?o.neutral40:o.neutral80,marginLeft:i.baseUnit/2,marginRight:i.baseUnit/2})},Wue=function(t){var r=t.children,n=t.isDisabled,s=t.innerProps;return Zt("div",sr({},zn(t,"singleValue",{"single-value":!0,"single-value--is-disabled":n}),s),r)},Xue=Wue,Yue={ClearIndicator:fue,Control:wue,DropdownIndicator:due,DownChevron:vD,CrossIcon:yj,Group:Sue,GroupHeading:Bue,IndicatorsContainer:iue,IndicatorSeparator:mue,Input:Iue,LoadingIndicator:gue,Menu:Kde,MenuList:Gde,MenuPortal:eue,LoadingMessage:Jde,NoOptionsMessage:Yde,MultiValue:Mue,MultiValueContainer:Pue,MultiValueLabel:Oue,MultiValueRemove:Rue,Option:$ue,Placeholder:zue,SelectContainer:rue,SingleValue:Xue,ValueContainer:sue},Jue=function(t){return rr(rr({},Yue),t.components)},xE=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function Zue(e,t){return!!(e===t||xE(e)&&xE(t))}function efe(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!Zue(e[r],t[r]))return!1;return!0}function tfe(e,t){t===void 0&&(t=efe);var r=null;function n(){for(var s=[],i=0;i<arguments.length;i++)s[i]=arguments[i];if(r&&r.lastThis===this&&t(s,r.lastArgs))return r.lastResult;var o=e.apply(this,s);return r={lastResult:o,lastArgs:s,lastThis:this},o}return n.clear=function(){r=null},n}var rfe={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},nfe=function(t){return Zt("span",sr({css:rfe},t))},gE=nfe,sfe={guidance:function(t){var r=t.isSearchable,n=t.isMulti,s=t.tabSelectsValue,i=t.context,o=t.isInitialFocus;switch(i){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(s?", press Tab to select the option and exit the menu":"",".");case"input":return o?"".concat(t["aria-label"]||"Select"," is focused ").concat(r?",type to refine list":"",", press Down to open the menu, ").concat(n?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(t){var r=t.action,n=t.label,s=n===void 0?"":n,i=t.labels,o=t.isDisabled;switch(r){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(s,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(i.length>1?"s":""," ").concat(i.join(","),", selected.");case"select-option":return o?"option ".concat(s," is disabled. Select another option."):"option ".concat(s,", selected.");default:return""}},onFocus:function(t){var r=t.context,n=t.focused,s=t.options,i=t.label,o=i===void 0?"":i,l=t.selectValue,c=t.isDisabled,A=t.isSelected,d=t.isAppleDevice,u=function(m,g){return m&&m.length?"".concat(m.indexOf(g)+1," of ").concat(m.length):""};if(r==="value"&&l)return"value ".concat(o," focused, ").concat(u(l,n),".");if(r==="menu"&&d){var f=c?" disabled":"",h="".concat(A?" selected":"").concat(f);return"".concat(o).concat(h,", ").concat(u(s,n),".")}return""},onFilter:function(t){var r=t.inputValue,n=t.resultsMessage;return"".concat(n).concat(r?" for search term "+r:"",".")}},afe=function(t){var r=t.ariaSelection,n=t.focusedOption,s=t.focusedValue,i=t.focusableOptions,o=t.isFocused,l=t.selectValue,c=t.selectProps,A=t.id,d=t.isAppleDevice,u=c.ariaLiveMessages,f=c.getOptionLabel,h=c.inputValue,x=c.isMulti,m=c.isOptionDisabled,g=c.isSearchable,p=c.menuIsOpen,v=c.options,w=c.screenReaderStatus,B=c.tabSelectsValue,T=c.isLoading,_=c["aria-label"],j=c["aria-live"],E=C.useMemo(function(){return rr(rr({},sfe),u||{})},[u]),L=C.useMemo(function(){var ae="";if(r&&E.onChange){var Z=r.option,oe=r.options,Y=r.removedValue,R=r.removedValues,z=r.value,ee=function(H){return Array.isArray(H)?null:H},b=Y||Z||ee(z),O=b?f(b):"",S=oe||R||void 0,I=S?S.map(f):[],U=rr({isDisabled:b&&m(b,l),label:O,labels:I},r);ae=E.onChange(U)}return ae},[r,E,m,l,f]),M=C.useMemo(function(){var ae="",Z=n||s,oe=!!(n&&l&&l.includes(n));if(Z&&E.onFocus){var Y={focused:Z,label:f(Z),isDisabled:m(Z,l),isSelected:oe,options:i,context:Z===n?"menu":"value",selectValue:l,isAppleDevice:d};ae=E.onFocus(Y)}return ae},[n,s,f,m,E,i,l,d]),F=C.useMemo(function(){var ae="";if(p&&v.length&&!T&&E.onFilter){var Z=w({count:i.length});ae=E.onFilter({inputValue:h,resultsMessage:Z})}return ae},[i,h,p,E,v,w,T]),D=(r==null?void 0:r.action)==="initial-input-focus",G=C.useMemo(function(){var ae="";if(E.guidance){var Z=s?"value":p?"menu":"input";ae=E.guidance({"aria-label":_,context:Z,isDisabled:n&&m(n,l),isMulti:x,isSearchable:g,tabSelectsValue:B,isInitialFocus:D})}return ae},[_,n,s,x,m,g,p,E,l,B,D]),K=Zt(C.Fragment,null,Zt("span",{id:"aria-selection"},L),Zt("span",{id:"aria-focused"},M),Zt("span",{id:"aria-results"},F),Zt("span",{id:"aria-guidance"},G));return Zt(C.Fragment,null,Zt(gE,{id:A},D&&K),Zt(gE,{"aria-live":j,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},o&&!D&&K))},ife=afe,n5=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],ofe=new RegExp("["+n5.map(function(e){return e.letters}).join("")+"]","g"),CD={};for(var Rw=0;Rw<n5.length;Rw++)for(var Qw=n5[Rw],Mw=0;Mw<Qw.letters.length;Mw++)CD[Qw.letters[Mw]]=Qw.base;var jD=function(t){return t.replace(ofe,function(r){return CD[r]})},lfe=tfe(jD),yE=function(t){return t.replace(/^\s+|\s+$/g,"")},cfe=function(t){return"".concat(t.label," ").concat(t.value)},Afe=function(t){return function(r,n){if(r.data.__isNew__)return!0;var s=rr({ignoreCase:!0,ignoreAccents:!0,stringify:cfe,trim:!0,matchFrom:"any"},t),i=s.ignoreCase,o=s.ignoreAccents,l=s.stringify,c=s.trim,A=s.matchFrom,d=c?yE(n):n,u=c?yE(l(r)):l(r);return i&&(d=d.toLowerCase(),u=u.toLowerCase()),o&&(d=lfe(d),u=jD(u)),A==="start"?u.substr(0,d.length)===d:u.indexOf(d)>-1}},dfe=["innerRef"];function ufe(e){var t=e.innerRef,r=yc(e,dfe),n=Ode(r,"onExited","in","enter","exit","appear");return Zt("input",sr({ref:t},n,{css:mj({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var ffe=function(t){t.cancelable&&t.preventDefault(),t.stopPropagation()};function hfe(e){var t=e.isEnabled,r=e.onBottomArrive,n=e.onBottomLeave,s=e.onTopArrive,i=e.onTopLeave,o=C.useRef(!1),l=C.useRef(!1),c=C.useRef(0),A=C.useRef(null),d=C.useCallback(function(g,p){if(A.current!==null){var v=A.current,w=v.scrollTop,B=v.scrollHeight,T=v.clientHeight,_=A.current,j=p>0,E=B-T-w,L=!1;E>p&&o.current&&(n&&n(g),o.current=!1),j&&l.current&&(i&&i(g),l.current=!1),j&&p>E?(r&&!o.current&&r(g),_.scrollTop=B,L=!0,o.current=!0):!j&&-p>w&&(s&&!l.current&&s(g),_.scrollTop=0,L=!0,l.current=!0),L&&ffe(g)}},[r,n,s,i]),u=C.useCallback(function(g){d(g,g.deltaY)},[d]),f=C.useCallback(function(g){c.current=g.changedTouches[0].clientY},[]),h=C.useCallback(function(g){var p=c.current-g.changedTouches[0].clientY;d(g,p)},[d]),x=C.useCallback(function(g){if(g){var p=Ude?{passive:!1}:!1;g.addEventListener("wheel",u,p),g.addEventListener("touchstart",f,p),g.addEventListener("touchmove",h,p)}},[h,f,u]),m=C.useCallback(function(g){g&&(g.removeEventListener("wheel",u,!1),g.removeEventListener("touchstart",f,!1),g.removeEventListener("touchmove",h,!1))},[h,f,u]);return C.useEffect(function(){if(t){var g=A.current;return x(g),function(){m(g)}}},[t,x,m]),function(g){A.current=g}}var vE=["boxSizing","height","overflow","paddingRight","position"],wE={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function bE(e){e.cancelable&&e.preventDefault()}function NE(e){e.stopPropagation()}function CE(){var e=this.scrollTop,t=this.scrollHeight,r=e+this.offsetHeight;e===0?this.scrollTop=1:r===t&&(this.scrollTop=e-1)}function jE(){return"ontouchstart"in window||navigator.maxTouchPoints}var BE=!!(typeof window<"u"&&window.document&&window.document.createElement),J0=0,Fu={capture:!1,passive:!1};function mfe(e){var t=e.isEnabled,r=e.accountForScrollbars,n=r===void 0?!0:r,s=C.useRef({}),i=C.useRef(null),o=C.useCallback(function(c){if(BE){var A=document.body,d=A&&A.style;if(n&&vE.forEach(function(x){var m=d&&d[x];s.current[x]=m}),n&&J0<1){var u=parseInt(s.current.paddingRight,10)||0,f=document.body?document.body.clientWidth:0,h=window.innerWidth-f+u||0;Object.keys(wE).forEach(function(x){var m=wE[x];d&&(d[x]=m)}),d&&(d.paddingRight="".concat(h,"px"))}A&&jE()&&(A.addEventListener("touchmove",bE,Fu),c&&(c.addEventListener("touchstart",CE,Fu),c.addEventListener("touchmove",NE,Fu))),J0+=1}},[n]),l=C.useCallback(function(c){if(BE){var A=document.body,d=A&&A.style;J0=Math.max(J0-1,0),n&&J0<1&&vE.forEach(function(u){var f=s.current[u];d&&(d[u]=f)}),A&&jE()&&(A.removeEventListener("touchmove",bE,Fu),c&&(c.removeEventListener("touchstart",CE,Fu),c.removeEventListener("touchmove",NE,Fu)))}},[n]);return C.useEffect(function(){if(t){var c=i.current;return o(c),function(){l(c)}}},[t,o,l]),function(c){i.current=c}}var pfe=function(t){var r=t.target;return r.ownerDocument.activeElement&&r.ownerDocument.activeElement.blur()},xfe={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function gfe(e){var t=e.children,r=e.lockEnabled,n=e.captureEnabled,s=n===void 0?!0:n,i=e.onBottomArrive,o=e.onBottomLeave,l=e.onTopArrive,c=e.onTopLeave,A=hfe({isEnabled:s,onBottomArrive:i,onBottomLeave:o,onTopArrive:l,onTopLeave:c}),d=mfe({isEnabled:r}),u=function(h){A(h),d(h)};return Zt(C.Fragment,null,r&&Zt("div",{onClick:pfe,css:xfe}),t(u))}var yfe={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},vfe=function(t){var r=t.name,n=t.onFocus;return Zt("input",{required:!0,name:r,tabIndex:-1,"aria-hidden":"true",onFocus:n,css:yfe,value:"",onChange:function(){}})},wfe=vfe;function vj(e){var t;return typeof window<"u"&&window.navigator!=null?e.test(((t=window.navigator.userAgentData)===null||t===void 0?void 0:t.platform)||window.navigator.platform):!1}function bfe(){return vj(/^iPhone/i)}function BD(){return vj(/^Mac/i)}function Nfe(){return vj(/^iPad/i)||BD()&&navigator.maxTouchPoints>1}function Cfe(){return bfe()||Nfe()}function jfe(){return BD()||Cfe()}var Bfe=function(t){return t.label},Sfe=function(t){return t.label},Ffe=function(t){return t.value},Efe=function(t){return!!t.isDisabled},kfe={clearIndicator:uue,container:tue,control:yue,dropdownIndicator:Aue,group:Nue,groupHeading:jue,indicatorsContainer:aue,indicatorSeparator:hue,input:Eue,loadingIndicator:xue,loadingMessage:Xde,menu:Vde,menuList:zde,menuPortal:Zde,multiValue:Lue,multiValueLabel:Uue,multiValueRemove:Due,noOptionsMessage:Wde,option:Hue,placeholder:que,singleValue:Gue,valueContainer:nue},Tfe={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},_fe=4,SD=4,Ife=38,Lfe=SD*2,Ufe={baseUnit:SD,controlHeight:Ife,menuGutter:Lfe},Hw={borderRadius:_fe,colors:Tfe,spacing:Ufe},Dfe={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:mE(),captureMenuScroll:!mE(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:Afe(),formatGroupLabel:Bfe,getOptionLabel:Sfe,getOptionValue:Ffe,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:Efe,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!Ide(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(t){var r=t.count;return"".concat(r," result").concat(r!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function SE(e,t,r,n){var s=kD(e,t,r),i=TD(e,t,r),o=ED(e,t),l=ny(e,t);return{type:"option",data:t,isDisabled:s,isSelected:i,label:o,value:l,index:n}}function $g(e,t){return e.options.map(function(r,n){if("options"in r){var s=r.options.map(function(o,l){return SE(e,o,t,l)}).filter(function(o){return EE(e,o)});return s.length>0?{type:"group",data:r,options:s,index:n}:void 0}var i=SE(e,r,t,n);return EE(e,i)?i:void 0}).filter(Dde)}function FD(e){return e.reduce(function(t,r){return r.type==="group"?t.push.apply(t,Aj(r.options.map(function(n){return n.data}))):t.push(r.data),t},[])}function FE(e,t){return e.reduce(function(r,n){return n.type==="group"?r.push.apply(r,Aj(n.options.map(function(s){return{data:s.data,id:"".concat(t,"-").concat(n.index,"-").concat(s.index)}}))):r.push({data:n.data,id:"".concat(t,"-").concat(n.index)}),r},[])}function Pfe(e,t){return FD($g(e,t))}function EE(e,t){var r=e.inputValue,n=r===void 0?"":r,s=t.data,i=t.isSelected,o=t.label,l=t.value;return(!ID(e)||!i)&&_D(e,{label:o,value:l,data:s},n)}function Ofe(e,t){var r=e.focusedValue,n=e.selectValue,s=n.indexOf(r);if(s>-1){var i=t.indexOf(r);if(i>-1)return r;if(s<t.length)return t[s]}return null}function Rfe(e,t){var r=e.focusedOption;return r&&t.indexOf(r)>-1?r:t[0]}var Vw=function(t,r){var n,s=(n=t.find(function(i){return i.data===r}))===null||n===void 0?void 0:n.id;return s||null},ED=function(t,r){return t.getOptionLabel(r)},ny=function(t,r){return t.getOptionValue(r)};function kD(e,t,r){return typeof e.isOptionDisabled=="function"?e.isOptionDisabled(t,r):!1}function TD(e,t,r){if(r.indexOf(t)>-1)return!0;if(typeof e.isOptionSelected=="function")return e.isOptionSelected(t,r);var n=ny(e,t);return r.some(function(s){return ny(e,s)===n})}function _D(e,t,r){return e.filterOption?e.filterOption(t,r):!0}var ID=function(t){var r=t.hideSelectedOptions,n=t.isMulti;return r===void 0?n:r},Qfe=1,LD=function(e){oAe(r,e);var t=AAe(r);function r(n){var s;if(aAe(this,r),s=t.call(this,n),s.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:""},s.blockOptionHover=!1,s.isComposing=!1,s.commonProps=void 0,s.initialTouchX=0,s.initialTouchY=0,s.openAfterFocus=!1,s.scrollToFocusedOptionOnUpdate=!1,s.userIsDragging=void 0,s.isAppleDevice=jfe(),s.controlRef=null,s.getControlRef=function(c){s.controlRef=c},s.focusedOptionRef=null,s.getFocusedOptionRef=function(c){s.focusedOptionRef=c},s.menuListRef=null,s.getMenuListRef=function(c){s.menuListRef=c},s.inputRef=null,s.getInputRef=function(c){s.inputRef=c},s.focus=s.focusInput,s.blur=s.blurInput,s.onChange=function(c,A){var d=s.props,u=d.onChange,f=d.name;A.name=f,s.ariaOnChange(c,A),u(c,A)},s.setValue=function(c,A,d){var u=s.props,f=u.closeMenuOnSelect,h=u.isMulti,x=u.inputValue;s.onInputChange("",{action:"set-value",prevInputValue:x}),f&&(s.setState({inputIsHiddenAfterUpdate:!h}),s.onMenuClose()),s.setState({clearFocusValueOnUpdate:!0}),s.onChange(c,{action:A,option:d})},s.selectOption=function(c){var A=s.props,d=A.blurInputOnSelect,u=A.isMulti,f=A.name,h=s.state.selectValue,x=u&&s.isOptionSelected(c,h),m=s.isOptionDisabled(c,h);if(x){var g=s.getOptionValue(c);s.setValue(h.filter(function(p){return s.getOptionValue(p)!==g}),"deselect-option",c)}else if(!m)u?s.setValue([].concat(Aj(h),[c]),"select-option",c):s.setValue(c,"select-option");else{s.ariaOnChange(c,{action:"select-option",option:c,name:f});return}d&&s.blurInput()},s.removeValue=function(c){var A=s.props.isMulti,d=s.state.selectValue,u=s.getOptionValue(c),f=d.filter(function(x){return s.getOptionValue(x)!==u}),h=qx(A,f,f[0]||null);s.onChange(h,{action:"remove-value",removedValue:c}),s.focusInput()},s.clearValue=function(){var c=s.state.selectValue;s.onChange(qx(s.props.isMulti,[],null),{action:"clear",removedValues:c})},s.popValue=function(){var c=s.props.isMulti,A=s.state.selectValue,d=A[A.length-1],u=A.slice(0,A.length-1),f=qx(c,u,u[0]||null);d&&s.onChange(f,{action:"pop-value",removedValue:d})},s.getFocusedOptionId=function(c){return Vw(s.state.focusableOptionsWithIds,c)},s.getFocusableOptionsWithIds=function(){return FE($g(s.props,s.state.selectValue),s.getElementId("option"))},s.getValue=function(){return s.state.selectValue},s.cx=function(){for(var c=arguments.length,A=new Array(c),d=0;d<c;d++)A[d]=arguments[d];return Fde.apply(void 0,[s.props.classNamePrefix].concat(A))},s.getOptionLabel=function(c){return ED(s.props,c)},s.getOptionValue=function(c){return ny(s.props,c)},s.getStyles=function(c,A){var d=s.props.unstyled,u=kfe[c](A,d);u.boxSizing="border-box";var f=s.props.styles[c];return f?f(u,A):u},s.getClassNames=function(c,A){var d,u;return(d=(u=s.props.classNames)[c])===null||d===void 0?void 0:d.call(u,A)},s.getElementId=function(c){return"".concat(s.state.instancePrefix,"-").concat(c)},s.getComponents=function(){return Jue(s.props)},s.buildCategorizedOptions=function(){return $g(s.props,s.state.selectValue)},s.getCategorizedOptions=function(){return s.props.menuIsOpen?s.buildCategorizedOptions():[]},s.buildFocusableOptions=function(){return FD(s.buildCategorizedOptions())},s.getFocusableOptions=function(){return s.props.menuIsOpen?s.buildFocusableOptions():[]},s.ariaOnChange=function(c,A){s.setState({ariaSelection:rr({value:c},A)})},s.onMenuMouseDown=function(c){c.button===0&&(c.stopPropagation(),c.preventDefault(),s.focusInput())},s.onMenuMouseMove=function(c){s.blockOptionHover=!1},s.onControlMouseDown=function(c){if(!c.defaultPrevented){var A=s.props.openMenuOnClick;s.state.isFocused?s.props.menuIsOpen?c.target.tagName!=="INPUT"&&c.target.tagName!=="TEXTAREA"&&s.onMenuClose():A&&s.openMenu("first"):(A&&(s.openAfterFocus=!0),s.focusInput()),c.target.tagName!=="INPUT"&&c.target.tagName!=="TEXTAREA"&&c.preventDefault()}},s.onDropdownIndicatorMouseDown=function(c){if(!(c&&c.type==="mousedown"&&c.button!==0)&&!s.props.isDisabled){var A=s.props,d=A.isMulti,u=A.menuIsOpen;s.focusInput(),u?(s.setState({inputIsHiddenAfterUpdate:!d}),s.onMenuClose()):s.openMenu("first"),c.preventDefault()}},s.onClearIndicatorMouseDown=function(c){c&&c.type==="mousedown"&&c.button!==0||(s.clearValue(),c.preventDefault(),s.openAfterFocus=!1,c.type==="touchend"?s.focusInput():setTimeout(function(){return s.focusInput()}))},s.onScroll=function(c){typeof s.props.closeMenuOnScroll=="boolean"?c.target instanceof HTMLElement&&Pv(c.target)&&s.props.onMenuClose():typeof s.props.closeMenuOnScroll=="function"&&s.props.closeMenuOnScroll(c)&&s.props.onMenuClose()},s.onCompositionStart=function(){s.isComposing=!0},s.onCompositionEnd=function(){s.isComposing=!1},s.onTouchStart=function(c){var A=c.touches,d=A&&A.item(0);d&&(s.initialTouchX=d.clientX,s.initialTouchY=d.clientY,s.userIsDragging=!1)},s.onTouchMove=function(c){var A=c.touches,d=A&&A.item(0);if(d){var u=Math.abs(d.clientX-s.initialTouchX),f=Math.abs(d.clientY-s.initialTouchY),h=5;s.userIsDragging=u>h||f>h}},s.onTouchEnd=function(c){s.userIsDragging||(s.controlRef&&!s.controlRef.contains(c.target)&&s.menuListRef&&!s.menuListRef.contains(c.target)&&s.blurInput(),s.initialTouchX=0,s.initialTouchY=0)},s.onControlTouchEnd=function(c){s.userIsDragging||s.onControlMouseDown(c)},s.onClearIndicatorTouchEnd=function(c){s.userIsDragging||s.onClearIndicatorMouseDown(c)},s.onDropdownIndicatorTouchEnd=function(c){s.userIsDragging||s.onDropdownIndicatorMouseDown(c)},s.handleInputChange=function(c){var A=s.props.inputValue,d=c.currentTarget.value;s.setState({inputIsHiddenAfterUpdate:!1}),s.onInputChange(d,{action:"input-change",prevInputValue:A}),s.props.menuIsOpen||s.onMenuOpen()},s.onInputFocus=function(c){s.props.onFocus&&s.props.onFocus(c),s.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(s.openAfterFocus||s.props.openMenuOnFocus)&&s.openMenu("first"),s.openAfterFocus=!1},s.onInputBlur=function(c){var A=s.props.inputValue;if(s.menuListRef&&s.menuListRef.contains(document.activeElement)){s.inputRef.focus();return}s.props.onBlur&&s.props.onBlur(c),s.onInputChange("",{action:"input-blur",prevInputValue:A}),s.onMenuClose(),s.setState({focusedValue:null,isFocused:!1})},s.onOptionHover=function(c){if(!(s.blockOptionHover||s.state.focusedOption===c)){var A=s.getFocusableOptions(),d=A.indexOf(c);s.setState({focusedOption:c,focusedOptionId:d>-1?s.getFocusedOptionId(c):null})}},s.shouldHideSelectedOptions=function(){return ID(s.props)},s.onValueInputFocus=function(c){c.preventDefault(),c.stopPropagation(),s.focus()},s.onKeyDown=function(c){var A=s.props,d=A.isMulti,u=A.backspaceRemovesValue,f=A.escapeClearsValue,h=A.inputValue,x=A.isClearable,m=A.isDisabled,g=A.menuIsOpen,p=A.onKeyDown,v=A.tabSelectsValue,w=A.openMenuOnFocus,B=s.state,T=B.focusedOption,_=B.focusedValue,j=B.selectValue;if(!m&&!(typeof p=="function"&&(p(c),c.defaultPrevented))){switch(s.blockOptionHover=!0,c.key){case"ArrowLeft":if(!d||h)return;s.focusValue("previous");break;case"ArrowRight":if(!d||h)return;s.focusValue("next");break;case"Delete":case"Backspace":if(h)return;if(_)s.removeValue(_);else{if(!u)return;d?s.popValue():x&&s.clearValue()}break;case"Tab":if(s.isComposing||c.shiftKey||!g||!v||!T||w&&s.isOptionSelected(T,j))return;s.selectOption(T);break;case"Enter":if(c.keyCode===229)break;if(g){if(!T||s.isComposing)return;s.selectOption(T);break}return;case"Escape":g?(s.setState({inputIsHiddenAfterUpdate:!1}),s.onInputChange("",{action:"menu-close",prevInputValue:h}),s.onMenuClose()):x&&f&&s.clearValue();break;case" ":if(h)return;if(!g){s.openMenu("first");break}if(!T)return;s.selectOption(T);break;case"ArrowUp":g?s.focusOption("up"):s.openMenu("last");break;case"ArrowDown":g?s.focusOption("down"):s.openMenu("first");break;case"PageUp":if(!g)return;s.focusOption("pageup");break;case"PageDown":if(!g)return;s.focusOption("pagedown");break;case"Home":if(!g)return;s.focusOption("first");break;case"End":if(!g)return;s.focusOption("last");break;default:return}c.preventDefault()}},s.state.instancePrefix="react-select-"+(s.props.instanceId||++Qfe),s.state.selectValue=fE(n.value),n.menuIsOpen&&s.state.selectValue.length){var i=s.getFocusableOptionsWithIds(),o=s.buildFocusableOptions(),l=o.indexOf(s.state.selectValue[0]);s.state.focusableOptionsWithIds=i,s.state.focusedOption=o[l],s.state.focusedOptionId=Vw(i,o[l])}return s}return iAe(r,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&hE(this.menuListRef,this.focusedOptionRef)}},{key:"componentDidUpdate",value:function(s){var i=this.props,o=i.isDisabled,l=i.menuIsOpen,c=this.state.isFocused;(c&&!o&&s.isDisabled||c&&l&&!s.menuIsOpen)&&this.focusInput(),c&&o&&!s.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!c&&!o&&s.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(hE(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(s,i){this.props.onInputChange(s,i)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(s){var i=this,o=this.state,l=o.selectValue,c=o.isFocused,A=this.buildFocusableOptions(),d=s==="first"?0:A.length-1;if(!this.props.isMulti){var u=A.indexOf(l[0]);u>-1&&(d=u)}this.scrollToFocusedOptionOnUpdate=!(c&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:A[d],focusedOptionId:this.getFocusedOptionId(A[d])},function(){return i.onMenuOpen()})}},{key:"focusValue",value:function(s){var i=this.state,o=i.selectValue,l=i.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var c=o.indexOf(l);l||(c=-1);var A=o.length-1,d=-1;if(o.length){switch(s){case"previous":c===0?d=0:c===-1?d=A:d=c-1;break;case"next":c>-1&&c<A&&(d=c+1);break}this.setState({inputIsHidden:d!==-1,focusedValue:o[d]})}}}},{key:"focusOption",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",i=this.props.pageSize,o=this.state.focusedOption,l=this.getFocusableOptions();if(l.length){var c=0,A=l.indexOf(o);o||(A=-1),s==="up"?c=A>0?A-1:l.length-1:s==="down"?c=(A+1)%l.length:s==="pageup"?(c=A-i,c<0&&(c=0)):s==="pagedown"?(c=A+i,c>l.length-1&&(c=l.length-1)):s==="last"&&(c=l.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:l[c],focusedValue:null,focusedOptionId:this.getFocusedOptionId(l[c])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(Hw):rr(rr({},Hw),this.props.theme):Hw}},{key:"getCommonProps",value:function(){var s=this.clearValue,i=this.cx,o=this.getStyles,l=this.getClassNames,c=this.getValue,A=this.selectOption,d=this.setValue,u=this.props,f=u.isMulti,h=u.isRtl,x=u.options,m=this.hasValue();return{clearValue:s,cx:i,getStyles:o,getClassNames:l,getValue:c,hasValue:m,isMulti:f,isRtl:h,options:x,selectOption:A,selectProps:u,setValue:d,theme:this.getTheme()}}},{key:"hasValue",value:function(){var s=this.state.selectValue;return s.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var s=this.props,i=s.isClearable,o=s.isMulti;return i===void 0?o:i}},{key:"isOptionDisabled",value:function(s,i){return kD(this.props,s,i)}},{key:"isOptionSelected",value:function(s,i){return TD(this.props,s,i)}},{key:"filterOption",value:function(s,i){return _D(this.props,s,i)}},{key:"formatOptionLabel",value:function(s,i){if(typeof this.props.formatOptionLabel=="function"){var o=this.props.inputValue,l=this.state.selectValue;return this.props.formatOptionLabel(s,{context:i,inputValue:o,selectValue:l})}else return this.getOptionLabel(s)}},{key:"formatGroupLabel",value:function(s){return this.props.formatGroupLabel(s)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var s=this.props,i=s.isDisabled,o=s.isSearchable,l=s.inputId,c=s.inputValue,A=s.tabIndex,d=s.form,u=s.menuIsOpen,f=s.required,h=this.getComponents(),x=h.Input,m=this.state,g=m.inputIsHidden,p=m.ariaSelection,v=this.commonProps,w=l||this.getElementId("input"),B=rr(rr(rr({"aria-autocomplete":"list","aria-expanded":u,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":f,role:"combobox","aria-activedescendant":this.isAppleDevice?void 0:this.state.focusedOptionId||""},u&&{"aria-controls":this.getElementId("listbox")}),!o&&{"aria-readonly":!0}),this.hasValue()?(p==null?void 0:p.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return o?C.createElement(x,sr({},v,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:w,innerRef:this.getInputRef,isDisabled:i,isHidden:g,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:A,form:d,type:"text",value:c},B)):C.createElement(ufe,sr({id:w,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:ty,onFocus:this.onInputFocus,disabled:i,tabIndex:A,inputMode:"none",form:d,value:""},B))}},{key:"renderPlaceholderOrValue",value:function(){var s=this,i=this.getComponents(),o=i.MultiValue,l=i.MultiValueContainer,c=i.MultiValueLabel,A=i.MultiValueRemove,d=i.SingleValue,u=i.Placeholder,f=this.commonProps,h=this.props,x=h.controlShouldRenderValue,m=h.isDisabled,g=h.isMulti,p=h.inputValue,v=h.placeholder,w=this.state,B=w.selectValue,T=w.focusedValue,_=w.isFocused;if(!this.hasValue()||!x)return p?null:C.createElement(u,sr({},f,{key:"placeholder",isDisabled:m,isFocused:_,innerProps:{id:this.getElementId("placeholder")}}),v);if(g)return B.map(function(E,L){var M=E===T,F="".concat(s.getOptionLabel(E),"-").concat(s.getOptionValue(E));return C.createElement(o,sr({},f,{components:{Container:l,Label:c,Remove:A},isFocused:M,isDisabled:m,key:F,index:L,removeProps:{onClick:function(){return s.removeValue(E)},onTouchEnd:function(){return s.removeValue(E)},onMouseDown:function(G){G.preventDefault()}},data:E}),s.formatOptionLabel(E,"value"))});if(p)return null;var j=B[0];return C.createElement(d,sr({},f,{data:j,isDisabled:m}),this.formatOptionLabel(j,"value"))}},{key:"renderClearIndicator",value:function(){var s=this.getComponents(),i=s.ClearIndicator,o=this.commonProps,l=this.props,c=l.isDisabled,A=l.isLoading,d=this.state.isFocused;if(!this.isClearable()||!i||c||!this.hasValue()||A)return null;var u={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return C.createElement(i,sr({},o,{innerProps:u,isFocused:d}))}},{key:"renderLoadingIndicator",value:function(){var s=this.getComponents(),i=s.LoadingIndicator,o=this.commonProps,l=this.props,c=l.isDisabled,A=l.isLoading,d=this.state.isFocused;if(!i||!A)return null;var u={"aria-hidden":"true"};return C.createElement(i,sr({},o,{innerProps:u,isDisabled:c,isFocused:d}))}},{key:"renderIndicatorSeparator",value:function(){var s=this.getComponents(),i=s.DropdownIndicator,o=s.IndicatorSeparator;if(!i||!o)return null;var l=this.commonProps,c=this.props.isDisabled,A=this.state.isFocused;return C.createElement(o,sr({},l,{isDisabled:c,isFocused:A}))}},{key:"renderDropdownIndicator",value:function(){var s=this.getComponents(),i=s.DropdownIndicator;if(!i)return null;var o=this.commonProps,l=this.props.isDisabled,c=this.state.isFocused,A={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return C.createElement(i,sr({},o,{innerProps:A,isDisabled:l,isFocused:c}))}},{key:"renderMenu",value:function(){var s=this,i=this.getComponents(),o=i.Group,l=i.GroupHeading,c=i.Menu,A=i.MenuList,d=i.MenuPortal,u=i.LoadingMessage,f=i.NoOptionsMessage,h=i.Option,x=this.commonProps,m=this.state.focusedOption,g=this.props,p=g.captureMenuScroll,v=g.inputValue,w=g.isLoading,B=g.loadingMessage,T=g.minMenuHeight,_=g.maxMenuHeight,j=g.menuIsOpen,E=g.menuPlacement,L=g.menuPosition,M=g.menuPortalTarget,F=g.menuShouldBlockScroll,D=g.menuShouldScrollIntoView,G=g.noOptionsMessage,K=g.onMenuScrollToTop,ae=g.onMenuScrollToBottom;if(!j)return null;var Z=function(O,S){var I=O.type,U=O.data,Q=O.isDisabled,H=O.isSelected,X=O.label,V=O.value,Ae=m===U,W=Q?void 0:function(){return s.onOptionHover(U)},J=Q?void 0:function(){return s.selectOption(U)},ve="".concat(s.getElementId("option"),"-").concat(S),de={id:ve,onClick:J,onMouseMove:W,onMouseOver:W,tabIndex:-1,role:"option","aria-selected":s.isAppleDevice?void 0:H};return C.createElement(h,sr({},x,{innerProps:de,data:U,isDisabled:Q,isSelected:H,key:ve,label:X,type:I,value:V,isFocused:Ae,innerRef:Ae?s.getFocusedOptionRef:void 0}),s.formatOptionLabel(O.data,"menu"))},oe;if(this.hasOptions())oe=this.getCategorizedOptions().map(function(b){if(b.type==="group"){var O=b.data,S=b.options,I=b.index,U="".concat(s.getElementId("group"),"-").concat(I),Q="".concat(U,"-heading");return C.createElement(o,sr({},x,{key:U,data:O,options:S,Heading:l,headingProps:{id:Q,data:b.data},label:s.formatGroupLabel(b.data)}),b.options.map(function(H){return Z(H,"".concat(I,"-").concat(H.index))}))}else if(b.type==="option")return Z(b,"".concat(b.index))});else if(w){var Y=B({inputValue:v});if(Y===null)return null;oe=C.createElement(u,x,Y)}else{var R=G({inputValue:v});if(R===null)return null;oe=C.createElement(f,x,R)}var z={minMenuHeight:T,maxMenuHeight:_,menuPlacement:E,menuPosition:L,menuShouldScrollIntoView:D},ee=C.createElement($de,sr({},x,z),function(b){var O=b.ref,S=b.placerProps,I=S.placement,U=S.maxHeight;return C.createElement(c,sr({},x,z,{innerRef:O,innerProps:{onMouseDown:s.onMenuMouseDown,onMouseMove:s.onMenuMouseMove},isLoading:w,placement:I}),C.createElement(gfe,{captureEnabled:p,onTopArrive:K,onBottomArrive:ae,lockEnabled:F},function(Q){return C.createElement(A,sr({},x,{innerRef:function(X){s.getMenuListRef(X),Q(X)},innerProps:{role:"listbox","aria-multiselectable":x.isMulti,id:s.getElementId("listbox")},isLoading:w,maxHeight:U,focusedOption:m}),oe)}))});return M||L==="fixed"?C.createElement(d,sr({},x,{appendTo:M,controlElement:this.controlRef,menuPlacement:E,menuPosition:L}),ee):ee}},{key:"renderFormField",value:function(){var s=this,i=this.props,o=i.delimiter,l=i.isDisabled,c=i.isMulti,A=i.name,d=i.required,u=this.state.selectValue;if(d&&!this.hasValue()&&!l)return C.createElement(wfe,{name:A,onFocus:this.onValueInputFocus});if(!(!A||l))if(c)if(o){var f=u.map(function(m){return s.getOptionValue(m)}).join(o);return C.createElement("input",{name:A,type:"hidden",value:f})}else{var h=u.length>0?u.map(function(m,g){return C.createElement("input",{key:"i-".concat(g),name:A,type:"hidden",value:s.getOptionValue(m)})}):C.createElement("input",{name:A,type:"hidden",value:""});return C.createElement("div",null,h)}else{var x=u[0]?this.getOptionValue(u[0]):"";return C.createElement("input",{name:A,type:"hidden",value:x})}}},{key:"renderLiveRegion",value:function(){var s=this.commonProps,i=this.state,o=i.ariaSelection,l=i.focusedOption,c=i.focusedValue,A=i.isFocused,d=i.selectValue,u=this.getFocusableOptions();return C.createElement(ife,sr({},s,{id:this.getElementId("live-region"),ariaSelection:o,focusedOption:l,focusedValue:c,isFocused:A,selectValue:d,focusableOptions:u,isAppleDevice:this.isAppleDevice}))}},{key:"render",value:function(){var s=this.getComponents(),i=s.Control,o=s.IndicatorsContainer,l=s.SelectContainer,c=s.ValueContainer,A=this.props,d=A.className,u=A.id,f=A.isDisabled,h=A.menuIsOpen,x=this.state.isFocused,m=this.commonProps=this.getCommonProps();return C.createElement(l,sr({},m,{className:d,innerProps:{id:u,onKeyDown:this.onKeyDown},isDisabled:f,isFocused:x}),this.renderLiveRegion(),C.createElement(i,sr({},m,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:f,isFocused:x,menuIsOpen:h}),C.createElement(c,sr({},m,{isDisabled:f}),this.renderPlaceholderOrValue(),this.renderInput()),C.createElement(o,sr({},m,{isDisabled:f}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(s,i){var o=i.prevProps,l=i.clearFocusValueOnUpdate,c=i.inputIsHiddenAfterUpdate,A=i.ariaSelection,d=i.isFocused,u=i.prevWasFocused,f=i.instancePrefix,h=s.options,x=s.value,m=s.menuIsOpen,g=s.inputValue,p=s.isMulti,v=fE(x),w={};if(o&&(x!==o.value||h!==o.options||m!==o.menuIsOpen||g!==o.inputValue)){var B=m?Pfe(s,v):[],T=m?FE($g(s,v),"".concat(f,"-option")):[],_=l?Ofe(i,v):null,j=Rfe(i,B),E=Vw(T,j);w={selectValue:v,focusedOption:j,focusedOptionId:E,focusableOptionsWithIds:T,focusedValue:_,clearFocusValueOnUpdate:!1}}var L=c!=null&&s!==o?{inputIsHidden:c,inputIsHiddenAfterUpdate:void 0}:{},M=A,F=d&&u;return d&&!F&&(M={value:qx(p,v,v[0]||null),options:v,action:"initial-input-focus"},F=!u),(A==null?void 0:A.action)==="initial-input-focus"&&(M=null),rr(rr(rr({},w),L),{},{prevProps:s,ariaSelection:M,prevWasFocused:F})}}]),r}(C.Component);LD.defaultProps=Dfe;var Mfe=C.forwardRef(function(e,t){var r=sAe(e);return C.createElement(LD,sr({ref:t},r))}),UD=Mfe;function Hfe(){const[e,t]=C.useState([]),r=Sr(),n=async()=>{try{const o=await Fn.get("https://openexchangerates.org/api/currencies.json"),l=Object.entries(o.data).map(([c,A])=>({value:c,label:`${A} (${c})`}));t(l)}catch(o){console.error("Error fetching currencies:",o),Ie.error("Failed to load currencies")}};C.useEffect(()=>{n()},[]);const s=up({initialValues:{entityName:"",currency:"",addressLine:"",city:"",site:"",type:"",taxId:"",invoiceMailId:"",poMailId:"",PoSVOK:""},validationSchema:ri({entityName:St().required("Entity name is required"),currency:St().required("Currency is required"),addressLine:St().required("Address line is required"),city:St().required("City is required"),site:St().required("Site is required"),type:St().required("Type is required"),taxId:St().required("TAX ID is required"),invoiceMailId:St().email("Invalid email").required("Invoice mail ID is required"),poMailId:St().email("Invalid email").required("PO mail ID is required"),PoSVOK:St().required("SPOC is required")}),onSubmit:async o=>{console.log("Form Values:",o);const l=await z$(o);l.status===201?(Ie.success(l.data.message),setTimeout(()=>{r("/entity-list-table")},1500)):Ie.error(l.data.message)}}),i=o=>{s.setFieldValue("currency",(o==null?void 0:o.value)||"")};return a.jsxs("div",{className:"max-w-4xl mx-auto p-3 sm:p-6 bg-white shadow-md rounded-md",children:[a.jsxs("form",{onSubmit:s.handleSubmit,children:[a.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-primary mb-4 sm:mb-6",children:"Entity Form"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[a.jsxs("div",{className:"col-span-1",children:[a.jsxs("label",{className:"block text-sm sm:text-base text-gray-700",children:["Entity Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"entityName",value:s.values.entityName,onChange:s.handleChange,className:`mt-1 w-full p-2 text-sm sm:text-base border rounded ${s.errors.entityName?"border-red-500":"border-gray-300"}`}),s.errors.entityName&&a.jsx("div",{className:"text-red-500 text-xs sm:text-sm",children:s.errors.entityName})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsxs("label",{className:"block text-sm sm:text-base text-gray-700",children:["Currency ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(UD,{options:e,onChange:i,placeholder:"Select a currency",className:"mt-1 text-sm sm:text-base",styles:{control:o=>({...o,minHeight:"38px","@media (max-width: 640px)":{minHeight:"36px"}}),menuPortal:o=>({...o,zIndex:9999})},menuPortalTarget:document.body}),s.errors.currency&&a.jsx("div",{className:"text-red-500 text-xs sm:text-sm",children:s.errors.currency})]}),a.jsxs("div",{className:"col-span-1 sm:col-span-2",children:[a.jsxs("label",{className:"block text-sm sm:text-base text-gray-700",children:["Address Line ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{name:"addressLine",value:s.values.addressLine,onChange:s.handleChange,rows:2,className:`mt-1 w-full p-2 text-sm sm:text-base border rounded ${s.errors.addressLine?"border-red-500":"border-gray-300"}`}),s.errors.addressLine&&a.jsx("div",{className:"text-red-500 text-xs sm:text-sm",children:s.errors.addressLine})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsxs("label",{className:"block text-sm sm:text-base text-gray-700",children:["City ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"city",value:s.values.city,onChange:s.handleChange,className:`mt-1 w-full p-2 text-sm sm:text-base border rounded ${s.errors.city?"border-red-500":"border-gray-300"}`}),s.errors.city&&a.jsx("div",{className:"text-red-500 text-xs sm:text-sm",children:s.errors.city})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsxs("label",{className:"block text-sm sm:text-base text-gray-700",children:["Site ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"site",value:s.values.site,onChange:s.handleChange,className:`mt-1 w-full p-2 text-sm sm:text-base border rounded ${s.errors.site?"border-red-500":"border-gray-300"}`}),s.errors.site&&a.jsx("div",{className:"text-red-500 text-xs sm:text-sm",children:s.errors.site})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsxs("label",{className:"block text-sm sm:text-base text-gray-700",children:["Type ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"type",value:s.values.type,onChange:s.handleChange,className:`mt-1 w-full p-2 text-sm sm:text-base border rounded ${s.errors.type?"border-red-500":"border-gray-300"}`}),s.errors.type&&a.jsx("div",{className:"text-red-500 text-xs sm:text-sm",children:s.errors.type})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsxs("label",{className:"block text-sm sm:text-base text-gray-700",children:["Tax Id ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"taxId",value:s.values.taxId,onChange:s.handleChange,className:`mt-1 w-full p-2 text-sm sm:text-base border rounded ${s.errors.taxId?"border-red-500":"border-gray-300"}`}),s.errors.taxId&&a.jsx("div",{className:"text-red-500 text-xs sm:text-sm",children:s.errors.taxId})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsxs("label",{className:"block text-sm sm:text-base text-gray-700",children:["Invoice Mail ID ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"email",name:"invoiceMailId",value:s.values.invoiceMailId,onChange:s.handleChange,className:`mt-1 w-full p-2 text-sm sm:text-base border rounded ${s.errors.invoiceMailId?"border-red-500":"border-gray-300"}`}),s.errors.invoiceMailId&&a.jsx("div",{className:"text-red-500 text-xs sm:text-sm",children:s.errors.invoiceMailId})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsxs("label",{className:"block text-sm sm:text-base text-gray-700",children:["PO Mail ID ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"email",name:"poMailId",value:s.values.poMailId,onChange:s.handleChange,className:`mt-1 w-full p-2 text-sm sm:text-base border rounded ${s.errors.poMailId?"border-red-500":"border-gray-300"}`}),s.errors.poMailId&&a.jsx("div",{className:"text-red-500 text-xs sm:text-sm",children:s.errors.poMailId})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsxs("label",{className:"block text-sm sm:text-base text-gray-700",children:["SPOC (Single Point of Contact)"," ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"PoSVOK",value:s.values.PoSVOK,onChange:s.handleChange,className:`mt-1 w-full p-2 text-sm sm:text-base border rounded ${s.errors.PoSVOK?"border-red-500":"border-gray-300"}`}),s.errors.PoSVOK&&a.jsx("div",{className:"text-red-500 text-xs sm:text-sm",children:s.errors.PoSVOK})]})]}),a.jsxs("div",{className:"mt-4 sm:mt-6 flex flex-col sm:flex-row justify-center sm:justify-end gap-2 sm:gap-4",children:[a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 bg-primary text-white text-sm sm:text-base rounded hover:bg-primary-dark",children:"Submit"}),a.jsx("button",{type:"button",onClick:s.handleReset,className:"w-full sm:w-auto px-4 py-2 bg-gray-400 text-white text-sm sm:text-base rounded hover:bg-gray-500",children:"Reset"})]})]}),a.jsx(In,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,pauseOnFocusLoss:!0})]})}const Vfe="/assets/Logo_Picture-BMzHnU4J.png",qg=e=>{if(!e)return{date:"-",time:"-"};const t=new Date(e),r=t.getDate().toString().padStart(2,"0"),n=(t.getMonth()+1).toString().padStart(2,"0"),s=t.getFullYear().toString().slice(-2),i=`${r}/${n}/${s}`,o=t.toTimeString().split(" ")[0];return{date:i,time:o}},kE=({formData:e,onSubmit:t})=>{var u,f,h,x,m,g,p,v,w,B,T,_,j;const{id:r}=yo(),n={date:new Date,dueDate:new Date,paymentInstruction:"Please pay via bank transfer to account #123456789.",notes:"Thank you for using our service!"},[s,i]=C.useState();C.useState(!1),C.useEffect(()=>{(async()=>{const L=await N$(r);console.log(L),L.status===200&&i(L.data.reqData)})()},[r]);const o=E=>E?E.reduce((L,M)=>L+parseFloat(M.price)*parseInt(M.quantity),0):0,l=E=>{const L=parseFloat(E.price)*parseInt(E.quantity),M=E.tax?parseFloat(E.tax):0;return L*(M/100)},c=E=>E?E.reduce((L,M)=>L+l(M),0):0,A=E=>{const L=o(E),M=c(E);return L+M},d=E=>{const L=parseFloat(E.price)*parseInt(E.quantity),M=l(E);return L+M};return s?a.jsxs("div",{className:"relative bg-white shadow-lg rounded-lg overflow-hidden max-w-7xl mx-auto p-3",children:[a.jsx("div",{className:"absolute inset-0 pointer-events-none z-10 overflow-hidden",style:{transform:"rotate(-45deg)",transformOrigin:"center"},children:a.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-gray-500 border-gray-100 font-extrabold text-6xl opacity-30",children:"INTERNAL USE ONLY"})}),a.jsxs("header",{className:"py-6 px-6 flex justify-between items-center relative z-20",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"flex items-center",children:a.jsx("img",{src:Vfe,alt:"Capillary Technologies",className:"h-40 w-auto"})}),a.jsxs("div",{className:"text-start",children:[a.jsx("p",{className:"font-semibold",children:"Capillary Technologies India Ltd"}),a.jsx("p",{children:"360, bearing PID No: 101, 360, 15th Cross Rd,"}),a.jsx("p",{children:"Sector 4, HSR Layout"}),a.jsx("p",{children:"Bengaluru, Karnataka 560102"}),a.jsx("p",{children:"India"}),a.jsxs("p",{className:"mt-2",children:["Web:"," ",a.jsx("a",{href:"http://www.capillarytech.com",className:"text-blue-500",children:"www.capillarytech.com"})]}),a.jsxs("p",{children:["Email:"," ",a.jsx("a",{href:"mailto:accounts@capillarytech.com",className:"text-blue-500",children:"accounts@capillarytech.com"})]}),a.jsxs("p",{className:"mt-2",children:["Tax No.: ",a.jsx("span",{className:"font-semibold",children:"29AAECK7007Q1ZY"})]})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Purchase Order Request"}),a.jsxs("span",{className:"font-medium block",children:["Request ID. ",`#${s==null?void 0:s.reqid}`]}),a.jsx("p",{className:"text-sm mt-2",children:(()=>{const E=new Date(s==null?void 0:s.createdAt).toLocaleDateString(),L=new Date(s==null?void 0:s.createdAt).toLocaleTimeString();return`Requested on ${E} at ${L}`})()}),a.jsx("p",{className:"text-sm mt-2",children:(()=>{const E=new Date(s==null?void 0:s.approvedOn).toLocaleDateString(),L=new Date(s==null?void 0:s.approvedOn).toLocaleTimeString();return`Approved on ${E} at ${L}`})()})]})]}),a.jsxs("div",{className:"p-6 grid grid-cols-2 gap-6 mb-3",children:[a.jsxs("div",{className:"p-2 border border-solid border-gray-300 bg-gray-100",children:[a.jsx("h2",{className:"text-lg font-bold mb-2",children:"Bill to"}),a.jsx("address",{className:"not-italic",children:a.jsx("div",{className:"font-medium",children:(u=s==null?void 0:s.commercials)==null?void 0:u.billTo})})]}),a.jsxs("div",{className:"text-right p-2 border border-solid border-gray-300 bg-gray-100",children:[" ",a.jsx("h2",{className:"text-lg  font-bold mb-2",children:"Ship To"}),a.jsx("address",{className:"not-italic",children:a.jsx("div",{className:"font-medium",children:(f=s==null?void 0:s.commercials)==null?void 0:f.shipTo})})]})]}),a.jsxs("div",{className:"p-6 grid grid-cols-2 gap-6 mb-3",children:[a.jsx("div",{className:"p-2",children:a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsxs("h3",{className:"font-semibold text-gray-800 mb-2",children:["Overall Payment Term:",a.jsx("span",{className:"text-gray-600 ml-2",children:(h=s==null?void 0:s.commercials)==null?void 0:h.paymentTerm})]}),(m=(x=s==null?void 0:s.commercials)==null?void 0:x.paymentTerms)==null?void 0:m.map(E=>a.jsx("div",{className:"border-l-4 border-blue-500 pl-4 py-2 mb-3 bg-white shadow-sm",children:a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("strong",{className:"text-gray-600",children:"Payment Term:"}),a.jsx("p",{className:"text-gray-800",children:E.paymentTerm})]}),a.jsxs("div",{children:[a.jsx("strong",{className:"text-gray-600",children:"Payment Type:"}),a.jsx("p",{className:"text-gray-800",children:E.paymentType})]}),a.jsxs("div",{children:[a.jsx("strong",{className:"text-gray-600",children:"Percentage Term:"}),a.jsxs("p",{className:"text-gray-800",children:[E.percentageTerm,"%"]})]})]})},E._id))]})})}),a.jsx("div",{className:"text-right p-2",children:a.jsx("h2",{className:"text-lg font-medium mb-2",children:"Tax Terms: Inclusion of Tax"})})]}),a.jsx("div",{className:"ml-7 p-1 mb-2 ",children:a.jsx("h2",{className:"text-lg",children:"30 days from receipt of invoice"})}),a.jsxs("table",{className:"w-full bg-gray-100 rounded-lg overflow-hidden",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-200 text-gray-600 font-medium",children:[a.jsx("th",{className:"p-3 text-left",children:"SNo"}),a.jsx("th",{className:"p-3 text-left",children:"Description of Service"}),a.jsx("th",{className:"p-3 text-right",children:"Quantity"}),a.jsx("th",{className:"p-3 text-right",children:"Unit"}),a.jsx("th",{className:"p-3 text-right",children:"Rate"}),a.jsx("th",{className:"p-3 text-right",children:"Tax %"}),a.jsx("th",{className:"p-3 text-right",children:"Tax Amount"}),a.jsx("th",{className:"p-3 text-right",children:"Total Amount"})]})}),a.jsx("tbody",{children:(p=(g=s==null?void 0:s.supplies)==null?void 0:g.services)==null?void 0:p.map((E,L)=>a.jsxs("tr",{className:"border-b border-gray-200",children:[a.jsx("td",{className:"p-3",children:L+1}),a.jsxs("td",{className:"p-3",children:[a.jsxs("div",{className:"font-medium",children:["ITEM: ",E.productName]}),a.jsx("div",{className:"text-gray-600 text-sm",children:E==null?void 0:E.description})]}),a.jsx("td",{className:"p-3 text-right",children:E.quantity}),a.jsx("td",{className:"p-3 text-right",children:"Qty"}),a.jsx("td",{className:"p-3 text-right",children:parseFloat(E.price).toFixed(2)}),a.jsxs("td",{className:"p-3 text-right",children:[E.tax||"0","%"]}),a.jsx("td",{className:"p-3 text-right",children:l(E).toFixed(2)}),a.jsx("td",{className:"p-3 text-right font-medium",children:d(E).toFixed(2)})]},E._id))})]}),a.jsx("div",{className:"p-6 space-y-4",children:a.jsx("div",{className:"flex justify-end",children:a.jsxs("div",{className:"w-80 space-y-3",children:[a.jsxs("div",{className:"flex justify-between text-gray-600",children:[a.jsx("span",{children:"Subtotal:"}),a.jsxs("span",{className:"font-medium",children:[(v=s==null?void 0:s.supplies)==null?void 0:v.selectedCurrency," ",o((w=s==null?void 0:s.supplies)==null?void 0:w.services).toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between text-gray-600",children:[a.jsx("span",{children:"Total Tax:"}),a.jsxs("span",{className:"font-medium",children:[(B=s==null?void 0:s.supplies)==null?void 0:B.selectedCurrency," ",c((T=s==null?void 0:s.supplies)==null?void 0:T.services).toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between border-t pt-3",children:[a.jsx("p",{className:"text-gray-800 font-semibold",children:"Total Amount:"}),a.jsxs("p",{className:"font-bold text-2xl",children:[a.jsx("span",{children:(_=s==null?void 0:s.supplies)==null?void 0:_.selectedCurrency}),` ${A((j=s==null?void 0:s.supplies)==null?void 0:j.services).toFixed(2)}`]})]})]})})}),a.jsxs("div",{className:"border-t pt-6 px-6 pb-6 space-y-2",children:[a.jsx("p",{className:"text-gray-600 font-medium",children:"Payment Instruction"}),a.jsx("p",{children:n.paymentInstruction}),a.jsx("p",{className:"text-gray-600 font-medium",children:"Notes"}),a.jsx("p",{children:n.notes})]})]}):a.jsx("div",{children:"Loading..."})},$fe=({currentPage:e,totalPages:t,handlePageChange:r,itemsPerPage:n,totalItems:s})=>{const i=()=>{const h=window.innerWidth<640?1:2,x=[],m=[];let g;for(let p=1;p<=t;p++)(p===1||p===t||p>=e-h&&p<=e+h)&&x.push(p);return x.forEach(p=>{g&&(p-g===2?m.push(g+1):p-g!==1&&m.push("...")),m.push(p),g=p}),m},o=(e-1)*n,l=Math.min(o+n,s),c="flex items-center justify-center px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm font-medium transition-colors duration-200",A="bg-primary text-white hover:bg-primary/90",d="text-gray-500 hover:bg-gray-100",u="text-gray-300 cursor-not-allowed hover:bg-transparent";return a.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between px-3 sm:px-6 py-3 sm:py-4 bg-gray-50 border-t border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 text-xs sm:text-sm text-gray-700 mb-3 sm:mb-0",children:[a.jsx("span",{children:"Showing"}),a.jsx("span",{className:"font-medium",children:o+1}),a.jsx("span",{children:"to"}),a.jsx("span",{className:"font-medium",children:l}),a.jsx("span",{children:"of"}),a.jsx("span",{className:"font-medium",children:s}),a.jsx("span",{className:"hidden xs:inline",children:"entries"})]}),a.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[a.jsx("button",{onClick:()=>r(1),disabled:e===1,className:`${c} rounded-l-lg ${e===1?u:d}`,children:a.jsx(Gm,{className:"h-3 w-3 sm:h-4 sm:w-4"})}),a.jsx("button",{onClick:()=>r(e-1),disabled:e===1,className:`${c} ${e===1?u:d}`,children:a.jsx(zm,{className:"h-3 w-3 sm:h-4 sm:w-4"})}),a.jsx("div",{className:"flex items-center",children:i().map((f,h)=>a.jsx("button",{onClick:()=>typeof f=="number"&&r(f),className:`${c} ${f===e?A:typeof f=="number"?d:u}`,disabled:typeof f!="number",children:f},h))}),a.jsx("button",{onClick:()=>r(e+1),disabled:e===t,className:`${c} ${e===t?u:d}`,children:a.jsx(Wf,{className:"h-3 w-3 sm:h-4 sm:w-4"})}),a.jsx("button",{onClick:()=>r(t),disabled:e===t,className:`${c} rounded-r-lg ${e===t?u:d}`,children:a.jsx(Wm,{className:"h-3 w-3 sm:h-4 sm:w-4"})})]})]})},qfe=()=>{const e=localStorage.getItem("userId"),t=Sr();C.useState([]);const[r,n]=C.useState([]),[s,i]=C.useState([]),[o,l]=C.useState(""),[c,A]=C.useState(1),[d,u]=C.useState(!1),[f,h]=C.useState(""),[x,m]=C.useState(""),g=10;C.useEffect(()=>{(async()=>{const M=await Zf(e);console.log(M),M.status===200&&(n(M.data.entities),i(M.data.entities))})()},[]),C.useEffect(()=>{let L=[...r];o&&(L=L.filter(M=>Object.values(M).some(F=>String(F).toLowerCase().includes(o.toLowerCase())))),f&&(L=L.filter(M=>M.type===f)),x&&(L=L.filter(M=>M.status===x)),i(L),A(1)},[o,f,x,r]);const p=async L=>{try{(await G$(L)).status===200&&(n(r==null?void 0:r.filter(F=>(F==null?void 0:F._id)!==L)),i(s==null?void 0:s.filter(F=>(F==null?void 0:F._id)!==L)))}catch(M){console.log("Error in delete entity",M)}},v=()=>{const L=as.book_new(),M=s.map(D=>({"Entity Name":D.entityName,Currency:D.currency,Address:D.addressLine,Type:D.type,"Tax ID":D.taxId,"Invoice Mail":D.invoiceMailId,"PO Mail":D.poMailId,Status:D.status,PoSVOK:D.PoSVOK})),F=as.json_to_sheet(M);as.book_append_sheet(L,F,"Entities"),s0(L,"entity_list.xlsx")},w=Math.ceil(s.length/g),B=(c-1)*g,T=B+g,_=s.slice(B,T),j=[...new Set(r.map(L=>L.type))],E=[...new Set(r.map(L=>L.status))];return a.jsxs("div",{className:"p-4 md:p-8 bg-white rounded-lg shadow-sm h-full",children:[a.jsxs("div",{className:"mb-6 md:mb-8",children:[a.jsx("h2",{className:"text-xl md:text-2xl font-bold text-gray-900 mb-4 md:mb-6",children:"Entity List"}),a.jsx("div",{className:"block md:hidden mb-4",children:a.jsxs("button",{className:"w-full inline-flex items-center justify-center px-4 py-2.5 bg-primary text-white rounded-lg text-sm font-medium hover:bg-primary/90",onClick:()=>t("/entity-list-table/entities"),children:[a.jsx(yn,{className:"h-4 w-4 mr-2"}),"Add Entity"]})}),a.jsxs("div",{className:"flex flex-col md:flex-row md:flex-wrap md:items-center md:justify-between gap-4 md:gap-6",children:[a.jsxs("div",{className:"relative flex-1 w-full md:min-w-[300px] md:max-w-md",children:[a.jsx(rn,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),a.jsx("input",{type:"text",value:o,onChange:L=>l(L.target.value),placeholder:"Search entities...",className:"w-full pl-11 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),a.jsxs("div",{className:"hidden md:flex items-center gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsxs("button",{className:"inline-flex items-center px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",onClick:()=>u(!d),children:[a.jsx(ti,{className:"h-4 w-4 mr-2"}),"Filter"]}),d&&a.jsx("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 p-4 z-50",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),a.jsxs("select",{value:f,onChange:L=>h(L.target.value),className:"w-full border border-gray-300 rounded-md p-2",children:[a.jsx("option",{value:"",children:"All Types"}),j.map(L=>a.jsx("option",{value:L,children:L},L))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),a.jsxs("select",{value:x,onChange:L=>m(L.target.value),className:"w-full border border-gray-300 rounded-md p-2",children:[a.jsx("option",{value:"",children:"All Statuses"}),E.map(L=>a.jsx("option",{value:L,children:L},L))]})]})]})})]}),a.jsxs("button",{onClick:v,className:"inline-flex items-center px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[a.jsx(_n,{className:"h-4 w-4 mr-2"}),"Export"]}),a.jsxs("button",{className:"inline-flex items-center px-4 py-2.5 bg-primary text-white rounded-lg text-sm font-medium hover:bg-primary/90",onClick:()=>t("/entity-list-table/entities"),children:[a.jsx(yn,{className:"h-4 w-4 mr-2"}),"Add Entity"]})]}),a.jsxs("div",{className:"flex md:hidden items-center gap-2 w-full",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsxs("button",{className:"w-full inline-flex items-center justify-center px-3 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",onClick:()=>u(!d),children:[a.jsx(ti,{className:"h-4 w-4 mr-1"}),"Filter"]}),d&&a.jsx("div",{className:"absolute left-0 right-0 mt-2 bg-white rounded-lg shadow-lg border border-gray-200 p-4 z-50",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),a.jsxs("select",{value:f,onChange:L=>h(L.target.value),className:"w-full border border-gray-300 rounded-md p-2",children:[a.jsx("option",{value:"",children:"All Types"}),j.map(L=>a.jsx("option",{value:L,children:L},L))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),a.jsxs("select",{value:x,onChange:L=>m(L.target.value),className:"w-full border border-gray-300 rounded-md p-2",children:[a.jsx("option",{value:"",children:"All Statuses"}),E.map(L=>a.jsx("option",{value:L,children:L},L))]})]})]})})]}),a.jsxs("button",{onClick:v,className:"flex-1 inline-flex items-center justify-center px-3 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[a.jsx(_n,{className:"h-4 w-4 mr-1"}),"Export"]})]})]})]}),a.jsx("div",{className:"border border-gray-200 rounded-lg",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsx("div",{className:"inline-block min-w-full align-middle",children:a.jsx("div",{className:"overflow-hidden",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-primary",children:a.jsxs("tr",{children:[a.jsx("th",{className:"sticky top-0 px-4 md:px-6 py-3 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Sno"}),a.jsx("th",{className:"sticky top-0 px-4 md:px-6 py-3 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"EntityName"}),a.jsx("th",{className:"sticky top-0 px-4 md:px-6 py-3 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Currency"}),a.jsx("th",{className:"sticky top-0 px-4 md:px-6 py-3 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"AddressLine"}),a.jsx("th",{className:"sticky top-0 px-4 md:px-6 py-3 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Type"}),a.jsx("th",{className:"sticky top-0 px-4 md:px-6 py-3 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Tax Id"}),a.jsx("th",{className:"sticky top-0 px-4 md:px-6 py-3 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Invoice Mail Id"}),a.jsx("th",{className:"sticky top-0 px-4 md:px-6 py-3 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Po MailId"}),a.jsx("th",{className:"sticky top-0 px-4 md:px-6 py-3 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"SPOC"}),a.jsx("th",{className:"sticky top-0 px-4 md:px-6 py-3 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"sticky top-0 px-4 md:px-6 py-3 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:_.map((L,M)=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 md:px-6 py-3 md:py-4 text-sm font-medium text-gray-900",children:B+M+1}),a.jsx("td",{className:"px-4 md:px-6 py-3 md:py-4 text-sm text-gray-500",children:L.entityName}),a.jsx("td",{className:"px-4 md:px-6 py-3 md:py-4 text-sm text-gray-500",children:L.currency}),a.jsx("td",{className:"px-4 md:px-6 py-3 md:py-4 text-sm text-gray-500",children:L.addressLine}),a.jsx("td",{className:"px-4 md:px-6 py-3 md:py-4 text-sm text-gray-500",children:L.type}),a.jsx("td",{className:"px-4 md:px-6 py-3 md:py-4 text-sm text-gray-500",children:L.taxId}),a.jsx("td",{className:"px-4 md:px-6 py-3 md:py-4 text-sm text-gray-500",children:L.invoiceMailId}),a.jsx("td",{className:"px-4 md:px-6 py-3 md:py-4 text-sm text-gray-500",children:L.poMailId}),a.jsx("td",{className:"px-4 md:px-6 py-3 md:py-4 text-sm text-gray-500",children:L.PoSVOK}),a.jsx("td",{className:"px-4 md:px-6 py-3 md:py-4 text-sm text-gray-500",children:L.status}),a.jsx("td",{className:"px-4 md:px-6 py-3 md:py-4 text-sm text-gray-500",children:a.jsxs("div",{className:"flex space-x-3 md:space-x-4",children:[a.jsx("button",{className:"text-primary hover:text-primary/80",onClick:()=>t(`/entity-list-table/edit-entities/${L._id}`),children:a.jsx(Us,{className:"h-4 md:h-5 w-4 md:w-5"})}),a.jsx("button",{onClick:()=>p(L._id),className:"text-red-600 hover:text-red-800",children:a.jsx($r,{className:"h-4 md:h-5 w-4 md:w-5"})})]})})]},L._id))})]})})})})}),a.jsx($fe,{currentPage:c,totalPages:w,handlePageChange:A,itemsPerPage:g,totalItems:s.length})]})};function Kfe(){const e=yo(),[t,r]=C.useState([]),n=Sr(),s=async()=>{try{const l=await Fn.get("https://openexchangerates.org/api/currencies.json"),c=Object.entries(l.data).map(([A,d])=>({value:A,label:`${d} (${A})`}));r(c)}catch(l){console.error("Error fetching currencies:",l),Ie.error("Failed to load currencies")}},i=up({initialValues:{entityName:"",currency:"",addressLine:"",city:"",site:"",type:"",taxId:"",invoiceMailId:"",poMailId:"",PoSVOK:""},validationSchema:ri({entityName:St().required("Entity name is required"),currency:St().required("Currency is required"),addressLine:St().required("Address line is required"),city:St().required("City is required"),site:St().required("Site is required"),type:St().required("Type is required"),taxId:St().required("TAX ID is required"),invoiceMailId:St().email("Invalid email").required("Invoice mail ID is required"),poMailId:St().email("Invalid email").required("PO mail ID is required"),PoSVOK:St().required("SPOC is required")}),onSubmit:async l=>{console.log("Form Values:",l);try{const c=await X$(e.id,l);console.log(c),c.status===200?(Ie.success(c.data.message),setTimeout(()=>{n("/entity-list-table")},1500)):Ie.error(c.data.message)}catch(c){console.error("Error submitting form:",c),Ie.error("Failed to update entity")}}}),o=l=>{i.setFieldValue("currency",l?l.value:"")};return C.useEffect(()=>{(async()=>{try{const c=await W$(e.id);if(c.status===200){const A=c.data;i.setValues({entityName:A.entityName||"",currency:A.currency||"",addressLine:A.addressLine||"",city:A.city||"",site:A.site||"",type:A.type||"",taxId:A.taxId||"",invoiceMailId:A.invoiceMailId||"",poMailId:A.poMailId||"",PoSVOK:A.PoSVOK||""})}else Ie.error("Failed to load entity data")}catch(c){console.error("Error fetching entity data:",c),Ie.error("Failed to load entity data")}})()},[e.id]),C.useEffect(()=>{if(t.length>0&&i.values.currency){const l=t.find(c=>c.value===i.values.currency);l&&i.setFieldValue("currency",l.value)}},[t,i.values.currency]),C.useEffect(()=>{s()},[]),a.jsxs("div",{className:"max-w-4xl mx-auto p-3 sm:p-6 bg-white shadow-md rounded-md",children:[a.jsxs("form",{onSubmit:i.handleSubmit,children:[a.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-primary mb-4 sm:mb-6",children:"Edit Entity Form"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[a.jsxs("div",{className:"col-span-1",children:[a.jsxs("label",{className:"block text-sm sm:text-base text-gray-700",children:["Entity Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"entityName",value:i.values.entityName,onChange:i.handleChange,className:`mt-1 w-full p-2 text-sm sm:text-base border rounded ${i.errors.entityName?"border-red-500":"border-gray-300"}`}),i.errors.entityName&&a.jsx("div",{className:"text-red-500 text-xs sm:text-sm",children:i.errors.entityName})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsxs("label",{className:"block text-sm sm:text-base text-gray-700",children:["Currency ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(UD,{options:t,onChange:o,value:t.length>0&&i.values.currency&&t.find(l=>l.value===i.values.currency)||null,placeholder:"Select a currency",className:"mt-1 text-sm sm:text-base",styles:{control:l=>({...l,minHeight:"38px","@media (max-width: 640px)":{minHeight:"36px"}}),menuPortal:l=>({...l,zIndex:9999})},menuPortalTarget:document.body}),i.errors.currency&&a.jsx("div",{className:"text-red-500 text-xs sm:text-sm",children:i.errors.currency})]}),a.jsxs("div",{className:"col-span-1 sm:col-span-2",children:[a.jsxs("label",{className:"block text-sm sm:text-base text-gray-700",children:["Address Line ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{name:"addressLine",value:i.values.addressLine,onChange:i.handleChange,rows:2,className:`mt-1 w-full p-2 text-sm sm:text-base border rounded ${i.errors.addressLine?"border-red-500":"border-gray-300"}`}),i.errors.addressLine&&a.jsx("div",{className:"text-red-500 text-xs sm:text-sm",children:i.errors.addressLine})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsxs("label",{className:"block text-sm sm:text-base text-gray-700",children:["City ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"city",value:i.values.city,onChange:i.handleChange,className:`mt-1 w-full p-2 text-sm sm:text-base border rounded ${i.errors.city?"border-red-500":"border-gray-300"}`}),i.errors.city&&a.jsx("div",{className:"text-red-500 text-xs sm:text-sm",children:i.errors.city})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsxs("label",{className:"block text-sm sm:text-base text-gray-700",children:["Site ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"site",value:i.values.site,onChange:i.handleChange,className:`mt-1 w-full p-2 text-sm sm:text-base border rounded ${i.errors.site?"border-red-500":"border-gray-300"}`}),i.errors.site&&a.jsx("div",{className:"text-red-500 text-xs sm:text-sm",children:i.errors.site})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsxs("label",{className:"block text-sm sm:text-base text-gray-700",children:["Type ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"type",value:i.values.type,onChange:i.handleChange,className:`mt-1 w-full p-2 text-sm sm:text-base border rounded ${i.errors.type?"border-red-500":"border-gray-300"}`}),i.errors.type&&a.jsx("div",{className:"text-red-500 text-xs sm:text-sm",children:i.errors.type})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsxs("label",{className:"block text-sm sm:text-base text-gray-700",children:["Tax Id ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"taxId",value:i.values.taxId,onChange:i.handleChange,className:`mt-1 w-full p-2 text-sm sm:text-base border rounded ${i.errors.taxId?"border-red-500":"border-gray-300"}`}),i.errors.taxId&&a.jsx("div",{className:"text-red-500 text-xs sm:text-sm",children:i.errors.taxId})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsxs("label",{className:"block text-sm sm:text-base text-gray-700",children:["Invoice Mail ID ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"email",name:"invoiceMailId",value:i.values.invoiceMailId,onChange:i.handleChange,className:`mt-1 w-full p-2 text-sm sm:text-base border rounded ${i.errors.invoiceMailId?"border-red-500":"border-gray-300"}`}),i.errors.invoiceMailId&&a.jsx("div",{className:"text-red-500 text-xs sm:text-sm",children:i.errors.invoiceMailId})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsxs("label",{className:"block text-sm sm:text-base text-gray-700",children:["PO Mail ID ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"email",name:"poMailId",value:i.values.poMailId,onChange:i.handleChange,className:`mt-1 w-full p-2 text-sm sm:text-base border rounded ${i.errors.poMailId?"border-red-500":"border-gray-300"}`}),i.errors.poMailId&&a.jsx("div",{className:"text-red-500 text-xs sm:text-sm",children:i.errors.poMailId})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsxs("label",{className:"block text-sm sm:text-base text-gray-700",children:["SPOC (Single Point of Contact)"," ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"PoSVOK",value:i.values.PoSVOK,onChange:i.handleChange,className:`mt-1 w-full p-2 text-sm sm:text-base border rounded ${i.errors.PoSVOK?"border-red-500":"border-gray-300"}`}),i.errors.PoSVOK&&a.jsx("div",{className:"text-red-500 text-xs sm:text-sm",children:i.errors.PoSVOK})]})]}),a.jsxs("div",{className:"mt-4 sm:mt-6 flex flex-col sm:flex-row justify-center sm:justify-end gap-2 sm:gap-4",children:[a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 bg-primary text-white text-sm sm:text-base rounded hover:bg-primary-dark",children:"Submit"}),a.jsx("button",{type:"button",onClick:i.handleReset,className:"w-full sm:w-auto px-4 py-2 bg-gray-400 text-white text-sm sm:text-base rounded hover:bg-gray-500",children:"Reset"})]})]}),a.jsx(In,{})]})}const zfe=({currentPage:e,totalPages:t,handlePageChange:r,itemsPerPage:n,totalItems:s})=>{const i=()=>{const h=[],x=[];let m;for(let g=1;g<=t;g++)(g===1||g===t||g>=e-2&&g<=e+2)&&h.push(g);return h.forEach(g=>{m&&(g-m===2?x.push(m+1):g-m!==1&&x.push("...")),x.push(g),m=g}),x},o=(e-1)*n,l=Math.min(o+n,s),c="flex items-center justify-center px-3 py-2 text-sm font-medium transition-colors duration-200",A="bg-primary text-white hover:bg-primary/90",d="text-gray-500 hover:bg-gray-100",u="text-gray-300 cursor-not-allowed hover:bg-transparent";return a.jsxs("div",{className:"flex items-center justify-between px-6 py-4 bg-gray-50 border-t border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[a.jsx("span",{children:"Showing"}),a.jsx("span",{className:"font-medium",children:o+1}),a.jsx("span",{children:"to"}),a.jsx("span",{className:"font-medium",children:l}),a.jsx("span",{children:"of"}),a.jsx("span",{className:"font-medium",children:s}),a.jsx("span",{children:"entries"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>r(1),disabled:e===1,className:`${c} rounded-l-lg ${e===1?u:d}`,children:a.jsx(Gm,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>r(e-1),disabled:e===1,className:`${c} ${e===1?u:d}`,children:a.jsx(zm,{className:"h-4 w-4"})}),a.jsx("div",{className:"flex items-center",children:i().map((f,h)=>a.jsx("button",{onClick:()=>typeof f=="number"&&r(f),className:`${c} ${f===e?A:typeof f=="number"?d:u}`,disabled:typeof f!="number",children:f},h))}),a.jsx("button",{onClick:()=>r(e+1),disabled:e===t,className:`${c} ${e===t?u:d}`,children:a.jsx(Wf,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>r(t),disabled:e===t,className:`${c} rounded-r-lg ${e===t?u:d}`,children:a.jsx(Wm,{className:"h-4 w-4"})})]})]})},TE=({isOpen:e,onClose:t,departments:r,hods:n,onFilter:s})=>{const[i,o]=C.useState(""),[l,c]=C.useState(""),[A,d]=C.useState(""),u=()=>{s({department:i,hod:l,syncStatus:A}),t()},f=()=>{o(""),c(""),d(""),s({department:"",hod:"",syncStatus:""}),t()};return e?a.jsx("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-medium",children:"Filters"}),a.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700",children:a.jsx(_r,{className:"h-5 w-5"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sync Status"}),a.jsxs("select",{value:A,onChange:h=>d(h.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[a.jsx("option",{value:"",children:"All Status"}),a.jsx("option",{value:"true",children:"Synced"}),a.jsx("option",{value:"false",children:"Not Synced"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),a.jsxs("select",{value:i,onChange:h=>o(h.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[a.jsx("option",{value:"",children:"All Departments"}),r.map(h=>a.jsx("option",{value:h,children:h},h))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"HOD"}),a.jsxs("select",{value:l,onChange:h=>c(h.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[a.jsx("option",{value:"",children:"All HODs"}),n.map(h=>a.jsx("option",{value:h,children:h},h))]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:u,className:"flex-1 bg-primary text-white rounded-md py-2 text-sm font-medium hover:bg-primary/90",children:"Apply"}),a.jsx("button",{onClick:f,className:"flex-1 bg-gray-100 text-gray-700 rounded-md py-2 text-sm font-medium hover:bg-gray-200",children:"Reset"})]})]})]})}):null},Gfe=()=>{const e=Sr(),[t,r]=C.useState([]),[n,s]=C.useState([]),[i,o]=C.useState([]),[l,c]=C.useState(!1),[A,d]=C.useState(1),[u,f]=C.useState(""),[h,x]=C.useState(!1),[m,g]=C.useState(!1),[p,v]=C.useState({}),[w,B]=C.useState([]),[T,_]=C.useState({department:"",hod:"",syncStatus:""}),j=20,E=async()=>{c(!0);try{const z=await jI();s(z.data),o(z.data);const ee=z.data.reduce((O,S)=>(O[S.employee_id]=S.sync,O),{});v(ee);const b=z.data.filter(O=>!O.sync).map(O=>O.employee_id);B(b)}catch(z){Ie.error("Error fetching employees"),console.error("Error fetching employees:",z)}c(!1)};C.useEffect(()=>{E()},[]),C.useEffect(()=>{let z=[...n];if(u&&(z=z.filter(ee=>["full_name","employee_id","department"].some(b=>String(ee[b]||"").toLowerCase().includes(u.toLowerCase())))),T.department&&(z=z.filter(ee=>ee.department===T.department)),T.hod&&(z=z.filter(ee=>ee.hod===T.hod)),T.syncStatus!==""){const ee=T.syncStatus==="true";z=z.filter(b=>p[b.employee_id]===ee)}o(z),d(1)},[u,T,n,p]);const L=async z=>{const ee=await p$(z);ee.status===200?(s(n==null?void 0:n.filter(b=>(b==null?void 0:b._id)!==z)),Ie.success(ee.data.message)):Ie.error(ee.data.message)},M=async()=>{if(!m){g(!0);try{console.log("Not sync data",w);const z=await h$(w);z.status===200&&(Ie.success(z.data.message),await E())}catch{Ie.error("Failed to sync employee data")}finally{g(!1)}}},F=[...new Set(n.map(z=>z.department))],D=[...new Set(n.map(z=>z.hod))],G=Math.ceil(i.length/j),K=(A-1)*j,ae=K+j,Z=i.slice(K,ae),oe=z=>{z>=1&&z<=G&&(d(z),r([]))},Y=z=>{v(ee=>{const b={...ee,[z]:!ee[z]},O=Object.keys(b).filter(S=>!b[S]);return B(O),b})},R=z=>{_(z)};return a.jsxs("div",{className:"p-4 md:p-8 bg-white rounded-lg shadow-sm h-full",children:[a.jsxs("div",{className:"mb-6 md:mb-8",children:[a.jsx("h2",{className:"text-xl md:text-2xl font-bold text-gray-900 mb-4 md:mb-6",children:"Employee List"}),a.jsx("div",{className:"block md:hidden mb-4",children:a.jsxs("button",{className:"w-full inline-flex items-center justify-center px-4 py-2.5 bg-primary text-white rounded-lg text-sm font-medium hover:bg-primary/90",onClick:()=>e("/employee-list-table/employee-reg"),children:[a.jsx(yn,{className:"h-4 w-4 mr-2"}),"Add Employee"]})}),a.jsxs("div",{className:"flex flex-col md:flex-row md:flex-wrap md:items-center md:justify-between gap-4 md:gap-6",children:[a.jsxs("div",{className:"relative flex-1 w-full md:min-w-[300px] md:max-w-md",children:[a.jsx(rn,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),a.jsx("input",{type:"text",value:u,onChange:z=>f(z.target.value),placeholder:"Search employees...",className:"w-full pl-11 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),a.jsxs("div",{className:"hidden md:flex items-center gap-4",children:[a.jsxs("button",{className:`inline-flex items-center px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium ${m?"bg-gray-100 text-gray-500 cursor-not-allowed":"text-gray-700 bg-white hover:bg-gray-50"}`,onClick:M,disabled:m,children:[a.jsx(Q3,{className:`h-4 w-4 mr-2 ${m?"animate-spin":""}`}),m?"Syncing...":"Sync"]}),a.jsxs("div",{className:"relative",children:[a.jsxs("button",{className:"inline-flex items-center px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",onClick:()=>x(!h),children:[a.jsx(ti,{className:"h-4 w-4 mr-2"}),"Filter"]}),a.jsx(TE,{isOpen:h,onClose:()=>x(!1),departments:F,hods:D,onFilter:R})]}),a.jsxs("button",{className:"inline-flex items-center px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[a.jsx(_n,{className:"h-4 w-4 mr-2"}),"Export"]}),a.jsxs("button",{className:"inline-flex items-center px-4 py-2.5 bg-primary text-white rounded-lg text-sm font-medium hover:bg-primary/90",onClick:()=>e("/employee-list-table/employee-reg"),children:[a.jsx(yn,{className:"h-4 w-4 mr-2"}),"Add Employee"]})]}),a.jsxs("div",{className:"flex md:hidden items-center w-full gap-2",children:[a.jsxs("button",{className:`flex-1 inline-flex items-center justify-center px-3 py-2 border border-gray-300 rounded-lg text-sm font-medium ${m?"bg-gray-100 text-gray-500 cursor-not-allowed":"text-gray-700 bg-white hover:bg-gray-50"}`,onClick:M,disabled:m,children:[a.jsx(Q3,{className:`h-4 w-4 mr-1 ${m?"animate-spin":""}`}),"Sync"]}),a.jsxs("div",{className:"relative flex-1",children:[a.jsxs("button",{className:"w-full inline-flex items-center justify-center px-3 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",onClick:()=>x(!h),children:[a.jsx(ti,{className:"h-4 w-4 mr-1"}),"Filter"]}),a.jsx(TE,{isOpen:h,onClose:()=>x(!1),departments:F,hods:D,onFilter:R})]}),a.jsxs("button",{className:"flex-1 inline-flex items-center justify-center px-3 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[a.jsx(_n,{className:"h-4 w-4 mr-1"}),"Export"]})]})]})]}),a.jsxs("div",{className:"bg-white shadow-lg rounded-lg border border-gray-200 overflow-hidden",children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-primary",children:a.jsx("tr",{children:["SNO","Employee","Sync","Bus_Unit","Head Of Department","Direct Manager","Actions"].map(z=>a.jsx("th",{className:"sticky top-0 px-3 md:px-6 py-3 md:py-4 text-left text-xs font-bold text-white uppercase tracking-wider whitespace-nowrap",children:z},z))})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:Z==null?void 0:Z.map((z,ee)=>a.jsxs("tr",{className:"hover:bg-blue-50 transition duration-200 ease-in-out",children:[a.jsx("td",{className:"px-3 md:px-6 py-3 md:py-4 text-sm text-gray-700",children:ee+1}),a.jsx("td",{className:"px-3 md:px-6 py-3 md:py-4",children:a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"block font-semibold text-gray-900",children:z.employee_id||"NA"}),a.jsx("span",{className:"block font-medium text-gray-800",children:z.full_name||"NA"}),a.jsx("span",{className:"block text-xs md:text-sm text-gray-500",children:z.company_email_id||"NA"}),a.jsx("span",{className:"block text-xs md:text-sm text-gray-500",children:z.department||"NA"})]})}),a.jsx("td",{className:"px-3 md:px-6 py-3 md:py-4",children:a.jsx("div",{className:"flex items-center",children:p[z.employee_id]?a.jsx(G_,{className:"h-6 w-6 md:h-8 md:w-8 text-green-500 hover:text-green-600 cursor-pointer transition",onClick:()=>Y(z.employee_id)}):a.jsx(z_,{className:"h-6 w-6 md:h-8 md:w-8 text-gray-400 hover:text-gray-500 cursor-pointer transition",onClick:()=>Y(z.employee_id)})})}),a.jsx("td",{className:"px-3 md:px-6 py-3 md:py-4 text-xs md:text-sm text-gray-700",children:z.business_unit}),a.jsx("td",{className:"px-3 md:px-6 py-3 md:py-4",children:a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"block font-semibold text-gray-900",children:z.hod||"NA"}),a.jsx("span",{className:"block text-xs md:text-sm text-gray-500",children:z.hod_email_id||"NA"})]})}),a.jsx("td",{className:"px-3 md:px-6 py-3 md:py-4",children:a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"block font-semibold text-gray-900",children:z.direct_manager||"NA"}),a.jsx("span",{className:"block text-xs md:text-sm text-gray-500",children:z.direct_manager_email||"NA"})]})}),a.jsx("td",{className:"px-3 md:px-6 py-3 md:py-4",children:a.jsxs("div",{className:"flex space-x-3 md:space-x-4",children:[a.jsx("button",{className:"text-primary hover:text-blue-800 transition",onClick:()=>e(`/employee-list-table/edit-employee/${z._id}`),children:a.jsx(Us,{className:"h-4 w-4 md:h-5 md:w-5"})}),a.jsx("button",{onClick:()=>L(z._id),className:"text-red-600 hover:text-red-800 transition",children:a.jsx($r,{className:"h-4 w-4 md:h-5 md:w-5"})})]})})]},z._id))})]})}),a.jsx(zfe,{currentPage:A,totalPages:G,handlePageChange:oe,itemsPerPage:j,totalItems:i.length})]}),a.jsx(In,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,pauseOnFocusLoss:!0})]})},Wfe=()=>{const e=Sr(),{id:t}=yo(),[r,n]=C.useState({employee_id:"",full_name:"",company_email_id:"",direct_manager:"",direct_manager_email:"",hod:"",hod_email_id:"",department:"",business_unit:""});C.useEffect(()=>{(async()=>{const l=await v$(t);n(l.data)})()},[]);const s=o=>{const{name:l,value:c}=o.target;n(A=>({...A,[l]:c}))},i=async o=>{o.preventDefault();try{const l=await b$(t,r);console.log(l),l.status===200&&(Ie.success("Employee data updated successfully"),setTimeout(()=>{e("/employee-list-table")},1500))}catch{Ie.error("Error adding employee")}};return a.jsxs("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[a.jsx("div",{children:a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Edit Employee"})}),a.jsxs("form",{onSubmit:i,children:[a.jsxs("div",{className:"p-4 border rounded-lg border-primary",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{htmlFor:"employee_id",className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee ID"}),a.jsx("input",{id:"employee_id",name:"employee_id",value:r.employee_id,type:"text",placeholder:"Employee ID (CAP-XXXX)",onChange:s,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"full_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),a.jsx("input",{id:"full_name",name:"full_name",type:"text",placeholder:"Full Name",value:r.full_name,onChange:s,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"company_email_id",className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Email"}),a.jsx("input",{id:"company_email_id",name:"company_email_id",type:"email",placeholder:"Company Email",value:r.company_email_id,onChange:s,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"direct_manager",className:"block text-sm font-medium text-gray-700 mb-1",children:"Direct Manager"}),a.jsx("input",{id:"direct_manager",name:"direct_manager",type:"text",placeholder:"Direct Manager",value:r.direct_manager,onChange:s,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})]})]})]}),a.jsxs("div",{className:"mt-6",children:[a.jsx("h2",{className:"text-lg text-primary mb-2",children:"Management Details"}),a.jsx("div",{className:"p-4 border rounded-lg border-primary",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"direct_manager_email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Manager's Email"}),a.jsx("input",{id:"direct_manager_email",name:"direct_manager_email",type:"email",placeholder:"Manager's Email",value:r.direct_manager_email,onChange:s,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"hod",className:"block text-sm font-medium text-gray-700 mb-1",children:"Head of Department"}),a.jsx("input",{id:"hod",name:"hod",type:"text",placeholder:"Head of Department",value:r.hod,onChange:s,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"hod_email_id",className:"block text-sm font-medium text-gray-700 mb-1",children:"HOD Email"}),a.jsx("input",{id:"hod_email_id",name:"hod_email_id",type:"email",placeholder:"HOD Email",value:r.hod_email_id,onChange:s,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})]})]})})]}),a.jsxs("div",{className:"mt-6",children:[a.jsx("h2",{className:"text-lg text-primary mb-2",children:"Department Details"}),a.jsx("div",{className:"p-4 border rounded-lg border-primary",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"department",className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),a.jsx("input",{id:"department",name:"department",type:"text",placeholder:"Department",value:r.department,onChange:s,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"business_unit",className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Unit"}),a.jsx("input",{id:"business_unit",name:"business_unit",type:"text",placeholder:"Business Unit",value:r.business_unit,onChange:s,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})]})]})})]}),a.jsx("div",{className:"flex justify-end mt-6",children:a.jsx("button",{type:"submit",className:"px-6 py-2 bg-primary text-white rounded hover:bg-primary focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",children:"SUBMIT"})})]}),a.jsx(In,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,pauseOnFocusLoss:!0})]})},Xfe=e=>ri({vendorId:e==="Vendor Management"?St().required("Vendor ID is required for Vendor Management"):St().nullable(),entity:St().required("Entity is required"),category:St().required("Category is required"),vendorName:St().required("Company Name is required"),email:St().email("Invalid email format").required("Email is required"),phone:St().required("Phone Number is required"),billingAddress:St().required("Address is required"),taxNumber:St().required("PAN/Tax Registration/W9 is required"),gstin:St().required("GST is required"),msme:St().required("MSME is required"),bankAccountNumber:St().required("Bank Account Number is required"),ifscSwiftCode:St().required("IFSC/SWIFT CODE is required"),bankName:St().required("Bank Name is required"),hasAgreement:St().required("Agreement/EL selection is required"),natureOfService:St().required("Nature of Service is required"),questionnaireData:ri().when("hasAgreement",([t],r)=>t==="no"?r.shape({counterpartyRequired:St().required("Please select an option"),agreementType:St().required("Please select an option"),serviceType:St().required("Please select an option"),paymentType:St().required("Please select an option")}):r.nullable()),panTaxFile:fl().nullable(),gstFile:fl().nullable(),msmeFile:fl().nullable(),bankProofFile:fl().nullable()}),Yfe=()=>{var K,ae,Z,oe,Y,R,z,ee;const e=Sr(),{id:t}=yo(),r=localStorage.getItem("role"),n=localStorage.getItem("userId"),s=Xfe(r),[i,o]=C.useState(!0),[l,c]=C.useState(""),[A,d]=C.useState(""),[u,f]=C.useState(""),[h,x]=C.useState(""),[m,g]=C.useState(""),[p,v]=C.useState(!1),[w,B]=C.useState(!1),[T,_]=C.useState([]),[j,E]=C.useState(!0),[L,M]=C.useState(!1),F=up({enableReinitialize:!0,validateOnMount:!0,initialValues:{vendorId:"",entity:"",category:"",vendorName:"",email:"",phone:"",billingAddress:"",shippingAddress:"",taxNumber:"",gstin:"",msme:"",bankAccountNumber:"",ifscSwiftCode:"",bankName:"",hasAgreement:"",agreementFile:null,questionnaireData:{counterpartyRequired:"",agreementType:"",serviceType:"",paymentType:""},natureOfService:"",primarySubsidiary:"",panTaxFile:null,gstFile:null,msmeFile:null,bankProofFile:null},validationSchema:s,onSubmit:async b=>{var O,S;try{console.log("Update values",b);const I=new FormData;Object.keys(b).forEach(Q=>{Q==="agreementFile"&&b.agreementFile?I.append("agreementFile",b.agreementFile):Q==="panTaxFile"&&b.panTaxFile?I.append("panTaxFile",b.panTaxFile):Q==="gstFile"&&b.gstFile?I.append("gstFile",b.gstFile):Q==="msmeFile"&&b.msmeFile?I.append("msmeFile",b.msmeFile):Q==="bankProofFile"&&b.bankProofFile?I.append("bankProofFile",b.bankProofFile):Q==="questionnaireData"&&b.hasAgreement==="no"?I.append("questionnaireAnswer",JSON.stringify(b.questionnaireData)):Q!=="agreementFile"&&Q!=="panTaxFile"&&Q!=="gstFile"&&Q!=="msmeFile"&&Q!=="bankProofFile"&&Q!=="questionnaireData"&&I.append(Q,b[Q]||"")});const U=await u$(t,I);console.log("Update response",U),U.status===200?(Ie.success(U.data.message||"Vendor updated successfully"),setTimeout(()=>{e("/vendor-list-table")},1500)):Ie.error("Update failed. Please try again.")}catch(I){console.error("Update failed:",I),Ie.error(((S=(O=I.response)==null?void 0:O.data)==null?void 0:S.message)||"Update failed. Please try again.")}}});C.useEffect(()=>{const b=S=>{if(!S)return"";let I=S.toLowerCase().split(" ").map(U=>U.charAt(0).toUpperCase()+U.slice(1)).join(" ");return I=I.replace(/ Pte\./gi," Pte.").replace(/ Ltd\./gi," Ltd.").replace(/ Inc\./gi," Inc."),I};(async()=>{try{const S=await Zf(n);if(S.data){const I=S.data.entities?S.data.entities.map(U=>{const Q=b(U.entityName);return{...U,displayName:Q,originalName:U.entityName}}).sort((U,Q)=>U.displayName.localeCompare(Q.displayName)):[];_(I)}}catch(S){console.error("Error fetching entities:",S),Ie.error("Failed to load entities")}finally{E(!1)}})()},[]),C.useEffect(()=>{console.log("Current form values:",F.values),console.log("Entities:",T),console.log("Vendor data loaded:",L)},[F.values,T,L]),C.useEffect(()=>{if(L&&F.values.entity){const b=F.values.entity.trim();if(console.log("Current entity from vendor data:",b),T.length>0){const O=T.find(S=>S.entityName===b||S.entityName.toLowerCase()===b.toLowerCase()||S.originalName&&S.originalName.toLowerCase()===b.toLowerCase());O?(console.log("Found matching entity:",O),F.setFieldValue("entity",O.entityName,!1)):(console.log("Adding vendor entity to dropdown:",b),_(S=>[...S,{_id:`vendor-${Date.now()}`,entityName:b,displayName:b,originalName:b}]))}}},[L,T,F.values.entity]),C.useEffect(()=>{t&&(async()=>{try{o(!0);const O=await d$(t);if(console.log("Response Vendor Data:",O),O.status===200){const S=O.data;S.agreementFileName&&c(S.agreementFileName),S.panTaxFileName&&d(S.panTaxFileName),S.gstFileName&&f(S.gstFileName),S.msmeFileName&&x(S.msmeFileName),S.bankProofFileName&&g(S.bankProofFileName);let I={counterpartyRequired:"",agreementType:"",serviceType:"",paymentType:""};if(S.questionnaireAnswer)try{I=JSON.parse(S.questionnaireAnswer)}catch(Q){console.error("Failed to parse questionnaire data:",Q)}else S.questionnaireData&&(I=S.questionnaireData);F.setValues({vendorId:S.vendorId||"",entity:S.entity||"",category:S.category||"",vendorName:S.vendorName||"",email:S.email||"",phone:S.phone||"",billingAddress:S.billingAddress||"",shippingAddress:S.shippingAddress||"",taxNumber:S.taxNumber||"",gstin:S.gstin||"",msme:S.msme||"",bankAccountNumber:S.bankAccountNumber||"",ifscSwiftCode:S.ifscSwiftCode||"",bankName:S.bankName||"",hasAgreement:S.hasAgreement||"",agreementFile:null,questionnaireData:I,natureOfService:S.natureOfService||"",primarySubsidiary:S.primarySubsidiary||"",panTaxFile:null,gstFile:null,msmeFile:null,bankProofFile:null});const U=!!S.vendorId;r!=="Vendor Management"&&B(U),M(!0)}else Ie.error("Failed to fetch vendor data")}catch(O){console.error("Failed to fetch Vendor Data:",O),Ie.error("Error fetching vendor data")}finally{o(!1)}})()},[t]);const D=b=>{const O=b.target.files[0];O&&(F.setFieldValue("agreementFile",O),c(""))},G=(b,O,S)=>{const I=b.target.files[0];if(I){if(I.size>10485760){Ie.error("File size should not exceed 10MB"),b.target.value="";return}if(!["application/pdf","image/jpeg","image/jpg","image/png","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(I.type)){Ie.error("Only PDF, DOC, DOCX, JPG, JPEG, and PNG files are allowed"),b.target.value="";return}F.setFieldValue(O,I),S("")}};return i?a.jsx("div",{className:"flex justify-center items-center h-screen",children:a.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-primary"})}):a.jsxs("form",{onSubmit:F.handleSubmit,className:"max-w-6xl bg-white mx-auto p-6 space-y-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Edit Vendor"}),a.jsx("div",{className:"p-4 border rounded-lg border-primary",children:r==="Vendor Management"?a.jsxs("div",{className:"mb-4",children:[a.jsxs("label",{htmlFor:"vendorId",className:"block mb-2 font-medium text-gray-700",children:["Vendor ID ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"vendorId",placeholder:"Enter Vendor ID (Required)",value:F.values.vendorId,onChange:F.handleChange,onBlur:F.handleBlur,className:`w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary ${F.touched.vendorId&&F.errors.vendorId?"border-red-500":""}`}),F.touched.vendorId&&F.errors.vendorId&&a.jsx("span",{className:"text-red-500 text-sm",children:F.errors.vendorId}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Vendor ID is mandatory for Vendor Management users"})]}):a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:w,onChange:b=>{B(b.target.checked),b.target.checked||F.setFieldValue("vendorId","")},className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Add Vendor ID (Optional)"}),a.jsxs("div",{className:"ml-2 relative",onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),children:[a.jsx("i",{className:"fas fa-info-circle text-gray-400 cursor-help"}),p&&a.jsx("div",{className:"absolute z-10 left-0 mt-2 w-64 p-2 bg-gray-800 text-white text-xs rounded shadow-lg",children:"Toggle to add a Vendor ID if available. This field is optional."})]})]}),w&&a.jsxs("div",{className:"mt-2",children:[a.jsx("input",{type:"text",name:"vendorId",placeholder:"Enter Vendor ID",value:F.values.vendorId,onChange:F.handleChange,onBlur:F.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),F.touched.vendorId&&F.errors.vendorId&&a.jsx("span",{className:"text-red-500 text-sm",children:F.errors.vendorId})]})]})}),a.jsxs("div",{className:"p-4 border rounded-lg border-primary",children:[a.jsx("h3",{className:"text-lg font-semibold text-primary mb-4",children:"Basic Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"entity",className:"block mb-2 font-medium",children:["Entity ",a.jsx("span",{className:"text-red-500",children:"*"})]}),j?a.jsx("select",{className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary text-gray-500",disabled:!0,children:a.jsx("option",{children:"Loading entities..."})}):a.jsxs("select",{name:"entity",value:F.values.entity||"",onChange:b=>{console.log("Selected entity:",b.target.value),F.handleChange(b)},onBlur:F.handleBlur,className:`w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary ${F.touched.entity&&F.errors.entity?"border-red-500":"border-gray-300"}`,children:[a.jsx("option",{value:"",children:"Select an entity"}),T.map(b=>a.jsx("option",{value:b.entityName,children:b.displayName||b.entityName},b._id||`entity-${b.entityName}`))]}),F.touched.entity&&F.errors.entity&&a.jsx("span",{className:"text-red-500 text-sm",children:F.errors.entity})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"category",className:"block mb-2 font-medium",children:["Category ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"category",placeholder:"Enter Category",value:F.values.category,onChange:F.handleChange,onBlur:F.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),F.touched.category&&F.errors.category&&a.jsx("span",{className:"text-red-500 text-sm",children:F.errors.category})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"vendorName",className:"block mb-2 font-medium",children:["Company Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"vendorName",placeholder:"Enter Company Name",value:F.values.vendorName,onChange:F.handleChange,onBlur:F.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),F.touched.vendorName&&F.errors.vendorName&&a.jsx("span",{className:"text-red-500 text-sm",children:F.errors.vendorName})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"email",className:"block mb-2 font-medium",children:["Email-ID ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"email",name:"email",placeholder:"Enter Email",value:F.values.email,onChange:F.handleChange,onBlur:F.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),F.touched.email&&F.errors.email&&a.jsx("span",{className:"text-red-500 text-sm",children:F.errors.email})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"phone",className:"block mb-2 font-medium",children:["Phone Number ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"tel",name:"phone",placeholder:"Enter Phone Number",value:F.values.phone,onChange:F.handleChange,onBlur:F.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),F.touched.phone&&F.errors.phone&&a.jsx("span",{className:"text-red-500 text-sm",children:F.errors.phone})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"natureOfService",className:"block mb-2 font-medium",children:["Nature of Service ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"natureOfService",placeholder:"Enter Nature of Service",value:F.values.natureOfService,onChange:F.handleChange,onBlur:F.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),F.touched.natureOfService&&F.errors.natureOfService&&a.jsx("span",{className:"text-red-500 text-sm",children:F.errors.natureOfService})]})]})]}),a.jsxs("div",{className:"p-4 border rounded-lg border-primary",children:[a.jsx("h3",{className:"text-lg font-semibold text-primary mb-4",children:"Address Details"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"billingAddress",className:"block mb-2 font-medium",children:["Address ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{name:"billingAddress",placeholder:"Enter Address",value:F.values.billingAddress,onChange:F.handleChange,onBlur:F.handleBlur,rows:"3",className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),F.touched.billingAddress&&F.errors.billingAddress&&a.jsx("span",{className:"text-red-500 text-sm",children:F.errors.billingAddress})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"shippingAddress",className:"block mb-2 font-medium",children:"Shipping Address"}),a.jsx("textarea",{name:"shippingAddress",placeholder:"Enter Shipping Address",value:F.values.shippingAddress,onChange:F.handleChange,rows:"3",className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})]})]})]}),a.jsxs("div",{className:"p-4 border rounded-lg border-primary",children:[a.jsx("h3",{className:"text-lg font-semibold text-primary mb-4",children:"Tax & Registration Details"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"taxNumber",className:"block mb-2 font-medium",children:["PAN/Tax Registration/W9 ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"taxNumber",placeholder:"Enter PAN/Tax Registration/W9",value:F.values.taxNumber,onChange:F.handleChange,onBlur:F.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),F.touched.taxNumber&&F.errors.taxNumber&&a.jsx("span",{className:"text-red-500 text-sm",children:F.errors.taxNumber})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"gstin",className:"block mb-2 font-medium",children:["GST ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"gstin",placeholder:"Enter GST Number",value:F.values.gstin,onChange:F.handleChange,onBlur:F.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),F.touched.gstin&&F.errors.gstin&&a.jsx("span",{className:"text-red-500 text-sm",children:F.errors.gstin})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"msme",className:"block mb-2 font-medium",children:["MSME ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"msme",placeholder:"Enter MSME Number",value:F.values.msme,onChange:F.handleChange,onBlur:F.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),F.touched.msme&&F.errors.msme&&a.jsx("span",{className:"text-red-500 text-sm",children:F.errors.msme})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"primarySubsidiary",className:"block mb-2 font-medium",children:"Primary Subsidiary"}),a.jsx("input",{type:"text",name:"primarySubsidiary",placeholder:"Enter Primary Subsidiary",value:F.values.primarySubsidiary,onChange:F.handleChange,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})]})]})]}),r!=="Vendor Management"&&a.jsxs("div",{className:"p-4 border rounded-lg border-primary",children:[a.jsx("h3",{className:"text-lg font-semibold text-primary mb-4",children:"Document Uploads"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"panTaxFile",className:"block mb-2 font-medium",children:"Upload PAN / TAX / W9 file"}),A&&a.jsxs("div",{className:"mb-2 p-2 bg-blue-50 border border-blue-200 rounded",children:[a.jsxs("p",{className:"text-sm text-blue-800",children:["Current file: ",a.jsx("span",{className:"font-semibold",children:A})]}),a.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Upload a new file to replace the existing one"})]}),a.jsx("input",{type:"file",name:"panTaxFile",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:b=>G(b,"panTaxFile",d),onBlur:F.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),F.values.panTaxFile&&a.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["New file selected: ",F.values.panTaxFile.name]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Supported formats: PDF, DOC, DOCX, JPG, PNG (Max: 10MB)"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"gstFile",className:"block mb-2 font-medium",children:"Upload GST file"}),u&&a.jsxs("div",{className:"mb-2 p-2 bg-blue-50 border border-blue-200 rounded",children:[a.jsxs("p",{className:"text-sm text-blue-800",children:["Current file: ",a.jsx("span",{className:"font-semibold",children:u})]}),a.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Upload a new file to replace the existing one"})]}),a.jsx("input",{type:"file",name:"gstFile",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:b=>G(b,"gstFile",f),onBlur:F.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),F.values.gstFile&&a.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["New file selected: ",F.values.gstFile.name]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Supported formats: PDF, DOC, DOCX, JPG, PNG (Max: 10MB)"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"msmeFile",className:"block mb-2 font-medium",children:"Upload MSME file"}),h&&a.jsxs("div",{className:"mb-2 p-2 bg-blue-50 border border-blue-200 rounded",children:[a.jsxs("p",{className:"text-sm text-blue-800",children:["Current file: ",a.jsx("span",{className:"font-semibold",children:h})]}),a.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Upload a new file to replace the existing one"})]}),a.jsx("input",{type:"file",name:"msmeFile",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:b=>G(b,"msmeFile",x),onBlur:F.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),F.values.msmeFile&&a.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["New file selected: ",F.values.msmeFile.name]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Supported formats: PDF, DOC, DOCX, JPG, PNG (Max: 10MB)"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"bankProofFile",className:"block mb-2 font-medium",children:"Upload bank account proof"}),m&&a.jsxs("div",{className:"mb-2 p-2 bg-blue-50 border border-blue-200 rounded",children:[a.jsxs("p",{className:"text-sm text-blue-800",children:["Current file: ",a.jsx("span",{className:"font-semibold",children:m})]}),a.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Upload a new file to replace the existing one"})]}),a.jsx("input",{type:"file",name:"bankProofFile",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:b=>G(b,"bankProofFile",g),onBlur:F.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),F.values.bankProofFile&&a.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["New file selected: ",F.values.bankProofFile.name]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Supported formats: PDF, DOC, DOCX, JPG, PNG (Max: 10MB)"})]})]})]}),a.jsxs("div",{className:"p-4 border rounded-lg border-primary",children:[a.jsx("h3",{className:"text-lg font-semibold text-primary mb-4",children:"Bank Details"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"bankAccountNumber",className:"block mb-2 font-medium",children:["Bank Account Number ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"bankAccountNumber",placeholder:"Enter Bank Account Number",value:F.values.bankAccountNumber,onChange:F.handleChange,onBlur:F.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),F.touched.bankAccountNumber&&F.errors.bankAccountNumber&&a.jsx("span",{className:"text-red-500 text-sm",children:F.errors.bankAccountNumber})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"ifscSwiftCode",className:"block mb-2 font-medium",children:["IFSC/SWIFT CODE ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"ifscSwiftCode",placeholder:"Enter IFSC/SWIFT CODE",value:F.values.ifscSwiftCode,onChange:F.handleChange,onBlur:F.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),F.touched.ifscSwiftCode&&F.errors.ifscSwiftCode&&a.jsx("span",{className:"text-red-500 text-sm",children:F.errors.ifscSwiftCode})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"bankName",className:"block mb-2 font-medium",children:["Bank Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"bankName",placeholder:"Enter Bank Name",value:F.values.bankName,onChange:F.handleChange,onBlur:F.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),F.touched.bankName&&F.errors.bankName&&a.jsx("span",{className:"text-red-500 text-sm",children:F.errors.bankName})]})]})]}),a.jsxs("div",{className:"p-4 border rounded-lg border-primary",children:[a.jsx("h3",{className:"text-lg font-semibold text-primary mb-4",children:"Agreement/EL"}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("label",{className:"block mb-2 font-medium",children:["Do you have an Agreement/EL? ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"flex gap-6",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"hasAgreement",value:"yes",checked:F.values.hasAgreement==="yes",onChange:F.handleChange,onBlur:F.handleBlur,className:"mr-2"}),"Yes"]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"hasAgreement",value:"no",checked:F.values.hasAgreement==="no",onChange:F.handleChange,onBlur:F.handleBlur,className:"mr-2"}),"No"]})]}),F.touched.hasAgreement&&F.errors.hasAgreement&&a.jsx("span",{className:"text-red-500 text-sm",children:F.errors.hasAgreement})]}),F.values.hasAgreement==="yes"&&a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"agreementFile",className:"block mb-2 font-medium",children:["Upload Agreement File ",!l&&a.jsx("span",{className:"text-red-500",children:"*"})]}),l&&a.jsxs("div",{className:"mb-2 p-2 bg-blue-50 border border-blue-200 rounded",children:[a.jsxs("p",{className:"text-sm text-blue-800",children:["Current file: ",a.jsx("span",{className:"font-semibold",children:l})]}),a.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Upload a new file to replace the existing one"})]}),a.jsx("input",{type:"file",name:"agreementFile",accept:".pdf,.doc,.docx",onChange:D,onBlur:F.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),F.values.agreementFile&&a.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["New file selected: ",F.values.agreementFile.name]}),F.touched.agreementFile&&F.errors.agreementFile&&!l&&a.jsx("span",{className:"text-red-500 text-sm",children:F.errors.agreementFile})]}),F.values.hasAgreement==="no"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("p",{className:"block mb-2 font-medium",children:["1. Is the agreement required by the counterparty? ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:"flex gap-6",children:["Yes","No"].map(b=>{var O;return a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"questionnaireData.counterpartyRequired",value:b,checked:((O=F.values.questionnaireData)==null?void 0:O.counterpartyRequired)===b,onChange:S=>{F.setFieldValue("questionnaireData",{...F.values.questionnaireData,counterpartyRequired:b})},onBlur:()=>F.setFieldTouched("questionnaireData.counterpartyRequired",!0),className:"mr-2"}),b]},b)})}),((K=F.touched.questionnaireData)==null?void 0:K.counterpartyRequired)&&((ae=F.errors.questionnaireData)==null?void 0:ae.counterpartyRequired)&&a.jsx("span",{className:"text-red-500 text-sm",children:F.errors.questionnaireData.counterpartyRequired})]}),a.jsxs("div",{children:[a.jsxs("p",{className:"block mb-2 font-medium",children:["2. Does the agreement have an auto-renewal clause or a fixed tenure? ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:"flex gap-6",children:["Auto-renewal","Fixed tenure"].map(b=>{var O;return a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"questionnaireData.agreementType",value:b,checked:((O=F.values.questionnaireData)==null?void 0:O.agreementType)===b,onChange:S=>{F.setFieldValue("questionnaireData",{...F.values.questionnaireData,agreementType:b})},onBlur:()=>F.setFieldTouched("questionnaireData.agreementType",!0),className:"mr-2"}),b]},b)})}),((Z=F.touched.questionnaireData)==null?void 0:Z.agreementType)&&((oe=F.errors.questionnaireData)==null?void 0:oe.agreementType)&&a.jsx("span",{className:"text-red-500 text-sm",children:F.errors.questionnaireData.agreementType})]}),a.jsxs("div",{children:[a.jsxs("p",{className:"block mb-2 font-medium",children:["3. Is this a one-time or recurring service? ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:"flex gap-6",children:["One-time","Recurring"].map(b=>{var O;return a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"questionnaireData.serviceType",value:b,checked:((O=F.values.questionnaireData)==null?void 0:O.serviceType)===b,onChange:S=>{F.setFieldValue("questionnaireData",{...F.values.questionnaireData,serviceType:b})},onBlur:()=>F.setFieldTouched("questionnaireData.serviceType",!0),className:"mr-2"}),b]},b)})}),((Y=F.touched.questionnaireData)==null?void 0:Y.serviceType)&&((R=F.errors.questionnaireData)==null?void 0:R.serviceType)&&a.jsx("span",{className:"text-red-500 text-sm",children:F.errors.questionnaireData.serviceType})]}),a.jsxs("div",{children:[a.jsxs("p",{className:"block mb-2 font-medium",children:["4. Is the payment a one-time transaction or a recurring payment? ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:"flex gap-6",children:["One-time","Recurring"].map(b=>{var O;return a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"questionnaireData.paymentType",value:b,checked:((O=F.values.questionnaireData)==null?void 0:O.paymentType)===b,onChange:S=>{F.setFieldValue("questionnaireData",{...F.values.questionnaireData,paymentType:b})},onBlur:()=>F.setFieldTouched("questionnaireData.paymentType",!0),className:"mr-2"}),b]},b)})}),((z=F.touched.questionnaireData)==null?void 0:z.paymentType)&&((ee=F.errors.questionnaireData)==null?void 0:ee.paymentType)&&a.jsx("span",{className:"text-red-500 text-sm",children:F.errors.questionnaireData.paymentType})]})]})]}),a.jsx("div",{className:"p-4 text-end",children:a.jsx("button",{type:"submit",className:"px-6 py-2 bg-primary text-white rounded hover:bg-primary-dark disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:F.isSubmitting||!F.isValid,children:F.isSubmitting?"Updating...":"Update Vendor"})}),a.jsx(In,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,pauseOnFocusLoss:!0})]})},DD=(e,t,r)=>{const[n,s]=C.useState(null),[i,o]=C.useState([]),[l,c]=C.useState([]),[A,d]=C.useState(!0),[u,f]=C.useState(!1),[h,x]=C.useState(null),m=async()=>{try{d(!0),x(null);const D=await FI(e);if(D.status===200)s(D.data.data),c(D.data.requestorLog);else throw new Error("Failed to fetch request data")}catch(D){console.error("Error fetching request:",D),x(D.message||"Failed to fetch request data")}finally{d(!1)}},g=async()=>{try{const D=await mo();D.status===200&&o(D.data.data)}catch(D){console.error("Error fetching currencies:",D)}},p=async()=>{if(!(!t||!e||!r))try{const D=await U$(t,e,r);D.status===200&&f(D.data.isDisplay)}catch(D){console.error("Error checking approval permission:",D)}},v=(D,G=null)=>{var Z;if(!i.length||!D)return"N/A";const K=G||((Z=n==null?void 0:n.supplies)==null?void 0:Z.selectedCurrency),ae=i.find(oe=>oe.code===K);if(!ae)return`${D} ${K||""}`;try{return new Intl.NumberFormat(ae.locale,{style:"currency",currency:ae.code,minimumFractionDigits:2,maximumFractionDigits:2}).format(D)}catch{return`${D} ${ae.code}`}},w=async()=>{await m(),await p()},B=D=>{s(G=>({...G,status:D}))},T=D=>{s(G=>({...G,approvals:[...G.approvals||[],D]}))};C.useEffect(()=>{e&&m()},[e]),C.useEffect(()=>{g()},[]),C.useEffect(()=>{p()},[t,e,r,u]);const _=!!n,j=!u&&r!=="Employee",E=(n==null?void 0:n.status)==="Pending",L=(n==null?void 0:n.status)==="Approved",M=(n==null?void 0:n.status)==="Rejected",F=(n==null?void 0:n.status)==="Hold";return{request:n,currencies:i,reqLogs:l,isLoading:A,isDisabled:u,error:h,isRequestLoaded:_,canApprove:j,isPending:E,isApproved:L,isRejected:M,isOnHold:F,refreshRequestData:w,updateRequestStatus:B,addApprovalLog:T,formatCurrency:v,setRequest:s,setCurrencies:o,setReqLogs:c,setIsDisabled:f}},Jfe=async(e,t,r,n,s,i)=>{try{console.log(`User ID: ${e}, Role: ${t}, Request ID: ${r} reason ${i}`);let o;switch(t){case"Admin":console.log("Approving for HOD"),o=await rS(e,t,r,n,s,i);break;case"HOD Department":console.log("Approving for HOD"),o=await rS(e,t,r,n,s,i);break;case"Business Finance":console.log("Approving for Business Finance"),o=await D$(e,t,r,n,s,i);break;case"Vendor Management":console.log("Approving for Vendor Management"),o=await P$(e,t,r,n,s,i);break;case"Legal Team":console.log("Approving for Legal Team"),o=await O$(e,t,r,n,s,i);break;case"Info Security":console.log("Approving for Info Security"),o=await R$(e,t,r,n,s,i);break;case"PO Team":console.log("Approving for PO Team"),o=await Q$(e,t,r,n,s,i);break;case"Head of Finance":console.log("Approving for HOF"),o=await M$(e,t,r,n,s,i);break;default:console.log(`Unknown role: ${t}`),o={status:"error",message:"Invalid role specified"}}return o}catch(o){return console.error("Error in approve request",o),{status:"error",message:"An error occurred during approval",error:o}}},PD=(e,t,r,n)=>{const[s,i]=C.useState(!1),[o,l]=C.useState(!1),[c,A]=C.useState(!1),[d,u]=C.useState("");return{isLoading:s,isUploading:o,isGeneratingPDF:c,loadingAction:d,isAnyActionInProgress:s||o||c,approveRequest:async(B,T,_="")=>{var j,E;i(!0),u(`${T.toLowerCase()}ing`);try{const L=await Jfe(e,t,B,T,r,_);if(L.status===200)return Ie.success(L.data.message),{success:!0,message:L.data.message};if(L.status===400)return Ie.info(L.response.data.message),{success:!1,message:L.response.data.message};if(L.status===401)return Ie.info(L.response.data.message),{success:!1,message:L.response.data.message}}catch(L){console.error("Error in approving the request",L);const M=((E=(j=L.response)==null?void 0:j.data)==null?void 0:E.message)||"Invalid workflow order";return Ie.error(M),{success:!1,message:M}}finally{i(!1),u("")}},handleRelease:async(B,T)=>{i(!0),u("releasing");try{const _=await V$(T,n,e,B,t,r);return _.status===200?(Ie.success(_.data.message),{success:!0,message:_.data.message}):(Ie.error("Something went wrong"),{success:!1,message:"Something went wrong"})}catch(_){console.error("Error:",_);const j="An error occurred while processing your request";return Ie.error(j),{success:!1,message:j}}finally{i(!1),u("")}},sendReminderNotification:async B=>{i(!0),u("sending reminder");try{return(await k$(B)).status===200?(Ie.success("Notification sent successfully!"),{success:!0,message:"Notification sent successfully!"}):(Ie.error("Failed to send notification."),{success:!1,message:"Failed to send notification."})}catch(T){console.error("Error:",T);const _="An error occurred while sending the notification.";return Ie.error(_),{success:!1,message:_}}finally{i(!1),u("")}},uploadPODocument:async(B,T,_,j)=>{var E;if(!_)return Ie.error("Please select a file to upload"),{success:!1,message:"No file selected"};l(!0),u("uploading PO");try{const L=await Ac(_,"PO-Documents",T);if(!((E=L.data.fileUrls)!=null&&E[0]))throw new Error("File upload failed");const M=await q$(e,B,L.data.fileUrls[0],j);if(M.status===200)return Ie.success(M.data.message),{success:!0,message:M.data.message,fileUrl:L.data.fileUrls[0]};throw new Error("Failed to add PO document reference")}catch(L){console.error("PO upload error:",L);const M=L.message||"Failed to upload PO";return Ie.error(M),{success:!1,message:M}}finally{l(!1),u("")}},uploadInvoiceDocument:async(B,T,_,j)=>{var E;if(!_)return Ie.error("Please select a file to upload"),{success:!1,message:"No file selected"};l(!0),u("uploading invoice");try{const L=await Ac(_,"Invoice-Documents",T);if(!((E=L.data.fileUrls)!=null&&E[0]))throw new Error("File upload failed");const M=await K$(e,B,L.data.fileUrls[0],j);if(M.status===200)return Ie.success(M.data.message),{success:!0,message:M.data.message,fileUrl:L.data.fileUrls[0]};throw new Error("Failed to add invoice document reference")}catch(L){console.error("Invoice upload error:",L);const M=L.message||"Failed to upload invoice";return Ie.error(M),{success:!1,message:M}}finally{l(!1),u("")}},setPDFGenerating:B=>{A(B),B?u("generating PDF"):d==="generating PDF"&&u("")},getLoadingMessage:()=>({approving:"Approving request...",rejecting:"Rejecting request...",holding:"Putting request on hold...",releasing:"Releasing request...","sending reminder":"Sending reminder...","uploading PO":"Uploading PO document...","uploading invoice":"Uploading invoice document...","generating PDF":"Generating PDF..."})[d]||"Processing..."}},Ov=e=>{const t=new Date(e),r=t.getDate(),n=t.toLocaleString("en-US",{month:"short"}),s=t.getFullYear(),i=t.getHours().toString().padStart(2,"0"),o=t.getMinutes().toString().padStart(2,"0"),l=t.getSeconds().toString().padStart(2,"0");return`${r} ${n} ${s}, ${i}:${o}:${l}`},OD=({request:e,currencies:t})=>{const r=d=>{const u=t.find(f=>f.code===e.supplies.selectedCurrency);return!u||!d?"N/A":new Intl.NumberFormat(u.locale,{style:"currency",currency:u.code,minimumFractionDigits:2,maximumFractionDigits:2}).format(d)},n=(d,u)=>`
          <div class="info-box">
            <div class="info-label">${d}</div>
            <div class="info-value">${u||"N/A"}</div>
          </div>
        `,s=(d,u)=>{const f=`
          <style>
            body { font-family: Arial, sans-serif; margin: 0; padding: 5px; }
            .section-container { max-width: 210mm; margin: 0 auto; }
            .header { display: flex; justify-content: space-between; border-bottom: 2px solid #80c242; padding-bottom: 15px; margin-bottom: 25px; }
            h1 { color: #80c242; font-size: 24px; margin: 0; }
            h2 { color: #80c242; font-size: 20px; border-bottom: 1px solid #e5e7eb; padding-bottom: 10px; margin-top: 30px; margin-bottom: 20px; }
            .info-box { background-color: #f9fafb; border-radius: 8px; padding: 15px; margin-bottom: 15px; border-left: 4px solid #80c242; }
            .info-label { color: #4b5563; font-weight: 600; margin-bottom: 6px; }
            .info-value { color: #1f2937; font-weight: 500; }
            table { width: 100%; border-collapse: collapse; margin-top: 20px; margin-bottom: 25px; }
            th { background-color: #eef7e6; color: #3d611f; padding: 12px; text-align: left; font-weight: 600; }
            td { padding: 12px; border-bottom: 1px solid #e5e7eb; }
            .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px; }
            .grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 20px; }
            .status-approved { background-color: #d1fae5; color: #065f46; border-radius: 12px; padding: 4px 10px; font-size: 12px; font-weight: 600; }
            .status-rejected { background-color: #fee2e2; color: #b91c1c; border-radius: 12px; padding: 4px 10px; font-size: 12px; font-weight: 600; }
            .status-pending { background-color: #fef3c7; color: #92400e; border-radius: 12px; padding: 4px 10px; font-size: 12px; font-weight: 600; }
            .remarks-box { background-color: #f3f4f6; border-radius: 6px; padding: 10px; margin-top: 8px; font-size: 13px; }
          </style>
        `,h=`
          <div class="header">
            <div>
              <h1>${u}</h1>
              <p>Request ID: ${e.reqid||"N/A"}</p>
            </div>
            <div>
              <p>Generated: ${new Date().toLocaleDateString()}</p>
            </div>
          </div>
        `;let x="";switch(d){case"commercial-details":x=i();break;case"procurement-details":x=o();break;case"supplies-details":x=l();break;case"compliance-details":x=c();break;case"approval-logs":x=A();break;default:x="<p>No content available</p>"}return`
          <div class="section-container">
            ${f}
            ${h}
            ${x}
          </div>
        `},i=()=>{var u,f,h;if(!e||!e.commercials)return"<p>No commercial details available</p>";let d=`
          <div class="section-content">
            <h2>Commercials</h2>
            <div class="grid-3">
              ${n("Request ID",e.reqid)}
              ${n("Business Unit",e.commercials.businessUnit)}
              ${n("Created At",Ov(e.createdAt))}
            </div>
            
            <div class="grid-3">
              ${n("Entity",e.commercials.entity)}
              ${n("City",e.commercials.city)}
              ${n("Site",e.commercials.site)}
            </div>
            
            <div class="grid-2">
              ${n("Department",e.commercials.department)}
              ${n("Head of Department",e.commercials.hod)}
            </div>
            
            <div class="grid-2">
              ${n("Bill To",e.commercials.billTo)}
              ${n("Ship To",e.commercials.shipTo)}
            </div>
        `;return(u=e.commercials)!=null&&u.additionalApprover&&(d+=`
            <h2>Additional Approver Information</h2>
            <div class="grid-3">
                ${n("Approver ID",e.commercials.additionalApprover)}
                ${n("Approver Name",e.commercials.additionalApproverName||"N/A")}
                ${n("Approver Email",e.commercials.additionalApproverEmail||"N/A")}
            </div>
            ${e.commercials.additionalApproverProof&&e.commercials.additionalApproverProof.length>0?`
                <div class="info-box">
                    <div class="info-label">Proof Documents</div>
                    <div class="info-value"> ${e.commercials.additionalApproverProof.length} document(s) uploaded</div>
                </div>
            `:""}
        `),((h=(f=e.commercials)==null?void 0:f.paymentTerms)==null?void 0:h.length)>0&&(d+=`
            <h2>Payment Terms</h2>
            <table>
              <thead>
                <tr>
                  <th>Percentage</th>
                  <th>Payment Term</th>
                  <th>Type</th>
                </tr>
              </thead>
              <tbody>
                ${e.commercials.paymentTerms.map(x=>`
                  <tr>
                    <td>${x.percentageTerm}%</td>
                    <td>${(x.paymentTerm||"").toLowerCase()}${x.customPaymentTerm?` - ${x.customPaymentTerm.toLowerCase()}`:""}</td>
                    <td>${(x.paymentType||"").toLowerCase()}${x.customPaymentType?` - ${x.customPaymentType.toLowerCase()}`:""}</td>
                  </tr>
                `).join("")}
              </tbody>
            </table>
          `),d+="</div>",d},o=()=>{var u;if(!e||!e.procurements)return"<p>No procurement details available</p>";let d=`
          <div class="section-content">
            <h2>Vendor Information</h2>
            <div class="grid-2">
              ${n("Vendor ID",e.procurements.vendor)}
              ${n("Vendor Name",e.procurements.vendorName)}
            </div>
            
            <div class="grid-2">
              ${n("Quotation Number",e.procurements.quotationNumber)}
              ${n("Quotation Date",e.procurements.quotationDate?so(e.procurements.quotationDate):"N/A")}
            </div>
            
            <div class="grid-3">
              ${n("Service Period",e.procurements.servicePeriod)}
              ${n("PO Valid From",e.procurements.poValidFrom?so(e.procurements.poValidFrom):"N/A")}
              ${n("PO Valid To",e.procurements.poValidTo?so(e.procurements.poValidTo):"N/A")}
            </div>
        `;return(u=e.procurements)!=null&&u.uploadedFiles&&e.procurements.uploadedFiles.length>0?(d+="<h2>Uploaded Files & Agreement Details</h2>",e.procurements.uploadedFiles.forEach((f,h)=>{Object.entries(f).forEach(([x,m])=>{m&&(m.urls||m.agreementValidFrom||m.agreementValidTo)&&(d+=`
                        <div class="info-box" style="margin-bottom: 20px;">
                            <h3 style="color: #80c242; margin-top: 0; margin-bottom: 15px; text-transform: capitalize;">
                                ${x.replace(/_/g," ")}
                            </h3>
                            
                            ${m.agreementValidFrom||m.agreementValidTo?`
                                <div class="grid-2" style="margin-bottom: 15px;">
                                    ${m.agreementValidFrom?n("Agreement Valid From",so(m.agreementValidFrom)):""}
                                    ${m.agreementValidTo?n("Agreement Valid To",so(m.agreementValidTo)):""}
                                </div>
                            `:""}
                            
                            ${m.urls&&m.urls.length>0?`
                                <div class="info-value" style="color: #80c242;">
                                     ${m.urls.length} file(s) uploaded successfully
                                </div>
                            `:`
                                <div class="info-value" style="color: #666;">
                                    No files uploaded for this category
                                </div>
                            `}
                        </div>
                    `)})})):d+=`
            <h2>Uploaded Files</h2>
            <div class="info-box">
                <p class="info-value">No files uploaded</p>
            </div>
        `,d+="</div>",d},l=()=>{var u,f,h,x;if(!e||!e.supplies)return"<p>No product/services details available</p>";let d='<div class="section-content" style="max-width: 100%; margin: 0;">';return((f=(u=e.supplies)==null?void 0:u.services)==null?void 0:f.length)>0&&(d+=`
            <h2>Products and Services</h2>
            <div style="width: 100%;">
                <table style="width: 100%; border-collapse: collapse; table-layout: fixed; font-size: 9px;">
                    <thead>
                        <tr style="background-color: rgba(128, 194, 66, 0.1);">
                            <th style="padding: 6px; text-align: left; width: 13%; border: 1px solid #ddd;">Product Name</th>
                            <th style="padding: 6px; text-align: left; width: 22%; border: 1px solid #ddd;">Description</th>
                            <th style="padding: 6px; text-align: left; width: 13%; border: 1px solid #ddd;">Purpose</th>
                            <th style="padding: 6px; text-align: center; width: 8%; border: 1px solid #ddd;">Quantity</th>
                            <th style="padding: 6px; text-align: right; width: 10%; border: 1px solid #ddd;">Price</th>
                            <th style="padding: 6px; text-align: center; width: 7%; border: 1px solid #ddd;">Tax (%)</th>
                            <th style="padding: 6px; text-align: right; width: 12%; border: 1px solid #ddd;">Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${e.supplies.services.map(m=>{const g=parseFloat(m.quantity)||0,p=parseFloat(m.price)||0,v=parseFloat(m.tax)||0,w=g*p*(1+v/100),B=(T,_=60)=>T?T.length>_?T.substring(0,_)+"...":T:"N/A";return`
                            <tr style="border-bottom: 1px solid #eee;">
                                <td style="padding: 6px; word-wrap: break-word; overflow-wrap: break-word; max-width: 100%; border: 1px solid #ddd;">
                                    ${B(m.productName,40)||"N/A"}
                                </td>
                                <td style="padding: 6px; word-wrap: break-word; overflow-wrap: break-word; max-width: 100%; border: 1px solid #ddd;">
                                    ${B(m.productDescription,80)||"N/A"}
                                </td>
                                <td style="padding: 6px; word-wrap: break-word; overflow-wrap: break-word; max-width: 100%; border: 1px solid #ddd;">
                                    ${B(m.productPurpose,40)||"N/A"}
                                </td>
                                <td style="padding: 6px; text-align: center; border: 1px solid #ddd;">
                                    ${m.quantity}
                                </td>
                                <td style="padding: 6px; text-align: right; border: 1px solid #ddd;">
                                    ${r(m.price)}
                                </td>
                                <td style="padding: 6px; text-align: center; border: 1px solid #ddd;">
                                    ${m.tax||"0"}
                                </td>
                                <td style="padding: 6px; text-align: right; font-weight: 600; border: 1px solid #ddd;">
                                    ${r(w)}
                                </td>
                            </tr>
                            `}).join("")}
                    </tbody>
                </table>
            </div>
            `),((h=e.supplies)==null?void 0:h.totalValue)!==void 0&&(d+=`
            <div style="margin-top: 20px; font-weight: bold; background-color: #eef7e6; border-left: 4px solid #80c242; padding: 10px;">
                <div style="color: #3d611f;">Total Value</div>
                <div style="font-size: 18px; color: #3d611f;">${r(e.supplies.totalValue)}</div>
            </div>
            `),(x=e.supplies)!=null&&x.remarks&&(d+=`
            <h2>Remarks</h2>
            <div style="padding: 10px; border: 1px solid #eee; background-color: #f9f9f9;">
                <p style="margin: 0;">${e.supplies.remarks}</p>
            </div>
            `),d+="</div>",d},c=()=>{if(!e||!e.complinces)return"<p>No compliance details available</p>";let d=`
          <div class="section-content">
            <h2>Compliance Answers</h2>
        `;return Object.keys(e.complinces).length>0?(d+='<div style="display: grid; grid-template-columns: 1fr; gap: 20px;">',Object.entries(e.complinces).forEach(([u,f])=>{var x,m;const h=f.expectedAnswer===f.answer;d+=`
              <div style="padding: 18px; border-radius: 8px; ${h?"background-color: #d1fae5; border: 1px solid #a7f3d0;":"background-color: #fee2e2; border: 1px solid #fecaca;"}">
                <h3 style="margin-top: 0; margin-bottom: 12px; ${h?"color: #065f46;":"color: #b91c1c;"}">${f.question}</h3>
                <p style="font-weight: 600; ${h?"color: #047857;":"color: #dc2626;"}; margin-bottom: 10px;">
                  ${f.answer?"Yes":"No"}
                </p>
                
                ${f.department?`
                  <p style="margin-top: 12px; font-size: 14px; color: #4b5563;">
                    <strong>Department:</strong> ${f.department}
                  </p>
                `:""}
                
                ${f.deviation&&!h?`
                  <div style="margin-top: 15px; padding: 12px; background-color: #fef2f2; border-radius: 6px;">
                    <p style="margin: 0; font-size: 14px; color: #b91c1c;">
                      <strong>Deviation Reason:</strong> ${f.deviation.reason}
                    </p>
                  </div>
                `:""}
                
                ${((m=(x=f==null?void 0:f.deviation)==null?void 0:x.attachments)==null?void 0:m.length)>0?`
                  <div style="margin-top: 15px;">
                    <strong style="color: #b91c1c;">Attachments:</strong>
                    <ul style="margin-top: 8px; padding-left: 20px;">
                      ${f.deviation.attachments.map((g,p)=>`<li>Attachment ${p+1}</li>`).join("")}
                    </ul>
                  </div>
                `:""}
              </div>
            `}),d+="</div>"):d+=`
            <div style="padding: 20px; background-color: #f9fafb; border-radius: 8px; text-align: center;">
              <p style="color: #6b7280; margin: 0;">No compliance details available</p>
            </div>`,d+="</div>",d},A=()=>{if(!e||!e.approvals||e.approvals.length===0)return`
            <div class="section-content">
                <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 40px; background-color: #f9fafb; border-radius: 8px; text-align: center;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#9ca3af" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                    <p style="color: #6b7280; margin-top: 16px;">No approval logs available</p>
                </div>
            </div>`;const d=(g,p)=>{if(!g||!p)return{days:"-",hours:"-",minutes:"-"};const v=new Date(g),B=new Date(p)-v;if(B<0)return{days:"-",hours:"-",minutes:"-"};const T=Math.floor(B/(1e3*60*60*24)),_=Math.floor(B%(1e3*60*60*24)/(1e3*60*60)),j=Math.floor(B%(1e3*60*60)/(1e3*60));return{days:T,hours:_,minutes:j}},u=g=>{if(g.days==="-")return"Pending";const p=[];return g.days>0&&p.push(`${g.days}d`),g.hours>0&&p.push(`${g.hours}h`),g.minutes>0&&p.push(`${g.minutes}m`),p.length>0?p.join(" "):"< 1m"},f=g=>{if(!g)return"background-color: #f0f0f0; color: #666;";switch(g.toLowerCase()){case"approved":return"background-color: #e6f7e6; color: #2c7a2c;";case"rejected":return"background-color: #fde8e8; color: #c53030;";case"pending":return"background-color: #f0f0f0; color: #666;";default:return"background-color: #f0f0f0; color: #666;"}},h=g=>{if(!g)return{date:"N/A",time:"N/A"};try{const p=new Date(g);return{date:p.toLocaleDateString(void 0,{month:"2-digit",day:"2-digit",year:"2-digit"}),time:p.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}}catch{return{date:"N/A",time:"N/A"}}},x=(g,p=25)=>g?g.length>p?g.substring(0,p)+"...":g:"N/A";let m=`
        <div class="section-content" style="width: 100%;">
            <h2>Approval Timeline</h2>
            <div style="width: 100%; overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse; table-layout: fixed; font-size: 9px;">
                    <thead>
                        <tr style="background-color: rgba(128, 194, 66, 0.1);">
                            <th style="width: 5%; padding: 6px; border: 1px solid #ddd; text-align: center;">#</th>
                            <th style="width: 18%; padding: 6px; border: 1px solid #ddd; text-align: left;">Approver</th>
                            <th style="width: 18%; padding: 6px; border: 1px solid #ddd; text-align: left;">Status & Remarks</th>
                            <th style="width: 14%; padding: 6px; border: 1px solid #ddd; text-align: left;">Received On</th>
                            <th style="width: 14%; padding: 6px; border: 1px solid #ddd; text-align: left;">Updated On</th>
                            <th style="width: 12%; padding: 6px; border: 1px solid #ddd; text-align: center;">Turn Around</th>
                            <th style="width: 19%; padding: 6px; border: 1px solid #ddd; text-align: left;">Proceeded To</th>
                        </tr>
                    </thead>
                    <tbody>
        `;return e.approvals.forEach((g,p)=>{const v=h(g.receivedOn),w=h(g.approvalDate),B=d(g.receivedOn,g.approvalDate),T=u(B);m+=`
            <tr style="border-bottom: 1px solid #eee;">
                <td style="padding: 6px; border: 1px solid #ddd; text-align: center;">${p+1}</td>
                <td style="padding: 6px; border: 1px solid #ddd; word-wrap: break-word; overflow-wrap: break-word;">
                    <div style="font-weight: 600;">${x(g.approverName,20)||"N/A"}</div>
                    <div style="font-size: 8px; color: #6b7280;">${x(g.departmentName,20)||"N/A"}</div>
                    <div style="font-size: 8px; color: #6b7280;">${x(g.approvalId,18)||"N/A"}</div>
                </td>
                <td style="padding: 6px; border: 1px solid #ddd; word-wrap: break-word; overflow-wrap: break-word;">
                    <div>
                        <span style="padding: 2px 6px; border-radius: 4px; font-size: 8px; font-weight: 600; ${f(g.status)}">${g.status||"Pending"}</span>
                        ${g.remarks?`<div style="margin-top: 4px; padding: 3px; background-color: #f7f7f7; border-radius: 3px; font-size: 8px;">${x(g.remarks,35)}</div>`:""}
                    </div>
                </td>
                <td style="padding: 6px; border: 1px solid #ddd;">
                    <div style="font-weight: 500;">${v.date}</div>
                    <div style="font-size: 8px; color: #6b7280;">${v.time}</div>
                </td>
                <td style="padding: 6px; border: 1px solid #ddd;">
                    <div style="font-weight: 500;">${w.date}</div>
                    <div style="font-size: 8px; color: #6b7280;">${w.time}</div>
                </td>
                <td style="padding: 6px; border: 1px solid #ddd; text-align: center; font-weight: 500;">${T}</td>
                <td style="padding: 6px; border: 1px solid #ddd; word-wrap: break-word; overflow-wrap: break-word;">${x(g.nextDepartment,25)||"N/A"}</td>
            </tr>
            `}),m+=`
                </tbody>
            </table>
            
            <div style="margin-top: 15px; font-size: 8px; color: #6b7280; font-style: italic; background-color: #f8f9fa; padding: 6px; border-radius: 4px;">
                <svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: inline; vertical-align: text-bottom; margin-right: 2px;">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="16" x2="12" y2="12"></line>
                    <line x1="12" y1="8" x2="12.01" y2="8"></line>
                </svg>
                Note: Turn Around Time includes non-working hours
            </div>
        </div>
        `,m};return{generateSectionHTML:s,generateCommercialDetailsHTML:i,generateProcurementDetailsHTML:o,generateSuppliesDetailsHTML:l,generateComplianceDetailsHTML:c,generateApprovalLogsHTML:A,formatCurrency:r,createInfoBox:n}};/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var s5=function(e,t){return s5=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])},s5(e,t)};function zo(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");s5(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var a5=function(){return a5=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},a5.apply(this,arguments)};function Ba(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(d){try{A(n.next(d))}catch(u){o(u)}}function c(d){try{A(n.throw(d))}catch(u){o(u)}}function A(d){d.done?i(d.value):s(d.value).then(l,c)}A((n=n.apply(e,[])).next())})}function la(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(A){return function(d){return c([A,d])}}function c(A){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=A[0]&2?s.return:A[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,A[1])).done)return i;switch(s=0,i&&(A=[A[0]&2,i.value]),A[0]){case 0:case 1:i=A;break;case 4:return r.label++,{value:A[1],done:!1};case 5:r.label++,s=A[1],A=[0];continue;case 7:A=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(A[0]===6||A[0]===2)){r=0;continue}if(A[0]===3&&(!i||A[1]>i[0]&&A[1]<i[3])){r.label=A[1];break}if(A[0]===6&&r.label<i[1]){r.label=i[1],i=A;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(A);break}i[2]&&r.ops.pop(),r.trys.pop();continue}A=t.call(e,r)}catch(d){A=[6,d],s=0}finally{n=i=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}}function Kx(e,t,r){if(arguments.length===2)for(var n=0,s=t.length,i;n<s;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||t)}var fc=function(){function e(t,r,n,s){this.left=t,this.top=r,this.width=n,this.height=s}return e.prototype.add=function(t,r,n,s){return new e(this.left+t,this.top+r,this.width+n,this.height+s)},e.fromClientRect=function(t,r){return new e(r.left+t.windowBounds.left,r.top+t.windowBounds.top,r.width,r.height)},e.fromDOMRectList=function(t,r){var n=Array.from(r).find(function(s){return s.width!==0});return n?new e(n.left+t.windowBounds.left,n.top+t.windowBounds.top,n.width,n.height):e.EMPTY},e.EMPTY=new e(0,0,0,0),e}(),Rv=function(e,t){return fc.fromClientRect(e,t.getBoundingClientRect())},Zfe=function(e){var t=e.body,r=e.documentElement;if(!t||!r)throw new Error("Unable to get document size");var n=Math.max(Math.max(t.scrollWidth,r.scrollWidth),Math.max(t.offsetWidth,r.offsetWidth),Math.max(t.clientWidth,r.clientWidth)),s=Math.max(Math.max(t.scrollHeight,r.scrollHeight),Math.max(t.offsetHeight,r.offsetHeight),Math.max(t.clientHeight,r.clientHeight));return new fc(0,0,n,s)},Qv=function(e){for(var t=[],r=0,n=e.length;r<n;){var s=e.charCodeAt(r++);if(s>=55296&&s<=56319&&r<n){var i=e.charCodeAt(r++);(i&64512)===56320?t.push(((s&1023)<<10)+(i&1023)+65536):(t.push(s),r--)}else t.push(s)}return t},Zn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var n=[],s=-1,i="";++s<r;){var o=e[s];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(s+1===r||n.length>16384)&&(i+=String.fromCharCode.apply(String,n),n.length=0)}return i},_E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e0e=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var zx=0;zx<_E.length;zx++)e0e[_E.charCodeAt(zx)]=zx;var IE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",mh=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Gx=0;Gx<IE.length;Gx++)mh[IE.charCodeAt(Gx)]=Gx;var t0e=function(e){var t=e.length*.75,r=e.length,n,s=0,i,o,l,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var A=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),d=Array.isArray(A)?A:new Uint8Array(A);for(n=0;n<r;n+=4)i=mh[e.charCodeAt(n)],o=mh[e.charCodeAt(n+1)],l=mh[e.charCodeAt(n+2)],c=mh[e.charCodeAt(n+3)],d[s++]=i<<2|o>>4,d[s++]=(o&15)<<4|l>>2,d[s++]=(l&3)<<6|c&63;return A},r0e=function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r.push(e[n+1]<<8|e[n]);return r},n0e=function(e){for(var t=e.length,r=[],n=0;n<t;n+=4)r.push(e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]);return r},gd=5,wj=11,$w=2,s0e=wj-gd,RD=65536>>gd,a0e=1<<gd,qw=a0e-1,i0e=1024>>gd,o0e=RD+i0e,l0e=o0e,c0e=32,A0e=l0e+c0e,d0e=65536>>wj,u0e=1<<s0e,f0e=u0e-1,LE=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},h0e=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},m0e=function(e,t){var r=t0e(e),n=Array.isArray(r)?n0e(r):new Uint32Array(r),s=Array.isArray(r)?r0e(r):new Uint16Array(r),i=24,o=LE(s,i/2,n[4]/2),l=n[5]===2?LE(s,(i+n[4])/2):h0e(n,Math.ceil((i+n[4])/4));return new p0e(n[0],n[1],n[2],n[3],o,l)},p0e=function(){function e(t,r,n,s,i,o){this.initialValue=t,this.errorValue=r,this.highStart=n,this.highValueIndex=s,this.index=i,this.data=o}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>gd],r=(r<<$w)+(t&qw),this.data[r];if(t<=65535)return r=this.index[RD+(t-55296>>gd)],r=(r<<$w)+(t&qw),this.data[r];if(t<this.highStart)return r=A0e-d0e+(t>>wj),r=this.index[r],r+=t>>gd&f0e,r=this.index[r],r=(r<<$w)+(t&qw),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),UE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",x0e=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Wx=0;Wx<UE.length;Wx++)x0e[UE.charCodeAt(Wx)]=Wx;var g0e="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",DE=50,y0e=1,QD=2,MD=3,v0e=4,w0e=5,PE=7,HD=8,OE=9,Jc=10,i5=11,RE=12,o5=13,b0e=14,ph=15,l5=16,Xx=17,Z0=18,N0e=19,QE=20,c5=21,eh=22,Kw=23,Eu=24,fi=25,xh=26,gh=27,ku=28,C0e=29,ZA=30,j0e=31,Yx=32,Jx=33,A5=34,d5=35,u5=36,Dm=37,f5=38,Kg=39,zg=40,zw=41,VD=42,B0e=43,S0e=[9001,65288],$D="!",kr="",Zx="",h5=m0e(g0e),Rl=[ZA,u5],m5=[y0e,QD,MD,w0e],qD=[Jc,HD],ME=[gh,xh],F0e=m5.concat(qD),HE=[f5,Kg,zg,A5,d5],E0e=[ph,o5],k0e=function(e,t){t===void 0&&(t="strict");var r=[],n=[],s=[];return e.forEach(function(i,o){var l=h5.get(i);if(l>DE?(s.push(!0),l-=DE):s.push(!1),["normal","auto","loose"].indexOf(t)!==-1&&[8208,8211,12316,12448].indexOf(i)!==-1)return n.push(o),r.push(l5);if(l===v0e||l===i5){if(o===0)return n.push(o),r.push(ZA);var c=r[o-1];return F0e.indexOf(c)===-1?(n.push(n[o-1]),r.push(c)):(n.push(o),r.push(ZA))}if(n.push(o),l===j0e)return r.push(t==="strict"?c5:Dm);if(l===VD||l===C0e)return r.push(ZA);if(l===B0e)return i>=131072&&i<=196605||i>=196608&&i<=262141?r.push(Dm):r.push(ZA);r.push(l)}),[n,r,s]},Gw=function(e,t,r,n){var s=n[r];if(Array.isArray(e)?e.indexOf(s)!==-1:e===s)for(var i=r;i<=n.length;){i++;var o=n[i];if(o===t)return!0;if(o!==Jc)break}if(s===Jc)for(var i=r;i>0;){i--;var l=n[i];if(Array.isArray(e)?e.indexOf(l)!==-1:e===l)for(var c=r;c<=n.length;){c++;var o=n[c];if(o===t)return!0;if(o!==Jc)break}if(l!==Jc)break}return!1},VE=function(e,t){for(var r=e;r>=0;){var n=t[r];if(n===Jc)r--;else return n}return 0},T0e=function(e,t,r,n,s){if(r[n]===0)return kr;var i=n-1;if(Array.isArray(s)&&s[i]===!0)return kr;var o=i-1,l=i+1,c=t[i],A=o>=0?t[o]:0,d=t[l];if(c===QD&&d===MD)return kr;if(m5.indexOf(c)!==-1)return $D;if(m5.indexOf(d)!==-1||qD.indexOf(d)!==-1)return kr;if(VE(i,t)===HD)return Zx;if(h5.get(e[i])===i5||(c===Yx||c===Jx)&&h5.get(e[l])===i5||c===PE||d===PE||c===OE||[Jc,o5,ph].indexOf(c)===-1&&d===OE||[Xx,Z0,N0e,Eu,ku].indexOf(d)!==-1||VE(i,t)===eh||Gw(Kw,eh,i,t)||Gw([Xx,Z0],c5,i,t)||Gw(RE,RE,i,t))return kr;if(c===Jc)return Zx;if(c===Kw||d===Kw)return kr;if(d===l5||c===l5)return Zx;if([o5,ph,c5].indexOf(d)!==-1||c===b0e||A===u5&&E0e.indexOf(c)!==-1||c===ku&&d===u5||d===QE||Rl.indexOf(d)!==-1&&c===fi||Rl.indexOf(c)!==-1&&d===fi||c===gh&&[Dm,Yx,Jx].indexOf(d)!==-1||[Dm,Yx,Jx].indexOf(c)!==-1&&d===xh||Rl.indexOf(c)!==-1&&ME.indexOf(d)!==-1||ME.indexOf(c)!==-1&&Rl.indexOf(d)!==-1||[gh,xh].indexOf(c)!==-1&&(d===fi||[eh,ph].indexOf(d)!==-1&&t[l+1]===fi)||[eh,ph].indexOf(c)!==-1&&d===fi||c===fi&&[fi,ku,Eu].indexOf(d)!==-1)return kr;if([fi,ku,Eu,Xx,Z0].indexOf(d)!==-1)for(var u=i;u>=0;){var f=t[u];if(f===fi)return kr;if([ku,Eu].indexOf(f)!==-1)u--;else break}if([gh,xh].indexOf(d)!==-1)for(var u=[Xx,Z0].indexOf(c)!==-1?o:i;u>=0;){var f=t[u];if(f===fi)return kr;if([ku,Eu].indexOf(f)!==-1)u--;else break}if(f5===c&&[f5,Kg,A5,d5].indexOf(d)!==-1||[Kg,A5].indexOf(c)!==-1&&[Kg,zg].indexOf(d)!==-1||[zg,d5].indexOf(c)!==-1&&d===zg||HE.indexOf(c)!==-1&&[QE,xh].indexOf(d)!==-1||HE.indexOf(d)!==-1&&c===gh||Rl.indexOf(c)!==-1&&Rl.indexOf(d)!==-1||c===Eu&&Rl.indexOf(d)!==-1||Rl.concat(fi).indexOf(c)!==-1&&d===eh&&S0e.indexOf(e[l])===-1||Rl.concat(fi).indexOf(d)!==-1&&c===Z0)return kr;if(c===zw&&d===zw){for(var h=r[i],x=1;h>0&&(h--,t[h]===zw);)x++;if(x%2!==0)return kr}return c===Yx&&d===Jx?kr:Zx},_0e=function(e,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var r=k0e(e,t.lineBreak),n=r[0],s=r[1],i=r[2];(t.wordBreak==="break-all"||t.wordBreak==="break-word")&&(s=s.map(function(l){return[fi,ZA,VD].indexOf(l)!==-1?Dm:l}));var o=t.wordBreak==="keep-all"?i.map(function(l,c){return l&&e[c]>=19968&&e[c]<=40959}):void 0;return[n,s,o]},I0e=function(){function e(t,r,n,s){this.codePoints=t,this.required=r===$D,this.start=n,this.end=s}return e.prototype.slice=function(){return Zn.apply(void 0,this.codePoints.slice(this.start,this.end))},e}(),L0e=function(e,t){var r=Qv(e),n=_0e(r,t),s=n[0],i=n[1],o=n[2],l=r.length,c=0,A=0;return{next:function(){if(A>=l)return{done:!0,value:null};for(var d=kr;A<l&&(d=T0e(r,i,s,++A,o))===kr;);if(d!==kr||A===l){var u=new I0e(r,d,c,A);return c=A,{value:u,done:!1}}return{done:!0,value:null}}}},U0e=1,D0e=2,hp=4,$E=8,sy=10,qE=47,Vh=92,P0e=9,O0e=32,eg=34,th=61,R0e=35,Q0e=36,M0e=37,tg=39,rg=40,rh=41,H0e=95,qa=45,V0e=33,$0e=60,q0e=62,K0e=64,z0e=91,G0e=93,W0e=61,X0e=123,ng=63,Y0e=125,KE=124,J0e=126,Z0e=128,zE=65533,Ww=42,od=43,ehe=44,the=58,rhe=59,Pm=46,nhe=0,she=8,ahe=11,ihe=14,ohe=31,lhe=127,nl=-1,KD=48,zD=97,GD=101,che=102,Ahe=117,dhe=122,WD=65,XD=69,YD=70,uhe=85,fhe=90,ua=function(e){return e>=KD&&e<=57},hhe=function(e){return e>=55296&&e<=57343},Tu=function(e){return ua(e)||e>=WD&&e<=YD||e>=zD&&e<=che},mhe=function(e){return e>=zD&&e<=dhe},phe=function(e){return e>=WD&&e<=fhe},xhe=function(e){return mhe(e)||phe(e)},ghe=function(e){return e>=Z0e},sg=function(e){return e===sy||e===P0e||e===O0e},ay=function(e){return xhe(e)||ghe(e)||e===H0e},GE=function(e){return ay(e)||ua(e)||e===qa},yhe=function(e){return e>=nhe&&e<=she||e===ahe||e>=ihe&&e<=ohe||e===lhe},Vc=function(e,t){return e!==Vh?!1:t!==sy},ag=function(e,t,r){return e===qa?ay(t)||Vc(t,r):ay(e)?!0:!!(e===Vh&&Vc(e,t))},Xw=function(e,t,r){return e===od||e===qa?ua(t)?!0:t===Pm&&ua(r):ua(e===Pm?t:e)},vhe=function(e){var t=0,r=1;(e[t]===od||e[t]===qa)&&(e[t]===qa&&(r=-1),t++);for(var n=[];ua(e[t]);)n.push(e[t++]);var s=n.length?parseInt(Zn.apply(void 0,n),10):0;e[t]===Pm&&t++;for(var i=[];ua(e[t]);)i.push(e[t++]);var o=i.length,l=o?parseInt(Zn.apply(void 0,i),10):0;(e[t]===XD||e[t]===GD)&&t++;var c=1;(e[t]===od||e[t]===qa)&&(e[t]===qa&&(c=-1),t++);for(var A=[];ua(e[t]);)A.push(e[t++]);var d=A.length?parseInt(Zn.apply(void 0,A),10):0;return r*(s+l*Math.pow(10,-o))*Math.pow(10,c*d)},whe={type:2},bhe={type:3},Nhe={type:4},Che={type:13},jhe={type:8},Bhe={type:21},She={type:9},Fhe={type:10},Ehe={type:11},khe={type:12},The={type:14},ig={type:23},_he={type:1},Ihe={type:25},Lhe={type:24},Uhe={type:26},Dhe={type:27},Phe={type:28},Ohe={type:29},Rhe={type:31},p5={type:32},JD=function(){function e(){this._value=[]}return e.prototype.write=function(t){this._value=this._value.concat(Qv(t))},e.prototype.read=function(){for(var t=[],r=this.consumeToken();r!==p5;)t.push(r),r=this.consumeToken();return t},e.prototype.consumeToken=function(){var t=this.consumeCodePoint();switch(t){case eg:return this.consumeStringToken(eg);case R0e:var r=this.peekCodePoint(0),n=this.peekCodePoint(1),s=this.peekCodePoint(2);if(GE(r)||Vc(n,s)){var i=ag(r,n,s)?D0e:U0e,o=this.consumeName();return{type:5,value:o,flags:i}}break;case Q0e:if(this.peekCodePoint(0)===th)return this.consumeCodePoint(),Che;break;case tg:return this.consumeStringToken(tg);case rg:return whe;case rh:return bhe;case Ww:if(this.peekCodePoint(0)===th)return this.consumeCodePoint(),The;break;case od:if(Xw(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case ehe:return Nhe;case qa:var l=t,c=this.peekCodePoint(0),A=this.peekCodePoint(1);if(Xw(l,c,A))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(ag(l,c,A))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(c===qa&&A===q0e)return this.consumeCodePoint(),this.consumeCodePoint(),Lhe;break;case Pm:if(Xw(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case qE:if(this.peekCodePoint(0)===Ww)for(this.consumeCodePoint();;){var d=this.consumeCodePoint();if(d===Ww&&(d=this.consumeCodePoint(),d===qE))return this.consumeToken();if(d===nl)return this.consumeToken()}break;case the:return Uhe;case rhe:return Dhe;case $0e:if(this.peekCodePoint(0)===V0e&&this.peekCodePoint(1)===qa&&this.peekCodePoint(2)===qa)return this.consumeCodePoint(),this.consumeCodePoint(),Ihe;break;case K0e:var u=this.peekCodePoint(0),f=this.peekCodePoint(1),h=this.peekCodePoint(2);if(ag(u,f,h)){var o=this.consumeName();return{type:7,value:o}}break;case z0e:return Phe;case Vh:if(Vc(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case G0e:return Ohe;case W0e:if(this.peekCodePoint(0)===th)return this.consumeCodePoint(),jhe;break;case X0e:return Ehe;case Y0e:return khe;case Ahe:case uhe:var x=this.peekCodePoint(0),m=this.peekCodePoint(1);return x===od&&(Tu(m)||m===ng)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case KE:if(this.peekCodePoint(0)===th)return this.consumeCodePoint(),She;if(this.peekCodePoint(0)===KE)return this.consumeCodePoint(),Bhe;break;case J0e:if(this.peekCodePoint(0)===th)return this.consumeCodePoint(),Fhe;break;case nl:return p5}return sg(t)?(this.consumeWhiteSpace(),Rhe):ua(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):ay(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:Zn(t)}},e.prototype.consumeCodePoint=function(){var t=this._value.shift();return typeof t>"u"?-1:t},e.prototype.reconsumeCodePoint=function(t){this._value.unshift(t)},e.prototype.peekCodePoint=function(t){return t>=this._value.length?-1:this._value[t]},e.prototype.consumeUnicodeRangeToken=function(){for(var t=[],r=this.consumeCodePoint();Tu(r)&&t.length<6;)t.push(r),r=this.consumeCodePoint();for(var n=!1;r===ng&&t.length<6;)t.push(r),r=this.consumeCodePoint(),n=!0;if(n){var s=parseInt(Zn.apply(void 0,t.map(function(c){return c===ng?KD:c})),16),i=parseInt(Zn.apply(void 0,t.map(function(c){return c===ng?YD:c})),16);return{type:30,start:s,end:i}}var o=parseInt(Zn.apply(void 0,t),16);if(this.peekCodePoint(0)===qa&&Tu(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var l=[];Tu(r)&&l.length<6;)l.push(r),r=this.consumeCodePoint();var i=parseInt(Zn.apply(void 0,l),16);return{type:30,start:o,end:i}}else return{type:30,start:o,end:o}},e.prototype.consumeIdentLikeToken=function(){var t=this.consumeName();return t.toLowerCase()==="url"&&this.peekCodePoint(0)===rg?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===rg?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}},e.prototype.consumeUrlToken=function(){var t=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===nl)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===tg||r===eg){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===nl||this.peekCodePoint(0)===rh)?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),ig)}for(;;){var s=this.consumeCodePoint();if(s===nl||s===rh)return{type:22,value:Zn.apply(void 0,t)};if(sg(s))return this.consumeWhiteSpace(),this.peekCodePoint(0)===nl||this.peekCodePoint(0)===rh?(this.consumeCodePoint(),{type:22,value:Zn.apply(void 0,t)}):(this.consumeBadUrlRemnants(),ig);if(s===eg||s===tg||s===rg||yhe(s))return this.consumeBadUrlRemnants(),ig;if(s===Vh)if(Vc(s,this.peekCodePoint(0)))t.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),ig;else t.push(s)}},e.prototype.consumeWhiteSpace=function(){for(;sg(this.peekCodePoint(0));)this.consumeCodePoint()},e.prototype.consumeBadUrlRemnants=function(){for(;;){var t=this.consumeCodePoint();if(t===rh||t===nl)return;Vc(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},e.prototype.consumeStringSlice=function(t){for(var r=5e4,n="";t>0;){var s=Math.min(r,t);n+=Zn.apply(void 0,this._value.splice(0,s)),t-=s}return this._value.shift(),n},e.prototype.consumeStringToken=function(t){var r="",n=0;do{var s=this._value[n];if(s===nl||s===void 0||s===t)return r+=this.consumeStringSlice(n),{type:0,value:r};if(s===sy)return this._value.splice(0,n),_he;if(s===Vh){var i=this._value[n+1];i!==nl&&i!==void 0&&(i===sy?(r+=this.consumeStringSlice(n),n=-1,this._value.shift()):Vc(s,i)&&(r+=this.consumeStringSlice(n),r+=Zn(this.consumeEscapedCodePoint()),n=-1))}n++}while(!0)},e.prototype.consumeNumber=function(){var t=[],r=hp,n=this.peekCodePoint(0);for((n===od||n===qa)&&t.push(this.consumeCodePoint());ua(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0);var s=this.peekCodePoint(1);if(n===Pm&&ua(s))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=$E;ua(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0),s=this.peekCodePoint(1);var i=this.peekCodePoint(2);if((n===XD||n===GD)&&((s===od||s===qa)&&ua(i)||ua(s)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=$E;ua(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[vhe(t),r]},e.prototype.consumeNumericToken=function(){var t=this.consumeNumber(),r=t[0],n=t[1],s=this.peekCodePoint(0),i=this.peekCodePoint(1),o=this.peekCodePoint(2);if(ag(s,i,o)){var l=this.consumeName();return{type:15,number:r,flags:n,unit:l}}return s===M0e?(this.consumeCodePoint(),{type:16,number:r,flags:n}):{type:17,number:r,flags:n}},e.prototype.consumeEscapedCodePoint=function(){var t=this.consumeCodePoint();if(Tu(t)){for(var r=Zn(t);Tu(this.peekCodePoint(0))&&r.length<6;)r+=Zn(this.consumeCodePoint());sg(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(r,16);return n===0||hhe(n)||n>1114111?zE:n}return t===nl?zE:t},e.prototype.consumeName=function(){for(var t="";;){var r=this.consumeCodePoint();if(GE(r))t+=Zn(r);else if(Vc(r,this.peekCodePoint(0)))t+=Zn(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),t}},e}(),ZD=function(){function e(t){this._tokens=t}return e.create=function(t){var r=new JD;return r.write(t),new e(r.read())},e.parseValue=function(t){return e.create(t).parseComponentValue()},e.parseValues=function(t){return e.create(t).parseComponentValues()},e.prototype.parseComponentValue=function(){for(var t=this.consumeToken();t.type===31;)t=this.consumeToken();if(t.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);var r=this.consumeComponentValue();do t=this.consumeToken();while(t.type===31);if(t.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},e.prototype.parseComponentValues=function(){for(var t=[];;){var r=this.consumeComponentValue();if(r.type===32)return t;t.push(r),t.push()}},e.prototype.consumeComponentValue=function(){var t=this.consumeToken();switch(t.type){case 11:case 28:case 2:return this.consumeSimpleBlock(t.type);case 19:return this.consumeFunction(t)}return t},e.prototype.consumeSimpleBlock=function(t){for(var r={type:t,values:[]},n=this.consumeToken();;){if(n.type===32||Mhe(n,t))return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue()),n=this.consumeToken()}},e.prototype.consumeFunction=function(t){for(var r={name:t.value,values:[],type:18};;){var n=this.consumeToken();if(n.type===32||n.type===3)return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue())}},e.prototype.consumeToken=function(){var t=this._tokens.shift();return typeof t>"u"?p5:t},e.prototype.reconsumeToken=function(t){this._tokens.unshift(t)},e}(),mp=function(e){return e.type===15},o0=function(e){return e.type===17},ln=function(e){return e.type===20},Qhe=function(e){return e.type===0},x5=function(e,t){return ln(e)&&e.value===t},eP=function(e){return e.type!==31},Qf=function(e){return e.type!==31&&e.type!==4},Bl=function(e){var t=[],r=[];return e.forEach(function(n){if(n.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");t.push(r),r=[];return}n.type!==31&&r.push(n)}),r.length&&t.push(r),t},Mhe=function(e,t){return t===11&&e.type===12||t===28&&e.type===29?!0:t===2&&e.type===3},NA=function(e){return e.type===17||e.type===15},ps=function(e){return e.type===16||NA(e)},tP=function(e){return e.length>1?[e[0],e[1]]:[e[0]]},zs={type:17,number:0,flags:hp},bj={type:16,number:50,flags:hp},Zc={type:16,number:100,flags:hp},yh=function(e,t,r){var n=e[0],s=e[1];return[xn(n,t),xn(typeof s<"u"?s:n,r)]},xn=function(e,t){if(e.type===16)return e.number/100*t;if(mp(e))switch(e.unit){case"rem":case"em":return 16*e.number;case"px":default:return e.number}return e.number},rP="deg",nP="grad",sP="rad",aP="turn",Mv={name:"angle",parse:function(e,t){if(t.type===15)switch(t.unit){case rP:return Math.PI*t.number/180;case nP:return Math.PI/200*t.number;case sP:return t.number;case aP:return Math.PI*2*t.number}throw new Error("Unsupported angle type")}},iP=function(e){return e.type===15&&(e.unit===rP||e.unit===nP||e.unit===sP||e.unit===aP)},oP=function(e){var t=e.filter(ln).map(function(r){return r.value}).join(" ");switch(t){case"to bottom right":case"to right bottom":case"left top":case"top left":return[zs,zs];case"to top":case"bottom":return io(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[zs,Zc];case"to right":case"left":return io(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[Zc,Zc];case"to bottom":case"top":return io(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[Zc,zs];case"to left":case"right":return io(270)}return 0},io=function(e){return Math.PI*e/180},uA={name:"color",parse:function(e,t){if(t.type===18){var r=Hhe[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+t.name+'"');return r(e,t.values)}if(t.type===5){if(t.value.length===3){var n=t.value.substring(0,1),s=t.value.substring(1,2),i=t.value.substring(2,3);return eA(parseInt(n+n,16),parseInt(s+s,16),parseInt(i+i,16),1)}if(t.value.length===4){var n=t.value.substring(0,1),s=t.value.substring(1,2),i=t.value.substring(2,3),o=t.value.substring(3,4);return eA(parseInt(n+n,16),parseInt(s+s,16),parseInt(i+i,16),parseInt(o+o,16)/255)}if(t.value.length===6){var n=t.value.substring(0,2),s=t.value.substring(2,4),i=t.value.substring(4,6);return eA(parseInt(n,16),parseInt(s,16),parseInt(i,16),1)}if(t.value.length===8){var n=t.value.substring(0,2),s=t.value.substring(2,4),i=t.value.substring(4,6),o=t.value.substring(6,8);return eA(parseInt(n,16),parseInt(s,16),parseInt(i,16),parseInt(o,16)/255)}}if(t.type===20){var l=sc[t.value.toUpperCase()];if(typeof l<"u")return l}return sc.TRANSPARENT}},fA=function(e){return(255&e)===0},Ss=function(e){var t=255&e,r=255&e>>8,n=255&e>>16,s=255&e>>24;return t<255?"rgba("+s+","+n+","+r+","+t/255+")":"rgb("+s+","+n+","+r+")"},eA=function(e,t,r,n){return(e<<24|t<<16|r<<8|Math.round(n*255)<<0)>>>0},WE=function(e,t){if(e.type===17)return e.number;if(e.type===16){var r=t===3?1:255;return t===3?e.number/100*r:Math.round(e.number/100*r)}return 0},XE=function(e,t){var r=t.filter(Qf);if(r.length===3){var n=r.map(WE),s=n[0],i=n[1],o=n[2];return eA(s,i,o,1)}if(r.length===4){var l=r.map(WE),s=l[0],i=l[1],o=l[2],c=l[3];return eA(s,i,o,c)}return 0};function Yw(e,t,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(t-e)*r*6+e:r<1/2?t:r<2/3?(t-e)*6*(2/3-r)+e:e}var YE=function(e,t){var r=t.filter(Qf),n=r[0],s=r[1],i=r[2],o=r[3],l=(n.type===17?io(n.number):Mv.parse(e,n))/(Math.PI*2),c=ps(s)?s.number/100:0,A=ps(i)?i.number/100:0,d=typeof o<"u"&&ps(o)?xn(o,1):1;if(c===0)return eA(A*255,A*255,A*255,1);var u=A<=.5?A*(c+1):A+c-A*c,f=A*2-u,h=Yw(f,u,l+1/3),x=Yw(f,u,l),m=Yw(f,u,l-1/3);return eA(h*255,x*255,m*255,d)},Hhe={hsl:YE,hsla:YE,rgb:XE,rgba:XE},$h=function(e,t){return uA.parse(e,ZD.create(t).parseComponentValue())},sc={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},Vhe={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(ln(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},$he={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Hv=function(e,t){var r=uA.parse(e,t[0]),n=t[1];return n&&ps(n)?{color:r,stop:n}:{color:r,stop:null}},JE=function(e,t){var r=e[0],n=e[e.length-1];r.stop===null&&(r.stop=zs),n.stop===null&&(n.stop=Zc);for(var s=[],i=0,o=0;o<e.length;o++){var l=e[o].stop;if(l!==null){var c=xn(l,t);c>i?s.push(c):s.push(i),i=c}else s.push(null)}for(var A=null,o=0;o<s.length;o++){var d=s[o];if(d===null)A===null&&(A=o);else if(A!==null){for(var u=o-A,f=s[A-1],h=(d-f)/(u+1),x=1;x<=u;x++)s[A+x-1]=h*x;A=null}}return e.map(function(m,g){var p=m.color;return{color:p,stop:Math.max(Math.min(1,s[g]/t),0)}})},qhe=function(e,t,r){var n=t/2,s=r/2,i=xn(e[0],t)-n,o=s-xn(e[1],r);return(Math.atan2(o,i)+Math.PI*2)%(Math.PI*2)},Khe=function(e,t,r){var n=typeof e=="number"?e:qhe(e,t,r),s=Math.abs(t*Math.sin(n))+Math.abs(r*Math.cos(n)),i=t/2,o=r/2,l=s/2,c=Math.sin(n-Math.PI/2)*l,A=Math.cos(n-Math.PI/2)*l;return[s,i-A,i+A,o-c,o+c]},_o=function(e,t){return Math.sqrt(e*e+t*t)},ZE=function(e,t,r,n,s){var i=[[0,0],[0,t],[e,0],[e,t]];return i.reduce(function(o,l){var c=l[0],A=l[1],d=_o(r-c,n-A);return(s?d<o.optimumDistance:d>o.optimumDistance)?{optimumCorner:l,optimumDistance:d}:o},{optimumDistance:s?1/0:-1/0,optimumCorner:null}).optimumCorner},zhe=function(e,t,r,n,s){var i=0,o=0;switch(e.size){case 0:e.shape===0?i=o=Math.min(Math.abs(t),Math.abs(t-n),Math.abs(r),Math.abs(r-s)):e.shape===1&&(i=Math.min(Math.abs(t),Math.abs(t-n)),o=Math.min(Math.abs(r),Math.abs(r-s)));break;case 2:if(e.shape===0)i=o=Math.min(_o(t,r),_o(t,r-s),_o(t-n,r),_o(t-n,r-s));else if(e.shape===1){var l=Math.min(Math.abs(r),Math.abs(r-s))/Math.min(Math.abs(t),Math.abs(t-n)),c=ZE(n,s,t,r,!0),A=c[0],d=c[1];i=_o(A-t,(d-r)/l),o=l*i}break;case 1:e.shape===0?i=o=Math.max(Math.abs(t),Math.abs(t-n),Math.abs(r),Math.abs(r-s)):e.shape===1&&(i=Math.max(Math.abs(t),Math.abs(t-n)),o=Math.max(Math.abs(r),Math.abs(r-s)));break;case 3:if(e.shape===0)i=o=Math.max(_o(t,r),_o(t,r-s),_o(t-n,r),_o(t-n,r-s));else if(e.shape===1){var l=Math.max(Math.abs(r),Math.abs(r-s))/Math.max(Math.abs(t),Math.abs(t-n)),u=ZE(n,s,t,r,!1),A=u[0],d=u[1];i=_o(A-t,(d-r)/l),o=l*i}break}return Array.isArray(e.size)&&(i=xn(e.size[0],n),o=e.size.length===2?xn(e.size[1],s):i),[i,o]},Ghe=function(e,t){var r=io(180),n=[];return Bl(t).forEach(function(s,i){if(i===0){var o=s[0];if(o.type===20&&o.value==="to"){r=oP(s);return}else if(iP(o)){r=Mv.parse(e,o);return}}var l=Hv(e,s);n.push(l)}),{angle:r,stops:n,type:1}},og=function(e,t){var r=io(180),n=[];return Bl(t).forEach(function(s,i){if(i===0){var o=s[0];if(o.type===20&&["top","left","right","bottom"].indexOf(o.value)!==-1){r=oP(s);return}else if(iP(o)){r=(Mv.parse(e,o)+io(270))%io(360);return}}var l=Hv(e,s);n.push(l)}),{angle:r,stops:n,type:1}},Whe=function(e,t){var r=io(180),n=[],s=1,i=0,o=3,l=[];return Bl(t).forEach(function(c,A){var d=c[0];if(A===0){if(ln(d)&&d.value==="linear"){s=1;return}else if(ln(d)&&d.value==="radial"){s=2;return}}if(d.type===18){if(d.name==="from"){var u=uA.parse(e,d.values[0]);n.push({stop:zs,color:u})}else if(d.name==="to"){var u=uA.parse(e,d.values[0]);n.push({stop:Zc,color:u})}else if(d.name==="color-stop"){var f=d.values.filter(Qf);if(f.length===2){var u=uA.parse(e,f[1]),h=f[0];o0(h)&&n.push({stop:{type:16,number:h.number*100,flags:h.flags},color:u})}}}}),s===1?{angle:(r+io(180))%io(360),stops:n,type:s}:{size:o,shape:i,stops:n,position:l,type:s}},lP="closest-side",cP="farthest-side",AP="closest-corner",dP="farthest-corner",uP="circle",fP="ellipse",hP="cover",mP="contain",Xhe=function(e,t){var r=0,n=3,s=[],i=[];return Bl(t).forEach(function(o,l){var c=!0;if(l===0){var A=!1;c=o.reduce(function(u,f){if(A)if(ln(f))switch(f.value){case"center":return i.push(bj),u;case"top":case"left":return i.push(zs),u;case"right":case"bottom":return i.push(Zc),u}else(ps(f)||NA(f))&&i.push(f);else if(ln(f))switch(f.value){case uP:return r=0,!1;case fP:return r=1,!1;case"at":return A=!0,!1;case lP:return n=0,!1;case hP:case cP:return n=1,!1;case mP:case AP:return n=2,!1;case dP:return n=3,!1}else if(NA(f)||ps(f))return Array.isArray(n)||(n=[]),n.push(f),!1;return u},c)}if(c){var d=Hv(e,o);s.push(d)}}),{size:n,shape:r,stops:s,position:i,type:2}},lg=function(e,t){var r=0,n=3,s=[],i=[];return Bl(t).forEach(function(o,l){var c=!0;if(l===0?c=o.reduce(function(d,u){if(ln(u))switch(u.value){case"center":return i.push(bj),!1;case"top":case"left":return i.push(zs),!1;case"right":case"bottom":return i.push(Zc),!1}else if(ps(u)||NA(u))return i.push(u),!1;return d},c):l===1&&(c=o.reduce(function(d,u){if(ln(u))switch(u.value){case uP:return r=0,!1;case fP:return r=1,!1;case mP:case lP:return n=0,!1;case cP:return n=1,!1;case AP:return n=2,!1;case hP:case dP:return n=3,!1}else if(NA(u)||ps(u))return Array.isArray(n)||(n=[]),n.push(u),!1;return d},c)),c){var A=Hv(e,o);s.push(A)}}),{size:n,shape:r,stops:s,position:i,type:2}},Yhe=function(e){return e.type===1},Jhe=function(e){return e.type===2},Nj={name:"image",parse:function(e,t){if(t.type===22){var r={url:t.value,type:0};return e.cache.addImage(t.value),r}if(t.type===18){var n=pP[t.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported image function "'+t.name+'"');return n(e,t.values)}throw new Error("Unsupported image type "+t.type)}};function Zhe(e){return!(e.type===20&&e.value==="none")&&(e.type!==18||!!pP[e.name])}var pP={"linear-gradient":Ghe,"-moz-linear-gradient":og,"-ms-linear-gradient":og,"-o-linear-gradient":og,"-webkit-linear-gradient":og,"radial-gradient":Xhe,"-moz-radial-gradient":lg,"-ms-radial-gradient":lg,"-o-radial-gradient":lg,"-webkit-radial-gradient":lg,"-webkit-gradient":Whe},eme={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t.filter(function(n){return Qf(n)&&Zhe(n)}).map(function(n){return Nj.parse(e,n)})}},tme={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(ln(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},rme={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(e,t){return Bl(t).map(function(r){return r.filter(ps)}).map(tP)}},nme={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(e,t){return Bl(t).map(function(r){return r.filter(ln).map(function(n){return n.value}).join(" ")}).map(sme)}},sme=function(e){switch(e){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},yf;(function(e){e.AUTO="auto",e.CONTAIN="contain",e.COVER="cover"})(yf||(yf={}));var ame={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(e,t){return Bl(t).map(function(r){return r.filter(ime)})}},ime=function(e){return ln(e)||ps(e)},Vv=function(e){return{name:"border-"+e+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},ome=Vv("top"),lme=Vv("right"),cme=Vv("bottom"),Ame=Vv("left"),$v=function(e){return{name:"border-radius-"+e,initialValue:"0 0",prefix:!1,type:1,parse:function(t,r){return tP(r.filter(ps))}}},dme=$v("top-left"),ume=$v("top-right"),fme=$v("bottom-right"),hme=$v("bottom-left"),qv=function(e){return{name:"border-"+e+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(t,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},mme=qv("top"),pme=qv("right"),xme=qv("bottom"),gme=qv("left"),Kv=function(e){return{name:"border-"+e+"-width",initialValue:"0",type:0,prefix:!1,parse:function(t,r){return mp(r)?r.number:0}}},yme=Kv("top"),vme=Kv("right"),wme=Kv("bottom"),bme=Kv("left"),Nme={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Cme={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(e,t){switch(t){case"rtl":return 1;case"ltr":default:return 0}}},jme={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(e,t){return t.filter(ln).reduce(function(r,n){return r|Bme(n.value)},0)}},Bme=function(e){switch(e){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},Sme={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},Fme={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(e,t){return t.type===20&&t.value==="normal"?0:t.type===17||t.type===15?t.number:0}},iy;(function(e){e.NORMAL="normal",e.STRICT="strict"})(iy||(iy={}));var Eme={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"strict":return iy.STRICT;case"normal":default:return iy.NORMAL}}},kme={name:"line-height",initialValue:"normal",prefix:!1,type:4},ek=function(e,t){return ln(e)&&e.value==="normal"?1.2*t:e.type===17?t*e.number:ps(e)?xn(e,t):t},Tme={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(e,t){return t.type===20&&t.value==="none"?null:Nj.parse(e,t)}},_me={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(e,t){switch(t){case"inside":return 0;case"outside":default:return 1}}},g5={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},zv=function(e){return{name:"margin-"+e,initialValue:"0",prefix:!1,type:4}},Ime=zv("top"),Lme=zv("right"),Ume=zv("bottom"),Dme=zv("left"),Pme={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(e,t){return t.filter(ln).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},Ome={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-word":return"break-word";case"normal":default:return"normal"}}},Gv=function(e){return{name:"padding-"+e,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},Rme=Gv("top"),Qme=Gv("right"),Mme=Gv("bottom"),Hme=Gv("left"),Vme={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(e,t){switch(t){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},$me={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(e,t){switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},qme={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&x5(t[0],"none")?[]:Bl(t).map(function(r){for(var n={color:sc.TRANSPARENT,offsetX:zs,offsetY:zs,blur:zs},s=0,i=0;i<r.length;i++){var o=r[i];NA(o)?(s===0?n.offsetX=o:s===1?n.offsetY=o:n.blur=o,s++):n.color=uA.parse(e,o)}return n})}},Kme={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},zme={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(e,t){if(t.type===20&&t.value==="none")return null;if(t.type===18){var r=Xme[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+t.name+'"');return r(t.values)}return null}},Gme=function(e){var t=e.filter(function(r){return r.type===17}).map(function(r){return r.number});return t.length===6?t:null},Wme=function(e){var t=e.filter(function(c){return c.type===17}).map(function(c){return c.number}),r=t[0],n=t[1];t[2],t[3];var s=t[4],i=t[5];t[6],t[7],t[8],t[9],t[10],t[11];var o=t[12],l=t[13];return t[14],t[15],t.length===16?[r,n,s,i,o,l]:null},Xme={matrix:Gme,matrix3d:Wme},tk={type:16,number:50,flags:hp},Yme=[tk,tk],Jme={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(e,t){var r=t.filter(ps);return r.length!==2?Yme:[r[0],r[1]]}},Zme={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},qh;(function(e){e.NORMAL="normal",e.BREAK_ALL="break-all",e.KEEP_ALL="keep-all"})(qh||(qh={}));var epe={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-all":return qh.BREAK_ALL;case"keep-all":return qh.KEEP_ALL;case"normal":default:return qh.NORMAL}}},tpe={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(e,t){if(t.type===20)return{auto:!0,order:0};if(o0(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}},xP={name:"time",parse:function(e,t){if(t.type===15)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")}},rpe={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(e,t){return o0(t)?t.number:1}},npe={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},spe={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(e,t){return t.filter(ln).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},ape={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(e,t){var r=[],n=[];return t.forEach(function(s){switch(s.type){case 20:case 0:r.push(s.value);break;case 17:r.push(s.number.toString());break;case 4:n.push(r.join(" ")),r.length=0;break}}),r.length&&n.push(r.join(" ")),n.map(function(s){return s.indexOf(" ")===-1?s:"'"+s+"'"})}},ipe={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},ope={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(e,t){if(o0(t))return t.number;if(ln(t))switch(t.value){case"bold":return 700;case"normal":default:return 400}return 400}},lpe={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.filter(ln).map(function(r){return r.value})}},cpe={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},vs=function(e,t){return(e&t)!==0},Ape={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t}},dpe={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;for(var n=[],s=t.filter(eP),i=0;i<s.length;i++){var o=s[i],l=s[i+1];if(o.type===20){var c=l&&o0(l)?l.number:1;n.push({counter:o.value,increment:c})}}return n}},upe={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return[];for(var r=[],n=t.filter(eP),s=0;s<n.length;s++){var i=n[s],o=n[s+1];if(ln(i)&&i.value!=="none"){var l=o&&o0(o)?o.number:0;r.push({counter:i.value,reset:l})}}return r}},fpe={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(e,t){return t.filter(mp).map(function(r){return xP.parse(e,r)})}},hpe={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;var n=[],s=t.filter(Qhe);if(s.length%2!==0)return null;for(var i=0;i<s.length;i+=2){var o=s[i].value,l=s[i+1].value;n.push({open:o,close:l})}return n}},rk=function(e,t,r){if(!e)return"";var n=e[Math.min(t,e.length-1)];return n?r?n.open:n.close:""},mpe={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&x5(t[0],"none")?[]:Bl(t).map(function(r){for(var n={color:255,offsetX:zs,offsetY:zs,blur:zs,spread:zs,inset:!1},s=0,i=0;i<r.length;i++){var o=r[i];x5(o,"inset")?n.inset=!0:NA(o)?(s===0?n.offsetX=o:s===1?n.offsetY=o:s===2?n.blur=o:n.spread=o,s++):n.color=uA.parse(e,o)}return n})}},ppe={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(e,t){var r=[0,1,2],n=[];return t.filter(ln).forEach(function(s){switch(s.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2);break}}),r.forEach(function(s){n.indexOf(s)===-1&&n.push(s)}),n}},xpe={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},gpe={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return mp(t)?t.number:0}},ype=function(){function e(t,r){var n,s;this.animationDuration=Ht(t,fpe,r.animationDuration),this.backgroundClip=Ht(t,Vhe,r.backgroundClip),this.backgroundColor=Ht(t,$he,r.backgroundColor),this.backgroundImage=Ht(t,eme,r.backgroundImage),this.backgroundOrigin=Ht(t,tme,r.backgroundOrigin),this.backgroundPosition=Ht(t,rme,r.backgroundPosition),this.backgroundRepeat=Ht(t,nme,r.backgroundRepeat),this.backgroundSize=Ht(t,ame,r.backgroundSize),this.borderTopColor=Ht(t,ome,r.borderTopColor),this.borderRightColor=Ht(t,lme,r.borderRightColor),this.borderBottomColor=Ht(t,cme,r.borderBottomColor),this.borderLeftColor=Ht(t,Ame,r.borderLeftColor),this.borderTopLeftRadius=Ht(t,dme,r.borderTopLeftRadius),this.borderTopRightRadius=Ht(t,ume,r.borderTopRightRadius),this.borderBottomRightRadius=Ht(t,fme,r.borderBottomRightRadius),this.borderBottomLeftRadius=Ht(t,hme,r.borderBottomLeftRadius),this.borderTopStyle=Ht(t,mme,r.borderTopStyle),this.borderRightStyle=Ht(t,pme,r.borderRightStyle),this.borderBottomStyle=Ht(t,xme,r.borderBottomStyle),this.borderLeftStyle=Ht(t,gme,r.borderLeftStyle),this.borderTopWidth=Ht(t,yme,r.borderTopWidth),this.borderRightWidth=Ht(t,vme,r.borderRightWidth),this.borderBottomWidth=Ht(t,wme,r.borderBottomWidth),this.borderLeftWidth=Ht(t,bme,r.borderLeftWidth),this.boxShadow=Ht(t,mpe,r.boxShadow),this.color=Ht(t,Nme,r.color),this.direction=Ht(t,Cme,r.direction),this.display=Ht(t,jme,r.display),this.float=Ht(t,Sme,r.cssFloat),this.fontFamily=Ht(t,ape,r.fontFamily),this.fontSize=Ht(t,ipe,r.fontSize),this.fontStyle=Ht(t,cpe,r.fontStyle),this.fontVariant=Ht(t,lpe,r.fontVariant),this.fontWeight=Ht(t,ope,r.fontWeight),this.letterSpacing=Ht(t,Fme,r.letterSpacing),this.lineBreak=Ht(t,Eme,r.lineBreak),this.lineHeight=Ht(t,kme,r.lineHeight),this.listStyleImage=Ht(t,Tme,r.listStyleImage),this.listStylePosition=Ht(t,_me,r.listStylePosition),this.listStyleType=Ht(t,g5,r.listStyleType),this.marginTop=Ht(t,Ime,r.marginTop),this.marginRight=Ht(t,Lme,r.marginRight),this.marginBottom=Ht(t,Ume,r.marginBottom),this.marginLeft=Ht(t,Dme,r.marginLeft),this.opacity=Ht(t,rpe,r.opacity);var i=Ht(t,Pme,r.overflow);this.overflowX=i[0],this.overflowY=i[i.length>1?1:0],this.overflowWrap=Ht(t,Ome,r.overflowWrap),this.paddingTop=Ht(t,Rme,r.paddingTop),this.paddingRight=Ht(t,Qme,r.paddingRight),this.paddingBottom=Ht(t,Mme,r.paddingBottom),this.paddingLeft=Ht(t,Hme,r.paddingLeft),this.paintOrder=Ht(t,ppe,r.paintOrder),this.position=Ht(t,$me,r.position),this.textAlign=Ht(t,Vme,r.textAlign),this.textDecorationColor=Ht(t,npe,(n=r.textDecorationColor)!==null&&n!==void 0?n:r.color),this.textDecorationLine=Ht(t,spe,(s=r.textDecorationLine)!==null&&s!==void 0?s:r.textDecoration),this.textShadow=Ht(t,qme,r.textShadow),this.textTransform=Ht(t,Kme,r.textTransform),this.transform=Ht(t,zme,r.transform),this.transformOrigin=Ht(t,Jme,r.transformOrigin),this.visibility=Ht(t,Zme,r.visibility),this.webkitTextStrokeColor=Ht(t,xpe,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=Ht(t,gpe,r.webkitTextStrokeWidth),this.wordBreak=Ht(t,epe,r.wordBreak),this.zIndex=Ht(t,tpe,r.zIndex)}return e.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},e.prototype.isTransparent=function(){return fA(this.backgroundColor)},e.prototype.isTransformed=function(){return this.transform!==null},e.prototype.isPositioned=function(){return this.position!==0},e.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},e.prototype.isFloating=function(){return this.float!==0},e.prototype.isInlineLevel=function(){return vs(this.display,4)||vs(this.display,33554432)||vs(this.display,268435456)||vs(this.display,536870912)||vs(this.display,67108864)||vs(this.display,134217728)},e}(),vpe=function(){function e(t,r){this.content=Ht(t,Ape,r.content),this.quotes=Ht(t,hpe,r.quotes)}return e}(),nk=function(){function e(t,r){this.counterIncrement=Ht(t,dpe,r.counterIncrement),this.counterReset=Ht(t,upe,r.counterReset)}return e}(),Ht=function(e,t,r){var n=new JD,s=r!==null&&typeof r<"u"?r.toString():t.initialValue;n.write(s);var i=new ZD(n.read());switch(t.type){case 2:var o=i.parseComponentValue();return t.parse(e,ln(o)?o.value:t.initialValue);case 0:return t.parse(e,i.parseComponentValue());case 1:return t.parse(e,i.parseComponentValues());case 4:return i.parseComponentValue();case 3:switch(t.format){case"angle":return Mv.parse(e,i.parseComponentValue());case"color":return uA.parse(e,i.parseComponentValue());case"image":return Nj.parse(e,i.parseComponentValue());case"length":var l=i.parseComponentValue();return NA(l)?l:zs;case"length-percentage":var c=i.parseComponentValue();return ps(c)?c:zs;case"time":return xP.parse(e,i.parseComponentValue())}break}},wpe="data-html2canvas-debug",bpe=function(e){var t=e.getAttribute(wpe);switch(t){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},y5=function(e,t){var r=bpe(e);return r===1||t===r},Sl=function(){function e(t,r){if(this.context=t,this.textNodes=[],this.elements=[],this.flags=0,y5(r,3))debugger;this.styles=new ype(t,window.getComputedStyle(r,null)),b5(r)&&(this.styles.animationDuration.some(function(n){return n>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=Rv(this.context,r),y5(r,4)&&(this.flags|=16)}return e}(),Npe="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",sk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",vh=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var cg=0;cg<sk.length;cg++)vh[sk.charCodeAt(cg)]=cg;var Cpe=function(e){var t=e.length*.75,r=e.length,n,s=0,i,o,l,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var A=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),d=Array.isArray(A)?A:new Uint8Array(A);for(n=0;n<r;n+=4)i=vh[e.charCodeAt(n)],o=vh[e.charCodeAt(n+1)],l=vh[e.charCodeAt(n+2)],c=vh[e.charCodeAt(n+3)],d[s++]=i<<2|o>>4,d[s++]=(o&15)<<4|l>>2,d[s++]=(l&3)<<6|c&63;return A},jpe=function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r.push(e[n+1]<<8|e[n]);return r},Bpe=function(e){for(var t=e.length,r=[],n=0;n<t;n+=4)r.push(e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]);return r},yd=5,Cj=11,Jw=2,Spe=Cj-yd,gP=65536>>yd,Fpe=1<<yd,Zw=Fpe-1,Epe=1024>>yd,kpe=gP+Epe,Tpe=kpe,_pe=32,Ipe=Tpe+_pe,Lpe=65536>>Cj,Upe=1<<Spe,Dpe=Upe-1,ak=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},Ppe=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},Ope=function(e,t){var r=Cpe(e),n=Array.isArray(r)?Bpe(r):new Uint32Array(r),s=Array.isArray(r)?jpe(r):new Uint16Array(r),i=24,o=ak(s,i/2,n[4]/2),l=n[5]===2?ak(s,(i+n[4])/2):Ppe(n,Math.ceil((i+n[4])/4));return new Rpe(n[0],n[1],n[2],n[3],o,l)},Rpe=function(){function e(t,r,n,s,i,o){this.initialValue=t,this.errorValue=r,this.highStart=n,this.highValueIndex=s,this.index=i,this.data=o}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>yd],r=(r<<Jw)+(t&Zw),this.data[r];if(t<=65535)return r=this.index[gP+(t-55296>>yd)],r=(r<<Jw)+(t&Zw),this.data[r];if(t<this.highStart)return r=Ipe-Lpe+(t>>Cj),r=this.index[r],r+=t>>yd&Dpe,r=this.index[r],r=(r<<Jw)+(t&Zw),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),ik="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Qpe=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Ag=0;Ag<ik.length;Ag++)Qpe[ik.charCodeAt(Ag)]=Ag;var Mpe=1,eb=2,tb=3,ok=4,lk=5,Hpe=7,ck=8,rb=9,nb=10,Ak=11,dk=12,uk=13,fk=14,sb=15,Vpe=function(e){for(var t=[],r=0,n=e.length;r<n;){var s=e.charCodeAt(r++);if(s>=55296&&s<=56319&&r<n){var i=e.charCodeAt(r++);(i&64512)===56320?t.push(((s&1023)<<10)+(i&1023)+65536):(t.push(s),r--)}else t.push(s)}return t},$pe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var n=[],s=-1,i="";++s<r;){var o=e[s];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(s+1===r||n.length>16384)&&(i+=String.fromCharCode.apply(String,n),n.length=0)}return i},qpe=Ope(Npe),Zi="",ab="",Kpe=function(e){return qpe.get(e)},zpe=function(e,t,r){var n=r-2,s=t[n],i=t[r-1],o=t[r];if(i===eb&&o===tb)return Zi;if(i===eb||i===tb||i===ok||o===eb||o===tb||o===ok)return ab;if(i===ck&&[ck,rb,Ak,dk].indexOf(o)!==-1||(i===Ak||i===rb)&&(o===rb||o===nb)||(i===dk||i===nb)&&o===nb||o===uk||o===lk||o===Hpe||i===Mpe)return Zi;if(i===uk&&o===fk){for(;s===lk;)s=t[--n];if(s===fk)return Zi}if(i===sb&&o===sb){for(var l=0;s===sb;)l++,s=t[--n];if(l%2===0)return Zi}return ab},Gpe=function(e){var t=Vpe(e),r=t.length,n=0,s=0,i=t.map(Kpe);return{next:function(){if(n>=r)return{done:!0,value:null};for(var o=Zi;n<r&&(o=zpe(t,i,++n))===Zi;);if(o!==Zi||n===r){var l=$pe.apply(null,t.slice(s,n));return s=n,{value:l,done:!1}}return{done:!0,value:null}}}},Wpe=function(e){for(var t=Gpe(e),r=[],n;!(n=t.next()).done;)n.value&&r.push(n.value.slice());return r},Xpe=function(e){var t=123;if(e.createRange){var r=e.createRange();if(r.getBoundingClientRect){var n=e.createElement("boundtest");n.style.height=t+"px",n.style.display="block",e.body.appendChild(n),r.selectNode(n);var s=r.getBoundingClientRect(),i=Math.round(s.height);if(e.body.removeChild(n),i===t)return!0}}return!1},Ype=function(e){var t=e.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",e.body.appendChild(t);var r=e.createRange();t.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var n=t.firstChild,s=Qv(n.data).map(function(c){return Zn(c)}),i=0,o={},l=s.every(function(c,A){r.setStart(n,i),r.setEnd(n,i+c.length);var d=r.getBoundingClientRect();i+=c.length;var u=d.x>o.x||d.y>o.y;return o=d,A===0?!0:u});return e.body.removeChild(t),l},Jpe=function(){return typeof new Image().crossOrigin<"u"},Zpe=function(){return typeof new XMLHttpRequest().responseType=="string"},exe=function(e){var t=new Image,r=e.createElement("canvas"),n=r.getContext("2d");if(!n)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(t,0,0),r.toDataURL()}catch{return!1}return!0},hk=function(e){return e[0]===0&&e[1]===255&&e[2]===0&&e[3]===255},txe=function(e){var t=e.createElement("canvas"),r=100;t.width=r,t.height=r;var n=t.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,r,r);var s=new Image,i=t.toDataURL();s.src=i;var o=v5(r,r,0,0,s);return n.fillStyle="red",n.fillRect(0,0,r,r),mk(o).then(function(l){n.drawImage(l,0,0);var c=n.getImageData(0,0,r,r).data;n.fillStyle="red",n.fillRect(0,0,r,r);var A=e.createElement("div");return A.style.backgroundImage="url("+i+")",A.style.height=r+"px",hk(c)?mk(v5(r,r,0,0,A)):Promise.reject(!1)}).then(function(l){return n.drawImage(l,0,0),hk(n.getImageData(0,0,r,r).data)}).catch(function(){return!1})},v5=function(e,t,r,n,s){var i="http://www.w3.org/2000/svg",o=document.createElementNS(i,"svg"),l=document.createElementNS(i,"foreignObject");return o.setAttributeNS(null,"width",e.toString()),o.setAttributeNS(null,"height",t.toString()),l.setAttributeNS(null,"width","100%"),l.setAttributeNS(null,"height","100%"),l.setAttributeNS(null,"x",r.toString()),l.setAttributeNS(null,"y",n.toString()),l.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(l),l.appendChild(s),o},mk=function(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){return t(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},Vs={get SUPPORT_RANGE_BOUNDS(){var e=Xpe(document);return Object.defineProperty(Vs,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_WORD_BREAKING(){var e=Vs.SUPPORT_RANGE_BOUNDS&&Ype(document);return Object.defineProperty(Vs,"SUPPORT_WORD_BREAKING",{value:e}),e},get SUPPORT_SVG_DRAWING(){var e=exe(document);return Object.defineProperty(Vs,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_FOREIGNOBJECT_DRAWING(){var e=typeof Array.from=="function"&&typeof window.fetch=="function"?txe(document):Promise.resolve(!1);return Object.defineProperty(Vs,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){var e=Jpe();return Object.defineProperty(Vs,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){var e=Zpe();return Object.defineProperty(Vs,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){var e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Vs,"SUPPORT_CORS_XHR",{value:e}),e},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var e=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Vs,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:e}),e}},Kh=function(){function e(t,r){this.text=t,this.bounds=r}return e}(),rxe=function(e,t,r,n){var s=axe(t,r),i=[],o=0;return s.forEach(function(l){if(r.textDecorationLine.length||l.trim().length>0)if(Vs.SUPPORT_RANGE_BOUNDS){var c=pk(n,o,l.length).getClientRects();if(c.length>1){var A=jj(l),d=0;A.forEach(function(f){i.push(new Kh(f,fc.fromDOMRectList(e,pk(n,d+o,f.length).getClientRects()))),d+=f.length})}else i.push(new Kh(l,fc.fromDOMRectList(e,c)))}else{var u=n.splitText(l.length);i.push(new Kh(l,nxe(e,n))),n=u}else Vs.SUPPORT_RANGE_BOUNDS||(n=n.splitText(l.length));o+=l.length}),i},nxe=function(e,t){var r=t.ownerDocument;if(r){var n=r.createElement("html2canvaswrapper");n.appendChild(t.cloneNode(!0));var s=t.parentNode;if(s){s.replaceChild(n,t);var i=Rv(e,n);return n.firstChild&&s.replaceChild(n.firstChild,n),i}}return fc.EMPTY},pk=function(e,t,r){var n=e.ownerDocument;if(!n)throw new Error("Node has no owner document");var s=n.createRange();return s.setStart(e,t),s.setEnd(e,t+r),s},jj=function(e){if(Vs.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(e)).map(function(r){return r.segment})}return Wpe(e)},sxe=function(e,t){if(Vs.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(e)).map(function(n){return n.segment})}return oxe(e,t)},axe=function(e,t){return t.letterSpacing!==0?jj(e):sxe(e,t)},ixe=[32,160,4961,65792,65793,4153,4241],oxe=function(e,t){for(var r=L0e(e,{lineBreak:t.lineBreak,wordBreak:t.overflowWrap==="break-word"?"break-word":t.wordBreak}),n=[],s,i=function(){if(s.value){var o=s.value.slice(),l=Qv(o),c="";l.forEach(function(A){ixe.indexOf(A)===-1?c+=Zn(A):(c.length&&n.push(c),n.push(Zn(A)),c="")}),c.length&&n.push(c)}};!(s=r.next()).done;)i();return n},lxe=function(){function e(t,r,n){this.text=cxe(r.data,n.textTransform),this.textBounds=rxe(t,this.text,n,r)}return e}(),cxe=function(e,t){switch(t){case 1:return e.toLowerCase();case 3:return e.replace(Axe,dxe);case 2:return e.toUpperCase();default:return e}},Axe=/(^|\s|:|-|\(|\))([a-z])/g,dxe=function(e,t,r){return e.length>0?t+r.toUpperCase():e},yP=function(e){zo(t,e);function t(r,n){var s=e.call(this,r,n)||this;return s.src=n.currentSrc||n.src,s.intrinsicWidth=n.naturalWidth,s.intrinsicHeight=n.naturalHeight,s.context.cache.addImage(s.src),s}return t}(Sl),vP=function(e){zo(t,e);function t(r,n){var s=e.call(this,r,n)||this;return s.canvas=n,s.intrinsicWidth=n.width,s.intrinsicHeight=n.height,s}return t}(Sl),wP=function(e){zo(t,e);function t(r,n){var s=e.call(this,r,n)||this,i=new XMLSerializer,o=Rv(r,n);return n.setAttribute("width",o.width+"px"),n.setAttribute("height",o.height+"px"),s.svg="data:image/svg+xml,"+encodeURIComponent(i.serializeToString(n)),s.intrinsicWidth=n.width.baseVal.value,s.intrinsicHeight=n.height.baseVal.value,s.context.cache.addImage(s.svg),s}return t}(Sl),bP=function(e){zo(t,e);function t(r,n){var s=e.call(this,r,n)||this;return s.value=n.value,s}return t}(Sl),w5=function(e){zo(t,e);function t(r,n){var s=e.call(this,r,n)||this;return s.start=n.start,s.reversed=typeof n.reversed=="boolean"&&n.reversed===!0,s}return t}(Sl),uxe=[{type:15,flags:0,unit:"px",number:3}],fxe=[{type:16,flags:0,number:50}],hxe=function(e){return e.width>e.height?new fc(e.left+(e.width-e.height)/2,e.top,e.height,e.height):e.width<e.height?new fc(e.left,e.top+(e.height-e.width)/2,e.width,e.width):e},mxe=function(e){var t=e.type===pxe?new Array(e.value.length+1).join(""):e.value;return t.length===0?e.placeholder||"":t},oy="checkbox",ly="radio",pxe="password",xk=707406591,Bj=function(e){zo(t,e);function t(r,n){var s=e.call(this,r,n)||this;switch(s.type=n.type.toLowerCase(),s.checked=n.checked,s.value=mxe(n),(s.type===oy||s.type===ly)&&(s.styles.backgroundColor=3739148031,s.styles.borderTopColor=s.styles.borderRightColor=s.styles.borderBottomColor=s.styles.borderLeftColor=2779096575,s.styles.borderTopWidth=s.styles.borderRightWidth=s.styles.borderBottomWidth=s.styles.borderLeftWidth=1,s.styles.borderTopStyle=s.styles.borderRightStyle=s.styles.borderBottomStyle=s.styles.borderLeftStyle=1,s.styles.backgroundClip=[0],s.styles.backgroundOrigin=[0],s.bounds=hxe(s.bounds)),s.type){case oy:s.styles.borderTopRightRadius=s.styles.borderTopLeftRadius=s.styles.borderBottomRightRadius=s.styles.borderBottomLeftRadius=uxe;break;case ly:s.styles.borderTopRightRadius=s.styles.borderTopLeftRadius=s.styles.borderBottomRightRadius=s.styles.borderBottomLeftRadius=fxe;break}return s}return t}(Sl),NP=function(e){zo(t,e);function t(r,n){var s=e.call(this,r,n)||this,i=n.options[n.selectedIndex||0];return s.value=i&&i.text||"",s}return t}(Sl),CP=function(e){zo(t,e);function t(r,n){var s=e.call(this,r,n)||this;return s.value=n.value,s}return t}(Sl),jP=function(e){zo(t,e);function t(r,n){var s=e.call(this,r,n)||this;s.src=n.src,s.width=parseInt(n.width,10)||0,s.height=parseInt(n.height,10)||0,s.backgroundColor=s.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){s.tree=SP(r,n.contentWindow.document.documentElement);var i=n.contentWindow.document.documentElement?$h(r,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):sc.TRANSPARENT,o=n.contentWindow.document.body?$h(r,getComputedStyle(n.contentWindow.document.body).backgroundColor):sc.TRANSPARENT;s.backgroundColor=fA(i)?fA(o)?s.styles.backgroundColor:o:i}}catch{}return s}return t}(Sl),xxe=["OL","UL","MENU"],Gg=function(e,t,r,n){for(var s=t.firstChild,i=void 0;s;s=i)if(i=s.nextSibling,FP(s)&&s.data.trim().length>0)r.textNodes.push(new lxe(e,s,r.styles));else if(af(s))if(_P(s)&&s.assignedNodes)s.assignedNodes().forEach(function(l){return Gg(e,l,r,n)});else{var o=BP(e,s);o.styles.isVisible()&&(gxe(s,o,n)?o.flags|=4:yxe(o.styles)&&(o.flags|=2),xxe.indexOf(s.tagName)!==-1&&(o.flags|=8),r.elements.push(o),s.slot,s.shadowRoot?Gg(e,s.shadowRoot,o,n):!cy(s)&&!EP(s)&&!Ay(s)&&Gg(e,s,o,n))}},BP=function(e,t){return N5(t)?new yP(e,t):kP(t)?new vP(e,t):EP(t)?new wP(e,t):vxe(t)?new bP(e,t):wxe(t)?new w5(e,t):bxe(t)?new Bj(e,t):Ay(t)?new NP(e,t):cy(t)?new CP(e,t):TP(t)?new jP(e,t):new Sl(e,t)},SP=function(e,t){var r=BP(e,t);return r.flags|=4,Gg(e,t,r,r),r},gxe=function(e,t,r){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||Sj(e)&&r.styles.isTransparent()},yxe=function(e){return e.isPositioned()||e.isFloating()},FP=function(e){return e.nodeType===Node.TEXT_NODE},af=function(e){return e.nodeType===Node.ELEMENT_NODE},b5=function(e){return af(e)&&typeof e.style<"u"&&!Wg(e)},Wg=function(e){return typeof e.className=="object"},vxe=function(e){return e.tagName==="LI"},wxe=function(e){return e.tagName==="OL"},bxe=function(e){return e.tagName==="INPUT"},Nxe=function(e){return e.tagName==="HTML"},EP=function(e){return e.tagName==="svg"},Sj=function(e){return e.tagName==="BODY"},kP=function(e){return e.tagName==="CANVAS"},gk=function(e){return e.tagName==="VIDEO"},N5=function(e){return e.tagName==="IMG"},TP=function(e){return e.tagName==="IFRAME"},yk=function(e){return e.tagName==="STYLE"},Cxe=function(e){return e.tagName==="SCRIPT"},cy=function(e){return e.tagName==="TEXTAREA"},Ay=function(e){return e.tagName==="SELECT"},_P=function(e){return e.tagName==="SLOT"},vk=function(e){return e.tagName.indexOf("-")>0},jxe=function(){function e(){this.counters={}}return e.prototype.getCounterValue=function(t){var r=this.counters[t];return r&&r.length?r[r.length-1]:1},e.prototype.getCounterValues=function(t){var r=this.counters[t];return r||[]},e.prototype.pop=function(t){var r=this;t.forEach(function(n){return r.counters[n].pop()})},e.prototype.parse=function(t){var r=this,n=t.counterIncrement,s=t.counterReset,i=!0;n!==null&&n.forEach(function(l){var c=r.counters[l.counter];c&&l.increment!==0&&(i=!1,c.length||c.push(1),c[Math.max(0,c.length-1)]+=l.increment)});var o=[];return i&&s.forEach(function(l){var c=r.counters[l.counter];o.push(l.counter),c||(c=r.counters[l.counter]=[]),c.push(l.reset)}),o},e}(),wk={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},bk={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Bxe={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Sxe={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},_u=function(e,t,r,n,s,i){return e<t||e>r?Om(e,s,i.length>0):n.integers.reduce(function(o,l,c){for(;e>=l;)e-=l,o+=n.values[c];return o},"")+i},IP=function(e,t,r,n){var s="";do r||e--,s=n(e)+s,e/=t;while(e*t>=t);return s},Yn=function(e,t,r,n,s){var i=r-t+1;return(e<0?"-":"")+(IP(Math.abs(e),i,n,function(o){return Zn(Math.floor(o%i)+t)})+s)},qA=function(e,t,r){r===void 0&&(r=". ");var n=t.length;return IP(Math.abs(e),n,!1,function(s){return t[Math.floor(s%n)]})+r},Ru=1,Rc=2,Qc=4,wh=8,Ql=function(e,t,r,n,s,i){if(e<-9999||e>9999)return Om(e,4,s.length>0);var o=Math.abs(e),l=s;if(o===0)return t[0]+l;for(var c=0;o>0&&c<=4;c++){var A=o%10;A===0&&vs(i,Ru)&&l!==""?l=t[A]+l:A>1||A===1&&c===0||A===1&&c===1&&vs(i,Rc)||A===1&&c===1&&vs(i,Qc)&&e>100||A===1&&c>1&&vs(i,wh)?l=t[A]+(c>0?r[c-1]:"")+l:A===1&&c>0&&(l=r[c-1]+l),o=Math.floor(o/10)}return(e<0?n:"")+l},Nk="",Ck="",jk="",ib="",Om=function(e,t,r){var n=r?". ":"",s=r?"":"",i=r?", ":"",o=r?" ":"";switch(t){case 0:return""+o;case 1:return""+o;case 2:return""+o;case 5:var l=Yn(e,48,57,!0,n);return l.length<4?"0"+l:l;case 4:return qA(e,"",s);case 6:return _u(e,1,3999,wk,3,n).toLowerCase();case 7:return _u(e,1,3999,wk,3,n);case 8:return Yn(e,945,969,!1,n);case 9:return Yn(e,97,122,!1,n);case 10:return Yn(e,65,90,!1,n);case 11:return Yn(e,1632,1641,!0,n);case 12:case 49:return _u(e,1,9999,bk,3,n);case 35:return _u(e,1,9999,bk,3,n).toLowerCase();case 13:return Yn(e,2534,2543,!0,n);case 14:case 30:return Yn(e,6112,6121,!0,n);case 15:return qA(e,"",s);case 16:return qA(e,"",s);case 17:case 48:return Ql(e,"",Nk,"",s,Rc|Qc|wh);case 47:return Ql(e,"",Ck,"",s,Ru|Rc|Qc|wh);case 42:return Ql(e,"",Nk,"",s,Rc|Qc|wh);case 41:return Ql(e,"",Ck,"",s,Ru|Rc|Qc|wh);case 26:return Ql(e,"","",jk,s,0);case 25:return Ql(e,"","",jk,s,Ru|Rc|Qc);case 31:return Ql(e,"","",ib,i,Ru|Rc|Qc);case 33:return Ql(e,"","",ib,i,0);case 32:return Ql(e,"","",ib,i,Ru|Rc|Qc);case 18:return Yn(e,2406,2415,!0,n);case 20:return _u(e,1,19999,Sxe,3,n);case 21:return Yn(e,2790,2799,!0,n);case 22:return Yn(e,2662,2671,!0,n);case 22:return _u(e,1,10999,Bxe,3,n);case 23:return qA(e,"");case 24:return qA(e,"");case 27:return Yn(e,3302,3311,!0,n);case 28:return qA(e,"",s);case 29:return qA(e,"",s);case 34:return Yn(e,3792,3801,!0,n);case 37:return Yn(e,6160,6169,!0,n);case 38:return Yn(e,4160,4169,!0,n);case 39:return Yn(e,2918,2927,!0,n);case 40:return Yn(e,1776,1785,!0,n);case 43:return Yn(e,3046,3055,!0,n);case 44:return Yn(e,3174,3183,!0,n);case 45:return Yn(e,3664,3673,!0,n);case 46:return Yn(e,3872,3881,!0,n);case 3:default:return Yn(e,48,57,!0,n)}},LP="data-html2canvas-ignore",Bk=function(){function e(t,r,n){if(this.context=t,this.options=n,this.scrolledElements=[],this.referenceElement=r,this.counters=new jxe,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return e.prototype.toIFrame=function(t,r){var n=this,s=Fxe(t,r);if(!s.contentWindow)return Promise.reject("Unable to find iframe window");var i=t.defaultView.pageXOffset,o=t.defaultView.pageYOffset,l=s.contentWindow,c=l.document,A=Txe(s).then(function(){return Ba(n,void 0,void 0,function(){var d,u;return la(this,function(f){switch(f.label){case 0:return this.scrolledElements.forEach(Uxe),l&&(l.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(l.scrollY!==r.top||l.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(l.scrollX-r.left,l.scrollY-r.top,0,0))),d=this.options.onclone,u=this.clonedReferenceElement,typeof u>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:c.fonts&&c.fonts.ready?[4,c.fonts.ready]:[3,2];case 1:f.sent(),f.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,kxe(c)]:[3,4];case 3:f.sent(),f.label=4;case 4:return typeof d=="function"?[2,Promise.resolve().then(function(){return d(c,u)}).then(function(){return s})]:[2,s]}})})});return c.open(),c.write(Ixe(document.doctype)+"<html></html>"),Lxe(this.referenceElement.ownerDocument,i,o),c.replaceChild(c.adoptNode(this.documentElement),c.documentElement),c.close(),A},e.prototype.createElementClone=function(t){if(y5(t,2))debugger;if(kP(t))return this.createCanvasClone(t);if(gk(t))return this.createVideoClone(t);if(yk(t))return this.createStyleClone(t);var r=t.cloneNode(!1);return N5(r)&&(N5(t)&&t.currentSrc&&t.currentSrc!==t.src&&(r.src=t.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),vk(r)?this.createCustomElementClone(r):r},e.prototype.createCustomElementClone=function(t){var r=document.createElement("html2canvascustomelement");return ob(t.style,r),r},e.prototype.createStyleClone=function(t){try{var r=t.sheet;if(r&&r.cssRules){var n=[].slice.call(r.cssRules,0).reduce(function(i,o){return o&&typeof o.cssText=="string"?i+o.cssText:i},""),s=t.cloneNode(!1);return s.textContent=n,s}}catch(i){if(this.context.logger.error("Unable to access cssRules property",i),i.name!=="SecurityError")throw i}return t.cloneNode(!1)},e.prototype.createCanvasClone=function(t){var r;if(this.options.inlineImages&&t.ownerDocument){var n=t.ownerDocument.createElement("img");try{return n.src=t.toDataURL(),n}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",t)}}var s=t.cloneNode(!1);try{s.width=t.width,s.height=t.height;var i=t.getContext("2d"),o=s.getContext("2d");if(o)if(!this.options.allowTaint&&i)o.putImageData(i.getImageData(0,0,t.width,t.height),0,0);else{var l=(r=t.getContext("webgl2"))!==null&&r!==void 0?r:t.getContext("webgl");if(l){var c=l.getContextAttributes();(c==null?void 0:c.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",t)}o.drawImage(t,0,0)}return s}catch{this.context.logger.info("Unable to clone canvas as it is tainted",t)}return s},e.prototype.createVideoClone=function(t){var r=t.ownerDocument.createElement("canvas");r.width=t.offsetWidth,r.height=t.offsetHeight;var n=r.getContext("2d");try{return n&&(n.drawImage(t,0,0,r.width,r.height),this.options.allowTaint||n.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",t)}var s=t.ownerDocument.createElement("canvas");return s.width=t.offsetWidth,s.height=t.offsetHeight,s},e.prototype.appendChildNode=function(t,r,n){(!af(r)||!Cxe(r)&&!r.hasAttribute(LP)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!af(r)||!yk(r))&&t.appendChild(this.cloneNode(r,n))},e.prototype.cloneChildNodes=function(t,r,n){for(var s=this,i=t.shadowRoot?t.shadowRoot.firstChild:t.firstChild;i;i=i.nextSibling)if(af(i)&&_P(i)&&typeof i.assignedNodes=="function"){var o=i.assignedNodes();o.length&&o.forEach(function(l){return s.appendChildNode(r,l,n)})}else this.appendChildNode(r,i,n)},e.prototype.cloneNode=function(t,r){if(FP(t))return document.createTextNode(t.data);if(!t.ownerDocument)return t.cloneNode(!1);var n=t.ownerDocument.defaultView;if(n&&af(t)&&(b5(t)||Wg(t))){var s=this.createElementClone(t);s.style.transitionProperty="none";var i=n.getComputedStyle(t),o=n.getComputedStyle(t,":before"),l=n.getComputedStyle(t,":after");this.referenceElement===t&&b5(s)&&(this.clonedReferenceElement=s),Sj(s)&&Oxe(s);var c=this.counters.parse(new nk(this.context,i)),A=this.resolvePseudoContent(t,s,o,zh.BEFORE);vk(t)&&(r=!0),gk(t)||this.cloneChildNodes(t,s,r),A&&s.insertBefore(A,s.firstChild);var d=this.resolvePseudoContent(t,s,l,zh.AFTER);return d&&s.appendChild(d),this.counters.pop(c),(i&&(this.options.copyStyles||Wg(t))&&!TP(t)||r)&&ob(i,s),(t.scrollTop!==0||t.scrollLeft!==0)&&this.scrolledElements.push([s,t.scrollLeft,t.scrollTop]),(cy(t)||Ay(t))&&(cy(s)||Ay(s))&&(s.value=t.value),s}return t.cloneNode(!1)},e.prototype.resolvePseudoContent=function(t,r,n,s){var i=this;if(n){var o=n.content,l=r.ownerDocument;if(!(!l||!o||o==="none"||o==="-moz-alt-content"||n.display==="none")){this.counters.parse(new nk(this.context,n));var c=new vpe(this.context,n),A=l.createElement("html2canvaspseudoelement");ob(n,A),c.content.forEach(function(u){if(u.type===0)A.appendChild(l.createTextNode(u.value));else if(u.type===22){var f=l.createElement("img");f.src=u.value,f.style.opacity="1",A.appendChild(f)}else if(u.type===18){if(u.name==="attr"){var h=u.values.filter(ln);h.length&&A.appendChild(l.createTextNode(t.getAttribute(h[0].value)||""))}else if(u.name==="counter"){var x=u.values.filter(Qf),m=x[0],g=x[1];if(m&&ln(m)){var p=i.counters.getCounterValue(m.value),v=g&&ln(g)?g5.parse(i.context,g.value):3;A.appendChild(l.createTextNode(Om(p,v,!1)))}}else if(u.name==="counters"){var w=u.values.filter(Qf),m=w[0],B=w[1],g=w[2];if(m&&ln(m)){var T=i.counters.getCounterValues(m.value),_=g&&ln(g)?g5.parse(i.context,g.value):3,j=B&&B.type===0?B.value:"",E=T.map(function(F){return Om(F,_,!1)}).join(j);A.appendChild(l.createTextNode(E))}}}else if(u.type===20)switch(u.value){case"open-quote":A.appendChild(l.createTextNode(rk(c.quotes,i.quoteDepth++,!0)));break;case"close-quote":A.appendChild(l.createTextNode(rk(c.quotes,--i.quoteDepth,!1)));break;default:A.appendChild(l.createTextNode(u.value))}}),A.className=C5+" "+j5;var d=s===zh.BEFORE?" "+C5:" "+j5;return Wg(r)?r.className.baseValue+=d:r.className+=d,A}}},e.destroy=function(t){return t.parentNode?(t.parentNode.removeChild(t),!0):!1},e}(),zh;(function(e){e[e.BEFORE=0]="BEFORE",e[e.AFTER=1]="AFTER"})(zh||(zh={}));var Fxe=function(e,t){var r=e.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=t.width.toString(),r.height=t.height.toString(),r.scrolling="no",r.setAttribute(LP,"true"),e.body.appendChild(r),r},Exe=function(e){return new Promise(function(t){if(e.complete){t();return}if(!e.src){t();return}e.onload=t,e.onerror=t})},kxe=function(e){return Promise.all([].slice.call(e.images,0).map(Exe))},Txe=function(e){return new Promise(function(t,r){var n=e.contentWindow;if(!n)return r("No window assigned for iframe");var s=n.document;n.onload=e.onload=function(){n.onload=e.onload=null;var i=setInterval(function(){s.body.childNodes.length>0&&s.readyState==="complete"&&(clearInterval(i),t(e))},50)}})},_xe=["all","d","content"],ob=function(e,t){for(var r=e.length-1;r>=0;r--){var n=e.item(r);_xe.indexOf(n)===-1&&t.style.setProperty(n,e.getPropertyValue(n))}return t},Ixe=function(e){var t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+='"'+e.publicId+'"'),e.systemId&&(t+='"'+e.systemId+'"'),t+=">"),t},Lxe=function(e,t,r){e&&e.defaultView&&(t!==e.defaultView.pageXOffset||r!==e.defaultView.pageYOffset)&&e.defaultView.scrollTo(t,r)},Uxe=function(e){var t=e[0],r=e[1],n=e[2];t.scrollLeft=r,t.scrollTop=n},Dxe=":before",Pxe=":after",C5="___html2canvas___pseudoelement_before",j5="___html2canvas___pseudoelement_after",Sk=`{
    content: "" !important;
    display: none !important;
}`,Oxe=function(e){Rxe(e,"."+C5+Dxe+Sk+`
         .`+j5+Pxe+Sk)},Rxe=function(e,t){var r=e.ownerDocument;if(r){var n=r.createElement("style");n.textContent=t,e.appendChild(n)}},UP=function(){function e(){}return e.getOrigin=function(t){var r=e._link;return r?(r.href=t,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},e.isSameOrigin=function(t){return e.getOrigin(t)===e._origin},e.setContext=function(t){e._link=t.document.createElement("a"),e._origin=e.getOrigin(t.location.href)},e._origin="about:blank",e}(),Qxe=function(){function e(t,r){this.context=t,this._options=r,this._cache={}}return e.prototype.addImage=function(t){var r=Promise.resolve();return this.has(t)||(cb(t)||$xe(t))&&(this._cache[t]=this.loadImage(t)).catch(function(){}),r},e.prototype.match=function(t){return this._cache[t]},e.prototype.loadImage=function(t){return Ba(this,void 0,void 0,function(){var r,n,s,i,o=this;return la(this,function(l){switch(l.label){case 0:return r=UP.isSameOrigin(t),n=!lb(t)&&this._options.useCORS===!0&&Vs.SUPPORT_CORS_IMAGES&&!r,s=!lb(t)&&!r&&!cb(t)&&typeof this._options.proxy=="string"&&Vs.SUPPORT_CORS_XHR&&!n,!r&&this._options.allowTaint===!1&&!lb(t)&&!cb(t)&&!s&&!n?[2]:(i=t,s?[4,this.proxy(i)]:[3,2]);case 1:i=l.sent(),l.label=2;case 2:return this.context.logger.debug("Added image "+t.substring(0,256)),[4,new Promise(function(c,A){var d=new Image;d.onload=function(){return c(d)},d.onerror=A,(qxe(i)||n)&&(d.crossOrigin="anonymous"),d.src=i,d.complete===!0&&setTimeout(function(){return c(d)},500),o._options.imageTimeout>0&&setTimeout(function(){return A("Timed out ("+o._options.imageTimeout+"ms) loading image")},o._options.imageTimeout)})];case 3:return[2,l.sent()]}})})},e.prototype.has=function(t){return typeof this._cache[t]<"u"},e.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},e.prototype.proxy=function(t){var r=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var s=t.substring(0,256);return new Promise(function(i,o){var l=Vs.SUPPORT_RESPONSE_TYPE?"blob":"text",c=new XMLHttpRequest;c.onload=function(){if(c.status===200)if(l==="text")i(c.response);else{var u=new FileReader;u.addEventListener("load",function(){return i(u.result)},!1),u.addEventListener("error",function(f){return o(f)},!1),u.readAsDataURL(c.response)}else o("Failed to proxy resource "+s+" with status code "+c.status)},c.onerror=o;var A=n.indexOf("?")>-1?"&":"?";if(c.open("GET",""+n+A+"url="+encodeURIComponent(t)+"&responseType="+l),l!=="text"&&c instanceof XMLHttpRequest&&(c.responseType=l),r._options.imageTimeout){var d=r._options.imageTimeout;c.timeout=d,c.ontimeout=function(){return o("Timed out ("+d+"ms) proxying "+s)}}c.send()})},e}(),Mxe=/^data:image\/svg\+xml/i,Hxe=/^data:image\/.*;base64,/i,Vxe=/^data:image\/.*/i,$xe=function(e){return Vs.SUPPORT_SVG_DRAWING||!Kxe(e)},lb=function(e){return Vxe.test(e)},qxe=function(e){return Hxe.test(e)},cb=function(e){return e.substr(0,4)==="blob"},Kxe=function(e){return e.substr(-3).toLowerCase()==="svg"||Mxe.test(e)},Rt=function(){function e(t,r){this.type=0,this.x=t,this.y=r}return e.prototype.add=function(t,r){return new e(this.x+t,this.y+r)},e}(),Iu=function(e,t,r){return new Rt(e.x+(t.x-e.x)*r,e.y+(t.y-e.y)*r)},dg=function(){function e(t,r,n,s){this.type=1,this.start=t,this.startControl=r,this.endControl=n,this.end=s}return e.prototype.subdivide=function(t,r){var n=Iu(this.start,this.startControl,t),s=Iu(this.startControl,this.endControl,t),i=Iu(this.endControl,this.end,t),o=Iu(n,s,t),l=Iu(s,i,t),c=Iu(o,l,t);return r?new e(this.start,n,o,c):new e(c,l,i,this.end)},e.prototype.add=function(t,r){return new e(this.start.add(t,r),this.startControl.add(t,r),this.endControl.add(t,r),this.end.add(t,r))},e.prototype.reverse=function(){return new e(this.end,this.endControl,this.startControl,this.start)},e}(),no=function(e){return e.type===1},zxe=function(){function e(t){var r=t.styles,n=t.bounds,s=yh(r.borderTopLeftRadius,n.width,n.height),i=s[0],o=s[1],l=yh(r.borderTopRightRadius,n.width,n.height),c=l[0],A=l[1],d=yh(r.borderBottomRightRadius,n.width,n.height),u=d[0],f=d[1],h=yh(r.borderBottomLeftRadius,n.width,n.height),x=h[0],m=h[1],g=[];g.push((i+c)/n.width),g.push((x+u)/n.width),g.push((o+m)/n.height),g.push((A+f)/n.height);var p=Math.max.apply(Math,g);p>1&&(i/=p,o/=p,c/=p,A/=p,u/=p,f/=p,x/=p,m/=p);var v=n.width-c,w=n.height-f,B=n.width-u,T=n.height-m,_=r.borderTopWidth,j=r.borderRightWidth,E=r.borderBottomWidth,L=r.borderLeftWidth,M=xn(r.paddingTop,t.bounds.width),F=xn(r.paddingRight,t.bounds.width),D=xn(r.paddingBottom,t.bounds.width),G=xn(r.paddingLeft,t.bounds.width);this.topLeftBorderDoubleOuterBox=i>0||o>0?En(n.left+L/3,n.top+_/3,i-L/3,o-_/3,Yr.TOP_LEFT):new Rt(n.left+L/3,n.top+_/3),this.topRightBorderDoubleOuterBox=i>0||o>0?En(n.left+v,n.top+_/3,c-j/3,A-_/3,Yr.TOP_RIGHT):new Rt(n.left+n.width-j/3,n.top+_/3),this.bottomRightBorderDoubleOuterBox=u>0||f>0?En(n.left+B,n.top+w,u-j/3,f-E/3,Yr.BOTTOM_RIGHT):new Rt(n.left+n.width-j/3,n.top+n.height-E/3),this.bottomLeftBorderDoubleOuterBox=x>0||m>0?En(n.left+L/3,n.top+T,x-L/3,m-E/3,Yr.BOTTOM_LEFT):new Rt(n.left+L/3,n.top+n.height-E/3),this.topLeftBorderDoubleInnerBox=i>0||o>0?En(n.left+L*2/3,n.top+_*2/3,i-L*2/3,o-_*2/3,Yr.TOP_LEFT):new Rt(n.left+L*2/3,n.top+_*2/3),this.topRightBorderDoubleInnerBox=i>0||o>0?En(n.left+v,n.top+_*2/3,c-j*2/3,A-_*2/3,Yr.TOP_RIGHT):new Rt(n.left+n.width-j*2/3,n.top+_*2/3),this.bottomRightBorderDoubleInnerBox=u>0||f>0?En(n.left+B,n.top+w,u-j*2/3,f-E*2/3,Yr.BOTTOM_RIGHT):new Rt(n.left+n.width-j*2/3,n.top+n.height-E*2/3),this.bottomLeftBorderDoubleInnerBox=x>0||m>0?En(n.left+L*2/3,n.top+T,x-L*2/3,m-E*2/3,Yr.BOTTOM_LEFT):new Rt(n.left+L*2/3,n.top+n.height-E*2/3),this.topLeftBorderStroke=i>0||o>0?En(n.left+L/2,n.top+_/2,i-L/2,o-_/2,Yr.TOP_LEFT):new Rt(n.left+L/2,n.top+_/2),this.topRightBorderStroke=i>0||o>0?En(n.left+v,n.top+_/2,c-j/2,A-_/2,Yr.TOP_RIGHT):new Rt(n.left+n.width-j/2,n.top+_/2),this.bottomRightBorderStroke=u>0||f>0?En(n.left+B,n.top+w,u-j/2,f-E/2,Yr.BOTTOM_RIGHT):new Rt(n.left+n.width-j/2,n.top+n.height-E/2),this.bottomLeftBorderStroke=x>0||m>0?En(n.left+L/2,n.top+T,x-L/2,m-E/2,Yr.BOTTOM_LEFT):new Rt(n.left+L/2,n.top+n.height-E/2),this.topLeftBorderBox=i>0||o>0?En(n.left,n.top,i,o,Yr.TOP_LEFT):new Rt(n.left,n.top),this.topRightBorderBox=c>0||A>0?En(n.left+v,n.top,c,A,Yr.TOP_RIGHT):new Rt(n.left+n.width,n.top),this.bottomRightBorderBox=u>0||f>0?En(n.left+B,n.top+w,u,f,Yr.BOTTOM_RIGHT):new Rt(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=x>0||m>0?En(n.left,n.top+T,x,m,Yr.BOTTOM_LEFT):new Rt(n.left,n.top+n.height),this.topLeftPaddingBox=i>0||o>0?En(n.left+L,n.top+_,Math.max(0,i-L),Math.max(0,o-_),Yr.TOP_LEFT):new Rt(n.left+L,n.top+_),this.topRightPaddingBox=c>0||A>0?En(n.left+Math.min(v,n.width-j),n.top+_,v>n.width+j?0:Math.max(0,c-j),Math.max(0,A-_),Yr.TOP_RIGHT):new Rt(n.left+n.width-j,n.top+_),this.bottomRightPaddingBox=u>0||f>0?En(n.left+Math.min(B,n.width-L),n.top+Math.min(w,n.height-E),Math.max(0,u-j),Math.max(0,f-E),Yr.BOTTOM_RIGHT):new Rt(n.left+n.width-j,n.top+n.height-E),this.bottomLeftPaddingBox=x>0||m>0?En(n.left+L,n.top+Math.min(T,n.height-E),Math.max(0,x-L),Math.max(0,m-E),Yr.BOTTOM_LEFT):new Rt(n.left+L,n.top+n.height-E),this.topLeftContentBox=i>0||o>0?En(n.left+L+G,n.top+_+M,Math.max(0,i-(L+G)),Math.max(0,o-(_+M)),Yr.TOP_LEFT):new Rt(n.left+L+G,n.top+_+M),this.topRightContentBox=c>0||A>0?En(n.left+Math.min(v,n.width+L+G),n.top+_+M,v>n.width+L+G?0:c-L+G,A-(_+M),Yr.TOP_RIGHT):new Rt(n.left+n.width-(j+F),n.top+_+M),this.bottomRightContentBox=u>0||f>0?En(n.left+Math.min(B,n.width-(L+G)),n.top+Math.min(w,n.height+_+M),Math.max(0,u-(j+F)),f-(E+D),Yr.BOTTOM_RIGHT):new Rt(n.left+n.width-(j+F),n.top+n.height-(E+D)),this.bottomLeftContentBox=x>0||m>0?En(n.left+L+G,n.top+T,Math.max(0,x-(L+G)),m-(E+D),Yr.BOTTOM_LEFT):new Rt(n.left+L+G,n.top+n.height-(E+D))}return e}(),Yr;(function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=1]="TOP_RIGHT",e[e.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",e[e.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(Yr||(Yr={}));var En=function(e,t,r,n,s){var i=4*((Math.sqrt(2)-1)/3),o=r*i,l=n*i,c=e+r,A=t+n;switch(s){case Yr.TOP_LEFT:return new dg(new Rt(e,A),new Rt(e,A-l),new Rt(c-o,t),new Rt(c,t));case Yr.TOP_RIGHT:return new dg(new Rt(e,t),new Rt(e+o,t),new Rt(c,A-l),new Rt(c,A));case Yr.BOTTOM_RIGHT:return new dg(new Rt(c,t),new Rt(c,t+l),new Rt(e+o,A),new Rt(e,A));case Yr.BOTTOM_LEFT:default:return new dg(new Rt(c,A),new Rt(c-o,A),new Rt(e,t+l),new Rt(e,t))}},dy=function(e){return[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox]},Gxe=function(e){return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox]},uy=function(e){return[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox]},Wxe=function(){function e(t,r,n){this.offsetX=t,this.offsetY=r,this.matrix=n,this.type=0,this.target=6}return e}(),ug=function(){function e(t,r){this.path=t,this.target=r,this.type=1}return e}(),Xxe=function(){function e(t){this.opacity=t,this.type=2,this.target=6}return e}(),Yxe=function(e){return e.type===0},DP=function(e){return e.type===1},Jxe=function(e){return e.type===2},Fk=function(e,t){return e.length===t.length?e.some(function(r,n){return r===t[n]}):!1},Zxe=function(e,t,r,n,s){return e.map(function(i,o){switch(o){case 0:return i.add(t,r);case 1:return i.add(t+n,r);case 2:return i.add(t+n,r+s);case 3:return i.add(t,r+s)}return i})},PP=function(){function e(t){this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return e}(),OP=function(){function e(t,r){if(this.container=t,this.parent=r,this.effects=[],this.curves=new zxe(this.container),this.container.styles.opacity<1&&this.effects.push(new Xxe(this.container.styles.opacity)),this.container.styles.transform!==null){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,s=this.container.bounds.top+this.container.styles.transformOrigin[1].number,i=this.container.styles.transform;this.effects.push(new Wxe(n,s,i))}if(this.container.styles.overflowX!==0){var o=dy(this.curves),l=uy(this.curves);Fk(o,l)?this.effects.push(new ug(o,6)):(this.effects.push(new ug(o,2)),this.effects.push(new ug(l,4)))}}return e.prototype.getEffects=function(t){for(var r=[2,3].indexOf(this.container.styles.position)===-1,n=this.parent,s=this.effects.slice(0);n;){var i=n.effects.filter(function(c){return!DP(c)});if(r||n.container.styles.position!==0||!n.parent){if(s.unshift.apply(s,i),r=[2,3].indexOf(n.container.styles.position)===-1,n.container.styles.overflowX!==0){var o=dy(n.curves),l=uy(n.curves);Fk(o,l)||s.unshift(new ug(l,6))}}else s.unshift.apply(s,i);n=n.parent}return s.filter(function(c){return vs(c.target,t)})},e}(),B5=function(e,t,r,n){e.container.elements.forEach(function(s){var i=vs(s.flags,4),o=vs(s.flags,2),l=new OP(s,e);vs(s.styles.display,2048)&&n.push(l);var c=vs(s.flags,8)?[]:n;if(i||o){var A=i||s.styles.isPositioned()?r:t,d=new PP(l);if(s.styles.isPositioned()||s.styles.opacity<1||s.styles.isTransformed()){var u=s.styles.zIndex.order;if(u<0){var f=0;A.negativeZIndex.some(function(x,m){return u>x.element.container.styles.zIndex.order?(f=m,!1):f>0}),A.negativeZIndex.splice(f,0,d)}else if(u>0){var h=0;A.positiveZIndex.some(function(x,m){return u>=x.element.container.styles.zIndex.order?(h=m+1,!1):h>0}),A.positiveZIndex.splice(h,0,d)}else A.zeroOrAutoZIndexOrTransformedOrOpacity.push(d)}else s.styles.isFloating()?A.nonPositionedFloats.push(d):A.nonPositionedInlineLevel.push(d);B5(l,d,i?d:r,c)}else s.styles.isInlineLevel()?t.inlineLevel.push(l):t.nonInlineLevel.push(l),B5(l,t,r,c);vs(s.flags,8)&&RP(s,c)})},RP=function(e,t){for(var r=e instanceof w5?e.start:1,n=e instanceof w5?e.reversed:!1,s=0;s<t.length;s++){var i=t[s];i.container instanceof bP&&typeof i.container.value=="number"&&i.container.value!==0&&(r=i.container.value),i.listValue=Om(r,i.container.styles.listStyleType,!0),r+=n?-1:1}},ege=function(e){var t=new OP(e,null),r=new PP(t),n=[];return B5(t,r,r,n),RP(t.container,n),r},Ek=function(e,t){switch(t){case 0:return oo(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return oo(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return oo(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);case 3:default:return oo(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}},tge=function(e,t){switch(t){case 0:return oo(e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox,e.topRightBorderBox,e.topRightBorderDoubleOuterBox);case 1:return oo(e.topRightBorderBox,e.topRightBorderDoubleOuterBox,e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox);case 2:return oo(e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox,e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox);case 3:default:return oo(e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox,e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox)}},rge=function(e,t){switch(t){case 0:return oo(e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox,e.topRightBorderDoubleInnerBox,e.topRightPaddingBox);case 1:return oo(e.topRightBorderDoubleInnerBox,e.topRightPaddingBox,e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox);case 2:return oo(e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox,e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox);case 3:default:return oo(e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox,e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox)}},nge=function(e,t){switch(t){case 0:return fg(e.topLeftBorderStroke,e.topRightBorderStroke);case 1:return fg(e.topRightBorderStroke,e.bottomRightBorderStroke);case 2:return fg(e.bottomRightBorderStroke,e.bottomLeftBorderStroke);case 3:default:return fg(e.bottomLeftBorderStroke,e.topLeftBorderStroke)}},fg=function(e,t){var r=[];return no(e)?r.push(e.subdivide(.5,!1)):r.push(e),no(t)?r.push(t.subdivide(.5,!0)):r.push(t),r},oo=function(e,t,r,n){var s=[];return no(e)?s.push(e.subdivide(.5,!1)):s.push(e),no(r)?s.push(r.subdivide(.5,!0)):s.push(r),no(n)?s.push(n.subdivide(.5,!0).reverse()):s.push(n),no(t)?s.push(t.subdivide(.5,!1).reverse()):s.push(t),s},QP=function(e){var t=e.bounds,r=e.styles;return t.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},fy=function(e){var t=e.styles,r=e.bounds,n=xn(t.paddingLeft,r.width),s=xn(t.paddingRight,r.width),i=xn(t.paddingTop,r.width),o=xn(t.paddingBottom,r.width);return r.add(n+t.borderLeftWidth,i+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+n+s),-(t.borderTopWidth+t.borderBottomWidth+i+o))},sge=function(e,t){return e===0?t.bounds:e===2?fy(t):QP(t)},age=function(e,t){return e===0?t.bounds:e===2?fy(t):QP(t)},Ab=function(e,t,r){var n=sge(Qu(e.styles.backgroundOrigin,t),e),s=age(Qu(e.styles.backgroundClip,t),e),i=ige(Qu(e.styles.backgroundSize,t),r,n),o=i[0],l=i[1],c=yh(Qu(e.styles.backgroundPosition,t),n.width-o,n.height-l),A=oge(Qu(e.styles.backgroundRepeat,t),c,i,n,s),d=Math.round(n.left+c[0]),u=Math.round(n.top+c[1]);return[A,d,u,o,l]},Lu=function(e){return ln(e)&&e.value===yf.AUTO},hg=function(e){return typeof e=="number"},ige=function(e,t,r){var n=t[0],s=t[1],i=t[2],o=e[0],l=e[1];if(!o)return[0,0];if(ps(o)&&l&&ps(l))return[xn(o,r.width),xn(l,r.height)];var c=hg(i);if(ln(o)&&(o.value===yf.CONTAIN||o.value===yf.COVER)){if(hg(i)){var A=r.width/r.height;return A<i!=(o.value===yf.COVER)?[r.width,r.width/i]:[r.height*i,r.height]}return[r.width,r.height]}var d=hg(n),u=hg(s),f=d||u;if(Lu(o)&&(!l||Lu(l))){if(d&&u)return[n,s];if(!c&&!f)return[r.width,r.height];if(f&&c){var h=d?n:s*i,x=u?s:n/i;return[h,x]}var m=d?n:r.width,g=u?s:r.height;return[m,g]}if(c){var p=0,v=0;return ps(o)?p=xn(o,r.width):ps(l)&&(v=xn(l,r.height)),Lu(o)?p=v*i:(!l||Lu(l))&&(v=p/i),[p,v]}var w=null,B=null;if(ps(o)?w=xn(o,r.width):l&&ps(l)&&(B=xn(l,r.height)),w!==null&&(!l||Lu(l))&&(B=d&&u?w/n*s:r.height),B!==null&&Lu(o)&&(w=d&&u?B/s*n:r.width),w!==null&&B!==null)return[w,B];throw new Error("Unable to calculate background-size for element")},Qu=function(e,t){var r=e[t];return typeof r>"u"?e[0]:r},oge=function(e,t,r,n,s){var i=t[0],o=t[1],l=r[0],c=r[1];switch(e){case 2:return[new Rt(Math.round(n.left),Math.round(n.top+o)),new Rt(Math.round(n.left+n.width),Math.round(n.top+o)),new Rt(Math.round(n.left+n.width),Math.round(c+n.top+o)),new Rt(Math.round(n.left),Math.round(c+n.top+o))];case 3:return[new Rt(Math.round(n.left+i),Math.round(n.top)),new Rt(Math.round(n.left+i+l),Math.round(n.top)),new Rt(Math.round(n.left+i+l),Math.round(n.height+n.top)),new Rt(Math.round(n.left+i),Math.round(n.height+n.top))];case 1:return[new Rt(Math.round(n.left+i),Math.round(n.top+o)),new Rt(Math.round(n.left+i+l),Math.round(n.top+o)),new Rt(Math.round(n.left+i+l),Math.round(n.top+o+c)),new Rt(Math.round(n.left+i),Math.round(n.top+o+c))];default:return[new Rt(Math.round(s.left),Math.round(s.top)),new Rt(Math.round(s.left+s.width),Math.round(s.top)),new Rt(Math.round(s.left+s.width),Math.round(s.height+s.top)),new Rt(Math.round(s.left),Math.round(s.height+s.top))]}},lge="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",kk="Hidden Text",cge=function(){function e(t){this._data={},this._document=t}return e.prototype.parseMetrics=function(t,r){var n=this._document.createElement("div"),s=this._document.createElement("img"),i=this._document.createElement("span"),o=this._document.body;n.style.visibility="hidden",n.style.fontFamily=t,n.style.fontSize=r,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",o.appendChild(n),s.src=lge,s.width=1,s.height=1,s.style.margin="0",s.style.padding="0",s.style.verticalAlign="baseline",i.style.fontFamily=t,i.style.fontSize=r,i.style.margin="0",i.style.padding="0",i.appendChild(this._document.createTextNode(kk)),n.appendChild(i),n.appendChild(s);var l=s.offsetTop-i.offsetTop+2;n.removeChild(i),n.appendChild(this._document.createTextNode(kk)),n.style.lineHeight="normal",s.style.verticalAlign="super";var c=s.offsetTop-n.offsetTop+2;return o.removeChild(n),{baseline:l,middle:c}},e.prototype.getMetrics=function(t,r){var n=t+" "+r;return typeof this._data[n]>"u"&&(this._data[n]=this.parseMetrics(t,r)),this._data[n]},e}(),MP=function(){function e(t,r){this.context=t,this.options=r}return e}(),Age=1e4,dge=function(e){zo(t,e);function t(r,n){var s=e.call(this,r,n)||this;return s._activeEffects=[],s.canvas=n.canvas?n.canvas:document.createElement("canvas"),s.ctx=s.canvas.getContext("2d"),n.canvas||(s.canvas.width=Math.floor(n.width*n.scale),s.canvas.height=Math.floor(n.height*n.scale),s.canvas.style.width=n.width+"px",s.canvas.style.height=n.height+"px"),s.fontMetrics=new cge(document),s.ctx.scale(s.options.scale,s.options.scale),s.ctx.translate(-n.x,-n.y),s.ctx.textBaseline="bottom",s._activeEffects=[],s.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),s}return t.prototype.applyEffects=function(r){for(var n=this;this._activeEffects.length;)this.popEffect();r.forEach(function(s){return n.applyEffect(s)})},t.prototype.applyEffect=function(r){this.ctx.save(),Jxe(r)&&(this.ctx.globalAlpha=r.opacity),Yxe(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),DP(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},t.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},t.prototype.renderStack=function(r){return Ba(this,void 0,void 0,function(){var n;return la(this,function(s){switch(s.label){case 0:return n=r.element.container.styles,n.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:s.sent(),s.label=2;case 2:return[2]}})})},t.prototype.renderNode=function(r){return Ba(this,void 0,void 0,function(){return la(this,function(n){switch(n.label){case 0:if(vs(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return n.sent(),[4,this.renderNodeContent(r)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.renderTextWithLetterSpacing=function(r,n,s){var i=this;if(n===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+s);else{var o=jj(r.text);o.reduce(function(l,c){return i.ctx.fillText(c,l,r.bounds.top+s),l+i.ctx.measureText(c).width},r.bounds.left)}},t.prototype.createFontStyle=function(r){var n=r.fontVariant.filter(function(o){return o==="normal"||o==="small-caps"}).join(""),s=pge(r.fontFamily).join(", "),i=mp(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,n,r.fontWeight,i,s].join(" "),s,i]},t.prototype.renderTextNode=function(r,n){return Ba(this,void 0,void 0,function(){var s,i,o,l,c,A,d,u,f=this;return la(this,function(h){return s=this.createFontStyle(n),i=s[0],o=s[1],l=s[2],this.ctx.font=i,this.ctx.direction=n.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",c=this.fontMetrics.getMetrics(o,l),A=c.baseline,d=c.middle,u=n.paintOrder,r.textBounds.forEach(function(x){u.forEach(function(m){switch(m){case 0:f.ctx.fillStyle=Ss(n.color),f.renderTextWithLetterSpacing(x,n.letterSpacing,A);var g=n.textShadow;g.length&&x.text.trim().length&&(g.slice(0).reverse().forEach(function(p){f.ctx.shadowColor=Ss(p.color),f.ctx.shadowOffsetX=p.offsetX.number*f.options.scale,f.ctx.shadowOffsetY=p.offsetY.number*f.options.scale,f.ctx.shadowBlur=p.blur.number,f.renderTextWithLetterSpacing(x,n.letterSpacing,A)}),f.ctx.shadowColor="",f.ctx.shadowOffsetX=0,f.ctx.shadowOffsetY=0,f.ctx.shadowBlur=0),n.textDecorationLine.length&&(f.ctx.fillStyle=Ss(n.textDecorationColor||n.color),n.textDecorationLine.forEach(function(p){switch(p){case 1:f.ctx.fillRect(x.bounds.left,Math.round(x.bounds.top+A),x.bounds.width,1);break;case 2:f.ctx.fillRect(x.bounds.left,Math.round(x.bounds.top),x.bounds.width,1);break;case 3:f.ctx.fillRect(x.bounds.left,Math.ceil(x.bounds.top+d),x.bounds.width,1);break}}));break;case 1:n.webkitTextStrokeWidth&&x.text.trim().length&&(f.ctx.strokeStyle=Ss(n.webkitTextStrokeColor),f.ctx.lineWidth=n.webkitTextStrokeWidth,f.ctx.lineJoin=window.chrome?"miter":"round",f.ctx.strokeText(x.text,x.bounds.left,x.bounds.top+A)),f.ctx.strokeStyle="",f.ctx.lineWidth=0,f.ctx.lineJoin="miter";break}})}),[2]})})},t.prototype.renderReplacedElement=function(r,n,s){if(s&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var i=fy(r),o=uy(n);this.path(o),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(s,0,0,r.intrinsicWidth,r.intrinsicHeight,i.left,i.top,i.width,i.height),this.ctx.restore()}},t.prototype.renderNodeContent=function(r){return Ba(this,void 0,void 0,function(){var n,s,i,o,l,c,v,v,A,d,u,f,B,h,x,T,m,g,p,v,w,B,T;return la(this,function(_){switch(_.label){case 0:this.applyEffects(r.getEffects(4)),n=r.container,s=r.curves,i=n.styles,o=0,l=n.textNodes,_.label=1;case 1:return o<l.length?(c=l[o],[4,this.renderTextNode(c,i)]):[3,4];case 2:_.sent(),_.label=3;case 3:return o++,[3,1];case 4:if(!(n instanceof yP))return[3,8];_.label=5;case 5:return _.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return v=_.sent(),this.renderReplacedElement(n,s,v),[3,8];case 7:return _.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof vP&&this.renderReplacedElement(n,s,n.canvas),!(n instanceof wP))return[3,12];_.label=9;case 9:return _.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return v=_.sent(),this.renderReplacedElement(n,s,v),[3,12];case 11:return _.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof jP&&n.tree?(A=new t(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}),[4,A.render(n.tree)]):[3,14];case 13:d=_.sent(),n.width&&n.height&&this.ctx.drawImage(d,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),_.label=14;case 14:if(n instanceof Bj&&(u=Math.min(n.bounds.width,n.bounds.height),n.type===oy?n.checked&&(this.ctx.save(),this.path([new Rt(n.bounds.left+u*.39363,n.bounds.top+u*.79),new Rt(n.bounds.left+u*.16,n.bounds.top+u*.5549),new Rt(n.bounds.left+u*.27347,n.bounds.top+u*.44071),new Rt(n.bounds.left+u*.39694,n.bounds.top+u*.5649),new Rt(n.bounds.left+u*.72983,n.bounds.top+u*.23),new Rt(n.bounds.left+u*.84,n.bounds.top+u*.34085),new Rt(n.bounds.left+u*.39363,n.bounds.top+u*.79)]),this.ctx.fillStyle=Ss(xk),this.ctx.fill(),this.ctx.restore()):n.type===ly&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+u/2,n.bounds.top+u/2,u/4,0,Math.PI*2,!0),this.ctx.fillStyle=Ss(xk),this.ctx.fill(),this.ctx.restore())),uge(n)&&n.value.length){switch(f=this.createFontStyle(i),B=f[0],h=f[1],x=this.fontMetrics.getMetrics(B,h).baseline,this.ctx.font=B,this.ctx.fillStyle=Ss(i.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=hge(n.styles.textAlign),T=fy(n),m=0,n.styles.textAlign){case 1:m+=T.width/2;break;case 2:m+=T.width;break}g=T.add(m,0,0,-T.height/2+1),this.ctx.save(),this.path([new Rt(T.left,T.top),new Rt(T.left+T.width,T.top),new Rt(T.left+T.width,T.top+T.height),new Rt(T.left,T.top+T.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Kh(n.value,g),i.letterSpacing,x),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!vs(n.styles.display,2048))return[3,20];if(n.styles.listStyleImage===null)return[3,19];if(p=n.styles.listStyleImage,p.type!==0)return[3,18];v=void 0,w=p.url,_.label=15;case 15:return _.trys.push([15,17,,18]),[4,this.context.cache.match(w)];case 16:return v=_.sent(),this.ctx.drawImage(v,n.bounds.left-(v.width+10),n.bounds.top),[3,18];case 17:return _.sent(),this.context.logger.error("Error loading list-style-image "+w),[3,18];case 18:return[3,20];case 19:r.listValue&&n.styles.listStyleType!==-1&&(B=this.createFontStyle(i)[0],this.ctx.font=B,this.ctx.fillStyle=Ss(i.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",T=new fc(n.bounds.left,n.bounds.top+xn(n.styles.paddingTop,n.bounds.width),n.bounds.width,ek(i.lineHeight,i.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Kh(r.listValue,T),i.letterSpacing,ek(i.lineHeight,i.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),_.label=20;case 20:return[2]}})})},t.prototype.renderStackContent=function(r){return Ba(this,void 0,void 0,function(){var n,s,p,i,o,p,l,c,p,A,d,p,u,f,p,h,x,p,m,g,p;return la(this,function(v){switch(v.label){case 0:if(vs(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:v.sent(),n=0,s=r.negativeZIndex,v.label=2;case 2:return n<s.length?(p=s[n],[4,this.renderStack(p)]):[3,5];case 3:v.sent(),v.label=4;case 4:return n++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:v.sent(),i=0,o=r.nonInlineLevel,v.label=7;case 7:return i<o.length?(p=o[i],[4,this.renderNode(p)]):[3,10];case 8:v.sent(),v.label=9;case 9:return i++,[3,7];case 10:l=0,c=r.nonPositionedFloats,v.label=11;case 11:return l<c.length?(p=c[l],[4,this.renderStack(p)]):[3,14];case 12:v.sent(),v.label=13;case 13:return l++,[3,11];case 14:A=0,d=r.nonPositionedInlineLevel,v.label=15;case 15:return A<d.length?(p=d[A],[4,this.renderStack(p)]):[3,18];case 16:v.sent(),v.label=17;case 17:return A++,[3,15];case 18:u=0,f=r.inlineLevel,v.label=19;case 19:return u<f.length?(p=f[u],[4,this.renderNode(p)]):[3,22];case 20:v.sent(),v.label=21;case 21:return u++,[3,19];case 22:h=0,x=r.zeroOrAutoZIndexOrTransformedOrOpacity,v.label=23;case 23:return h<x.length?(p=x[h],[4,this.renderStack(p)]):[3,26];case 24:v.sent(),v.label=25;case 25:return h++,[3,23];case 26:m=0,g=r.positiveZIndex,v.label=27;case 27:return m<g.length?(p=g[m],[4,this.renderStack(p)]):[3,30];case 28:v.sent(),v.label=29;case 29:return m++,[3,27];case 30:return[2]}})})},t.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},t.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},t.prototype.formatPath=function(r){var n=this;r.forEach(function(s,i){var o=no(s)?s.start:s;i===0?n.ctx.moveTo(o.x,o.y):n.ctx.lineTo(o.x,o.y),no(s)&&n.ctx.bezierCurveTo(s.startControl.x,s.startControl.y,s.endControl.x,s.endControl.y,s.end.x,s.end.y)})},t.prototype.renderRepeat=function(r,n,s,i){this.path(r),this.ctx.fillStyle=n,this.ctx.translate(s,i),this.ctx.fill(),this.ctx.translate(-s,-i)},t.prototype.resizeImage=function(r,n,s){var i;if(r.width===n&&r.height===s)return r;var o=(i=this.canvas.ownerDocument)!==null&&i!==void 0?i:document,l=o.createElement("canvas");l.width=Math.max(1,n),l.height=Math.max(1,s);var c=l.getContext("2d");return c.drawImage(r,0,0,r.width,r.height,0,0,n,s),l},t.prototype.renderBackgroundImage=function(r){return Ba(this,void 0,void 0,function(){var n,s,i,o,l,c;return la(this,function(A){switch(A.label){case 0:n=r.styles.backgroundImage.length-1,s=function(d){var u,f,h,M,Z,oe,G,K,E,x,M,Z,oe,G,K,m,g,p,v,w,B,T,_,j,E,L,M,F,D,G,K,ae,Z,oe,Y,R,z,ee,b,O,S,I;return la(this,function(U){switch(U.label){case 0:if(d.type!==0)return[3,5];u=void 0,f=d.url,U.label=1;case 1:return U.trys.push([1,3,,4]),[4,i.context.cache.match(f)];case 2:return u=U.sent(),[3,4];case 3:return U.sent(),i.context.logger.error("Error loading background-image "+f),[3,4];case 4:return u&&(h=Ab(r,n,[u.width,u.height,u.width/u.height]),M=h[0],Z=h[1],oe=h[2],G=h[3],K=h[4],E=i.ctx.createPattern(i.resizeImage(u,G,K),"repeat"),i.renderRepeat(M,E,Z,oe)),[3,6];case 5:Yhe(d)?(x=Ab(r,n,[null,null,null]),M=x[0],Z=x[1],oe=x[2],G=x[3],K=x[4],m=Khe(d.angle,G,K),g=m[0],p=m[1],v=m[2],w=m[3],B=m[4],T=document.createElement("canvas"),T.width=G,T.height=K,_=T.getContext("2d"),j=_.createLinearGradient(p,w,v,B),JE(d.stops,g).forEach(function(Q){return j.addColorStop(Q.stop,Ss(Q.color))}),_.fillStyle=j,_.fillRect(0,0,G,K),G>0&&K>0&&(E=i.ctx.createPattern(T,"repeat"),i.renderRepeat(M,E,Z,oe))):Jhe(d)&&(L=Ab(r,n,[null,null,null]),M=L[0],F=L[1],D=L[2],G=L[3],K=L[4],ae=d.position.length===0?[bj]:d.position,Z=xn(ae[0],G),oe=xn(ae[ae.length-1],K),Y=zhe(d,Z,oe,G,K),R=Y[0],z=Y[1],R>0&&z>0&&(ee=i.ctx.createRadialGradient(F+Z,D+oe,0,F+Z,D+oe,R),JE(d.stops,R*2).forEach(function(Q){return ee.addColorStop(Q.stop,Ss(Q.color))}),i.path(M),i.ctx.fillStyle=ee,R!==z?(b=r.bounds.left+.5*r.bounds.width,O=r.bounds.top+.5*r.bounds.height,S=z/R,I=1/S,i.ctx.save(),i.ctx.translate(b,O),i.ctx.transform(1,0,0,S,0,0),i.ctx.translate(-b,-O),i.ctx.fillRect(F,I*(D-O)+O,G,K*I),i.ctx.restore()):i.ctx.fill())),U.label=6;case 6:return n--,[2]}})},i=this,o=0,l=r.styles.backgroundImage.slice(0).reverse(),A.label=1;case 1:return o<l.length?(c=l[o],[5,s(c)]):[3,4];case 2:A.sent(),A.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},t.prototype.renderSolidBorder=function(r,n,s){return Ba(this,void 0,void 0,function(){return la(this,function(i){return this.path(Ek(s,n)),this.ctx.fillStyle=Ss(r),this.ctx.fill(),[2]})})},t.prototype.renderDoubleBorder=function(r,n,s,i){return Ba(this,void 0,void 0,function(){var o,l;return la(this,function(c){switch(c.label){case 0:return n<3?[4,this.renderSolidBorder(r,s,i)]:[3,2];case 1:return c.sent(),[2];case 2:return o=tge(i,s),this.path(o),this.ctx.fillStyle=Ss(r),this.ctx.fill(),l=rge(i,s),this.path(l),this.ctx.fill(),[2]}})})},t.prototype.renderNodeBackgroundAndBorders=function(r){return Ba(this,void 0,void 0,function(){var n,s,i,o,l,c,A,d,u=this;return la(this,function(f){switch(f.label){case 0:return this.applyEffects(r.getEffects(2)),n=r.container.styles,s=!fA(n.backgroundColor)||n.backgroundImage.length,i=[{style:n.borderTopStyle,color:n.borderTopColor,width:n.borderTopWidth},{style:n.borderRightStyle,color:n.borderRightColor,width:n.borderRightWidth},{style:n.borderBottomStyle,color:n.borderBottomColor,width:n.borderBottomWidth},{style:n.borderLeftStyle,color:n.borderLeftColor,width:n.borderLeftWidth}],o=fge(Qu(n.backgroundClip,0),r.curves),s||n.boxShadow.length?(this.ctx.save(),this.path(o),this.ctx.clip(),fA(n.backgroundColor)||(this.ctx.fillStyle=Ss(n.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:f.sent(),this.ctx.restore(),n.boxShadow.slice(0).reverse().forEach(function(h){u.ctx.save();var x=dy(r.curves),m=h.inset?0:Age,g=Zxe(x,-m+(h.inset?1:-1)*h.spread.number,(h.inset?1:-1)*h.spread.number,h.spread.number*(h.inset?-2:2),h.spread.number*(h.inset?-2:2));h.inset?(u.path(x),u.ctx.clip(),u.mask(g)):(u.mask(x),u.ctx.clip(),u.path(g)),u.ctx.shadowOffsetX=h.offsetX.number+m,u.ctx.shadowOffsetY=h.offsetY.number,u.ctx.shadowColor=Ss(h.color),u.ctx.shadowBlur=h.blur.number,u.ctx.fillStyle=h.inset?Ss(h.color):"rgba(0,0,0,1)",u.ctx.fill(),u.ctx.restore()}),f.label=2;case 2:l=0,c=0,A=i,f.label=3;case 3:return c<A.length?(d=A[c],d.style!==0&&!fA(d.color)&&d.width>0?d.style!==2?[3,5]:[4,this.renderDashedDottedBorder(d.color,d.width,l,r.curves,2)]:[3,11]):[3,13];case 4:return f.sent(),[3,11];case 5:return d.style!==3?[3,7]:[4,this.renderDashedDottedBorder(d.color,d.width,l,r.curves,3)];case 6:return f.sent(),[3,11];case 7:return d.style!==4?[3,9]:[4,this.renderDoubleBorder(d.color,d.width,l,r.curves)];case 8:return f.sent(),[3,11];case 9:return[4,this.renderSolidBorder(d.color,l,r.curves)];case 10:f.sent(),f.label=11;case 11:l++,f.label=12;case 12:return c++,[3,3];case 13:return[2]}})})},t.prototype.renderDashedDottedBorder=function(r,n,s,i,o){return Ba(this,void 0,void 0,function(){var l,c,A,d,u,f,h,x,m,g,p,v,w,B,T,_,T,_;return la(this,function(j){return this.ctx.save(),l=nge(i,s),c=Ek(i,s),o===2&&(this.path(c),this.ctx.clip()),no(c[0])?(A=c[0].start.x,d=c[0].start.y):(A=c[0].x,d=c[0].y),no(c[1])?(u=c[1].end.x,f=c[1].end.y):(u=c[1].x,f=c[1].y),s===0||s===2?h=Math.abs(A-u):h=Math.abs(d-f),this.ctx.beginPath(),o===3?this.formatPath(l):this.formatPath(c.slice(0,2)),x=n<3?n*3:n*2,m=n<3?n*2:n,o===3&&(x=n,m=n),g=!0,h<=x*2?g=!1:h<=x*2+m?(p=h/(2*x+m),x*=p,m*=p):(v=Math.floor((h+m)/(x+m)),w=(h-v*x)/(v-1),B=(h-(v+1)*x)/v,m=B<=0||Math.abs(m-w)<Math.abs(m-B)?w:B),g&&(o===3?this.ctx.setLineDash([0,x+m]):this.ctx.setLineDash([x,m])),o===3?(this.ctx.lineCap="round",this.ctx.lineWidth=n):this.ctx.lineWidth=n*2+1.1,this.ctx.strokeStyle=Ss(r),this.ctx.stroke(),this.ctx.setLineDash([]),o===2&&(no(c[0])&&(T=c[3],_=c[0],this.ctx.beginPath(),this.formatPath([new Rt(T.end.x,T.end.y),new Rt(_.start.x,_.start.y)]),this.ctx.stroke()),no(c[1])&&(T=c[1],_=c[2],this.ctx.beginPath(),this.formatPath([new Rt(T.end.x,T.end.y),new Rt(_.start.x,_.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},t.prototype.render=function(r){return Ba(this,void 0,void 0,function(){var n;return la(this,function(s){switch(s.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Ss(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=ege(r),[4,this.renderStack(n)];case 1:return s.sent(),this.applyEffects([]),[2,this.canvas]}})})},t}(MP),uge=function(e){return e instanceof CP||e instanceof NP?!0:e instanceof Bj&&e.type!==ly&&e.type!==oy},fge=function(e,t){switch(e){case 0:return dy(t);case 2:return Gxe(t);case 1:default:return uy(t)}},hge=function(e){switch(e){case 1:return"center";case 2:return"right";case 0:default:return"left"}},mge=["-apple-system","system-ui"],pge=function(e){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?e.filter(function(t){return mge.indexOf(t)===-1}):e},xge=function(e){zo(t,e);function t(r,n){var s=e.call(this,r,n)||this;return s.canvas=n.canvas?n.canvas:document.createElement("canvas"),s.ctx=s.canvas.getContext("2d"),s.options=n,s.canvas.width=Math.floor(n.width*n.scale),s.canvas.height=Math.floor(n.height*n.scale),s.canvas.style.width=n.width+"px",s.canvas.style.height=n.height+"px",s.ctx.scale(s.options.scale,s.options.scale),s.ctx.translate(-n.x,-n.y),s.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),s}return t.prototype.render=function(r){return Ba(this,void 0,void 0,function(){var n,s;return la(this,function(i){switch(i.label){case 0:return n=v5(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,gge(n)];case 1:return s=i.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Ss(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(s,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},t}(MP),gge=function(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){t(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},yge=function(){function e(t){var r=t.id,n=t.enabled;this.id=r,this.enabled=n,this.start=Date.now()}return e.prototype.debug=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,Kx([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.getTime=function(){return Date.now()-this.start},e.prototype.info=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,Kx([this.id,this.getTime()+"ms"],t))},e.prototype.warn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,Kx([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.error=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,Kx([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.instances={},e}(),vge=function(){function e(t,r){var n;this.windowBounds=r,this.instanceName="#"+e.instanceCount++,this.logger=new yge({id:this.instanceName,enabled:t.logging}),this.cache=(n=t.cache)!==null&&n!==void 0?n:new Qxe(this,t)}return e.instanceCount=1,e}(),HP=function(e,t){return t===void 0&&(t={}),wge(e,t)};typeof window<"u"&&UP.setContext(window);var wge=function(e,t){return Ba(void 0,void 0,void 0,function(){var r,n,s,i,o,l,c,A,d,u,f,h,x,m,g,p,v,w,B,T,j,_,j,E,L,M,F,D,G,K,ae,Z,oe,Y,R,z,ee,b,O,S;return la(this,function(I){switch(I.label){case 0:if(!e||typeof e!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=e.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(n=r.defaultView,!n)throw new Error("Document is not attached to a Window");return s={allowTaint:(E=t.allowTaint)!==null&&E!==void 0?E:!1,imageTimeout:(L=t.imageTimeout)!==null&&L!==void 0?L:15e3,proxy:t.proxy,useCORS:(M=t.useCORS)!==null&&M!==void 0?M:!1},i=a5({logging:(F=t.logging)!==null&&F!==void 0?F:!0,cache:t.cache},s),o={windowWidth:(D=t.windowWidth)!==null&&D!==void 0?D:n.innerWidth,windowHeight:(G=t.windowHeight)!==null&&G!==void 0?G:n.innerHeight,scrollX:(K=t.scrollX)!==null&&K!==void 0?K:n.pageXOffset,scrollY:(ae=t.scrollY)!==null&&ae!==void 0?ae:n.pageYOffset},l=new fc(o.scrollX,o.scrollY,o.windowWidth,o.windowHeight),c=new vge(i,l),A=(Z=t.foreignObjectRendering)!==null&&Z!==void 0?Z:!1,d={allowTaint:(oe=t.allowTaint)!==null&&oe!==void 0?oe:!1,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:A,copyStyles:A},c.logger.debug("Starting document clone with size "+l.width+"x"+l.height+" scrolled to "+-l.left+","+-l.top),u=new Bk(c,e,d),f=u.clonedReferenceElement,f?[4,u.toIFrame(r,l)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return h=I.sent(),x=Sj(f)||Nxe(f)?Zfe(f.ownerDocument):Rv(c,f),m=x.width,g=x.height,p=x.left,v=x.top,w=bge(c,f,t.backgroundColor),B={canvas:t.canvas,backgroundColor:w,scale:(R=(Y=t.scale)!==null&&Y!==void 0?Y:n.devicePixelRatio)!==null&&R!==void 0?R:1,x:((z=t.x)!==null&&z!==void 0?z:0)+p,y:((ee=t.y)!==null&&ee!==void 0?ee:0)+v,width:(b=t.width)!==null&&b!==void 0?b:Math.ceil(m),height:(O=t.height)!==null&&O!==void 0?O:Math.ceil(g)},A?(c.logger.debug("Document cloned, using foreign object rendering"),j=new xge(c,B),[4,j.render(f)]):[3,3];case 2:return T=I.sent(),[3,5];case 3:return c.logger.debug("Document cloned, element located at "+p+","+v+" with size "+m+"x"+g+" using computed rendering"),c.logger.debug("Starting DOM parsing"),_=SP(c,f),w===_.styles.backgroundColor&&(_.styles.backgroundColor=sc.TRANSPARENT),c.logger.debug("Starting renderer for element at "+B.x+","+B.y+" with size "+B.width+"x"+B.height),j=new dge(c,B),[4,j.render(_)];case 4:T=I.sent(),I.label=5;case 5:return(!((S=t.removeContainer)!==null&&S!==void 0)||S)&&(Bk.destroy(h)||c.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),c.logger.debug("Finished rendering"),[2,T]}})})},bge=function(e,t,r){var n=t.ownerDocument,s=n.documentElement?$h(e,getComputedStyle(n.documentElement).backgroundColor):sc.TRANSPARENT,i=n.body?$h(e,getComputedStyle(n.body).backgroundColor):sc.TRANSPARENT,o=typeof r=="string"?$h(e,r):r===null?sc.TRANSPARENT:4294967295;return t===n.documentElement?fA(s)?fA(i)?o:i:s:o};const Nge=Object.freeze(Object.defineProperty({__proto__:null,default:HP},Symbol.toStringTag,{value:"Module"})),Cge="modulepreload",jge=function(e){return"/"+e},Tk={},S5=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(r.map(c=>{if(c=jge(c),c in Tk)return;Tk[c]=!0;const A=c.endsWith(".css"),d=A?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const u=document.createElement("link");if(u.rel=A?"stylesheet":Cge,A||(u.as="script"),u.crossOrigin="",u.href=c,l&&u.setAttribute("nonce",l),document.head.appendChild(u),A)return new Promise((f,h)=>{u.addEventListener("load",f),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})};var xa=Uint8Array,Ni=Uint16Array,Fj=Int32Array,Wv=new xa([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Xv=new xa([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),F5=new xa([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),VP=function(e,t){for(var r=new Ni(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var s=new Fj(r[30]),n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)s[i]=i-r[n]<<5|n;return{b:r,r:s}},$P=VP(Wv,2),qP=$P.b,E5=$P.r;qP[28]=258,E5[258]=28;var KP=VP(Xv,0),Bge=KP.b,_k=KP.r,k5=new Ni(32768);for(var Cn=0;Cn<32768;++Cn){var Dc=(Cn&43690)>>1|(Cn&21845)<<1;Dc=(Dc&52428)>>2|(Dc&13107)<<2,Dc=(Dc&61680)>>4|(Dc&3855)<<4,k5[Cn]=((Dc&65280)>>8|(Dc&255)<<8)>>1}var yl=function(e,t,r){for(var n=e.length,s=0,i=new Ni(t);s<n;++s)e[s]&&++i[e[s]-1];var o=new Ni(t);for(s=1;s<t;++s)o[s]=o[s-1]+i[s-1]<<1;var l;if(r){l=new Ni(1<<t);var c=15-t;for(s=0;s<n;++s)if(e[s])for(var A=s<<4|e[s],d=t-e[s],u=o[e[s]-1]++<<d,f=u|(1<<d)-1;u<=f;++u)l[k5[u]>>c]=A}else for(l=new Ni(n),s=0;s<n;++s)e[s]&&(l[s]=k5[o[e[s]-1]++]>>15-e[s]);return l},CA=new xa(288);for(var Cn=0;Cn<144;++Cn)CA[Cn]=8;for(var Cn=144;Cn<256;++Cn)CA[Cn]=9;for(var Cn=256;Cn<280;++Cn)CA[Cn]=7;for(var Cn=280;Cn<288;++Cn)CA[Cn]=8;var Rm=new xa(32);for(var Cn=0;Cn<32;++Cn)Rm[Cn]=5;var Sge=yl(CA,9,0),Fge=yl(CA,9,1),Ege=yl(Rm,5,0),kge=yl(Rm,5,1),db=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},Eo=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(t&7)&r},ub=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(t&7)},Ej=function(e){return(e+7)/8|0},zP=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new xa(e.subarray(t,r))},Tge=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Lo=function(e,t,r){var n=new Error(t||Tge[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,Lo),!r)throw n;return n},_ge=function(e,t,r,n){var s=e.length,i=0;if(!s||t.f&&!t.l)return r||new xa(0);var o=!r,l=o||t.i!=2,c=t.i;o&&(r=new xa(s*3));var A=function(Ae){var W=r.length;if(Ae>W){var J=new xa(Math.max(W*2,Ae));J.set(r),r=J}},d=t.f||0,u=t.p||0,f=t.b||0,h=t.l,x=t.d,m=t.m,g=t.n,p=s*8;do{if(!h){d=Eo(e,u,1);var v=Eo(e,u+1,3);if(u+=3,v)if(v==1)h=Fge,x=kge,m=9,g=5;else if(v==2){var _=Eo(e,u,31)+257,j=Eo(e,u+10,15)+4,E=_+Eo(e,u+5,31)+1;u+=14;for(var L=new xa(E),M=new xa(19),F=0;F<j;++F)M[F5[F]]=Eo(e,u+F*3,7);u+=j*3;for(var D=db(M),G=(1<<D)-1,K=yl(M,D,1),F=0;F<E;){var ae=K[Eo(e,u,G)];u+=ae&15;var w=ae>>4;if(w<16)L[F++]=w;else{var Z=0,oe=0;for(w==16?(oe=3+Eo(e,u,3),u+=2,Z=L[F-1]):w==17?(oe=3+Eo(e,u,7),u+=3):w==18&&(oe=11+Eo(e,u,127),u+=7);oe--;)L[F++]=Z}}var Y=L.subarray(0,_),R=L.subarray(_);m=db(Y),g=db(R),h=yl(Y,m,1),x=yl(R,g,1)}else Lo(1);else{var w=Ej(u)+4,B=e[w-4]|e[w-3]<<8,T=w+B;if(T>s){c&&Lo(0);break}l&&A(f+B),r.set(e.subarray(w,T),f),t.b=f+=B,t.p=u=T*8,t.f=d;continue}if(u>p){c&&Lo(0);break}}l&&A(f+131072);for(var z=(1<<m)-1,ee=(1<<g)-1,b=u;;b=u){var Z=h[ub(e,u)&z],O=Z>>4;if(u+=Z&15,u>p){c&&Lo(0);break}if(Z||Lo(2),O<256)r[f++]=O;else if(O==256){b=u,h=null;break}else{var S=O-254;if(O>264){var F=O-257,I=Wv[F];S=Eo(e,u,(1<<I)-1)+qP[F],u+=I}var U=x[ub(e,u)&ee],Q=U>>4;U||Lo(3),u+=U&15;var R=Bge[Q];if(Q>3){var I=Xv[Q];R+=ub(e,u)&(1<<I)-1,u+=I}if(u>p){c&&Lo(0);break}l&&A(f+131072);var H=f+S;if(f<R){var X=i-R,V=Math.min(R,H);for(X+f<0&&Lo(3);f<V;++f)r[f]=n[X+f]}for(;f<H;++f)r[f]=r[f-R]}}t.l=h,t.p=b,t.b=f,t.f=d,h&&(d=1,t.m=m,t.d=x,t.n=g)}while(!d);return f!=r.length&&o?zP(r,0,f):r.subarray(0,f)},Ml=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},nh=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},fb=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var s=r.length,i=r.slice();if(!s)return{t:WP,l:0};if(s==1){var o=new xa(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(T,_){return T.f-_.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],A=0,d=1,u=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};d!=s-1;)l=r[r[A].f<r[u].f?A++:u++],c=r[A!=d&&r[A].f<r[u].f?A++:u++],r[d++]={s:-1,f:l.f+c.f,l,r:c};for(var f=i[0].s,n=1;n<s;++n)i[n].s>f&&(f=i[n].s);var h=new Ni(f+1),x=T5(r[d-1],h,0);if(x>t){var n=0,m=0,g=x-t,p=1<<g;for(i.sort(function(_,j){return h[j.s]-h[_.s]||_.f-j.f});n<s;++n){var v=i[n].s;if(h[v]>t)m+=p-(1<<x-h[v]),h[v]=t;else break}for(m>>=g;m>0;){var w=i[n].s;h[w]<t?m-=1<<t-h[w]++-1:++n}for(;n>=0&&m;--n){var B=i[n].s;h[B]==t&&(--h[B],++m)}x=t}return{t:new xa(h),l:x}},T5=function(e,t,r){return e.s==-1?Math.max(T5(e.l,t,r+1),T5(e.r,t,r+1)):t[e.s]=r},Ik=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Ni(++t),n=0,s=e[0],i=1,o=function(c){r[n++]=c},l=1;l<=t;++l)if(e[l]==s&&l!=t)++i;else{if(!s&&i>2){for(;i>138;i-=138)o(32754);i>2&&(o(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(o(s),--i;i>6;i-=6)o(8304);i>2&&(o(i-3<<5|8208),i=0)}for(;i--;)o(s);i=1,s=e[l]}return{c:r.subarray(0,n),n:t}},sh=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},GP=function(e,t,r){var n=r.length,s=Ej(t+2);e[s]=n&255,e[s+1]=n>>8,e[s+2]=e[s]^255,e[s+3]=e[s+1]^255;for(var i=0;i<n;++i)e[s+i+4]=r[i];return(s+4+n)*8},Lk=function(e,t,r,n,s,i,o,l,c,A,d){Ml(t,d++,r),++s[256];for(var u=fb(s,15),f=u.t,h=u.l,x=fb(i,15),m=x.t,g=x.l,p=Ik(f),v=p.c,w=p.n,B=Ik(m),T=B.c,_=B.n,j=new Ni(19),E=0;E<v.length;++E)++j[v[E]&31];for(var E=0;E<T.length;++E)++j[T[E]&31];for(var L=fb(j,7),M=L.t,F=L.l,D=19;D>4&&!M[F5[D-1]];--D);var G=A+5<<3,K=sh(s,CA)+sh(i,Rm)+o,ae=sh(s,f)+sh(i,m)+o+14+3*D+sh(j,M)+2*j[16]+3*j[17]+7*j[18];if(c>=0&&G<=K&&G<=ae)return GP(t,d,e.subarray(c,c+A));var Z,oe,Y,R;if(Ml(t,d,1+(ae<K)),d+=2,ae<K){Z=yl(f,h,0),oe=f,Y=yl(m,g,0),R=m;var z=yl(M,F,0);Ml(t,d,w-257),Ml(t,d+5,_-1),Ml(t,d+10,D-4),d+=14;for(var E=0;E<D;++E)Ml(t,d+3*E,M[F5[E]]);d+=3*D;for(var ee=[v,T],b=0;b<2;++b)for(var O=ee[b],E=0;E<O.length;++E){var S=O[E]&31;Ml(t,d,z[S]),d+=M[S],S>15&&(Ml(t,d,O[E]>>5&127),d+=O[E]>>12)}}else Z=Sge,oe=CA,Y=Ege,R=Rm;for(var E=0;E<l;++E){var I=n[E];if(I>255){var S=I>>18&31;nh(t,d,Z[S+257]),d+=oe[S+257],S>7&&(Ml(t,d,I>>23&31),d+=Wv[S]);var U=I&31;nh(t,d,Y[U]),d+=R[U],U>3&&(nh(t,d,I>>5&8191),d+=Xv[U])}else nh(t,d,Z[I]),d+=oe[I]}return nh(t,d,Z[256]),d+oe[256]},Ige=new Fj([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),WP=new xa(0),Lge=function(e,t,r,n,s,i){var o=i.z||e.length,l=new xa(n+o+5*(1+Math.ceil(o/7e3))+s),c=l.subarray(n,l.length-s),A=i.l,d=(i.r||0)&7;if(t){d&&(c[0]=i.r>>3);for(var u=Ige[t-1],f=u>>13,h=u&8191,x=(1<<r)-1,m=i.p||new Ni(32768),g=i.h||new Ni(x+1),p=Math.ceil(r/3),v=2*p,w=function(ve){return(e[ve]^e[ve+1]<<p^e[ve+2]<<v)&x},B=new Fj(25e3),T=new Ni(288),_=new Ni(32),j=0,E=0,L=i.i||0,M=0,F=i.w||0,D=0;L+2<o;++L){var G=w(L),K=L&32767,ae=g[G];if(m[K]=ae,g[G]=K,F<=L){var Z=o-L;if((j>7e3||M>24576)&&(Z>423||!A)){d=Lk(e,c,0,B,T,_,E,M,D,L-D,d),M=j=E=0,D=L;for(var oe=0;oe<286;++oe)T[oe]=0;for(var oe=0;oe<30;++oe)_[oe]=0}var Y=2,R=0,z=h,ee=K-ae&32767;if(Z>2&&G==w(L-ee))for(var b=Math.min(f,Z)-1,O=Math.min(32767,L),S=Math.min(258,Z);ee<=O&&--z&&K!=ae;){if(e[L+Y]==e[L+Y-ee]){for(var I=0;I<S&&e[L+I]==e[L+I-ee];++I);if(I>Y){if(Y=I,R=ee,I>b)break;for(var U=Math.min(ee,I-2),Q=0,oe=0;oe<U;++oe){var H=L-ee+oe&32767,X=m[H],V=H-X&32767;V>Q&&(Q=V,ae=H)}}}K=ae,ae=m[K],ee+=K-ae&32767}if(R){B[M++]=268435456|E5[Y]<<18|_k[R];var Ae=E5[Y]&31,W=_k[R]&31;E+=Wv[Ae]+Xv[W],++T[257+Ae],++_[W],F=L+Y,++j}else B[M++]=e[L],++T[e[L]]}}for(L=Math.max(L,F);L<o;++L)B[M++]=e[L],++T[e[L]];d=Lk(e,c,A,B,T,_,E,M,D,L-D,d),A||(i.r=d&7|c[d/8|0]<<3,d-=7,i.h=g,i.p=m,i.i=L,i.w=F)}else{for(var L=i.w||0;L<o+A;L+=65535){var J=L+65535;J>=o&&(c[d/8|0]=A,J=o),d=GP(c,d+1,e.subarray(L,J))}i.i=o}return zP(l,0,n+Ej(d)+s)},XP=function(){var e=1,t=0;return{p:function(r){for(var n=e,s=t,i=r.length|0,o=0;o!=i;){for(var l=Math.min(o+2655,i);o<l;++o)s+=n+=r[o];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}e=n,t=s},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},Uge=function(e,t,r,n,s){if(!s&&(s={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),o=new xa(i.length+e.length);o.set(i),o.set(e,i.length),e=o,s.w=i.length}return Lge(e,t.level==null?6:t.level,t.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,s)},YP=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},Dge=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var s=XP();s.p(t.dictionary),YP(e,2,s.d())}},Pge=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&Lo(6,"invalid zlib data"),(e[1]>>5&1)==+!t&&Lo(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function _5(e,t){t||(t={});var r=XP();r.p(e);var n=Uge(e,t,t.dictionary?6:2,4);return Dge(n,t),YP(n,n.length-4,r.d()),n}function Oge(e,t){return _ge(e.subarray(Pge(e,t),-4),{i:2},t,t)}var Rge=typeof TextDecoder<"u"&&new TextDecoder,Qge=0;try{Rge.decode(WP,{stream:!0}),Qge=1}catch{}var cr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function hb(){cr.console&&typeof cr.console.log=="function"&&cr.console.log.apply(cr.console,arguments)}var dn={log:hb,warn:function(e){cr.console&&(typeof cr.console.warn=="function"?cr.console.warn.apply(cr.console,arguments):hb.call(null,arguments))},error:function(e){cr.console&&(typeof cr.console.error=="function"?cr.console.error.apply(cr.console,arguments):hb(e))}};function mb(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){XA(n.response,t,r)},n.onerror=function(){dn.error("could not download file")},n.send()}function Uk(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function mg(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var Gh,I5,XA=cr.saveAs||((typeof window>"u"?"undefined":Ur(window))!=="object"||window!==cr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=cr.URL||cr.webkitURL,s=document.createElement("a");t=t||e.name||"download",s.download=t,s.rel="noopener",typeof e=="string"?(s.href=e,s.origin!==location.origin?Uk(s.href)?mb(e,t,r):mg(s,s.target="_blank"):mg(s)):(s.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){mg(s)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(Uk(e))mb(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){mg(n)})}else navigator.msSaveOrOpenBlob(function(s,i){return i===void 0?i={autoBom:!1}:Ur(i)!=="object"&&(dn.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return mb(e,t,r);var s=e.type==="application/octet-stream",i=/constructor/i.test(cr.HTMLElement)||cr.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||s&&i)&&(typeof FileReader>"u"?"undefined":Ur(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var d=l.result;d=o?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},l.readAsDataURL(e)}else{var c=cr.URL||cr.webkitURL,A=c.createObjectURL(e);n?n.location=A:location.href=A,n=null,setTimeout(function(){c.revokeObjectURL(A)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function JP(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var s=r[n].re,i=r[n].process,o=s.exec(e);o&&(t=i(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),A=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),A.length==1&&(A="0"+A),"#"+l+c+A}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function pb(e,t){var r=e[0],n=e[1],s=e[2],i=e[3];r=na(r,n,s,i,t[0],7,-680876936),i=na(i,r,n,s,t[1],12,-389564586),s=na(s,i,r,n,t[2],17,606105819),n=na(n,s,i,r,t[3],22,-1044525330),r=na(r,n,s,i,t[4],7,-176418897),i=na(i,r,n,s,t[5],12,1200080426),s=na(s,i,r,n,t[6],17,-1473231341),n=na(n,s,i,r,t[7],22,-45705983),r=na(r,n,s,i,t[8],7,1770035416),i=na(i,r,n,s,t[9],12,-1958414417),s=na(s,i,r,n,t[10],17,-42063),n=na(n,s,i,r,t[11],22,-1990404162),r=na(r,n,s,i,t[12],7,1804603682),i=na(i,r,n,s,t[13],12,-40341101),s=na(s,i,r,n,t[14],17,-1502002290),r=sa(r,n=na(n,s,i,r,t[15],22,1236535329),s,i,t[1],5,-165796510),i=sa(i,r,n,s,t[6],9,-1069501632),s=sa(s,i,r,n,t[11],14,643717713),n=sa(n,s,i,r,t[0],20,-373897302),r=sa(r,n,s,i,t[5],5,-701558691),i=sa(i,r,n,s,t[10],9,38016083),s=sa(s,i,r,n,t[15],14,-660478335),n=sa(n,s,i,r,t[4],20,-405537848),r=sa(r,n,s,i,t[9],5,568446438),i=sa(i,r,n,s,t[14],9,-1019803690),s=sa(s,i,r,n,t[3],14,-187363961),n=sa(n,s,i,r,t[8],20,1163531501),r=sa(r,n,s,i,t[13],5,-1444681467),i=sa(i,r,n,s,t[2],9,-51403784),s=sa(s,i,r,n,t[7],14,1735328473),r=aa(r,n=sa(n,s,i,r,t[12],20,-1926607734),s,i,t[5],4,-378558),i=aa(i,r,n,s,t[8],11,-2022574463),s=aa(s,i,r,n,t[11],16,1839030562),n=aa(n,s,i,r,t[14],23,-35309556),r=aa(r,n,s,i,t[1],4,-1530992060),i=aa(i,r,n,s,t[4],11,1272893353),s=aa(s,i,r,n,t[7],16,-155497632),n=aa(n,s,i,r,t[10],23,-1094730640),r=aa(r,n,s,i,t[13],4,681279174),i=aa(i,r,n,s,t[0],11,-358537222),s=aa(s,i,r,n,t[3],16,-722521979),n=aa(n,s,i,r,t[6],23,76029189),r=aa(r,n,s,i,t[9],4,-640364487),i=aa(i,r,n,s,t[12],11,-421815835),s=aa(s,i,r,n,t[15],16,530742520),r=ia(r,n=aa(n,s,i,r,t[2],23,-995338651),s,i,t[0],6,-198630844),i=ia(i,r,n,s,t[7],10,1126891415),s=ia(s,i,r,n,t[14],15,-1416354905),n=ia(n,s,i,r,t[5],21,-57434055),r=ia(r,n,s,i,t[12],6,1700485571),i=ia(i,r,n,s,t[3],10,-1894986606),s=ia(s,i,r,n,t[10],15,-1051523),n=ia(n,s,i,r,t[1],21,-2054922799),r=ia(r,n,s,i,t[8],6,1873313359),i=ia(i,r,n,s,t[15],10,-30611744),s=ia(s,i,r,n,t[6],15,-1560198380),n=ia(n,s,i,r,t[13],21,1309151649),r=ia(r,n,s,i,t[4],6,-145523070),i=ia(i,r,n,s,t[11],10,-1120210379),s=ia(s,i,r,n,t[2],15,718787259),n=ia(n,s,i,r,t[9],21,-343485551),e[0]=tA(r,e[0]),e[1]=tA(n,e[1]),e[2]=tA(s,e[2]),e[3]=tA(i,e[3])}function Yv(e,t,r,n,s,i){return t=tA(tA(t,e),tA(n,i)),tA(t<<s|t>>>32-s,r)}function na(e,t,r,n,s,i,o){return Yv(t&r|~t&n,e,t,s,i,o)}function sa(e,t,r,n,s,i,o){return Yv(t&n|r&~n,e,t,s,i,o)}function aa(e,t,r,n,s,i,o){return Yv(t^r^n,e,t,s,i,o)}function ia(e,t,r,n,s,i,o){return Yv(r^(t|~n),e,t,s,i,o)}function ZP(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)pb(n,Mge(e.substring(t-64,t)));e=e.substring(t-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)s[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(s[t>>2]|=128<<(t%4<<3),t>55)for(pb(n,s),t=0;t<16;t++)s[t]=0;return s[14]=8*r,pb(n,s),n}function Mge(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}Gh=cr.atob.bind(cr),I5=cr.btoa.bind(cr);var Dk="0123456789abcdef".split("");function Hge(e){for(var t="",r=0;r<4;r++)t+=Dk[e>>8*r+4&15]+Dk[e>>8*r&15];return t}function Vge(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function L5(e){return ZP(e).map(Vge).join("")}var $ge=function(e){for(var t=0;t<e.length;t++)e[t]=Hge(e[t]);return e.join("")}(ZP("hello"))!="5d41402abc4b2a76b9719d911017c592";function tA(e,t){if($ge){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function U5(e,t){var r,n,s,i;if(e!==r){for(var o=(s=e,i=1+(256/e.length>>0),new Array(i+1).join(s)),l=[],c=0;c<256;c++)l[c]=c;var A=0;for(c=0;c<256;c++){var d=l[c];A=(A+d+o.charCodeAt(c))%256,l[c]=l[A],l[A]=d}r=e,n=l}else l=n;var u=t.length,f=0,h=0,x="";for(c=0;c<u;c++)h=(h+(d=l[f=(f+1)%256]))%256,l[f]=l[h],l[h]=d,o=l[(l[f]+l[h])%256],x+=String.fromCharCode(t.charCodeAt(c)^o);return x}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Pk={print:4,modify:8,copy:16,"annot-forms":32};function Mu(e,t,r,n){this.v=1,this.r=2;var s=192;e.forEach(function(l){if(Pk.perm!==void 0)throw new Error("Invalid permission: "+l);s+=Pk[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(t+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,o),this.P=-(1+(255^s)),this.encryptionKey=L5(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=U5(this.encryptionKey,this.padding)}function Hu(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var s=e.charCodeAt(n);s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?t+="#"+("0"+s.toString(16)).slice(-2):t+=e[n]}return t}function Ok(e){if(Ur(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,s){if(s=s||!1,typeof r!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var i=Math.random().toString(35);return t[r][i]=[n,!!s],i},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var i in t[r]){var o=t[r][i];try{o[0].apply(e,n)}catch(l){cr.console&&dn.error("jsPDF PubSub Error",l.message,l)}o[1]&&s.push(i)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function hy(e){if(!(this instanceof hy))return new hy(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function eO(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function ed(e,t,r,n,s){if(!(this instanceof ed))return new ed(e,t,r,n,s);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,eO.call(this,n,s)}function of(e,t,r,n,s){if(!(this instanceof of))return new of(e,t,r,n,s);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,eO.call(this,n,s)}function lr(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],i=arguments[3],o=[],l=1,c=16,A="S",d=null;Ur(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,s=e.format||s,i=e.compress||e.compressPdf||i,(d=e.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),l=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),A=e.defaultPathOperation||"S"),o=e.filters||(i===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var u=e.putOnlyUsedFonts||!1,f={},h={internal:{},__private__:{}};h.__private__.PubSub=Ok;var x="1.3",m=h.__private__.getPdfVersion=function(){return x};h.__private__.setPdfVersion=function(k){x=k};var g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return g};var p=h.__private__.getPageFormat=function(k){return g[k]};s=s||"a4";var v={COMPAT:"compat",ADVANCED:"advanced"},w=v.COMPAT;function B(){this.saveGraphicsState(),te(new Re(Pe,0,0,-Pe,0,bc()*Pe).toString()+" cm"),this.setFontSize(this.getFontSize()/Pe),A="n",w=v.ADVANCED}function T(){this.restoreGraphicsState(),A="S",w=v.COMPAT}var _=h.__private__.combineFontStyleAndFontWeight=function(k,ne){if(k=="bold"&&ne=="normal"||k=="bold"&&ne==400||k=="normal"&&ne=="italic"||k=="bold"&&ne=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ne&&(k=ne==400||ne==="normal"?k==="italic"?"italic":"normal":ne!=700&&ne!=="bold"||k!=="normal"?(ne==700?"bold":ne)+""+k:"bold"),k};h.advancedAPI=function(k){var ne=w===v.COMPAT;return ne&&B.call(this),typeof k!="function"||(k(this),ne&&T.call(this)),this},h.compatAPI=function(k){var ne=w===v.ADVANCED;return ne&&T.call(this),typeof k!="function"||(k(this),ne&&B.call(this)),this},h.isAdvancedAPI=function(){return w===v.ADVANCED};var j,E=function(k){if(w!==v.ADVANCED)throw new Error(k+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},L=h.roundToPrecision=h.__private__.roundToPrecision=function(k,ne){var be=t||ne;if(isNaN(k)||isNaN(be))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return k.toFixed(be).replace(/0+$/,"")};j=h.hpf=h.__private__.hpf=typeof c=="number"?function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return L(k,c)}:c==="smart"?function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return L(k,k>-1&&k<1?16:5)}:function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return L(k,16)};var M=h.f2=h.__private__.f2=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.f2");return L(k,2)},F=h.__private__.f3=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.f3");return L(k,3)},D=h.scale=h.__private__.scale=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.scale");return w===v.COMPAT?k*Pe:w===v.ADVANCED?k:void 0},G=function(k){return w===v.COMPAT?bc()-k:w===v.ADVANCED?k:void 0},K=function(k){return D(G(k))};h.__private__.setPrecision=h.setPrecision=function(k){typeof parseInt(k,10)=="number"&&(t=parseInt(k,10))};var ae,Z="00000000000000000000000000000000",oe=h.__private__.getFileId=function(){return Z},Y=h.__private__.setFileId=function(k){return Z=k!==void 0&&/^[a-fA-F0-9]{32}$/.test(k)?k.toUpperCase():Z.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(Js=new Mu(d.userPermissions,d.userPassword,d.ownerPassword,Z)),Z};h.setFileId=function(k){return Y(k),this},h.getFileId=function(){return oe()};var R=h.__private__.convertDateToPDFDate=function(k){var ne=k.getTimezoneOffset(),be=ne<0?"+":"-",_e=Math.floor(Math.abs(ne/60)),Ve=Math.abs(ne%60),it=[be,S(_e),"'",S(Ve),"'"].join("");return["D:",k.getFullYear(),S(k.getMonth()+1),S(k.getDate()),S(k.getHours()),S(k.getMinutes()),S(k.getSeconds()),it].join("")},z=h.__private__.convertPDFDateToDate=function(k){var ne=parseInt(k.substr(2,4),10),be=parseInt(k.substr(6,2),10)-1,_e=parseInt(k.substr(8,2),10),Ve=parseInt(k.substr(10,2),10),it=parseInt(k.substr(12,2),10),yt=parseInt(k.substr(14,2),10);return new Date(ne,be,_e,Ve,it,yt,0)},ee=h.__private__.setCreationDate=function(k){var ne;if(k===void 0&&(k=new Date),k instanceof Date)ne=R(k);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(k))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ne=k}return ae=ne},b=h.__private__.getCreationDate=function(k){var ne=ae;return k==="jsDate"&&(ne=z(ae)),ne};h.setCreationDate=function(k){return ee(k),this},h.getCreationDate=function(k){return b(k)};var O,S=h.__private__.padd2=function(k){return("0"+parseInt(k)).slice(-2)},I=h.__private__.padd2Hex=function(k){return("00"+(k=k.toString())).substr(k.length)},U=0,Q=[],H=[],X=0,V=[],Ae=[],W=!1,J=H,ve=function(){U=0,X=0,H=[],Q=[],V=[],he=Nt(),me=Nt()};h.__private__.setCustomOutputDestination=function(k){W=!0,J=k};var de=function(k){W||(J=k)};h.__private__.resetCustomOutputDestination=function(){W=!1,J=H};var te=h.__private__.out=function(k){return k=k.toString(),X+=k.length+1,J.push(k),J},je=h.__private__.write=function(k){return te(arguments.length===1?k.toString():Array.prototype.join.call(arguments," "))},qe=h.__private__.getArrayBuffer=function(k){for(var ne=k.length,be=new ArrayBuffer(ne),_e=new Uint8Array(be);ne--;)_e[ne]=k.charCodeAt(ne);return be},He=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return He};var Ze=e.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(k){return Ze=w===v.ADVANCED?k/Pe:k,this};var xe,ue=h.__private__.getFontSize=h.getFontSize=function(){return w===v.COMPAT?Ze:Ze*Pe},Fe=e.R2L||!1;h.__private__.setR2L=h.setR2L=function(k){return Fe=k,this},h.__private__.getR2L=h.getR2L=function(){return Fe};var ke,Te=h.__private__.setZoomMode=function(k){var ne=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(k))xe=k;else if(isNaN(k)){if(ne.indexOf(k)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+k+'" is not recognized.');xe=k}else xe=parseInt(k,10)};h.__private__.getZoomMode=function(){return xe};var Ne,et=h.__private__.setPageMode=function(k){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(k)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+k+'" is not recognized.');ke=k};h.__private__.getPageMode=function(){return ke};var Se=h.__private__.setLayoutMode=function(k){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(k)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+k+'" is not recognized.');Ne=k};h.__private__.getLayoutMode=function(){return Ne},h.__private__.setDisplayMode=h.setDisplayMode=function(k,ne,be){return Te(k),Se(ne),et(be),this};var Ce={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(k){if(Object.keys(Ce).indexOf(k)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Ce[k]},h.__private__.getDocumentProperties=function(){return Ce},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(k){for(var ne in Ce)Ce.hasOwnProperty(ne)&&k[ne]&&(Ce[ne]=k[ne]);return this},h.__private__.setDocumentProperty=function(k,ne){if(Object.keys(Ce).indexOf(k)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Ce[k]=ne};var Be,Pe,Bt,tt,Ot,vt={},Vt={},pr=[],$t={},Qr={},ir={},Gr={},un=null,Nr=0,Wt=[],lt=new Ok(h),Et=e.hotfixes||[],It={},Ee={},Oe=[],Re=function k(ne,be,_e,Ve,it,yt){if(!(this instanceof k))return new k(ne,be,_e,Ve,it,yt);isNaN(ne)&&(ne=1),isNaN(be)&&(be=0),isNaN(_e)&&(_e=0),isNaN(Ve)&&(Ve=1),isNaN(it)&&(it=0),isNaN(yt)&&(yt=0),this._matrix=[ne,be,_e,Ve,it,yt]};Object.defineProperty(Re.prototype,"sx",{get:function(){return this._matrix[0]},set:function(k){this._matrix[0]=k}}),Object.defineProperty(Re.prototype,"shy",{get:function(){return this._matrix[1]},set:function(k){this._matrix[1]=k}}),Object.defineProperty(Re.prototype,"shx",{get:function(){return this._matrix[2]},set:function(k){this._matrix[2]=k}}),Object.defineProperty(Re.prototype,"sy",{get:function(){return this._matrix[3]},set:function(k){this._matrix[3]=k}}),Object.defineProperty(Re.prototype,"tx",{get:function(){return this._matrix[4]},set:function(k){this._matrix[4]=k}}),Object.defineProperty(Re.prototype,"ty",{get:function(){return this._matrix[5]},set:function(k){this._matrix[5]=k}}),Object.defineProperty(Re.prototype,"a",{get:function(){return this._matrix[0]},set:function(k){this._matrix[0]=k}}),Object.defineProperty(Re.prototype,"b",{get:function(){return this._matrix[1]},set:function(k){this._matrix[1]=k}}),Object.defineProperty(Re.prototype,"c",{get:function(){return this._matrix[2]},set:function(k){this._matrix[2]=k}}),Object.defineProperty(Re.prototype,"d",{get:function(){return this._matrix[3]},set:function(k){this._matrix[3]=k}}),Object.defineProperty(Re.prototype,"e",{get:function(){return this._matrix[4]},set:function(k){this._matrix[4]=k}}),Object.defineProperty(Re.prototype,"f",{get:function(){return this._matrix[5]},set:function(k){this._matrix[5]=k}}),Object.defineProperty(Re.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Re.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Re.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Re.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Re.prototype.join=function(k){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(j).join(k)},Re.prototype.multiply=function(k){var ne=k.sx*this.sx+k.shy*this.shx,be=k.sx*this.shy+k.shy*this.sy,_e=k.shx*this.sx+k.sy*this.shx,Ve=k.shx*this.shy+k.sy*this.sy,it=k.tx*this.sx+k.ty*this.shx+this.tx,yt=k.tx*this.shy+k.ty*this.sy+this.ty;return new Re(ne,be,_e,Ve,it,yt)},Re.prototype.decompose=function(){var k=this.sx,ne=this.shy,be=this.shx,_e=this.sy,Ve=this.tx,it=this.ty,yt=Math.sqrt(k*k+ne*ne),Qt=(k/=yt)*be+(ne/=yt)*_e;be-=k*Qt,_e-=ne*Qt;var Yt=Math.sqrt(be*be+_e*_e);return Qt/=Yt,k*(_e/=Yt)<ne*(be/=Yt)&&(k=-k,ne=-ne,Qt=-Qt,yt=-yt),{scale:new Re(yt,0,0,Yt,0,0),translate:new Re(1,0,0,1,Ve,it),rotate:new Re(k,ne,-ne,k,0,0),skew:new Re(1,0,Qt,1,0,0)}},Re.prototype.toString=function(k){return this.join(" ")},Re.prototype.inversed=function(){var k=this.sx,ne=this.shy,be=this.shx,_e=this.sy,Ve=this.tx,it=this.ty,yt=1/(k*_e-ne*be),Qt=_e*yt,Yt=-ne*yt,gr=-be*yt,fr=k*yt;return new Re(Qt,Yt,gr,fr,-Qt*Ve-gr*it,-Yt*Ve-fr*it)},Re.prototype.applyToPoint=function(k){var ne=k.x*this.sx+k.y*this.shx+this.tx,be=k.x*this.shy+k.y*this.sy+this.ty;return new ou(ne,be)},Re.prototype.applyToRectangle=function(k){var ne=this.applyToPoint(k),be=this.applyToPoint(new ou(k.x+k.w,k.y+k.h));return new y0(ne.x,ne.y,be.x-ne.x,be.y-ne.y)},Re.prototype.clone=function(){var k=this.sx,ne=this.shy,be=this.shx,_e=this.sy,Ve=this.tx,it=this.ty;return new Re(k,ne,be,_e,Ve,it)},h.Matrix=Re;var Ye=h.matrixMult=function(k,ne){return ne.multiply(k)},ft=new Re(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=ft;var mt=function(k,ne){if(!Qr[k]){var be=(ne instanceof ed?"Sh":"P")+(Object.keys($t).length+1).toString(10);ne.id=be,Qr[k]=be,$t[be]=ne,lt.publish("addPattern",ne)}};h.ShadingPattern=ed,h.TilingPattern=of,h.addShadingPattern=function(k,ne){return E("addShadingPattern()"),mt(k,ne),this},h.beginTilingPattern=function(k){E("beginTilingPattern()"),_p(k.boundingBox[0],k.boundingBox[1],k.boundingBox[2]-k.boundingBox[0],k.boundingBox[3]-k.boundingBox[1],k.matrix)},h.endTilingPattern=function(k,ne){E("endTilingPattern()"),ne.stream=Ae[O].join(`
`),mt(k,ne),lt.publish("endTilingPattern",ne),Oe.pop().restore()};var qt=h.__private__.newObject=function(){var k=Nt();return se(k,!0),k},Nt=h.__private__.newObjectDeferred=function(){return U++,Q[U]=function(){return X},U},se=function(k,ne){return ne=typeof ne=="boolean"&&ne,Q[k]=X,ne&&te(k+" 0 obj"),k},pe=h.__private__.newAdditionalObject=function(){var k={objId:Nt(),content:""};return V.push(k),k},he=Nt(),me=Nt(),ge=h.__private__.decodeColorString=function(k){var ne=k.split(" ");if(ne.length!==2||ne[1]!=="g"&&ne[1]!=="G")ne.length===5&&(ne[4]==="k"||ne[4]==="K")&&(ne=[(1-ne[0])*(1-ne[3]),(1-ne[1])*(1-ne[3]),(1-ne[2])*(1-ne[3]),"r"]);else{var be=parseFloat(ne[0]);ne=[be,be,be,"r"]}for(var _e="#",Ve=0;Ve<3;Ve++)_e+=("0"+Math.floor(255*parseFloat(ne[Ve])).toString(16)).slice(-2);return _e},we=h.__private__.encodeColorString=function(k){var ne;typeof k=="string"&&(k={ch1:k});var be=k.ch1,_e=k.ch2,Ve=k.ch3,it=k.ch4,yt=k.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof be=="string"&&be.charAt(0)!=="#"){var Qt=new JP(be);if(Qt.ok)be=Qt.toHex();else if(!/^\d*\.?\d*$/.test(be))throw new Error('Invalid color "'+be+'" passed to jsPDF.encodeColorString.')}if(typeof be=="string"&&/^#[0-9A-Fa-f]{3}$/.test(be)&&(be="#"+be[1]+be[1]+be[2]+be[2]+be[3]+be[3]),typeof be=="string"&&/^#[0-9A-Fa-f]{6}$/.test(be)){var Yt=parseInt(be.substr(1),16);be=Yt>>16&255,_e=Yt>>8&255,Ve=255&Yt}if(_e===void 0||it===void 0&&be===_e&&_e===Ve)if(typeof be=="string")ne=be+" "+yt[0];else switch(k.precision){case 2:ne=M(be/255)+" "+yt[0];break;case 3:default:ne=F(be/255)+" "+yt[0]}else if(it===void 0||Ur(it)==="object"){if(it&&!isNaN(it.a)&&it.a===0)return ne=["1.","1.","1.",yt[1]].join(" ");if(typeof be=="string")ne=[be,_e,Ve,yt[1]].join(" ");else switch(k.precision){case 2:ne=[M(be/255),M(_e/255),M(Ve/255),yt[1]].join(" ");break;default:case 3:ne=[F(be/255),F(_e/255),F(Ve/255),yt[1]].join(" ")}}else if(typeof be=="string")ne=[be,_e,Ve,it,yt[2]].join(" ");else switch(k.precision){case 2:ne=[M(be),M(_e),M(Ve),M(it),yt[2]].join(" ");break;case 3:default:ne=[F(be),F(_e),F(Ve),F(it),yt[2]].join(" ")}return ne},ze=h.__private__.getFilters=function(){return o},rt=h.__private__.putStream=function(k){var ne=(k=k||{}).data||"",be=k.filters||ze(),_e=k.alreadyAppliedFilters||[],Ve=k.addLength1||!1,it=ne.length,yt=k.objectId,Qt=function(Zs){return Zs};if(d!==null&&yt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(Qt=Js.encryptor(yt,0));var Yt={};be===!0&&(be=["FlateEncode"]);var gr=k.additionalKeyValues||[],fr=(Yt=lr.API.processDataByFilters!==void 0?lr.API.processDataByFilters(ne,be):{data:ne,reverseChain:[]}).reverseChain+(Array.isArray(_e)?_e.join(" "):_e.toString());if(Yt.data.length!==0&&(gr.push({key:"Length",value:Yt.data.length}),Ve===!0&&gr.push({key:"Length1",value:it})),fr.length!=0)if(fr.split("/").length-1==1)gr.push({key:"Filter",value:fr});else{gr.push({key:"Filter",value:"["+fr+"]"});for(var Ir=0;Ir<gr.length;Ir+=1)if(gr[Ir].key==="DecodeParms"){for(var Ln=[],Mn=0;Mn<Yt.reverseChain.split("/").length-1;Mn+=1)Ln.push("null");Ln.push(gr[Ir].value),gr[Ir].value="["+Ln.join(" ")+"]"}}te("<<");for(var cs=0;cs<gr.length;cs++)te("/"+gr[cs].key+" "+gr[cs].value);te(">>"),Yt.data.length!==0&&(te("stream"),te(Qt(Yt.data)),te("endstream"))},$e=h.__private__.putPage=function(k){var ne=k.number,be=k.data,_e=k.objId,Ve=k.contentsObjId;se(_e,!0),te("<</Type /Page"),te("/Parent "+k.rootDictionaryObjId+" 0 R"),te("/Resources "+k.resourceDictionaryObjId+" 0 R"),te("/MediaBox ["+parseFloat(j(k.mediaBox.bottomLeftX))+" "+parseFloat(j(k.mediaBox.bottomLeftY))+" "+j(k.mediaBox.topRightX)+" "+j(k.mediaBox.topRightY)+"]"),k.cropBox!==null&&te("/CropBox ["+j(k.cropBox.bottomLeftX)+" "+j(k.cropBox.bottomLeftY)+" "+j(k.cropBox.topRightX)+" "+j(k.cropBox.topRightY)+"]"),k.bleedBox!==null&&te("/BleedBox ["+j(k.bleedBox.bottomLeftX)+" "+j(k.bleedBox.bottomLeftY)+" "+j(k.bleedBox.topRightX)+" "+j(k.bleedBox.topRightY)+"]"),k.trimBox!==null&&te("/TrimBox ["+j(k.trimBox.bottomLeftX)+" "+j(k.trimBox.bottomLeftY)+" "+j(k.trimBox.topRightX)+" "+j(k.trimBox.topRightY)+"]"),k.artBox!==null&&te("/ArtBox ["+j(k.artBox.bottomLeftX)+" "+j(k.artBox.bottomLeftY)+" "+j(k.artBox.topRightX)+" "+j(k.artBox.topRightY)+"]"),typeof k.userUnit=="number"&&k.userUnit!==1&&te("/UserUnit "+k.userUnit),lt.publish("putPage",{objId:_e,pageContext:Wt[ne],pageNumber:ne,page:be}),te("/Contents "+Ve+" 0 R"),te(">>"),te("endobj");var it=be.join(`
`);return w===v.ADVANCED&&(it+=`
Q`),se(Ve,!0),rt({data:it,filters:ze(),objectId:Ve}),te("endobj"),_e},Xe=h.__private__.putPages=function(){var k,ne,be=[];for(k=1;k<=Nr;k++)Wt[k].objId=Nt(),Wt[k].contentsObjId=Nt();for(k=1;k<=Nr;k++)be.push($e({number:k,data:Ae[k],objId:Wt[k].objId,contentsObjId:Wt[k].contentsObjId,mediaBox:Wt[k].mediaBox,cropBox:Wt[k].cropBox,bleedBox:Wt[k].bleedBox,trimBox:Wt[k].trimBox,artBox:Wt[k].artBox,userUnit:Wt[k].userUnit,rootDictionaryObjId:he,resourceDictionaryObjId:me}));se(he,!0),te("<</Type /Pages");var _e="/Kids [";for(ne=0;ne<Nr;ne++)_e+=be[ne]+" 0 R ";te(_e+"]"),te("/Count "+Nr),te(">>"),te("endobj"),lt.publish("postPutPages")},Je=function(k){lt.publish("putFont",{font:k,out:te,newObject:qt,putStream:rt}),k.isAlreadyPutted!==!0&&(k.objectNumber=qt(),te("<<"),te("/Type /Font"),te("/BaseFont /"+Hu(k.postScriptName)),te("/Subtype /Type1"),typeof k.encoding=="string"&&te("/Encoding /"+k.encoding),te("/FirstChar 32"),te("/LastChar 255"),te(">>"),te("endobj"))},gt=function(){for(var k in vt)vt.hasOwnProperty(k)&&(u===!1||u===!0&&f.hasOwnProperty(k))&&Je(vt[k])},Ct=function(k){k.objectNumber=qt();var ne=[];ne.push({key:"Type",value:"/XObject"}),ne.push({key:"Subtype",value:"/Form"}),ne.push({key:"BBox",value:"["+[j(k.x),j(k.y),j(k.x+k.width),j(k.y+k.height)].join(" ")+"]"}),ne.push({key:"Matrix",value:"["+k.matrix.toString()+"]"});var be=k.pages[1].join(`
`);rt({data:be,additionalKeyValues:ne,objectId:k.objectNumber}),te("endobj")},Ut=function(){for(var k in It)It.hasOwnProperty(k)&&Ct(It[k])},wt=function(k,ne){var be,_e=[],Ve=1/(ne-1);for(be=0;be<1;be+=Ve)_e.push(be);if(_e.push(1),k[0].offset!=0){var it={offset:0,color:k[0].color};k.unshift(it)}if(k[k.length-1].offset!=1){var yt={offset:1,color:k[k.length-1].color};k.push(yt)}for(var Qt="",Yt=0,gr=0;gr<_e.length;gr++){for(be=_e[gr];be>k[Yt+1].offset;)Yt++;var fr=k[Yt].offset,Ir=(be-fr)/(k[Yt+1].offset-fr),Ln=k[Yt].color,Mn=k[Yt+1].color;Qt+=I(Math.round((1-Ir)*Ln[0]+Ir*Mn[0]).toString(16))+I(Math.round((1-Ir)*Ln[1]+Ir*Mn[1]).toString(16))+I(Math.round((1-Ir)*Ln[2]+Ir*Mn[2]).toString(16))}return Qt.trim()},Lt=function(k,ne){ne||(ne=21);var be=qt(),_e=wt(k.colors,ne),Ve=[];Ve.push({key:"FunctionType",value:"0"}),Ve.push({key:"Domain",value:"[0.0 1.0]"}),Ve.push({key:"Size",value:"["+ne+"]"}),Ve.push({key:"BitsPerSample",value:"8"}),Ve.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ve.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),rt({data:_e,additionalKeyValues:Ve,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:be}),te("endobj"),k.objectNumber=qt(),te("<< /ShadingType "+k.type),te("/ColorSpace /DeviceRGB");var it="/Coords ["+j(parseFloat(k.coords[0]))+" "+j(parseFloat(k.coords[1]))+" ";k.type===2?it+=j(parseFloat(k.coords[2]))+" "+j(parseFloat(k.coords[3])):it+=j(parseFloat(k.coords[2]))+" "+j(parseFloat(k.coords[3]))+" "+j(parseFloat(k.coords[4]))+" "+j(parseFloat(k.coords[5])),te(it+="]"),k.matrix&&te("/Matrix ["+k.matrix.toString()+"]"),te("/Function "+be+" 0 R"),te("/Extend [true true]"),te(">>"),te("endobj")},or=function(k,ne){var be=Nt(),_e=qt();ne.push({resourcesOid:be,objectOid:_e}),k.objectNumber=_e;var Ve=[];Ve.push({key:"Type",value:"/Pattern"}),Ve.push({key:"PatternType",value:"1"}),Ve.push({key:"PaintType",value:"1"}),Ve.push({key:"TilingType",value:"1"}),Ve.push({key:"BBox",value:"["+k.boundingBox.map(j).join(" ")+"]"}),Ve.push({key:"XStep",value:j(k.xStep)}),Ve.push({key:"YStep",value:j(k.yStep)}),Ve.push({key:"Resources",value:be+" 0 R"}),k.matrix&&Ve.push({key:"Matrix",value:"["+k.matrix.toString()+"]"}),rt({data:k.stream,additionalKeyValues:Ve,objectId:k.objectNumber}),te("endobj")},Mr=function(k){var ne;for(ne in $t)$t.hasOwnProperty(ne)&&($t[ne]instanceof ed?Lt($t[ne]):$t[ne]instanceof of&&or($t[ne],k))},Wr=function(k){for(var ne in k.objectNumber=qt(),te("<<"),k)switch(ne){case"opacity":te("/ca "+M(k[ne]));break;case"stroke-opacity":te("/CA "+M(k[ne]))}te(">>"),te("endobj")},Qn=function(){var k;for(k in ir)ir.hasOwnProperty(k)&&Wr(ir[k])},li=function(){for(var k in te("/XObject <<"),It)It.hasOwnProperty(k)&&It[k].objectNumber>=0&&te("/"+k+" "+It[k].objectNumber+" 0 R");lt.publish("putXobjectDict"),te(">>")},bo=function(){Js.oid=qt(),te("<<"),te("/Filter /Standard"),te("/V "+Js.v),te("/R "+Js.r),te("/U <"+Js.toHexString(Js.U)+">"),te("/O <"+Js.toHexString(Js.O)+">"),te("/P "+Js.P),te(">>"),te("endobj")},Pi=function(){for(var k in te("/Font <<"),vt)vt.hasOwnProperty(k)&&(u===!1||u===!0&&f.hasOwnProperty(k))&&te("/"+k+" "+vt[k].objectNumber+" 0 R");te(">>")},Pa=function(){if(Object.keys($t).length>0){for(var k in te("/Shading <<"),$t)$t.hasOwnProperty(k)&&$t[k]instanceof ed&&$t[k].objectNumber>=0&&te("/"+k+" "+$t[k].objectNumber+" 0 R");lt.publish("putShadingPatternDict"),te(">>")}},Oi=function(k){if(Object.keys($t).length>0){for(var ne in te("/Pattern <<"),$t)$t.hasOwnProperty(ne)&&$t[ne]instanceof h.TilingPattern&&$t[ne].objectNumber>=0&&$t[ne].objectNumber<k&&te("/"+ne+" "+$t[ne].objectNumber+" 0 R");lt.publish("putTilingPatternDict"),te(">>")}},Ke=function(){if(Object.keys(ir).length>0){var k;for(k in te("/ExtGState <<"),ir)ir.hasOwnProperty(k)&&ir[k].objectNumber>=0&&te("/"+k+" "+ir[k].objectNumber+" 0 R");lt.publish("putGStateDict"),te(">>")}},Le=function(k){se(k.resourcesOid,!0),te("<<"),te("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Pi(),Pa(),Oi(k.objectOid),Ke(),li(),te(">>"),te("endobj")},ct=function(){var k=[];gt(),Qn(),Ut(),Mr(k),lt.publish("putResources"),k.forEach(Le),Le({resourcesOid:me,objectOid:Number.MAX_SAFE_INTEGER}),lt.publish("postPutResources")},jt=function(){lt.publish("putAdditionalObjects");for(var k=0;k<V.length;k++){var ne=V[k];se(ne.objId,!0),te(ne.content),te("endobj")}lt.publish("postPutAdditionalObjects")},Gt=function(k){Vt[k.fontName]=Vt[k.fontName]||{},Vt[k.fontName][k.fontStyle]=k.id},er=function(k,ne,be,_e,Ve){var it={id:"F"+(Object.keys(vt).length+1).toString(10),postScriptName:k,fontName:ne,fontStyle:be,encoding:_e,isStandardFont:Ve||!1,metadata:{}};return lt.publish("addFont",{font:it,instance:this}),vt[it.id]=it,Gt(it),it.id},Pt=function(k){for(var ne=0,be=He.length;ne<be;ne++){var _e=er.call(this,k[ne][0],k[ne][1],k[ne][2],He[ne][3],!0);u===!1&&(f[_e]=!0);var Ve=k[ne][0].split("-");Gt({id:_e,fontName:Ve[0],fontStyle:Ve[1]||""})}lt.publish("addFonts",{fonts:vt,dictionary:Vt})},xr=function(k){return k.foo=function(){try{return k.apply(this,arguments)}catch(_e){var ne=_e.stack||"";~ne.indexOf(" at ")&&(ne=ne.split(" at ")[1]);var be="Error in function "+ne.split(`
`)[0].split("<")[0]+": "+_e.message;if(!cr.console)throw new Error(be);cr.console.error(be,_e),cr.alert&&alert(be)}},k.foo.bar=k,k.foo},Xr=function(k,ne){var be,_e,Ve,it,yt,Qt,Yt,gr,fr;if(Ve=(ne=ne||{}).sourceEncoding||"Unicode",yt=ne.outputEncoding,(ne.autoencode||yt)&&vt[Be].metadata&&vt[Be].metadata[Ve]&&vt[Be].metadata[Ve].encoding&&(it=vt[Be].metadata[Ve].encoding,!yt&&vt[Be].encoding&&(yt=vt[Be].encoding),!yt&&it.codePages&&(yt=it.codePages[0]),typeof yt=="string"&&(yt=it[yt]),yt)){for(Yt=!1,Qt=[],be=0,_e=k.length;be<_e;be++)(gr=yt[k.charCodeAt(be)])?Qt.push(String.fromCharCode(gr)):Qt.push(k[be]),Qt[be].charCodeAt(0)>>8&&(Yt=!0);k=Qt.join("")}for(be=k.length;Yt===void 0&&be!==0;)k.charCodeAt(be-1)>>8&&(Yt=!0),be--;if(!Yt)return k;for(Qt=ne.noBOM?[]:[254,255],be=0,_e=k.length;be<_e;be++){if((fr=(gr=k.charCodeAt(be))>>8)>>8)throw new Error("Character at position "+be+" of string '"+k+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Qt.push(fr),Qt.push(gr-(fr<<8))}return String.fromCharCode.apply(void 0,Qt)},Tr=h.__private__.pdfEscape=h.pdfEscape=function(k,ne){return Xr(k,ne).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},fn=h.__private__.beginPage=function(k){Ae[++Nr]=[],Wt[Nr]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(k[0]),topRightY:Number(k[1])}},IA(Nr),de(Ae[O])},Xs=function(k,ne){var be,_e,Ve;switch(r=ne||r,typeof k=="string"&&(be=p(k.toLowerCase()),Array.isArray(be)&&(_e=be[0],Ve=be[1])),Array.isArray(k)&&(_e=k[0]*Pe,Ve=k[1]*Pe),isNaN(_e)&&(_e=s[0],Ve=s[1]),(_e>14400||Ve>14400)&&(dn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),_e=Math.min(14400,_e),Ve=Math.min(14400,Ve)),s=[_e,Ve],r.substr(0,1)){case"l":Ve>_e&&(s=[Ve,_e]);break;case"p":_e>Ve&&(s=[Ve,_e])}fn(s),Sp(m0),te(No),x0!==0&&te(x0+" J"),g0!==0&&te(g0+" j"),lt.publish("addPage",{pageNumber:Nr})},Ys=function(k){k>0&&k<=Nr&&(Ae.splice(k,1),Wt.splice(k,1),Nr--,O>Nr&&(O=Nr),this.setPage(O))},IA=function(k){k>0&&k<=Nr&&(O=k)},tu=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return Ae.length-1},bp=function(k,ne,be){var _e,Ve=void 0;return be=be||{},k=k!==void 0?k:vt[Be].fontName,ne=ne!==void 0?ne:vt[Be].fontStyle,_e=k.toLowerCase(),Vt[_e]!==void 0&&Vt[_e][ne]!==void 0?Ve=Vt[_e][ne]:Vt[k]!==void 0&&Vt[k][ne]!==void 0?Ve=Vt[k][ne]:be.disableWarning===!1&&dn.warn("Unable to look up font label for font '"+k+"', '"+ne+"'. Refer to getFontList() for available fonts."),Ve||be.noFallback||(Ve=Vt.times[ne])==null&&(Ve=Vt.times.normal),Ve},n2=h.__private__.putInfo=function(){var k=qt(),ne=function(_e){return _e};for(var be in d!==null&&(ne=Js.encryptor(k,0)),te("<<"),te("/Producer ("+Tr(ne("jsPDF "+lr.version))+")"),Ce)Ce.hasOwnProperty(be)&&Ce[be]&&te("/"+be.substr(0,1).toUpperCase()+be.substr(1)+" ("+Tr(ne(Ce[be]))+")");te("/CreationDate ("+Tr(ne(ae))+")"),te(">>"),te("endobj")},u0=h.__private__.putCatalog=function(k){var ne=(k=k||{}).rootDictionaryObjId||he;switch(qt(),te("<<"),te("/Type /Catalog"),te("/Pages "+ne+" 0 R"),xe||(xe="fullwidth"),xe){case"fullwidth":te("/OpenAction [3 0 R /FitH null]");break;case"fullheight":te("/OpenAction [3 0 R /FitV null]");break;case"fullpage":te("/OpenAction [3 0 R /Fit]");break;case"original":te("/OpenAction [3 0 R /XYZ null null 1]");break;default:var be=""+xe;be.substr(be.length-1)==="%"&&(xe=parseInt(xe)/100),typeof xe=="number"&&te("/OpenAction [3 0 R /XYZ null null "+M(xe)+"]")}switch(Ne||(Ne="continuous"),Ne){case"continuous":te("/PageLayout /OneColumn");break;case"single":te("/PageLayout /SinglePage");break;case"two":case"twoleft":te("/PageLayout /TwoColumnLeft");break;case"tworight":te("/PageLayout /TwoColumnRight")}ke&&te("/PageMode /"+ke),lt.publish("putCatalog"),te(">>"),te("endobj")},s2=h.__private__.putTrailer=function(){te("trailer"),te("<<"),te("/Size "+(U+1)),te("/Root "+U+" 0 R"),te("/Info "+(U-1)+" 0 R"),d!==null&&te("/Encrypt "+Js.oid+" 0 R"),te("/ID [ <"+Z+"> <"+Z+"> ]"),te(">>")},a2=h.__private__.putHeader=function(){te("%PDF-"+x),te("%")},i2=h.__private__.putXRef=function(){var k="0000000000";te("xref"),te("0 "+(U+1)),te("0000000000 65535 f ");for(var ne=1;ne<=U;ne++)typeof Q[ne]=="function"?te((k+Q[ne]()).slice(-10)+" 00000 n "):Q[ne]!==void 0?te((k+Q[ne]).slice(-10)+" 00000 n "):te("0000000000 00000 n ")},El=h.__private__.buildDocument=function(){ve(),de(H),lt.publish("buildDocument"),a2(),Xe(),jt(),ct(),d!==null&&bo(),n2(),u0();var k=X;return i2(),s2(),te("startxref"),te(""+k),te("%%EOF"),de(Ae[O]),H.join(`
`)},ru=h.__private__.getBlob=function(k){return new Blob([qe(k)],{type:"application/pdf"})},nu=h.output=h.__private__.output=xr(function(k,ne){switch(typeof(ne=ne||{})=="string"?ne={filename:ne}:ne.filename=ne.filename||"generated.pdf",k){case void 0:return El();case"save":h.save(ne.filename);break;case"arraybuffer":return qe(El());case"blob":return ru(El());case"bloburi":case"bloburl":if(cr.URL!==void 0&&typeof cr.URL.createObjectURL=="function")return cr.URL&&cr.URL.createObjectURL(ru(El()))||void 0;dn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var be="",_e=El();try{be=I5(_e)}catch{be=I5(unescape(encodeURIComponent(_e)))}return"data:application/pdf;filename="+ne.filename+";base64,"+be;case"pdfobjectnewwindow":if(Object.prototype.toString.call(cr)==="[object Window]"){var Ve="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",it=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ne.pdfObjectUrl&&(Ve=ne.pdfObjectUrl,it="");var yt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ve+'"'+it+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ne)+");<\/script></body></html>",Qt=cr.open();return Qt!==null&&Qt.document.write(yt),Qt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(cr)==="[object Window]"){var Yt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ne.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ne.filename+'" width="500px" height="400px" /></body></html>',gr=cr.open();if(gr!==null){gr.document.write(Yt);var fr=this;gr.document.documentElement.querySelector("#pdfViewer").onload=function(){gr.document.title=ne.filename,gr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(fr.output("bloburl"))}}return gr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(cr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Ir='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ne)+'"></iframe></body></html>',Ln=cr.open();if(Ln!==null&&(Ln.document.write(Ir),Ln.document.title=ne.filename),Ln||typeof safari>"u")return Ln;break;case"datauri":case"dataurl":return cr.document.location.href=this.output("datauristring",ne);default:return null}}),Np=function(k){return Array.isArray(Et)===!0&&Et.indexOf(k)>-1};switch(n){case"pt":Pe=1;break;case"mm":Pe=72/25.4;break;case"cm":Pe=72/2.54;break;case"in":Pe=72;break;case"px":Pe=Np("px_scaling")==1?.75:96/72;break;case"pc":case"em":Pe=12;break;case"ex":Pe=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Pe=n}var Js=null;ee(),Y();var o2=function(k){return d!==null?Js.encryptor(k,0):function(ne){return ne}},Cp=h.__private__.getPageInfo=h.getPageInfo=function(k){if(isNaN(k)||k%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Wt[k].objId,pageNumber:k,pageContext:Wt[k]}},ur=h.__private__.getPageInfoByObjId=function(k){if(isNaN(k)||k%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ne in Wt)if(Wt[ne].objId===k)break;return Cp(ne)},l2=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:Wt[O].objId,pageNumber:O,pageContext:Wt[O]}};h.addPage=function(){return Xs.apply(this,arguments),this},h.setPage=function(){return IA.apply(this,arguments),de.call(this,Ae[O]),this},h.insertPage=function(k){return this.addPage(),this.movePage(O,k),this},h.movePage=function(k,ne){var be,_e;if(k>ne){be=Ae[k],_e=Wt[k];for(var Ve=k;Ve>ne;Ve--)Ae[Ve]=Ae[Ve-1],Wt[Ve]=Wt[Ve-1];Ae[ne]=be,Wt[ne]=_e,this.setPage(ne)}else if(k<ne){be=Ae[k],_e=Wt[k];for(var it=k;it<ne;it++)Ae[it]=Ae[it+1],Wt[it]=Wt[it+1];Ae[ne]=be,Wt[ne]=_e,this.setPage(ne)}return this},h.deletePage=function(){return Ys.apply(this,arguments),this},h.__private__.text=h.text=function(k,ne,be,_e,Ve){var it,yt,Qt,Yt,gr,fr,Ir,Ln,Mn,cs=(_e=_e||{}).scope||this;if(typeof k=="number"&&typeof ne=="number"&&(typeof be=="string"||Array.isArray(be))){var Zs=be;be=ne,ne=k,k=Zs}if(arguments[3]instanceof Re?(E("The transform parameter of text() with a Matrix value"),Mn=Ve):(Qt=arguments[4],Yt=arguments[5],Ur(Ir=arguments[3])==="object"&&Ir!==null||(typeof Qt=="string"&&(Yt=Qt,Qt=null),typeof Ir=="string"&&(Yt=Ir,Ir=null),typeof Ir=="number"&&(Qt=Ir,Ir=null),_e={flags:Ir,angle:Qt,align:Yt})),isNaN(ne)||isNaN(be)||k==null)throw new Error("Invalid arguments passed to jsPDF.text");if(k.length===0)return cs;var Cs="",Co=!1,ci=typeof _e.lineHeightFactor=="number"?_e.lineHeightFactor:UA,Jo=cs.internal.scaleFactor;function Ip(hn){return hn=hn.split("	").join(Array(_e.TabLen||9).join(" ")),Tr(hn,Ir)}function N0(hn){for(var mn,Xn=hn.concat(),gs=[],Ll=Xn.length;Ll--;)typeof(mn=Xn.shift())=="string"?gs.push(mn):Array.isArray(hn)&&(mn.length===1||mn[1]===void 0&&mn[2]===void 0)?gs.push(mn[0]):gs.push([mn[0],mn[1],mn[2]]);return gs}function C0(hn,mn){var Xn;if(typeof hn=="string")Xn=mn(hn)[0];else if(Array.isArray(hn)){for(var gs,Ll,_0=hn.concat(),gu=[],Op=_0.length;Op--;)typeof(gs=_0.shift())=="string"?gu.push(mn(gs)[0]):Array.isArray(gs)&&typeof gs[0]=="string"&&(Ll=mn(gs[0],gs[1],gs[2]),gu.push([Ll[0],Ll[1],Ll[2]]));Xn=gu}return Xn}var cu=!1,j0=!0;if(typeof k=="string")cu=!0;else if(Array.isArray(k)){var B0=k.concat();yt=[];for(var Au,Rs=B0.length;Rs--;)(typeof(Au=B0.shift())!="string"||Array.isArray(Au)&&typeof Au[0]!="string")&&(j0=!1);cu=j0}if(cu===!1)throw new Error('Type of text must be string or Array. "'+k+'" is not recognized.');typeof k=="string"&&(k=k.match(/[\r?\n]/)?k.split(/\r\n|\r|\n/g):[k]);var du=Ze/cs.internal.scaleFactor,uu=du*(ci-1);switch(_e.baseline){case"bottom":be-=uu;break;case"top":be+=du-uu;break;case"hanging":be+=du-2*uu;break;case"middle":be+=du/2-uu}if((fr=_e.maxWidth||0)>0&&(typeof k=="string"?k=cs.splitTextToSize(k,fr):Object.prototype.toString.call(k)==="[object Array]"&&(k=k.reduce(function(hn,mn){return hn.concat(cs.splitTextToSize(mn,fr))},[]))),it={text:k,x:ne,y:be,options:_e,mutex:{pdfEscape:Tr,activeFontKey:Be,fonts:vt,activeFontSize:Ze}},lt.publish("preProcessText",it),k=it.text,Qt=(_e=it.options).angle,!(Mn instanceof Re)&&Qt&&typeof Qt=="number"){Qt*=Math.PI/180,_e.rotationDirection===0&&(Qt=-Qt),w===v.ADVANCED&&(Qt=-Qt);var fu=Math.cos(Qt),S0=Math.sin(Qt);Mn=new Re(fu,S0,-S0,fu,0,0)}else Qt&&Qt instanceof Re&&(Mn=Qt);w!==v.ADVANCED||Mn||(Mn=ft),(gr=_e.charSpace||iu)!==void 0&&(Cs+=j(D(gr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Ln=_e.horizontalScale)!==void 0&&(Cs+=j(100*Ln)+` Tz
`),_e.lang;var Oa=-1,g2=_e.renderingMode!==void 0?_e.renderingMode:_e.stroke,F0=cs.internal.getCurrentPageInfo().pageContext;switch(g2){case 0:case!1:case"fill":Oa=0;break;case 1:case!0:case"stroke":Oa=1;break;case 2:case"fillThenStroke":Oa=2;break;case 3:case"invisible":Oa=3;break;case 4:case"fillAndAddForClipping":Oa=4;break;case 5:case"strokeAndAddPathForClipping":Oa=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Oa=6;break;case 7:case"addToPathForClipping":Oa=7}var Lp=F0.usedRenderingMode!==void 0?F0.usedRenderingMode:-1;Oa!==-1?Cs+=Oa+` Tr
`:Lp!==-1&&(Cs+=`0 Tr
`),Oa!==-1&&(F0.usedRenderingMode=Oa),Yt=_e.align||"left";var Ri,hu=Ze*ci,Up=cs.internal.pageSize.getWidth(),Dp=vt[Be];gr=_e.charSpace||iu,fr=_e.maxWidth||0,Ir=Object.assign({autoencode:!0,noBOM:!0},_e.flags);var Nc=[],OA=function(hn){return cs.getStringUnitWidth(hn,{font:Dp,charSpace:gr,fontSize:Ze,doKerning:!1})*Ze/Jo};if(Object.prototype.toString.call(k)==="[object Array]"){var Ra;yt=N0(k),Yt!=="left"&&(Ri=yt.map(OA));var Na,Cc=0;if(Yt==="right"){ne-=Ri[0],k=[],Rs=yt.length;for(var Tl=0;Tl<Rs;Tl++)Tl===0?(Na=Yo(ne),Ra=kl(be)):(Na=D(Cc-Ri[Tl]),Ra=-hu),k.push([yt[Tl],Na,Ra]),Cc=Ri[Tl]}else if(Yt==="center"){ne-=Ri[0]/2,k=[],Rs=yt.length;for(var _l=0;_l<Rs;_l++)_l===0?(Na=Yo(ne),Ra=kl(be)):(Na=D((Cc-Ri[_l])/2),Ra=-hu),k.push([yt[_l],Na,Ra]),Cc=Ri[_l]}else if(Yt==="left"){k=[],Rs=yt.length;for(var mu=0;mu<Rs;mu++)k.push(yt[mu])}else if(Yt==="justify"&&Dp.encoding==="Identity-H"){k=[],Rs=yt.length,fr=fr!==0?fr:Up;for(var Il=0,Wn=0;Wn<Rs;Wn++)if(Ra=Wn===0?kl(be):-hu,Na=Wn===0?Yo(ne):Il,Wn<Rs-1){var E0=D((fr-Ri[Wn])/(yt[Wn].split(" ").length-1)),Ca=yt[Wn].split(" ");k.push([Ca[0]+" ",Na,Ra]),Il=0;for(var Qi=1;Qi<Ca.length;Qi++){var pu=(OA(Ca[Qi-1]+" "+Ca[Qi])-OA(Ca[Qi]))*Jo+E0;Qi==Ca.length-1?k.push([Ca[Qi],pu,0]):k.push([Ca[Qi]+" ",pu,0]),Il-=pu}}else k.push([yt[Wn],Na,Ra]);k.push(["",Il,0])}else{if(Yt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(k=[],Rs=yt.length,fr=fr!==0?fr:Up,Wn=0;Wn<Rs;Wn++)Ra=Wn===0?kl(be):-hu,Na=Wn===0?Yo(ne):0,Wn<Rs-1?Nc.push(j(D((fr-Ri[Wn])/(yt[Wn].split(" ").length-1)))):Nc.push(0),k.push([yt[Wn],Na,Ra])}}var Pp=typeof _e.R2L=="boolean"?_e.R2L:Fe;Pp===!0&&(k=C0(k,function(hn,mn,Xn){return[hn.split("").reverse().join(""),mn,Xn]})),it={text:k,x:ne,y:be,options:_e,mutex:{pdfEscape:Tr,activeFontKey:Be,fonts:vt,activeFontSize:Ze}},lt.publish("postProcessText",it),k=it.text,Co=it.mutex.isHex||!1;var k0=vt[Be].encoding;k0!=="WinAnsiEncoding"&&k0!=="StandardEncoding"||(k=C0(k,function(hn,mn,Xn){return[Ip(hn),mn,Xn]})),yt=N0(k),k=[];for(var RA,QA,jc,MA=0,xu=1,HA=Array.isArray(yt[0])?xu:MA,Bc="",T0=function(hn,mn,Xn){var gs="";return Xn instanceof Re?(Xn=typeof _e.angle=="number"?Ye(Xn,new Re(1,0,0,1,hn,mn)):Ye(new Re(1,0,0,1,hn,mn),Xn),w===v.ADVANCED&&(Xn=Ye(new Re(1,0,0,-1,0,0),Xn)),gs=Xn.join(" ")+` Tm
`):gs=j(hn)+" "+j(mn)+` Td
`,gs},Mi=0;Mi<yt.length;Mi++){switch(Bc="",HA){case xu:jc=(Co?"<":"(")+yt[Mi][0]+(Co?">":")"),RA=parseFloat(yt[Mi][1]),QA=parseFloat(yt[Mi][2]);break;case MA:jc=(Co?"<":"(")+yt[Mi]+(Co?">":")"),RA=Yo(ne),QA=kl(be)}Nc!==void 0&&Nc[Mi]!==void 0&&(Bc=Nc[Mi]+` Tw
`),Mi===0?k.push(Bc+T0(RA,QA,Mn)+jc):HA===MA?k.push(Bc+jc):HA===xu&&k.push(Bc+T0(RA,QA,Mn)+jc)}k=HA===MA?k.join(` Tj
T* `):k.join(` Tj
`),k+=` Tj
`;var Hi=`BT
/`;return Hi+=Be+" "+Ze+` Tf
`,Hi+=j(Ze*ci)+` TL
`,Hi+=DA+`
`,Hi+=Cs,Hi+=k,te(Hi+="ET"),f[Be]=!0,cs};var c2=h.__private__.clip=h.clip=function(k){return te(k==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return c2("evenodd")},h.__private__.discardPath=h.discardPath=function(){return te("n"),this};var Xo=h.__private__.isValidStyle=function(k){var ne=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(k)!==-1&&(ne=!0),ne};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(k){return Xo(k)&&(A=k),this};var jp=h.__private__.getStyle=h.getStyle=function(k){var ne=A;switch(k){case"D":case"S":ne="S";break;case"F":ne="f";break;case"FD":case"DF":ne="B";break;case"f":case"f*":case"B":case"B*":ne=k}return ne},Bp=h.close=function(){return te("h"),this};h.stroke=function(){return te("S"),this},h.fill=function(k){return su("f",k),this},h.fillEvenOdd=function(k){return su("f*",k),this},h.fillStroke=function(k){return su("B",k),this},h.fillStrokeEvenOdd=function(k){return su("B*",k),this};var su=function(k,ne){Ur(ne)==="object"?d2(ne,k):te(k)},f0=function(k){k===null||w===v.ADVANCED&&k===void 0||(k=jp(k),te(k))};function A2(k,ne,be,_e,Ve){var it=new of(ne||this.boundingBox,be||this.xStep,_e||this.yStep,this.gState,Ve||this.matrix);it.stream=this.stream;var yt=k+"$$"+this.cloneIndex+++"$$";return mt(yt,it),it}var d2=function(k,ne){var be=Qr[k.key],_e=$t[be];if(_e instanceof ed)te("q"),te(u2(ne)),_e.gState&&h.setGState(_e.gState),te(k.matrix.toString()+" cm"),te("/"+be+" sh"),te("Q");else if(_e instanceof of){var Ve=new Re(1,0,0,-1,0,bc());k.matrix&&(Ve=Ve.multiply(k.matrix||ft),be=A2.call(_e,k.key,k.boundingBox,k.xStep,k.yStep,Ve).id),te("q"),te("/Pattern cs"),te("/"+be+" scn"),_e.gState&&h.setGState(_e.gState),te(ne),te("Q")}},u2=function(k){switch(k){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},h0=h.moveTo=function(k,ne){return te(j(D(k))+" "+j(K(ne))+" m"),this},LA=h.lineTo=function(k,ne){return te(j(D(k))+" "+j(K(ne))+" l"),this},vc=h.curveTo=function(k,ne,be,_e,Ve,it){return te([j(D(k)),j(K(ne)),j(D(be)),j(K(_e)),j(D(Ve)),j(K(it)),"c"].join(" ")),this};h.__private__.line=h.line=function(k,ne,be,_e,Ve){if(isNaN(k)||isNaN(ne)||isNaN(be)||isNaN(_e)||!Xo(Ve))throw new Error("Invalid arguments passed to jsPDF.line");return w===v.COMPAT?this.lines([[be-k,_e-ne]],k,ne,[1,1],Ve||"S"):this.lines([[be-k,_e-ne]],k,ne,[1,1]).stroke()},h.__private__.lines=h.lines=function(k,ne,be,_e,Ve,it){var yt,Qt,Yt,gr,fr,Ir,Ln,Mn,cs,Zs,Cs,Co;if(typeof k=="number"&&(Co=be,be=ne,ne=k,k=Co),_e=_e||[1,1],it=it||!1,isNaN(ne)||isNaN(be)||!Array.isArray(k)||!Array.isArray(_e)||!Xo(Ve)||typeof it!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(h0(ne,be),yt=_e[0],Qt=_e[1],gr=k.length,Zs=ne,Cs=be,Yt=0;Yt<gr;Yt++)(fr=k[Yt]).length===2?(Zs=fr[0]*yt+Zs,Cs=fr[1]*Qt+Cs,LA(Zs,Cs)):(Ir=fr[0]*yt+Zs,Ln=fr[1]*Qt+Cs,Mn=fr[2]*yt+Zs,cs=fr[3]*Qt+Cs,Zs=fr[4]*yt+Zs,Cs=fr[5]*Qt+Cs,vc(Ir,Ln,Mn,cs,Zs,Cs));return it&&Bp(),f0(Ve),this},h.path=function(k){for(var ne=0;ne<k.length;ne++){var be=k[ne],_e=be.c;switch(be.op){case"m":h0(_e[0],_e[1]);break;case"l":LA(_e[0],_e[1]);break;case"c":vc.apply(this,_e);break;case"h":Bp()}}return this},h.__private__.rect=h.rect=function(k,ne,be,_e,Ve){if(isNaN(k)||isNaN(ne)||isNaN(be)||isNaN(_e)||!Xo(Ve))throw new Error("Invalid arguments passed to jsPDF.rect");return w===v.COMPAT&&(_e=-_e),te([j(D(k)),j(K(ne)),j(D(be)),j(D(_e)),"re"].join(" ")),f0(Ve),this},h.__private__.triangle=h.triangle=function(k,ne,be,_e,Ve,it,yt){if(isNaN(k)||isNaN(ne)||isNaN(be)||isNaN(_e)||isNaN(Ve)||isNaN(it)||!Xo(yt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[be-k,_e-ne],[Ve-be,it-_e],[k-Ve,ne-it]],k,ne,[1,1],yt,!0),this},h.__private__.roundedRect=h.roundedRect=function(k,ne,be,_e,Ve,it,yt){if(isNaN(k)||isNaN(ne)||isNaN(be)||isNaN(_e)||isNaN(Ve)||isNaN(it)||!Xo(yt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Qt=4/3*(Math.SQRT2-1);return Ve=Math.min(Ve,.5*be),it=Math.min(it,.5*_e),this.lines([[be-2*Ve,0],[Ve*Qt,0,Ve,it-it*Qt,Ve,it],[0,_e-2*it],[0,it*Qt,-Ve*Qt,it,-Ve,it],[2*Ve-be,0],[-Ve*Qt,0,-Ve,-it*Qt,-Ve,-it],[0,2*it-_e],[0,-it*Qt,Ve*Qt,-it,Ve,-it]],k+Ve,ne,[1,1],yt,!0),this},h.__private__.ellipse=h.ellipse=function(k,ne,be,_e,Ve){if(isNaN(k)||isNaN(ne)||isNaN(be)||isNaN(_e)||!Xo(Ve))throw new Error("Invalid arguments passed to jsPDF.ellipse");var it=4/3*(Math.SQRT2-1)*be,yt=4/3*(Math.SQRT2-1)*_e;return h0(k+be,ne),vc(k+be,ne-yt,k+it,ne-_e,k,ne-_e),vc(k-it,ne-_e,k-be,ne-yt,k-be,ne),vc(k-be,ne+yt,k-it,ne+_e,k,ne+_e),vc(k+it,ne+_e,k+be,ne+yt,k+be,ne),f0(Ve),this},h.__private__.circle=h.circle=function(k,ne,be,_e){if(isNaN(k)||isNaN(ne)||isNaN(be)||!Xo(_e))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(k,ne,be,be,_e)},h.setFont=function(k,ne,be){return be&&(ne=_(ne,be)),Be=bp(k,ne,{disableWarning:!1}),this};var f2=h.__private__.getFont=h.getFont=function(){return vt[bp.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var k,ne,be={};for(k in Vt)if(Vt.hasOwnProperty(k))for(ne in be[k]=[],Vt[k])Vt[k].hasOwnProperty(ne)&&be[k].push(ne);return be},h.addFont=function(k,ne,be,_e,Ve){var it=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&it.indexOf(arguments[3])!==-1?Ve=arguments[3]:arguments[3]&&it.indexOf(arguments[3])==-1&&(be=_(be,_e)),Ve=Ve||"Identity-H",er.call(this,k,ne,be,Ve)};var UA,m0=e.lineWidth||.200025,au=h.__private__.getLineWidth=h.getLineWidth=function(){return m0},Sp=h.__private__.setLineWidth=h.setLineWidth=function(k){return m0=k,te(j(D(k))+" w"),this};h.__private__.setLineDash=lr.API.setLineDash=lr.API.setLineDashPattern=function(k,ne){if(k=k||[],ne=ne||0,isNaN(ne)||!Array.isArray(k))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return k=k.map(function(be){return j(D(be))}).join(" "),ne=j(D(ne)),te("["+k+"] "+ne+" d"),this};var Fp=h.__private__.getLineHeight=h.getLineHeight=function(){return Ze*UA};h.__private__.getLineHeight=h.getLineHeight=function(){return Ze*UA};var Ep=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(k){return typeof(k=k||1.15)=="number"&&(UA=k),this},kp=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return UA};Ep(e.lineHeight);var Yo=h.__private__.getHorizontalCoordinate=function(k){return D(k)},kl=h.__private__.getVerticalCoordinate=function(k){return w===v.ADVANCED?k:Wt[O].mediaBox.topRightY-Wt[O].mediaBox.bottomLeftY-D(k)},h2=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(k){return j(Yo(k))},wc=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(k){return j(kl(k))},No=e.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return ge(No)},h.__private__.setStrokeColor=h.setDrawColor=function(k,ne,be,_e){return No=we({ch1:k,ch2:ne,ch3:be,ch4:_e,pdfColorType:"draw",precision:2}),te(No),this};var p0=e.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return ge(p0)},h.__private__.setFillColor=h.setFillColor=function(k,ne,be,_e){return p0=we({ch1:k,ch2:ne,ch3:be,ch4:_e,pdfColorType:"fill",precision:2}),te(p0),this};var DA=e.textColor||"0 g",m2=h.__private__.getTextColor=h.getTextColor=function(){return ge(DA)};h.__private__.setTextColor=h.setTextColor=function(k,ne,be,_e){return DA=we({ch1:k,ch2:ne,ch3:be,ch4:_e,pdfColorType:"text",precision:3}),this};var iu=e.charSpace,p2=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(iu||0)};h.__private__.setCharSpace=h.setCharSpace=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return iu=k,this};var x0=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(k){var ne=h.CapJoinStyles[k];if(ne===void 0)throw new Error("Line cap style of '"+k+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return x0=ne,te(ne+" J"),this};var g0=0;h.__private__.setLineJoin=h.setLineJoin=function(k){var ne=h.CapJoinStyles[k];if(ne===void 0)throw new Error("Line join style of '"+k+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return g0=ne,te(ne+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(k){if(k=k||0,isNaN(k))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return te(j(D(k))+" M"),this},h.GState=hy,h.setGState=function(k){(k=typeof k=="string"?ir[Gr[k]]:Tp(null,k)).equals(un)||(te("/"+k.id+" gs"),un=k)};var Tp=function(k,ne){if(!k||!Gr[k]){var be=!1;for(var _e in ir)if(ir.hasOwnProperty(_e)&&ir[_e].equals(ne)){be=!0;break}if(be)ne=ir[_e];else{var Ve="GS"+(Object.keys(ir).length+1).toString(10);ir[Ve]=ne,ne.id=Ve}return k&&(Gr[k]=ne.id),lt.publish("addGState",ne),ne}};h.addGState=function(k,ne){return Tp(k,ne),this},h.saveGraphicsState=function(){return te("q"),pr.push({key:Be,size:Ze,color:DA}),this},h.restoreGraphicsState=function(){te("Q");var k=pr.pop();return Be=k.key,Ze=k.size,DA=k.color,un=null,this},h.setCurrentTransformationMatrix=function(k){return te(k.toString()+" cm"),this},h.comment=function(k){return te("#"+k),this};var ou=function(k,ne){var be=k||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return be},set:function(it){isNaN(it)||(be=parseFloat(it))}});var _e=ne||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return _e},set:function(it){isNaN(it)||(_e=parseFloat(it))}});var Ve="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ve},set:function(it){Ve=it.toString()}}),this},y0=function(k,ne,be,_e){ou.call(this,k,ne),this.type="rect";var Ve=be||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ve},set:function(yt){isNaN(yt)||(Ve=parseFloat(yt))}});var it=_e||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return it},set:function(yt){isNaN(yt)||(it=parseFloat(yt))}}),this},v0=function(){this.page=Nr,this.currentPage=O,this.pages=Ae.slice(0),this.pagesContext=Wt.slice(0),this.x=Bt,this.y=tt,this.matrix=Ot,this.width=PA(O),this.height=bc(O),this.outputDestination=J,this.id="",this.objectNumber=-1};v0.prototype.restore=function(){Nr=this.page,O=this.currentPage,Wt=this.pagesContext,Ae=this.pages,Bt=this.x,tt=this.y,Ot=this.matrix,w0(O,this.width),b0(O,this.height),J=this.outputDestination};var _p=function(k,ne,be,_e,Ve){Oe.push(new v0),Nr=O=0,Ae=[],Bt=k,tt=ne,Ot=Ve,fn([be,_e])},x2=function(k){if(Ee[k])Oe.pop().restore();else{var ne=new v0,be="Xo"+(Object.keys(It).length+1).toString(10);ne.id=be,Ee[k]=be,It[be]=ne,lt.publish("addFormObject",ne),Oe.pop().restore()}};for(var lu in h.beginFormObject=function(k,ne,be,_e,Ve){return _p(k,ne,be,_e,Ve),this},h.endFormObject=function(k){return x2(k),this},h.doFormObject=function(k,ne){var be=It[Ee[k]];return te("q"),te(ne.toString()+" cm"),te("/"+be.id+" Do"),te("Q"),this},h.getFormObject=function(k){var ne=It[Ee[k]];return{x:ne.x,y:ne.y,width:ne.width,height:ne.height,matrix:ne.matrix}},h.save=function(k,ne){return k=k||"generated.pdf",(ne=ne||{}).returnPromise=ne.returnPromise||!1,ne.returnPromise===!1?(XA(ru(El()),k),typeof XA.unload=="function"&&cr.setTimeout&&setTimeout(XA.unload,911),this):new Promise(function(be,_e){try{var Ve=XA(ru(El()),k);typeof XA.unload=="function"&&cr.setTimeout&&setTimeout(XA.unload,911),be(Ve)}catch(it){_e(it.message)}})},lr.API)lr.API.hasOwnProperty(lu)&&(lu==="events"&&lr.API.events.length?function(k,ne){var be,_e,Ve;for(Ve=ne.length-1;Ve!==-1;Ve--)be=ne[Ve][0],_e=ne[Ve][1],k.subscribe.apply(k,[be].concat(typeof _e=="function"?[_e]:_e))}(lt,lr.API.events):h[lu]=lr.API[lu]);var PA=h.getPageWidth=function(k){return(Wt[k=k||O].mediaBox.topRightX-Wt[k].mediaBox.bottomLeftX)/Pe},w0=h.setPageWidth=function(k,ne){Wt[k].mediaBox.topRightX=ne*Pe+Wt[k].mediaBox.bottomLeftX},bc=h.getPageHeight=function(k){return(Wt[k=k||O].mediaBox.topRightY-Wt[k].mediaBox.bottomLeftY)/Pe},b0=h.setPageHeight=function(k,ne){Wt[k].mediaBox.topRightY=ne*Pe+Wt[k].mediaBox.bottomLeftY};return h.internal={pdfEscape:Tr,getStyle:jp,getFont:f2,getFontSize:ue,getCharSpace:p2,getTextColor:m2,getLineHeight:Fp,getLineHeightFactor:kp,getLineWidth:au,write:je,getHorizontalCoordinate:Yo,getVerticalCoordinate:kl,getCoordinateString:h2,getVerticalCoordinateString:wc,collections:{},newObject:qt,newAdditionalObject:pe,newObjectDeferred:Nt,newObjectDeferredBegin:se,getFilters:ze,putStream:rt,events:lt,scaleFactor:Pe,pageSize:{getWidth:function(){return PA(O)},setWidth:function(k){w0(O,k)},getHeight:function(){return bc(O)},setHeight:function(k){b0(O,k)}},encryptionOptions:d,encryption:Js,getEncryptor:o2,output:nu,getNumberOfPages:tu,pages:Ae,out:te,f2:M,f3:F,getPageInfo:Cp,getPageInfoByObjId:ur,getCurrentPageInfo:l2,getPDFVersion:m,Point:ou,Rectangle:y0,Matrix:Re,hasHotfix:Np},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return PA(O)},set:function(k){w0(O,k)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return bc(O)},set:function(k){b0(O,k)},enumerable:!0,configurable:!0}),Pt.call(h,He),Be="F1",Xs(s,r),lt.publish("initialized"),h}Mu.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},Mu.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Mu.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},Mu.prototype.processOwnerPassword=function(e,t){return U5(L5(t).substr(0,5),e)},Mu.prototype.encryptor=function(e,t){var r=L5(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return U5(r,n)}},hy.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||Ur(e)!==Ur(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},lr.API={events:[]},lr.version="2.5.2";var Vn=lr.API,kj=1,Jd=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Uu=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},hr=function(e){return e.toFixed(2)},Pc=function(e){return e.toFixed(5)};Vn.__acroform__={};var ai=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},Rk=function(e){return e*kj},il=function(e){var t=new rO,r=zt.internal.getHeight(e)||0,n=zt.internal.getWidth(e)||0;return t.BBox=[0,0,Number(hr(n)),Number(hr(r))],t},qge=Vn.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},Kge=Vn.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},zge=Vn.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},rs=Vn.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return zge(e,t-1)},ns=Vn.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return qge(e,t-1)},ss=Vn.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Kge(e,t-1)},Gge=Vn.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,s=e[0],i=e[1],o=e[2],l=e[3],c={};return c.lowerLeft_X=r(s)||0,c.lowerLeft_Y=n(i+l)||0,c.upperRight_X=r(s+o)||0,c.upperRight_Y=n(i)||0,[Number(hr(c.lowerLeft_X)),Number(hr(c.lowerLeft_Y)),Number(hr(c.upperRight_X)),Number(hr(c.upperRight_Y))]},Wge=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=D5(e,r),s=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+s+" "+hr(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=il(e);return i.scope=e.scope,i.stream=t.join(`
`),i}},D5=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},s=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");s=e.multiline?s.map(function(F){return F.split(`
`)}):s.map(function(F){return[F]});var i=r,o=zt.internal.getHeight(e)||0;o=o<0?-o:o;var l=zt.internal.getWidth(e)||0;l=l<0?-l:l;var c=function(F,D,G){if(F+1<s.length){var K=D+" "+s[F+1][0];return pg(K,e,G).width<=l-4}return!1};i++;e:for(;i>0;){t="",i--;var A,d,u=pg("3",e,i).height,f=e.multiline?o-i:(o-u)/2,h=f+=2,x=0,m=0,g=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+pg(t,e,i=12).width+", FieldWidth:"+l+`
`;break}for(var p="",v=0,w=0;w<s.length;w++)if(s.hasOwnProperty(w)){var B=!1;if(s[w].length!==1&&g!==s[w].length-1){if((u+2)*(v+2)+2>o)continue e;p+=s[w][g],B=!0,m=w,w--}else{p=(p+=s[w][g]+" ").substr(p.length-1)==" "?p.substr(0,p.length-1):p;var T=parseInt(w),_=c(T,p,i),j=w>=s.length-1;if(_&&!j){p+=" ",g=0;continue}if(_||j){if(j)m=T;else if(e.multiline&&(u+2)*(v+2)+2>o)continue e}else{if(!e.multiline||(u+2)*(v+2)+2>o)continue e;m=T}}for(var E="",L=x;L<=m;L++){var M=s[L];if(e.multiline){if(L===m){E+=M[g]+" ",g=(g+1)%M.length;continue}if(L===x){E+=M[M.length-1]+" ";continue}}E+=M[0]+" "}switch(E=E.substr(E.length-1)==" "?E.substr(0,E.length-1):E,d=pg(E,e,i).width,e.textAlign){case"right":A=l-d-2;break;case"center":A=(l-d)/2;break;case"left":default:A=2}t+=hr(A)+" "+hr(h)+` Td
`,t+="("+Jd(E)+`) Tj
`,t+=-hr(A)+` 0 Td
`,h=-(i+2),d=0,x=B?m:m+1,v++,p=""}break}return n.text=t,n.fontSize=i,n},pg=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),s=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:s}},Xge={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Yge=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},Jge=function(e,t){for(var r in e)if(e.hasOwnProperty(r)){var n=r,s=e[r];t.internal.newObjectDeferredBegin(s.objId,!0),Ur(s)==="object"&&typeof s.putStream=="function"&&s.putStream(),delete e[n]}},Zge=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(Go.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(Xge)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");kj=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new nO,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var i=n[s];i.objId=void 0,i.hasAnnotation&&Yge(i,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,s){var i=!n;for(var o in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],A=l.Rect;if(l.Rect&&(l.Rect=Gge(l.Rect,s)),s.internal.newObjectDeferredBegin(l.objId,!0),l.DA=zt.createDefaultAppearanceStream(l),Ur(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=A,l.hasAppearanceStream&&!l.appearanceStreamContent){var d=Wge(l);c.push({key:"AP",value:"<</N "+d+">>"}),s.internal.acroformPlugin.xForms.push(d)}if(l.appearanceStreamContent){var u="";for(var f in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(f)){var h=l.appearanceStreamContent[f];if(u+="/"+f+" ",u+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var o in h)if(h.hasOwnProperty(o)){var x=h[o];typeof x=="function"&&(x=x.call(s,l)),u+="/"+o+" "+x+" ",s.internal.acroformPlugin.xForms.indexOf(x)>=0||s.internal.acroformPlugin.xForms.push(x)}}else typeof(x=h)=="function"&&(x=x.call(s,l)),u+="/"+o+" "+x,s.internal.acroformPlugin.xForms.indexOf(x)>=0||s.internal.acroformPlugin.xForms.push(x);u+=">>"}c.push({key:"AP",value:`<<
`+u+">>"})}s.internal.putStream({additionalKeyValues:c,objectId:l.objId}),s.internal.out("endobj")}i&&Jge(s.internal.acroformPlugin.xForms,s)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},tO=Vn.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(o){return o};if(Array.isArray(e)){for(var s="[",i=0;i<e.length;i++)switch(i!==0&&(s+=" "),Ur(e[i])){case"boolean":case"number":case"object":s+=e[i].toString();break;case"string":e[i].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),s+="("+Jd(n(e[i].toString()))+")"):s+=e[i].toString()}return s+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},xb=function(e,t,r){var n=function(s){return s};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),e="("+Jd(n(e))+")"},ml=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ml.prototype.toString=function(){return this.objId+" 0 R"},ml.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},ml.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],s=this[n];s&&(Array.isArray(s)?e.push({key:n,value:tO(s,this.objId,this.scope)}):s instanceof ml?(s.scope=this.scope,e.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&e.push({key:n,value:s}))}return e};var rO=function(){ml.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};ai(rO,ml);var nO=function(){ml.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Jd(r(e))+")"}},set:function(r){e=r}})};ai(nO,ml);var Go=function e(){ml.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(p){if(isNaN(p))throw new Error('Invalid value "'+p+'" for attribute F supplied.');t=p}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!rs(t,3)},set:function(p){p?this.F=ns(t,3):this.F=ss(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(p){if(isNaN(p))throw new Error('Invalid value "'+p+'" for attribute Ff supplied.');r=p}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(p){n=p!==void 0?p:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(p){n[0]=p}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(p){n[1]=p}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(p){n[2]=p}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(p){n[3]=p}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(p){switch(p){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=p;break;default:throw new Error('Invalid value "'+p+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof my)return;i="FieldObject"+e.FieldNum++}var p=function(v){return v};return this.scope&&(p=this.scope.internal.getEncryptor(this.objId)),"("+Jd(p(i))+")"},set:function(p){i=p.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(p){i=p}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(p){o=p}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(p){l=p}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(p){c=p}});var A=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return A===void 0?50/kj:A},set:function(p){A=p}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(p){d=p}});var u="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!u||this instanceof my||this instanceof vd))return xb(u,this.objId,this.scope)},set:function(p){p=p.toString(),u=p}});var f=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof Ts?f:xb(f,this.objId,this.scope)},set:function(p){p=p.toString(),f=this instanceof Ts?p:p.substr(0,1)==="("?Uu(p.substr(1,p.length-2)):Uu(p)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Ts?Uu(f.substr(1,f.length-1)):f},set:function(p){p=p.toString(),f=this instanceof Ts?"/"+p:p}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(p){this.V=p}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Ts?h:xb(h,this.objId,this.scope)},set:function(p){p=p.toString(),h=this instanceof Ts?p:p.substr(0,1)==="("?Uu(p.substr(1,p.length-2)):Uu(p)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Ts?Uu(h.substr(1,h.length-1)):h},set:function(p){p=p.toString(),h=this instanceof Ts?"/"+p:p}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var x,m=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return m},set:function(p){p=!!p,m=p}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(x)return x},set:function(p){x=p}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,1)},set:function(p){p?this.Ff=ns(this.Ff,1):this.Ff=ss(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,2)},set:function(p){p?this.Ff=ns(this.Ff,2):this.Ff=ss(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,3)},set:function(p){p?this.Ff=ns(this.Ff,3):this.Ff=ss(this.Ff,3)}});var g=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(g!==null)return g},set:function(p){if([0,1,2].indexOf(p)===-1)throw new Error('Invalid value "'+p+'" for attribute Q supplied.');g=p}}),Object.defineProperty(this,"textAlign",{get:function(){var p;switch(g){case 0:default:p="left";break;case 1:p="center";break;case 2:p="right"}return p},configurable:!0,enumerable:!0,set:function(p){switch(p){case"right":case 2:g=2;break;case"center":case 1:g=1;break;case"left":case 0:default:g=0}}})};ai(Go,ml);var vf=function(){Go.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return tO(t,this.objId,this.scope)},set:function(r){var n,s;s=[],typeof(n=r)=="string"&&(s=function(i,o,l){l||(l=1);for(var c,A=[];c=o.exec(i);)A.push(c[l]);return A}(n,/\((.*?)\)/g)),t=s}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,18)},set:function(r){r?this.Ff=ns(this.Ff,18):this.Ff=ss(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=ns(this.Ff,19):this.Ff=ss(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,20)},set:function(r){r?(this.Ff=ns(this.Ff,20),t.sort()):this.Ff=ss(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,22)},set:function(r){r?this.Ff=ns(this.Ff,22):this.Ff=ss(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,23)},set:function(r){r?this.Ff=ns(this.Ff,23):this.Ff=ss(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,27)},set:function(r){r?this.Ff=ns(this.Ff,27):this.Ff=ss(this.Ff,27)}}),this.hasAppearanceStream=!1};ai(vf,Go);var wf=function(){vf.call(this),this.fontName="helvetica",this.combo=!1};ai(wf,vf);var bf=function(){wf.call(this),this.combo=!0};ai(bf,wf);var Xg=function(){bf.call(this),this.edit=!0};ai(Xg,bf);var Ts=function(){Go.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,15)},set:function(r){r?this.Ff=ns(this.Ff,15):this.Ff=ss(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,16)},set:function(r){r?this.Ff=ns(this.Ff,16):this.Ff=ss(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,17)},set:function(r){r?this.Ff=ns(this.Ff,17):this.Ff=ss(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,26)},set:function(r){r?this.Ff=ns(this.Ff,26):this.Ff=ss(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,s=[];for(n in s.push("<<"),t)s.push("/"+n+" ("+Jd(r(t[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(r){Ur(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};ai(Ts,Go);var Yg=function(){Ts.call(this),this.pushButton=!0};ai(Yg,Ts);var Nf=function(){Ts.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};ai(Nf,Ts);var my=function(){var e,t;Go.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(s){e=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(s){t=s}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(l){return l};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var i,o=[];for(i in o.push("<<"),n)o.push("/"+i+" ("+Jd(s(n[i]))+")");return o.push(">>"),o.join(`
`)},set:function(s){Ur(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(s){r="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=zt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ai(my,Go),Nf.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},Nf.prototype.createOption=function(e){var t=new my;return t.Parent=this,t.optionName=e,this.Kids.push(t),e1e.call(this.scope,t),t};var Jg=function(){Ts.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=zt.CheckBox.createAppearanceStream()};ai(Jg,Ts);var vd=function(){Go.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,13)},set:function(t){t?this.Ff=ns(this.Ff,13):this.Ff=ss(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,21)},set:function(t){t?this.Ff=ns(this.Ff,21):this.Ff=ss(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,23)},set:function(t){t?this.Ff=ns(this.Ff,23):this.Ff=ss(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,24)},set:function(t){t?this.Ff=ns(this.Ff,24):this.Ff=ss(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,25)},set:function(t){t?this.Ff=ns(this.Ff,25):this.Ff=ss(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,26)},set:function(t){t?this.Ff=ns(this.Ff,26):this.Ff=ss(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ai(vd,Go);var Zg=function(){vd.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,14)},set:function(e){e?this.Ff=ns(this.Ff,14):this.Ff=ss(this.Ff,14)}}),this.password=!0};ai(Zg,vd);var zt={CheckBox:{createAppearanceStream:function(){return{N:{On:zt.CheckBox.YesNormal},D:{On:zt.CheckBox.YesPushDown,Off:zt.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=il(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,s=e.scope.__private__.encodeColorString(e.color),i=D5(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+hr(zt.internal.getWidth(e))+" "+hr(zt.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+hr(i.fontSize)+" Tf "+s),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=il(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),s=[],i=zt.internal.getHeight(e),o=zt.internal.getWidth(e),l=D5(e,e.caption);return s.push("1 g"),s.push("0 0 "+hr(o)+" "+hr(i)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+hr(o-1)+" "+hr(i-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+r+" "+hr(l.fontSize)+" Tf "+n),s.push(l.text),s.push("ET"),s.push("Q"),t.stream=s.join(`
`),t},OffPushDown:function(e){var t=il(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+hr(zt.internal.getWidth(e))+" "+hr(zt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:zt.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=zt.RadioButton.Circle.YesNormal,t.D[e]=zt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=il(e);t.scope=e.scope;var r=[],n=zt.internal.getWidth(e)<=zt.internal.getHeight(e)?zt.internal.getWidth(e)/4:zt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=zt.internal.Bezier_C,i=Number((n*s).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Pc(zt.internal.getWidth(e)/2)+" "+Pc(zt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=il(e);t.scope=e.scope;var r=[],n=zt.internal.getWidth(e)<=zt.internal.getHeight(e)?zt.internal.getWidth(e)/4:zt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),i=Number((s*zt.internal.Bezier_C).toFixed(5)),o=Number((n*zt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Pc(zt.internal.getWidth(e)/2)+" "+Pc(zt.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),r.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),r.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),r.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Pc(zt.internal.getWidth(e)/2)+" "+Pc(zt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=il(e);t.scope=e.scope;var r=[],n=zt.internal.getWidth(e)<=zt.internal.getHeight(e)?zt.internal.getWidth(e)/4:zt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),i=Number((s*zt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Pc(zt.internal.getWidth(e)/2)+" "+Pc(zt.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),r.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),r.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),r.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:zt.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=zt.RadioButton.Cross.YesNormal,t.D[e]=zt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=il(e);t.scope=e.scope;var r=[],n=zt.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+hr(zt.internal.getWidth(e)-2)+" "+hr(zt.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(hr(n.x1.x)+" "+hr(n.x1.y)+" m"),r.push(hr(n.x2.x)+" "+hr(n.x2.y)+" l"),r.push(hr(n.x4.x)+" "+hr(n.x4.y)+" m"),r.push(hr(n.x3.x)+" "+hr(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=il(e);t.scope=e.scope;var r=zt.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+hr(zt.internal.getWidth(e))+" "+hr(zt.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+hr(zt.internal.getWidth(e)-2)+" "+hr(zt.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(hr(r.x1.x)+" "+hr(r.x1.y)+" m"),n.push(hr(r.x2.x)+" "+hr(r.x2.y)+" l"),n.push(hr(r.x4.x)+" "+hr(r.x4.y)+" m"),n.push(hr(r.x3.x)+" "+hr(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=il(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+hr(zt.internal.getWidth(e))+" "+hr(zt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};zt.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=zt.internal.getWidth(e),r=zt.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},zt.internal.getWidth=function(e){var t=0;return Ur(e)==="object"&&(t=Rk(e.Rect[2])),t},zt.internal.getHeight=function(e){var t=0;return Ur(e)==="object"&&(t=Rk(e.Rect[3])),t};var e1e=Vn.addField=function(e){if(Zge(this,e),!(e instanceof Go))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Vn.AcroFormChoiceField=vf,Vn.AcroFormListBox=wf,Vn.AcroFormComboBox=bf,Vn.AcroFormEditBox=Xg,Vn.AcroFormButton=Ts,Vn.AcroFormPushButton=Yg,Vn.AcroFormRadioButton=Nf,Vn.AcroFormCheckBox=Jg,Vn.AcroFormTextField=vd,Vn.AcroFormPasswordField=Zg,Vn.AcroFormAppearance=zt,Vn.AcroForm={ChoiceField:vf,ListBox:wf,ComboBox:bf,EditBox:Xg,Button:Ts,PushButton:Yg,RadioButton:Nf,CheckBox:Jg,TextField:vd,PasswordField:Zg,Appearance:zt},lr.AcroForm={ChoiceField:vf,ListBox:wf,ComboBox:bf,EditBox:Xg,Button:Ts,PushButton:Yg,RadioButton:Nf,CheckBox:Jg,TextField:vd,PasswordField:Zg,Appearance:zt};function sO(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){e.__addimage__={};var t="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=e.__addimage__.getImageFileTypeByImageData=function(F,D){var G,K,ae,Z,oe,Y=t;if((D=D||t)==="RGBA"||F.data!==void 0&&F.data instanceof Uint8ClampedArray&&"height"in F&&"width"in F)return"RGBA";if(_(F))for(oe in r)for(ae=r[oe],G=0;G<ae.length;G+=1){for(Z=!0,K=0;K<ae[G].length;K+=1)if(ae[G][K]!==void 0&&ae[G][K]!==F[K]){Z=!1;break}if(Z===!0){Y=oe;break}}else for(oe in r)for(ae=r[oe],G=0;G<ae.length;G+=1){for(Z=!0,K=0;K<ae[G].length;K+=1)if(ae[G][K]!==void 0&&ae[G][K]!==F.charCodeAt(K)){Z=!1;break}if(Z===!0){Y=oe;break}}return Y===t&&D!==t&&(Y=D),Y},s=function F(D){for(var G=this.internal.write,K=this.internal.putStream,ae=(0,this.internal.getFilters)();ae.indexOf("FlateEncode")!==-1;)ae.splice(ae.indexOf("FlateEncode"),1);D.objectId=this.internal.newObject();var Z=[];if(Z.push({key:"Type",value:"/XObject"}),Z.push({key:"Subtype",value:"/Image"}),Z.push({key:"Width",value:D.width}),Z.push({key:"Height",value:D.height}),D.colorSpace===g.INDEXED?Z.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(D.palette.length/3-1)+" "+("sMask"in D&&D.sMask!==void 0?D.objectId+2:D.objectId+1)+" 0 R]"}):(Z.push({key:"ColorSpace",value:"/"+D.colorSpace}),D.colorSpace===g.DEVICE_CMYK&&Z.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Z.push({key:"BitsPerComponent",value:D.bitsPerComponent}),"decodeParameters"in D&&D.decodeParameters!==void 0&&Z.push({key:"DecodeParms",value:"<<"+D.decodeParameters+">>"}),"transparency"in D&&Array.isArray(D.transparency)){for(var oe="",Y=0,R=D.transparency.length;Y<R;Y++)oe+=D.transparency[Y]+" "+D.transparency[Y]+" ";Z.push({key:"Mask",value:"["+oe+"]"})}D.sMask!==void 0&&Z.push({key:"SMask",value:D.objectId+1+" 0 R"});var z=D.filter!==void 0?["/"+D.filter]:void 0;if(K({data:D.data,additionalKeyValues:Z,alreadyAppliedFilters:z,objectId:D.objectId}),G("endobj"),"sMask"in D&&D.sMask!==void 0){var ee="/Predictor "+D.predictor+" /Colors 1 /BitsPerComponent "+D.bitsPerComponent+" /Columns "+D.width,b={width:D.width,height:D.height,colorSpace:"DeviceGray",bitsPerComponent:D.bitsPerComponent,decodeParameters:ee,data:D.sMask};"filter"in D&&(b.filter=D.filter),F.call(this,b)}if(D.colorSpace===g.INDEXED){var O=this.internal.newObject();K({data:E(new Uint8Array(D.palette)),objectId:O}),G("endobj")}},i=function(){var F=this.internal.collections.addImage_images;for(var D in F)s.call(this,F[D])},o=function(){var F,D=this.internal.collections.addImage_images,G=this.internal.write;for(var K in D)G("/I"+(F=D[K]).index,F.objectId,"0","R")},l=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var F=this.internal.collections.addImage_images;return l.call(this),F},A=function(){return Object.keys(this.internal.collections.addImage_images).length},d=function(F){return typeof e["process"+F.toUpperCase()]=="function"},u=function(F){return Ur(F)==="object"&&F.nodeType===1},f=function(F,D){if(F.nodeName==="IMG"&&F.hasAttribute("src")){var G=""+F.getAttribute("src");if(G.indexOf("data:image/")===0)return Gh(unescape(G).split("base64,").pop());var K=e.loadFile(G,!0);if(K!==void 0)return K}if(F.nodeName==="CANVAS"){if(F.width===0||F.height===0)throw new Error("Given canvas must have data. Canvas width: "+F.width+", height: "+F.height);var ae;switch(D){case"PNG":ae="image/png";break;case"WEBP":ae="image/webp";break;case"JPEG":case"JPG":default:ae="image/jpeg"}return Gh(F.toDataURL(ae,1).split("base64,").pop())}},h=function(F){var D=this.internal.collections.addImage_images;if(D){for(var G in D)if(F===D[G].alias)return D[G]}},x=function(F,D,G){return F||D||(F=-96,D=-96),F<0&&(F=-1*G.width*72/F/this.internal.scaleFactor),D<0&&(D=-1*G.height*72/D/this.internal.scaleFactor),F===0&&(F=D*G.width/G.height),D===0&&(D=F*G.height/G.width),[F,D]},m=function(F,D,G,K,ae,Z){var oe=x.call(this,G,K,ae),Y=this.internal.getCoordinateString,R=this.internal.getVerticalCoordinateString,z=c.call(this);if(G=oe[0],K=oe[1],z[ae.index]=ae,Z){Z*=Math.PI/180;var ee=Math.cos(Z),b=Math.sin(Z),O=function(I){return I.toFixed(4)},S=[O(ee),O(b),O(-1*b),O(ee),0,0,"cm"]}this.internal.write("q"),Z?(this.internal.write([1,"0","0",1,Y(F),R(D+K),"cm"].join(" ")),this.internal.write(S.join(" ")),this.internal.write([Y(G),"0","0",Y(K),"0","0","cm"].join(" "))):this.internal.write([Y(G),"0","0",Y(K),Y(F),R(D+K),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ae.index+" Do"),this.internal.write("Q")},g=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var p=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},v=e.__addimage__.sHashCode=function(F){var D,G,K=0;if(typeof F=="string")for(G=F.length,D=0;D<G;D++)K=(K<<5)-K+F.charCodeAt(D),K|=0;else if(_(F))for(G=F.byteLength/2,D=0;D<G;D++)K=(K<<5)-K+F[D],K|=0;return K},w=e.__addimage__.validateStringAsBase64=function(F){(F=F||"").toString().trim();var D=!0;return F.length===0&&(D=!1),F.length%4!=0&&(D=!1),/^[A-Za-z0-9+/]+$/.test(F.substr(0,F.length-2))===!1&&(D=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(F.substr(-2))===!1&&(D=!1),D},B=e.__addimage__.extractImageFromDataUrl=function(F){var D=(F=F||"").split("base64,"),G=null;if(D.length===2){var K=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(D[0]);Array.isArray(K)&&(G={mimeType:K[1],charset:K[2],data:D[1]})}return G},T=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(F){return T()&&F instanceof ArrayBuffer};var _=e.__addimage__.isArrayBufferView=function(F){return T()&&typeof Uint32Array<"u"&&(F instanceof Int8Array||F instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&F instanceof Uint8ClampedArray||F instanceof Int16Array||F instanceof Uint16Array||F instanceof Int32Array||F instanceof Uint32Array||F instanceof Float32Array||F instanceof Float64Array)},j=e.__addimage__.binaryStringToUint8Array=function(F){for(var D=F.length,G=new Uint8Array(D),K=0;K<D;K++)G[K]=F.charCodeAt(K);return G},E=e.__addimage__.arrayBufferToBinaryString=function(F){for(var D="",G=_(F)?F:new Uint8Array(F),K=0;K<G.length;K+=8192)D+=String.fromCharCode.apply(null,G.subarray(K,K+8192));return D};e.addImage=function(){var F,D,G,K,ae,Z,oe,Y,R;if(typeof arguments[1]=="number"?(D=t,G=arguments[1],K=arguments[2],ae=arguments[3],Z=arguments[4],oe=arguments[5],Y=arguments[6],R=arguments[7]):(D=arguments[1],G=arguments[2],K=arguments[3],ae=arguments[4],Z=arguments[5],oe=arguments[6],Y=arguments[7],R=arguments[8]),Ur(F=arguments[0])==="object"&&!u(F)&&"imageData"in F){var z=F;F=z.imageData,D=z.format||D||t,G=z.x||G||0,K=z.y||K||0,ae=z.w||z.width||ae,Z=z.h||z.height||Z,oe=z.alias||oe,Y=z.compression||Y,R=z.rotation||z.angle||R}var ee=this.internal.getFilters();if(Y===void 0&&ee.indexOf("FlateEncode")!==-1&&(Y="SLOW"),isNaN(G)||isNaN(K))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var b=L.call(this,F,D,oe,Y);return m.call(this,G,K,ae,Z,b,R),this};var L=function(F,D,G,K){var ae,Z,oe;if(typeof F=="string"&&n(F)===t){F=unescape(F);var Y=M(F,!1);(Y!==""||(Y=e.loadFile(F,!0))!==void 0)&&(F=Y)}if(u(F)&&(F=f(F,D)),D=n(F,D),!d(D))throw new Error("addImage does not support files of type '"+D+"', please ensure that a plugin for '"+D+"' support is added.");if(((oe=G)==null||oe.length===0)&&(G=function(R){return typeof R=="string"||_(R)?v(R):_(R.data)?v(R.data):null}(F)),(ae=h.call(this,G))||(T()&&(F instanceof Uint8Array||D==="RGBA"||(Z=F,F=j(F))),ae=this["process"+D.toUpperCase()](F,A.call(this),G,function(R){return R&&typeof R=="string"&&(R=R.toUpperCase()),R in e.image_compression?R:p.NONE}(K),Z)),!ae)throw new Error("An unknown error occurred whilst processing the image.");return ae},M=e.__addimage__.convertBase64ToBinaryString=function(F,D){var G;D=typeof D!="boolean"||D;var K,ae="";if(typeof F=="string"){K=(G=B(F))!==null?G.data:F;try{ae=Gh(K)}catch(Z){if(D)throw w(K)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Z.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return ae};e.getImageProperties=function(F){var D,G,K="";if(u(F)&&(F=f(F)),typeof F=="string"&&n(F)===t&&((K=M(F,!1))===""&&(K=e.loadFile(F)||""),F=K),G=n(F),!d(G))throw new Error("addImage does not support files of type '"+G+"', please ensure that a plugin for '"+G+"' support is added.");if(!T()||F instanceof Uint8Array||(F=j(F)),!(D=this["process"+G.toUpperCase()](F)))throw new Error("An unknown error occurred whilst processing the image");return D.fileType=G,D}})(lr.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};lr.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,s,i,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),A=r.pageContext.annotations,d=!1,u=0;u<A.length&&!d;u++)switch((n=A[u]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var f=0;f<A.length;f++){n=A[f];var h=this.internal.pdfEscape,x=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var m=this.internal.newAdditionalObject(),g=this.internal.newAdditionalObject(),p=this.internal.getEncryptor(m.objId),v=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(s="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+h(p(n.contents))+")",i+=" /Popup "+g.objId+" 0 R",i+=" /P "+c.objId+" 0 R",i+=" /T ("+h(p(v))+") >>",m.content=i;var w=m.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+w,n.open&&(i+=" /Open true"),i+=" >>",g.content=i,this.internal.write(m.objId,"0 R",g.objId,"0 R");break;case"freetext":s="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var B=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+h(x(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+B+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var T=this.annotations._nameMap[n.options.name];n.options.pageNumber=T.page,n.options.top=T.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+h(x(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var _=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+_+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,s,i,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,A=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:A(n),w:c(r+s),h:A(n+i)},options:o,type:"link"})},e.textWithLink=function(r,n,s,i){var o,l,c=this.getTextWidth(r),A=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){l=i.maxWidth;var d=this.splitTextToSize(r,l).length;o=Math.ceil(A*d)}else l=c,o=A;return this.text(r,n,s,i),s+=.2*A,i.align==="center"&&(n-=c/2),i.align==="right"&&(n-=c),this.link(n,s-A,l,o,i),c},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(lr.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(m){return t[m.charCodeAt(0)]!==void 0},o=e.__arabicParser__.isArabicLetter=function(m){return typeof m=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(m)},l=e.__arabicParser__.isArabicEndLetter=function(m){return o(m)&&i(m)&&t[m.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(m){return o(m)&&s.indexOf(m.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(m){return o(m)&&i(m)&&t[m.charCodeAt(0)].length>=1};var A=e.__arabicParser__.arabicLetterHasFinalForm=function(m){return o(m)&&i(m)&&t[m.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(m){return o(m)&&i(m)&&t[m.charCodeAt(0)].length>=3};var d=e.__arabicParser__.arabicLetterHasMedialForm=function(m){return o(m)&&i(m)&&t[m.charCodeAt(0)].length==4},u=e.__arabicParser__.resolveLigatures=function(m){var g=0,p=r,v="",w=0;for(g=0;g<m.length;g+=1)p[m.charCodeAt(g)]!==void 0?(w++,typeof(p=p[m.charCodeAt(g)])=="number"&&(v+=String.fromCharCode(p),p=r,w=0),g===m.length-1&&(p=r,v+=m.charAt(g-(w-1)),g-=w-1,w=0)):(p=r,v+=m.charAt(g-w),g-=w,w=0);return v};e.__arabicParser__.isArabicDiacritic=function(m){return m!==void 0&&n[m.charCodeAt(0)]!==void 0};var f=e.__arabicParser__.getCorrectForm=function(m,g,p){return o(m)?i(m)===!1?-1:!A(m)||!o(g)&&!o(p)||!o(p)&&l(g)||l(m)&&!o(g)||l(m)&&c(g)||l(m)&&l(g)?0:d(m)&&o(g)&&!l(g)&&o(p)&&A(p)?3:l(m)||!o(p)?1:2:-1},h=function(m){var g=0,p=0,v=0,w="",B="",T="",_=(m=m||"").split("\\s+"),j=[];for(g=0;g<_.length;g+=1){for(j.push(""),p=0;p<_[g].length;p+=1)w=_[g][p],B=_[g][p-1],T=_[g][p+1],o(w)?(v=f(w,B,T),j[g]+=v!==-1?String.fromCharCode(t[w.charCodeAt(0)][v]):w):j[g]+=w;j[g]=u(j[g])}return j.join(" ")},x=e.__arabicParser__.processArabic=e.processArabic=function(){var m,g=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,p=[];if(Array.isArray(g)){var v=0;for(p=[],v=0;v<g.length;v+=1)Array.isArray(g[v])?p.push([h(g[v][0]),g[v][1],g[v][2]]):p.push([h(g[v])]);m=p}else m=h(g);return typeof arguments[0]=="string"?m:(arguments[0].text=m,arguments[0])};e.events.push(["preProcessText",x])}(lr.API),lr.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(l){s=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(l){i=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var s;if((r=r||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(lr.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(m){c=m}});var A=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return A},set:function(m){A=m}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(m){d=m}});var u=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return u},set:function(m){u=m}});var f=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return f},set:function(m){f=m}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(m){h=m}});var x=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return x},set:function(m){x=m}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,A){n.call(this);var d=(A=A||{}).fontSize||this.getFontSize(),u=A.font||this.getFont(),f=A.scaleFactor||this.internal.scaleFactor,h=0,x=0,m=0,g=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var p=A.maxWidth;p>0?typeof c=="string"?c=this.splitTextToSize(c,p):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(w,B){return w.concat(g.splitTextToSize(B,p))},[])):c=Array.isArray(c)?c:[c];for(var v=0;v<c.length;v++)h<(m=this.getStringUnitWidth(c[v],{font:u})*d)&&(h=m);return h!==0&&(x=c.length),{w:h/=f,h:Math.max((x*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/f,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var c;c=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var A=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,u=this.internal.__cell__.margins||t,f=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return A.lineNumber!==void 0&&(A.lineNumber===c.lineNumber?(c.x=(A.x||0)+(A.width||0),c.y=A.y||0):A.y+A.height+c.height+u.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=u.top,h&&f&&(this.printHeaderRow(c.lineNumber,!0),c.y+=f[0].height)):c.y=A.y+A.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};e.table=function(c,A,d,u,f){if(n.call(this),!d)throw new Error("No data for PDF table.");var h,x,m,g,p=[],v=[],w=[],B={},T={},_=[],j=[],E=(f=f||{}).autoSize||!1,L=f.printHeaders!==!1,M=f.css&&f.css["font-size"]!==void 0?16*f.css["font-size"]:f.fontSize||12,F=f.margins||Object.assign({width:this.getPageWidth()},t),D=typeof f.padding=="number"?f.padding:3,G=f.headerBackgroundColor||"#c8c8c8",K=f.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=L,this.internal.__cell__.margins=F,this.internal.__cell__.table_font_size=M,this.internal.__cell__.padding=D,this.internal.__cell__.headerBackgroundColor=G,this.internal.__cell__.headerTextColor=K,this.setFontSize(M),u==null)v=p=Object.keys(d[0]),w=p.map(function(){return"left"});else if(Array.isArray(u)&&Ur(u[0])==="object")for(p=u.map(function(z){return z.name}),v=u.map(function(z){return z.prompt||z.name||""}),w=u.map(function(z){return z.align||"left"}),h=0;h<u.length;h+=1)T[u[h].name]=u[h].width*(19.049976/25.4);else Array.isArray(u)&&typeof u[0]=="string"&&(v=p=u,w=p.map(function(){return"left"}));if(E||Array.isArray(u)&&typeof u[0]=="string")for(h=0;h<p.length;h+=1){for(B[g=p[h]]=d.map(function(z){return z[g]}),this.setFont(void 0,"bold"),_.push(this.getTextDimensions(v[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),x=B[g],this.setFont(void 0,"normal"),m=0;m<x.length;m+=1)_.push(this.getTextDimensions(x[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);T[g]=Math.max.apply(null,_)+D+D,_=[]}if(L){var ae={};for(h=0;h<p.length;h+=1)ae[p[h]]={},ae[p[h]].text=v[h],ae[p[h]].align=w[h];var Z=l.call(this,ae,T);j=p.map(function(z){return new i(c,A,T[z],Z,ae[z].text,void 0,ae[z].align)}),this.setTableHeaderRow(j),this.printHeaderRow(1,!1)}var oe=u.reduce(function(z,ee){return z[ee.name]=ee.align,z},{});for(h=0;h<d.length;h+=1){"rowStart"in f&&f.rowStart instanceof Function&&f.rowStart({row:h,data:d[h]},this);var Y=l.call(this,d[h],T);for(m=0;m<p.length;m+=1){var R=d[h][p[m]];"cellStart"in f&&f.cellStart instanceof Function&&f.cellStart({row:h,col:m,data:R},this),o.call(this,new i(c,A,T[p[m]],Y,R,h+2,oe[p[m]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=A,this};var l=function(c,A){var d=this.internal.__cell__.padding,u=this.internal.__cell__.table_font_size,f=this.internal.scaleFactor;return Object.keys(c).map(function(h){var x=c[h];return this.splitTextToSize(x.hasOwnProperty("text")?x.text:x,A[h]-d-d)},this).map(function(h){return this.getLineHeightFactor()*h.length*u/f+d+d},this).reduce(function(h,x){return Math.max(h,x)},0)};e.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,A){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var u=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(u[0],u[1],u[2],u[3],void 0,-1)}this.setFont(void 0,"bold");for(var f=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){d=this.internal.__cell__.tableHeaderRow[h].clone(),A&&(d.y=this.internal.__cell__.margins.top||0,f.push(d)),d.lineNumber=c;var x=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,d),this.setTextColor(x)}f.length>0&&this.setTableHeaderRow(f),this.setFont(void 0,"normal"),r=!1}}(lr.API);var aO={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},iO=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],P5=sO(iO),oO=[100,200,300,400,500,600,700,800,900],t1e=sO(oO);function O5(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(i){return aO[i=i||"normal"]?i:"normal"}(e.style),n=function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}}(e.weight),s=function(i){return typeof P5[i=i||"normal"]=="number"?i:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:s,src:e.src||[],ref:e.ref||{name:t,style:[s,r,n].join(" ")}}}function Qk(e,t,r,n){var s;for(s=r;s>=0&&s<t.length;s+=n)if(e[t[s]])return e[t[s]];for(s=r;s>=0&&s<t.length;s-=n)if(e[t[s]])return e[t[s]]}var r1e={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Mk={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Hk(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function n1e(e,t,r){for(var n=(r=r||{}).defaultFontFamily||"times",s=Object.assign({},r1e,r.genericFontFamilies||{}),i=null,o=null,l=0;l<t.length;++l)if(s[(i=O5(t[l])).family]&&(i.family=s[i.family]),e.hasOwnProperty(i.family)){o=e[i.family];break}if(!(o=o||e[n]))throw new Error("Could not find a font-family for the rule '"+Hk(i)+"' and default family '"+n+"'.");if(o=function(c,A){if(A[c])return A[c];var d=P5[c],u=d<=P5.normal?-1:1,f=Qk(A,iO,d,u);if(!f)throw new Error("Could not find a matching font-stretch value for "+c);return f}(i.stretch,o),o=function(c,A){if(A[c])return A[c];for(var d=aO[c],u=0;u<d.length;++u)if(A[d[u]])return A[d[u]];throw new Error("Could not find a matching font-style for "+c)}(i.style,o),!(o=function(c,A){if(A[c])return A[c];if(c===400&&A[500])return A[500];if(c===500&&A[400])return A[400];var d=t1e[c],u=Qk(A,oO,d,c<400?-1:1);if(!u)throw new Error("Could not find a matching font-weight for value "+c);return u}(i.weight,o)))throw new Error("Failed to resolve a font for the rule '"+Hk(i)+"'.");return o}function Vk(e){return e.trimLeft()}function s1e(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function a1e(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var xg,$k,qk,gb=["times"];(function(e){var t,r,n,s,i,o,l,c,A,d=function(b){return b=b||{},this.isStrokeTransparent=b.isStrokeTransparent||!1,this.strokeOpacity=b.strokeOpacity||1,this.strokeStyle=b.strokeStyle||"#000000",this.fillStyle=b.fillStyle||"#000000",this.isFillTransparent=b.isFillTransparent||!1,this.fillOpacity=b.fillOpacity||1,this.font=b.font||"10px sans-serif",this.textBaseline=b.textBaseline||"alphabetic",this.textAlign=b.textAlign||"left",this.lineWidth=b.lineWidth||1,this.lineJoin=b.lineJoin||"miter",this.lineCap=b.lineCap||"butt",this.path=b.path||[],this.transform=b.transform!==void 0?b.transform.clone():new c,this.globalCompositeOperation=b.globalCompositeOperation||"normal",this.globalAlpha=b.globalAlpha||1,this.clip_path=b.clip_path||[],this.currentPoint=b.currentPoint||new o,this.miterLimit=b.miterLimit||10,this.lastPoint=b.lastPoint||new o,this.lineDashOffset=b.lineDashOffset||0,this.lineDash=b.lineDash||[],this.margin=b.margin||[0,0,0,0],this.prevPageLastElemOffset=b.prevPageLastElemOffset||0,this.ignoreClearRect=typeof b.ignoreClearRect!="boolean"||b.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new u(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,A=new d}]);var u=function(b){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var O=b;Object.defineProperty(this,"pdf",{get:function(){return O}});var S=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return S},set:function(de){S=!!de}});var I=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return I},set:function(de){I=!!de}});var U=0;Object.defineProperty(this,"posX",{get:function(){return U},set:function(de){isNaN(de)||(U=de)}});var Q=0;Object.defineProperty(this,"posY",{get:function(){return Q},set:function(de){isNaN(de)||(Q=de)}}),Object.defineProperty(this,"margin",{get:function(){return A.margin},set:function(de){var te;typeof de=="number"?te=[de,de,de,de]:((te=new Array(4))[0]=de[0],te[1]=de.length>=2?de[1]:te[0],te[2]=de.length>=3?de[2]:te[0],te[3]=de.length>=4?de[3]:te[1]),A.margin=te}});var H=!1;Object.defineProperty(this,"autoPaging",{get:function(){return H},set:function(de){H=de}});var X=0;Object.defineProperty(this,"lastBreak",{get:function(){return X},set:function(de){X=de}});var V=[];Object.defineProperty(this,"pageBreaks",{get:function(){return V},set:function(de){V=de}}),Object.defineProperty(this,"ctx",{get:function(){return A},set:function(de){de instanceof d&&(A=de)}}),Object.defineProperty(this,"path",{get:function(){return A.path},set:function(de){A.path=de}});var Ae=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ae},set:function(de){Ae=de}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(de){var te;te=f(de),this.ctx.fillStyle=te.style,this.ctx.isFillTransparent=te.a===0,this.ctx.fillOpacity=te.a,this.pdf.setFillColor(te.r,te.g,te.b,{a:te.a}),this.pdf.setTextColor(te.r,te.g,te.b,{a:te.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(de){var te=f(de);this.ctx.strokeStyle=te.style,this.ctx.isStrokeTransparent=te.a===0,this.ctx.strokeOpacity=te.a,te.a===0?this.pdf.setDrawColor(255,255,255):(te.a,this.pdf.setDrawColor(te.r,te.g,te.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(de){["butt","round","square"].indexOf(de)!==-1&&(this.ctx.lineCap=de,this.pdf.setLineCap(de))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(de){isNaN(de)||(this.ctx.lineWidth=de,this.pdf.setLineWidth(de))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(de){["bevel","round","miter"].indexOf(de)!==-1&&(this.ctx.lineJoin=de,this.pdf.setLineJoin(de))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(de){isNaN(de)||(this.ctx.miterLimit=de,this.pdf.setMiterLimit(de))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(de){this.ctx.textBaseline=de}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(de){["right","end","center","left","start"].indexOf(de)!==-1&&(this.ctx.textAlign=de)}});var W=null;function J(de,te){if(W===null){var je=function(qe){var He=[];return Object.keys(qe).forEach(function(Ze){qe[Ze].forEach(function(xe){var ue=null;switch(xe){case"bold":ue={family:Ze,weight:"bold"};break;case"italic":ue={family:Ze,style:"italic"};break;case"bolditalic":ue={family:Ze,weight:"bold",style:"italic"};break;case"":case"normal":ue={family:Ze}}ue!==null&&(ue.ref={name:Ze,style:xe},He.push(ue))})}),He}(de.getFontList());W=function(qe){for(var He={},Ze=0;Ze<qe.length;++Ze){var xe=O5(qe[Ze]),ue=xe.family,Fe=xe.stretch,ke=xe.style,Te=xe.weight;He[ue]=He[ue]||{},He[ue][Fe]=He[ue][Fe]||{},He[ue][Fe][ke]=He[ue][Fe][ke]||{},He[ue][Fe][ke][Te]=xe}return He}(je.concat(te))}return W}var ve=null;Object.defineProperty(this,"fontFaces",{get:function(){return ve},set:function(de){W=null,ve=de}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(de){var te;if(this.ctx.font=de,(te=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(de))!==null){var je=te[1],qe=(te[2],te[3]),He=te[4],Ze=(te[5],te[6]),xe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(He)[2];He=Math.floor(xe==="px"?parseFloat(He)*this.pdf.internal.scaleFactor:xe==="em"?parseFloat(He)*this.pdf.getFontSize():parseFloat(He)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(He);var ue=function(Ce){var Be,Pe,Bt=[],tt=Ce.trim();if(tt==="")return gb;if(tt in Mk)return[Mk[tt]];for(;tt!=="";){switch(Pe=null,Be=(tt=Vk(tt)).charAt(0)){case'"':case"'":Pe=s1e(tt.substring(1),Be);break;default:Pe=a1e(tt)}if(Pe===null||(Bt.push(Pe[0]),(tt=Vk(Pe[1]))!==""&&tt.charAt(0)!==","))return gb;tt=tt.replace(/^,/,"")}return Bt}(Ze);if(this.fontFaces){var Fe=n1e(J(this.pdf,this.fontFaces),ue.map(function(Ce){return{family:Ce,stretch:"normal",weight:qe,style:je}}));this.pdf.setFont(Fe.ref.name,Fe.ref.style)}else{var ke="";(qe==="bold"||parseInt(qe,10)>=700||je==="bold")&&(ke="bold"),je==="italic"&&(ke+="italic"),ke.length===0&&(ke="normal");for(var Te="",Ne={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},et=0;et<ue.length;et++){if(this.pdf.internal.getFont(ue[et],ke,{noFallback:!0,disableWarning:!0})!==void 0){Te=ue[et];break}if(ke==="bolditalic"&&this.pdf.internal.getFont(ue[et],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Te=ue[et],ke="bold";else if(this.pdf.internal.getFont(ue[et],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Te=ue[et],ke="normal";break}}if(Te===""){for(var Se=0;Se<ue.length;Se++)if(Ne[ue[Se]]){Te=Ne[ue[Se]];break}}Te=Te===""?"Times":Te,this.pdf.setFont(Te,ke)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(de){this.ctx.globalCompositeOperation=de}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(de){this.ctx.globalAlpha=de}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(de){this.ctx.lineDashOffset=de,ee.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(de){this.ctx.lineDash=de,ee.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(de){this.ctx.ignoreClearRect=!!de}})};u.prototype.setLineDash=function(b){this.lineDash=b},u.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},u.prototype.fill=function(){B.call(this,"fill",!1)},u.prototype.stroke=function(){B.call(this,"stroke",!1)},u.prototype.beginPath=function(){this.path=[{type:"begin"}]},u.prototype.moveTo=function(b,O){if(isNaN(b)||isNaN(O))throw dn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var S=this.ctx.transform.applyToPoint(new o(b,O));this.path.push({type:"mt",x:S.x,y:S.y}),this.ctx.lastPoint=new o(b,O)},u.prototype.closePath=function(){var b=new o(0,0),O=0;for(O=this.path.length-1;O!==-1;O--)if(this.path[O].type==="begin"&&Ur(this.path[O+1])==="object"&&typeof this.path[O+1].x=="number"){b=new o(this.path[O+1].x,this.path[O+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(b.x,b.y)},u.prototype.lineTo=function(b,O){if(isNaN(b)||isNaN(O))throw dn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var S=this.ctx.transform.applyToPoint(new o(b,O));this.path.push({type:"lt",x:S.x,y:S.y}),this.ctx.lastPoint=new o(S.x,S.y)},u.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),B.call(this,null,!0)},u.prototype.quadraticCurveTo=function(b,O,S,I){if(isNaN(S)||isNaN(I)||isNaN(b)||isNaN(O))throw dn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var U=this.ctx.transform.applyToPoint(new o(S,I)),Q=this.ctx.transform.applyToPoint(new o(b,O));this.path.push({type:"qct",x1:Q.x,y1:Q.y,x:U.x,y:U.y}),this.ctx.lastPoint=new o(U.x,U.y)},u.prototype.bezierCurveTo=function(b,O,S,I,U,Q){if(isNaN(U)||isNaN(Q)||isNaN(b)||isNaN(O)||isNaN(S)||isNaN(I))throw dn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var H=this.ctx.transform.applyToPoint(new o(U,Q)),X=this.ctx.transform.applyToPoint(new o(b,O)),V=this.ctx.transform.applyToPoint(new o(S,I));this.path.push({type:"bct",x1:X.x,y1:X.y,x2:V.x,y2:V.y,x:H.x,y:H.y}),this.ctx.lastPoint=new o(H.x,H.y)},u.prototype.arc=function(b,O,S,I,U,Q){if(isNaN(b)||isNaN(O)||isNaN(S)||isNaN(I)||isNaN(U))throw dn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Q=!!Q,!this.ctx.transform.isIdentity){var H=this.ctx.transform.applyToPoint(new o(b,O));b=H.x,O=H.y;var X=this.ctx.transform.applyToPoint(new o(0,S)),V=this.ctx.transform.applyToPoint(new o(0,0));S=Math.sqrt(Math.pow(X.x-V.x,2)+Math.pow(X.y-V.y,2))}Math.abs(U-I)>=2*Math.PI&&(I=0,U=2*Math.PI),this.path.push({type:"arc",x:b,y:O,radius:S,startAngle:I,endAngle:U,counterclockwise:Q})},u.prototype.arcTo=function(b,O,S,I,U){throw new Error("arcTo not implemented.")},u.prototype.rect=function(b,O,S,I){if(isNaN(b)||isNaN(O)||isNaN(S)||isNaN(I))throw dn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(b,O),this.lineTo(b+S,O),this.lineTo(b+S,O+I),this.lineTo(b,O+I),this.lineTo(b,O),this.lineTo(b+S,O),this.lineTo(b,O)},u.prototype.fillRect=function(b,O,S,I){if(isNaN(b)||isNaN(O)||isNaN(S)||isNaN(I))throw dn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var U={};this.lineCap!=="butt"&&(U.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(U.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(b,O,S,I),this.fill(),U.hasOwnProperty("lineCap")&&(this.lineCap=U.lineCap),U.hasOwnProperty("lineJoin")&&(this.lineJoin=U.lineJoin)}},u.prototype.strokeRect=function(b,O,S,I){if(isNaN(b)||isNaN(O)||isNaN(S)||isNaN(I))throw dn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");x.call(this)||(this.beginPath(),this.rect(b,O,S,I),this.stroke())},u.prototype.clearRect=function(b,O,S,I){if(isNaN(b)||isNaN(O)||isNaN(S)||isNaN(I))throw dn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(b,O,S,I))},u.prototype.save=function(b){b=typeof b!="boolean"||b;for(var O=this.pdf.internal.getCurrentPageInfo().pageNumber,S=0;S<this.pdf.internal.getNumberOfPages();S++)this.pdf.setPage(S+1),this.pdf.internal.out("q");if(this.pdf.setPage(O),b){this.ctx.fontSize=this.pdf.internal.getFontSize();var I=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=I}},u.prototype.restore=function(b){b=typeof b!="boolean"||b;for(var O=this.pdf.internal.getCurrentPageInfo().pageNumber,S=0;S<this.pdf.internal.getNumberOfPages();S++)this.pdf.setPage(S+1),this.pdf.internal.out("Q");this.pdf.setPage(O),b&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},u.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var f=function(b){var O,S,I,U;if(b.isCanvasGradient===!0&&(b=b.getColor()),!b)return{r:0,g:0,b:0,a:0,style:b};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(b))O=0,S=0,I=0,U=0;else{var Q=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(b);if(Q!==null)O=parseInt(Q[1]),S=parseInt(Q[2]),I=parseInt(Q[3]),U=1;else if((Q=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(b))!==null)O=parseInt(Q[1]),S=parseInt(Q[2]),I=parseInt(Q[3]),U=parseFloat(Q[4]);else{if(U=1,typeof b=="string"&&b.charAt(0)!=="#"){var H=new JP(b);b=H.ok?H.toHex():"#000000"}b.length===4?(O=b.substring(1,2),O+=O,S=b.substring(2,3),S+=S,I=b.substring(3,4),I+=I):(O=b.substring(1,3),S=b.substring(3,5),I=b.substring(5,7)),O=parseInt(O,16),S=parseInt(S,16),I=parseInt(I,16)}}return{r:O,g:S,b:I,a:U,style:b}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},x=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};u.prototype.fillText=function(b,O,S,I){if(isNaN(O)||isNaN(S)||typeof b!="string")throw dn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(I=isNaN(I)?void 0:I,!h.call(this)){var U=Y(this.ctx.transform.rotation),Q=this.ctx.transform.scaleX;D.call(this,{text:b,x:O,y:S,scale:Q,angle:U,align:this.textAlign,maxWidth:I})}},u.prototype.strokeText=function(b,O,S,I){if(isNaN(O)||isNaN(S)||typeof b!="string")throw dn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!x.call(this)){I=isNaN(I)?void 0:I;var U=Y(this.ctx.transform.rotation),Q=this.ctx.transform.scaleX;D.call(this,{text:b,x:O,y:S,scale:Q,renderingMode:"stroke",angle:U,align:this.textAlign,maxWidth:I})}},u.prototype.measureText=function(b){if(typeof b!="string")throw dn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var O=this.pdf,S=this.pdf.internal.scaleFactor,I=O.internal.getFontSize(),U=O.getStringUnitWidth(b)*I/O.internal.scaleFactor,Q=function(H){var X=(H=H||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return X}}),this};return new Q({width:U*=Math.round(96*S/72*1e4)/1e4})},u.prototype.scale=function(b,O){if(isNaN(b)||isNaN(O))throw dn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var S=new c(b,0,0,O,0,0);this.ctx.transform=this.ctx.transform.multiply(S)},u.prototype.rotate=function(b){if(isNaN(b))throw dn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var O=new c(Math.cos(b),Math.sin(b),-Math.sin(b),Math.cos(b),0,0);this.ctx.transform=this.ctx.transform.multiply(O)},u.prototype.translate=function(b,O){if(isNaN(b)||isNaN(O))throw dn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var S=new c(1,0,0,1,b,O);this.ctx.transform=this.ctx.transform.multiply(S)},u.prototype.transform=function(b,O,S,I,U,Q){if(isNaN(b)||isNaN(O)||isNaN(S)||isNaN(I)||isNaN(U)||isNaN(Q))throw dn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var H=new c(b,O,S,I,U,Q);this.ctx.transform=this.ctx.transform.multiply(H)},u.prototype.setTransform=function(b,O,S,I,U,Q){b=isNaN(b)?1:b,O=isNaN(O)?0:O,S=isNaN(S)?0:S,I=isNaN(I)?1:I,U=isNaN(U)?0:U,Q=isNaN(Q)?0:Q,this.ctx.transform=new c(b,O,S,I,U,Q)};var m=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};u.prototype.drawImage=function(b,O,S,I,U,Q,H,X,V){var Ae=this.pdf.getImageProperties(b),W=1,J=1,ve=1,de=1;I!==void 0&&X!==void 0&&(ve=X/I,de=V/U,W=Ae.width/I*X/I,J=Ae.height/U*V/U),Q===void 0&&(Q=O,H=S,O=0,S=0),I!==void 0&&X===void 0&&(X=I,V=U),I===void 0&&X===void 0&&(X=Ae.width,V=Ae.height);for(var te,je=this.ctx.transform.decompose(),qe=Y(je.rotate.shx),He=new c,Ze=(He=(He=(He=He.multiply(je.translate)).multiply(je.skew)).multiply(je.scale)).applyToRectangle(new l(Q-O*ve,H-S*de,I*W,U*J)),xe=g.call(this,Ze),ue=[],Fe=0;Fe<xe.length;Fe+=1)ue.indexOf(xe[Fe])===-1&&ue.push(xe[Fe]);if(w(ue),this.autoPaging)for(var ke=ue[0],Te=ue[ue.length-1],Ne=ke;Ne<Te+1;Ne++){this.pdf.setPage(Ne);var et=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Se=Ne===1?this.posY+this.margin[0]:this.margin[0],Ce=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Be=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Pe=Ne===1?0:Ce+(Ne-2)*Be;if(this.ctx.clip_path.length!==0){var Bt=this.path;te=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(te,this.posX+this.margin[3],-Pe+Se+this.ctx.prevPageLastElemOffset),T.call(this,"fill",!0),this.path=Bt}var tt=JSON.parse(JSON.stringify(Ze));tt=v([tt],this.posX+this.margin[3],-Pe+Se+this.ctx.prevPageLastElemOffset)[0];var Ot=(Ne>ke||Ne<Te)&&m.call(this);Ot&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],et,Be,null).clip().discardPath()),this.pdf.addImage(b,"JPEG",tt.x,tt.y,tt.w,tt.h,null,null,qe),Ot&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(b,"JPEG",Ze.x,Ze.y,Ze.w,Ze.h,null,null,qe)};var g=function(b,O,S){var I=[];O=O||this.pdf.internal.pageSize.width,S=S||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var U=this.posY+this.ctx.prevPageLastElemOffset;switch(b.type){default:case"mt":case"lt":I.push(Math.floor((b.y+U)/S)+1);break;case"arc":I.push(Math.floor((b.y+U-b.radius)/S)+1),I.push(Math.floor((b.y+U+b.radius)/S)+1);break;case"qct":var Q=R(this.ctx.lastPoint.x,this.ctx.lastPoint.y,b.x1,b.y1,b.x,b.y);I.push(Math.floor((Q.y+U)/S)+1),I.push(Math.floor((Q.y+Q.h+U)/S)+1);break;case"bct":var H=z(this.ctx.lastPoint.x,this.ctx.lastPoint.y,b.x1,b.y1,b.x2,b.y2,b.x,b.y);I.push(Math.floor((H.y+U)/S)+1),I.push(Math.floor((H.y+H.h+U)/S)+1);break;case"rect":I.push(Math.floor((b.y+U)/S)+1),I.push(Math.floor((b.y+b.h+U)/S)+1)}for(var X=0;X<I.length;X+=1)for(;this.pdf.internal.getNumberOfPages()<I[X];)p.call(this);return I},p=function(){var b=this.fillStyle,O=this.strokeStyle,S=this.font,I=this.lineCap,U=this.lineWidth,Q=this.lineJoin;this.pdf.addPage(),this.fillStyle=b,this.strokeStyle=O,this.font=S,this.lineCap=I,this.lineWidth=U,this.lineJoin=Q},v=function(b,O,S){for(var I=0;I<b.length;I++)switch(b[I].type){case"bct":b[I].x2+=O,b[I].y2+=S;case"qct":b[I].x1+=O,b[I].y1+=S;case"mt":case"lt":case"arc":default:b[I].x+=O,b[I].y+=S}return b},w=function(b){return b.sort(function(O,S){return O-S})},B=function(b,O){for(var S,I,U=this.fillStyle,Q=this.strokeStyle,H=this.lineCap,X=this.lineWidth,V=Math.abs(X*this.ctx.transform.scaleX),Ae=this.lineJoin,W=JSON.parse(JSON.stringify(this.path)),J=JSON.parse(JSON.stringify(this.path)),ve=[],de=0;de<J.length;de++)if(J[de].x!==void 0)for(var te=g.call(this,J[de]),je=0;je<te.length;je+=1)ve.indexOf(te[je])===-1&&ve.push(te[je]);for(var qe=0;qe<ve.length;qe++)for(;this.pdf.internal.getNumberOfPages()<ve[qe];)p.call(this);if(w(ve),this.autoPaging)for(var He=ve[0],Ze=ve[ve.length-1],xe=He;xe<Ze+1;xe++){this.pdf.setPage(xe),this.fillStyle=U,this.strokeStyle=Q,this.lineCap=H,this.lineWidth=V,this.lineJoin=Ae;var ue=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Fe=xe===1?this.posY+this.margin[0]:this.margin[0],ke=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Te=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ne=xe===1?0:ke+(xe-2)*Te;if(this.ctx.clip_path.length!==0){var et=this.path;S=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(S,this.posX+this.margin[3],-Ne+Fe+this.ctx.prevPageLastElemOffset),T.call(this,b,!0),this.path=et}if(I=JSON.parse(JSON.stringify(W)),this.path=v(I,this.posX+this.margin[3],-Ne+Fe+this.ctx.prevPageLastElemOffset),O===!1||xe===0){var Se=(xe>He||xe<Ze)&&m.call(this);Se&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ue,Te,null).clip().discardPath()),T.call(this,b,O),Se&&this.pdf.restoreGraphicsState()}this.lineWidth=X}else this.lineWidth=V,T.call(this,b,O),this.lineWidth=X;this.path=W},T=function(b,O){if((b!=="stroke"||O||!x.call(this))&&(b==="stroke"||O||!h.call(this))){for(var S,I,U=[],Q=this.path,H=0;H<Q.length;H++){var X=Q[H];switch(X.type){case"begin":U.push({begin:!0});break;case"close":U.push({close:!0});break;case"mt":U.push({start:X,deltas:[],abs:[]});break;case"lt":var V=U.length;if(Q[H-1]&&!isNaN(Q[H-1].x)&&(S=[X.x-Q[H-1].x,X.y-Q[H-1].y],V>0)){for(;V>=0;V--)if(U[V-1].close!==!0&&U[V-1].begin!==!0){U[V-1].deltas.push(S),U[V-1].abs.push(X);break}}break;case"bct":S=[X.x1-Q[H-1].x,X.y1-Q[H-1].y,X.x2-Q[H-1].x,X.y2-Q[H-1].y,X.x-Q[H-1].x,X.y-Q[H-1].y],U[U.length-1].deltas.push(S);break;case"qct":var Ae=Q[H-1].x+2/3*(X.x1-Q[H-1].x),W=Q[H-1].y+2/3*(X.y1-Q[H-1].y),J=X.x+2/3*(X.x1-X.x),ve=X.y+2/3*(X.y1-X.y),de=X.x,te=X.y;S=[Ae-Q[H-1].x,W-Q[H-1].y,J-Q[H-1].x,ve-Q[H-1].y,de-Q[H-1].x,te-Q[H-1].y],U[U.length-1].deltas.push(S);break;case"arc":U.push({deltas:[],abs:[],arc:!0}),Array.isArray(U[U.length-1].abs)&&U[U.length-1].abs.push(X)}}I=O?null:b==="stroke"?"stroke":"fill";for(var je=!1,qe=0;qe<U.length;qe++)if(U[qe].arc)for(var He=U[qe].abs,Ze=0;Ze<He.length;Ze++){var xe=He[Ze];xe.type==="arc"?E.call(this,xe.x,xe.y,xe.radius,xe.startAngle,xe.endAngle,xe.counterclockwise,void 0,O,!je):G.call(this,xe.x,xe.y),je=!0}else if(U[qe].close===!0)this.pdf.internal.out("h"),je=!1;else if(U[qe].begin!==!0){var ue=U[qe].start.x,Fe=U[qe].start.y;K.call(this,U[qe].deltas,ue,Fe),je=!0}I&&L.call(this,I),O&&M.call(this)}},_=function(b){var O=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,S=O*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return b-S;case"top":return b+O-S;case"hanging":return b+O-2*S;case"middle":return b+O/2-S;case"ideographic":return b;case"alphabetic":default:return b}},j=function(b){return b+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};u.prototype.createLinearGradient=function(){var b=function(){};return b.colorStops=[],b.addColorStop=function(O,S){this.colorStops.push([O,S])},b.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},b.isCanvasGradient=!0,b},u.prototype.createPattern=function(){return this.createLinearGradient()},u.prototype.createRadialGradient=function(){return this.createLinearGradient()};var E=function(b,O,S,I,U,Q,H,X,V){for(var Ae=Z.call(this,S,I,U,Q),W=0;W<Ae.length;W++){var J=Ae[W];W===0&&(V?F.call(this,J.x1+b,J.y1+O):G.call(this,J.x1+b,J.y1+O)),ae.call(this,b,O,J.x2,J.y2,J.x3,J.y3,J.x4,J.y4)}X?M.call(this):L.call(this,H)},L=function(b){switch(b){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},M=function(){this.pdf.clip(),this.pdf.discardPath()},F=function(b,O){this.pdf.internal.out(r(b)+" "+n(O)+" m")},D=function(b){var O;switch(b.align){case"right":case"end":O="right";break;case"center":O="center";break;case"left":case"start":default:O="left"}var S=this.pdf.getTextDimensions(b.text),I=_.call(this,b.y),U=j.call(this,I)-S.h,Q=this.ctx.transform.applyToPoint(new o(b.x,I)),H=this.ctx.transform.decompose(),X=new c;X=(X=(X=X.multiply(H.translate)).multiply(H.skew)).multiply(H.scale);for(var V,Ae,W,J=this.ctx.transform.applyToRectangle(new l(b.x,I,S.w,S.h)),ve=X.applyToRectangle(new l(b.x,U,S.w,S.h)),de=g.call(this,ve),te=[],je=0;je<de.length;je+=1)te.indexOf(de[je])===-1&&te.push(de[je]);if(w(te),this.autoPaging)for(var qe=te[0],He=te[te.length-1],Ze=qe;Ze<He+1;Ze++){this.pdf.setPage(Ze);var xe=Ze===1?this.posY+this.margin[0]:this.margin[0],ue=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Fe=this.pdf.internal.pageSize.height-this.margin[2],ke=Fe-this.margin[0],Te=this.pdf.internal.pageSize.width-this.margin[1],Ne=Te-this.margin[3],et=Ze===1?0:ue+(Ze-2)*ke;if(this.ctx.clip_path.length!==0){var Se=this.path;V=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(V,this.posX+this.margin[3],-1*et+xe),T.call(this,"fill",!0),this.path=Se}var Ce=v([JSON.parse(JSON.stringify(ve))],this.posX+this.margin[3],-et+xe+this.ctx.prevPageLastElemOffset)[0];b.scale>=.01&&(Ae=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ae*b.scale),W=this.lineWidth,this.lineWidth=W*b.scale);var Be=this.autoPaging!=="text";if(Be||Ce.y+Ce.h<=Fe){if(Be||Ce.y>=xe&&Ce.x<=Te){var Pe=Be?b.text:this.pdf.splitTextToSize(b.text,b.maxWidth||Te-Ce.x)[0],Bt=v([JSON.parse(JSON.stringify(J))],this.posX+this.margin[3],-et+xe+this.ctx.prevPageLastElemOffset)[0],tt=Be&&(Ze>qe||Ze<He)&&m.call(this);tt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ne,ke,null).clip().discardPath()),this.pdf.text(Pe,Bt.x,Bt.y,{angle:b.angle,align:O,renderingMode:b.renderingMode}),tt&&this.pdf.restoreGraphicsState()}}else Ce.y<Fe&&(this.ctx.prevPageLastElemOffset+=Fe-Ce.y);b.scale>=.01&&(this.pdf.setFontSize(Ae),this.lineWidth=W)}else b.scale>=.01&&(Ae=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ae*b.scale),W=this.lineWidth,this.lineWidth=W*b.scale),this.pdf.text(b.text,Q.x+this.posX,Q.y+this.posY,{angle:b.angle,align:O,renderingMode:b.renderingMode,maxWidth:b.maxWidth}),b.scale>=.01&&(this.pdf.setFontSize(Ae),this.lineWidth=W)},G=function(b,O,S,I){S=S||0,I=I||0,this.pdf.internal.out(r(b+S)+" "+n(O+I)+" l")},K=function(b,O,S){return this.pdf.lines(b,O,S,null,null)},ae=function(b,O,S,I,U,Q,H,X){this.pdf.internal.out([t(s(S+b)),t(i(I+O)),t(s(U+b)),t(i(Q+O)),t(s(H+b)),t(i(X+O)),"c"].join(" "))},Z=function(b,O,S,I){for(var U=2*Math.PI,Q=Math.PI/2;O>S;)O-=U;var H=Math.abs(S-O);H<U&&I&&(H=U-H);for(var X=[],V=I?-1:1,Ae=O;H>1e-5;){var W=Ae+V*Math.min(H,Q);X.push(oe.call(this,b,Ae,W)),H-=Math.abs(W-Ae),Ae=W}return X},oe=function(b,O,S){var I=(S-O)/2,U=b*Math.cos(I),Q=b*Math.sin(I),H=U,X=-Q,V=H*H+X*X,Ae=V+H*U+X*Q,W=4/3*(Math.sqrt(2*V*Ae)-Ae)/(H*Q-X*U),J=H-W*X,ve=X+W*H,de=J,te=-ve,je=I+O,qe=Math.cos(je),He=Math.sin(je);return{x1:b*Math.cos(O),y1:b*Math.sin(O),x2:J*qe-ve*He,y2:J*He+ve*qe,x3:de*qe-te*He,y3:de*He+te*qe,x4:b*Math.cos(S),y4:b*Math.sin(S)}},Y=function(b){return 180*b/Math.PI},R=function(b,O,S,I,U,Q){var H=b+.5*(S-b),X=O+.5*(I-O),V=U+.5*(S-U),Ae=Q+.5*(I-Q),W=Math.min(b,U,H,V),J=Math.max(b,U,H,V),ve=Math.min(O,Q,X,Ae),de=Math.max(O,Q,X,Ae);return new l(W,ve,J-W,de-ve)},z=function(b,O,S,I,U,Q,H,X){var V,Ae,W,J,ve,de,te,je,qe,He,Ze,xe,ue,Fe,ke=S-b,Te=I-O,Ne=U-S,et=Q-I,Se=H-U,Ce=X-Q;for(Ae=0;Ae<41;Ae++)qe=(te=(W=b+(V=Ae/40)*ke)+V*((ve=S+V*Ne)-W))+V*(ve+V*(U+V*Se-ve)-te),He=(je=(J=O+V*Te)+V*((de=I+V*et)-J))+V*(de+V*(Q+V*Ce-de)-je),Ae==0?(Ze=qe,xe=He,ue=qe,Fe=He):(Ze=Math.min(Ze,qe),xe=Math.min(xe,He),ue=Math.max(ue,qe),Fe=Math.max(Fe,He));return new l(Math.round(Ze),Math.round(xe),Math.round(ue-Ze),Math.round(Fe-xe))},ee=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var b,O,S=(b=this.ctx.lineDash,O=this.ctx.lineDashOffset,JSON.stringify({lineDash:b,lineDashOffset:O}));this.prevLineDash!==S&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=S)}}})(lr.API),function(e){var t=function(i){var o,l,c,A,d,u,f,h,x,m;for(l=[],c=0,A=(i+=o="\0\0\0\0".slice(i.length%4||4)).length;A>c;c+=4)(d=(i.charCodeAt(c)<<24)+(i.charCodeAt(c+1)<<16)+(i.charCodeAt(c+2)<<8)+i.charCodeAt(c+3))!==0?(u=(d=((d=((d=((d=(d-(m=d%85))/85)-(x=d%85))/85)-(h=d%85))/85)-(f=d%85))/85)%85,l.push(u+33,f+33,h+33,x+33,m+33)):l.push(122);return function(g,p){for(var v=p;v>0;v--)g.pop()}(l,o.length),String.fromCharCode.apply(String,l)+"~>"},r=function(i){var o,l,c,A,d,u=String,f="length",h=255,x="charCodeAt",m="slice",g="replace";for(i[m](-2),i=i[m](0,-2)[g](/\s/g,"")[g]("z","!!!!!"),c=[],A=0,d=(i+=o="uuuuu"[m](i[f]%5||5))[f];d>A;A+=5)l=52200625*(i[x](A)-33)+614125*(i[x](A+1)-33)+7225*(i[x](A+2)-33)+85*(i[x](A+3)-33)+(i[x](A+4)-33),c.push(h&l>>24,h&l>>16,h&l>>8,h&l);return function(p,v){for(var w=v;w>0;w--)p.pop()}(c,o[f]),u.fromCharCode.apply(u,c)},n=function(i){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),o.test(i)===!1)return"";for(var l="",c=0;c<i.length;c+=2)l+=String.fromCharCode("0x"+(i[c]+i[c+1]));return l},s=function(i){for(var o=new Uint8Array(i.length),l=i.length;l--;)o[l]=i.charCodeAt(l);return i=(o=_5(o)).reduce(function(c,A){return c+String.fromCharCode(A)},"")};e.processDataByFilters=function(i,o){var l=0,c=i||"",A=[];for(typeof(o=o||[])=="string"&&(o=[o]),l=0;l<o.length;l+=1)switch(o[l]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),A.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=t(c),A.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=n(c),A.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(d){return("0"+d.charCodeAt().toString(16)).slice(-2)}).join("")+">",A.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=s(c),A.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[l]+'" is not implemented')}return{data:c,reverseChain:A.reverse().join(" ")}}}(lr.API),function(e){e.loadFile=function(t,r,n){return function(s,i,o){i=i!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,A,d){var u=new XMLHttpRequest,f=0,h=function(x){var m=x.length,g=[],p=String.fromCharCode;for(f=0;f<m;f+=1)g.push(p(255&x.charCodeAt(f)));return g.join("")};if(u.open("GET",c,!A),u.overrideMimeType("text/plain; charset=x-user-defined"),A===!1&&(u.onload=function(){u.status===200?d(h(this.responseText)):d(void 0)}),u.send(null),A&&u.status===200)return h(u.responseText)}(s,i,o)}catch{}return l}(t,r,n)},e.loadImageFile=e.loadFile}(lr.API),function(e){function t(){return(cr.html2canvas?Promise.resolve(cr.html2canvas):S5(()=>Promise.resolve().then(()=>Nge),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function r(){return(cr.DOMPurify?Promise.resolve(cr.DOMPurify):S5(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var n=function(o){var l=Ur(o);return l==="undefined"?"undefined":l==="string"||o instanceof String?"string":l==="number"||o instanceof Number?"number":l==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":l==="object"?"object":"unknown"},s=function(o,l){var c=document.createElement(o);for(var A in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[A]=l.style[A];return c},i=function o(l){var c=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),A=o.convert(Promise.resolve(),c);return A=(A=A.setProgress(1,o,1,[o])).set(l)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(o,l){return o.__proto__=l||i.prototype,o},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(o,l){return this.then(function(){switch(l=l||function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o)){case"string":return this.then(r).then(function(c){return this.set({src:s("div",{innerHTML:o,dompurify:c})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},i.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=function c(A,d){for(var u=A.nodeType===3?document.createTextNode(A.nodeValue):A.cloneNode(!1),f=A.firstChild;f;f=f.nextSibling)d!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||u.appendChild(c(f,d));return A.nodeType===1&&(A.nodeName==="CANVAS"?(u.width=A.width,u.height=A.height,u.getContext("2d").drawImage(A,0,0)):A.nodeName!=="TEXTAREA"&&A.nodeName!=="SELECT"||(u.value=A.value),u.addEventListener("load",function(){u.scrollTop=A.scrollTop,u.scrollLeft=A.scrollLeft},!0)),u}(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(l){var c=this.opt.jsPDF,A=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,u=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete u.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=A,A)for(var f=0;f<A.length;++f){var h=A[f],x=h.src.find(function(m){return m.format==="truetype"});x&&c.addFont(x.url,h.ref.name,h.ref.style)}return u.windowHeight=u.windowHeight||0,u.windowHeight=u.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):u.windowHeight,c.context2d.save(!0),l(this.prop.container,u)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(o,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(o,l):this.outputPdf(o,l)},i.prototype.outputPdf=function(o,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,l)})},i.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},i.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(o){if(n(o)!=="object")return this;var l=Object.keys(o||{}).map(function(c){if(c in i.template.prop)return function(){this.prop[c]=o[c]};switch(c){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[c]=o[c]}}},this);return this.then(function(){return this.thenList(l)})},i.prototype.get=function(o,l){return this.then(function(){var c=o in i.template.prop?this.prop[o]:this.opt[o];return l?l(c):c})},i.prototype.setMargin=function(o){return this.then(function(){switch(n(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},i.prototype.setPageSize=function(o){function l(c,A){return Math.floor(c*A/72*96)}return this.then(function(){(o=o||lr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:l(o.inner.width,o.k),height:l(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},i.prototype.setProgress=function(o,l,c,A){return o!=null&&(this.progress.val=o),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),A!=null&&(this.progress.stack=A),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(o,l,c,A){return this.setProgress(o?this.progress.val+o:null,l||null,c?this.progress.n+c:null,A?this.progress.stack.concat(A):null)},i.prototype.then=function(o,l){var c=this;return this.thenCore(o,l,function(A,d){return c.updateProgress(null,null,1,[A]),Promise.prototype.then.call(this,function(u){return c.updateProgress(null,A),u}).then(A,d).then(function(u){return c.updateProgress(1),u})})},i.prototype.thenCore=function(o,l,c){c=c||Promise.prototype.then,o&&(o=o.bind(this)),l&&(l=l.bind(this));var A=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),d=c.call(A,o,l);return i.convert(d,this.__proto__)},i.prototype.thenExternal=function(o,l){return Promise.prototype.then.call(this,o,l)},i.prototype.thenList=function(o){var l=this;return o.forEach(function(c){l=l.thenCore(c)}),l},i.prototype.catch=function(o){o&&(o=o.bind(this));var l=Promise.prototype.catch.call(this,o);return i.convert(l,this)},i.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},i.prototype.error=function(o){return this.then(function(){throw new Error(o)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,lr.getPageSize=function(o,l,c){if(Ur(o)==="object"){var A=o;o=A.orientation,l=A.unit||l,c=A.format||c}l=l||"mm",c=c||"a4",o=(""+(o||"P")).toLowerCase();var d,u=(""+c).toLowerCase(),f={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+l}var h,x=0,m=0;if(f.hasOwnProperty(u))x=f[u][1]/d,m=f[u][0]/d;else try{x=c[1],m=c[0]}catch{throw new Error("Invalid format: "+c)}if(o==="p"||o==="portrait")o="p",m>x&&(h=m,m=x,x=h);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",x>m&&(h=m,m=x,x=h)}return{width:m,height:x,unit:l,k:d,orientation:o}},e.html=function(o,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(O5):null;var c=new i(l);return l.worker?c:c.from(o).doCallback()}}(lr.API),lr.API.addJS=function(e){return qk=e,this.internal.events.subscribe("postPutResources",function(){xg=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(xg+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),$k=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+qk+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){xg!==void 0&&$k!==void 0&&this.internal.out("/Names <</JavaScript "+xg+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=r.outline.render().split(/\r\n/),i=0;i<s.length;i++){var o=s[i],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var A=this.internal.pages.length,d=[];for(i=0;i<A;i++){var u=r.internal.newObject();d.push(u);var f=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+f.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<d.length;i++)r.internal.write("(page_"+(i+1)+")"+d[i]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,s,i){var o={title:s,options:i,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var o=n.children[i];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var A=0;A<n.children.length;A++)this.renderItems(n.children[A])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,s){for(var i=0;i<s.children.length;i++)n.count++,this.count_r(n,s.children[i]);return n.count}}])}(lr.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,s,i,o,l){var c,A=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(c=function(u){for(var f,h=256*u.charCodeAt(4)+u.charCodeAt(5),x=u.length,m={width:0,height:0,numcomponents:1},g=4;g<x;g+=2){if(g+=h,t.indexOf(u.charCodeAt(g+1))!==-1){f=256*u.charCodeAt(g+5)+u.charCodeAt(g+6),m={width:256*u.charCodeAt(g+7)+u.charCodeAt(g+8),height:f,numcomponents:u.charCodeAt(g+9)};break}h=256*u.charCodeAt(g+2)+u.charCodeAt(g+3)}return m}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}d={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:A,index:n,alias:s}}return d}}(lr.API);var Du,gg,Kk,zk,Gk,i1e=function(){var e,t,r;function n(i){var o,l,c,A,d,u,f,h,x,m,g,p,v,w;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},u=null;;){switch(o=this.readUInt32(),x=(function(){var B,T;for(T=[],B=0;B<4;++B)T.push(String.fromCharCode(this.data[this.pos++]));return T}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(o);break;case"fcTL":u&&this.animation.frames.push(u),this.pos+=4,u={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},d=this.readUInt16(),A=this.readUInt16()||100,u.delay=1e3*d/A,u.disposeOp=this.data[this.pos++],u.blendOp=this.data[this.pos++],u.data=[];break;case"IDAT":case"fdAT":for(x==="fdAT"&&(this.pos+=4,o-=4),i=(u!=null?u.data:void 0)||this.imgData,p=0;0<=o?p<o:p>o;0<=o?++p:--p)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(o),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((m=c-this.transparency.indexed.length)>0)for(v=0;0<=m?v<m:v>m;0<=m?++v:--v)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(o)[0];break;case 2:this.transparency.rgb=this.read(o)}break;case"tEXt":f=(g=this.read(o)).indexOf(0),h=String.fromCharCode.apply(String,g.slice(0,f)),this.text[h]=String.fromCharCode.apply(String,g.slice(f+1));break;case"IEND":return u&&this.animation.frames.push(u),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(w=this.colorType)===4||w===6,l=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*l,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=o}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(i){var o,l;for(l=[],o=0;0<=i?o<i:o>i;0<=i?++o:--o)l.push(this.data[this.pos++]);return l},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(i){var o=this.pixelBitlength/8,l=new Uint8Array(this.width*this.height*o),c=0,A=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function d(u,f,h,x){var m,g,p,v,w,B,T,_,j,E,L,M,F,D,G,K,ae,Z,oe,Y,R,z=Math.ceil((A.width-u)/h),ee=Math.ceil((A.height-f)/x),b=A.width==z&&A.height==ee;for(D=o*z,M=b?l:new Uint8Array(D*ee),B=i.length,F=0,g=0;F<ee&&c<B;){switch(i[c++]){case 0:for(v=ae=0;ae<D;v=ae+=1)M[g++]=i[c++];break;case 1:for(v=Z=0;Z<D;v=Z+=1)m=i[c++],w=v<o?0:M[g-o],M[g++]=(m+w)%256;break;case 2:for(v=oe=0;oe<D;v=oe+=1)m=i[c++],p=(v-v%o)/o,G=F&&M[(F-1)*D+p*o+v%o],M[g++]=(G+m)%256;break;case 3:for(v=Y=0;Y<D;v=Y+=1)m=i[c++],p=(v-v%o)/o,w=v<o?0:M[g-o],G=F&&M[(F-1)*D+p*o+v%o],M[g++]=(m+Math.floor((w+G)/2))%256;break;case 4:for(v=R=0;R<D;v=R+=1)m=i[c++],p=(v-v%o)/o,w=v<o?0:M[g-o],F===0?G=K=0:(G=M[(F-1)*D+p*o+v%o],K=p&&M[(F-1)*D+(p-1)*o+v%o]),T=w+G-K,_=Math.abs(T-w),E=Math.abs(T-G),L=Math.abs(T-K),j=_<=E&&_<=L?w:E<=L?G:K,M[g++]=(m+j)%256;break;default:throw new Error("Invalid filter algorithm: "+i[c-1])}if(!b){var O=((f+F*x)*A.width+u)*o,S=F*D;for(v=0;v<z;v+=1){for(var I=0;I<o;I+=1)l[O++]=M[S++];O+=(h-1)*o}}F++}}return i=Oge(i),A.interlaceMethod==1?(d(0,0,8,8),d(4,0,8,8),d(0,4,4,8),d(2,0,4,4),d(0,2,2,4),d(1,0,2,2),d(0,1,1,2)):d(0,0,1,1),l},n.prototype.decodePalette=function(){var i,o,l,c,A,d,u,f,h;for(l=this.palette,d=this.transparency.indexed||[],A=new Uint8Array((d.length||0)+l.length),c=0,i=0,o=u=0,f=l.length;u<f;o=u+=3)A[c++]=l[o],A[c++]=l[o+1],A[c++]=l[o+2],A[c++]=(h=d[i++])!=null?h:255;return A},n.prototype.copyToImageData=function(i,o){var l,c,A,d,u,f,h,x,m,g,p;if(c=this.colors,m=null,l=this.hasAlphaChannel,this.palette.length&&(m=(p=this._decodedPalette)!=null?p:this._decodedPalette=this.decodePalette(),c=4,l=!0),x=(A=i.data||i).length,u=m||o,d=f=0,c===1)for(;d<x;)h=m?4*o[d/4]:f,g=u[h++],A[d++]=g,A[d++]=g,A[d++]=g,A[d++]=l?u[h++]:255,f=h;else for(;d<x;)h=m?4*o[d/4]:f,A[d++]=u[h++],A[d++]=u[h++],A[d++]=u[h++],A[d++]=l?u[h++]:255,f=h},n.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var s=function(){if(Object.prototype.toString.call(cr)==="[object Window]"){try{t=cr.document.createElement("canvas"),r=t.getContext("2d")}catch{return!1}return!0}return!1};return s(),e=function(i){var o;if(s()===!0)return r.width=i.width,r.height=i.height,r.clearRect(0,0,i.width,i.height),r.putImageData(i,0,0),(o=new Image).src=t.toDataURL(),o;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(i){var o,l,c,A,d,u,f,h;if(this.animation){for(h=[],l=d=0,u=(f=this.animation.frames).length;d<u;l=++d)o=f[l],c=i.createImageData(o.width,o.height),A=this.decodePixels(new Uint8Array(o.data)),this.copyToImageData(c,A),o.imageData=c,h.push(o.image=e(c));return h}},n.prototype.renderFrame=function(i,o){var l,c,A;return l=(c=this.animation.frames)[o],A=c[o-1],o===0&&i.clearRect(0,0,this.width,this.height),(A!=null?A.disposeOp:void 0)===1?i.clearRect(A.xOffset,A.yOffset,A.width,A.height):(A!=null?A.disposeOp:void 0)===2&&i.putImageData(A.imageData,A.xOffset,A.yOffset),l.blendOp===0&&i.clearRect(l.xOffset,l.yOffset,l.width,l.height),i.drawImage(l.image,l.xOffset,l.yOffset)},n.prototype.animate=function(i){var o,l,c,A,d,u,f=this;return l=0,u=this.animation,A=u.numFrames,c=u.frames,d=u.numPlays,(o=function(){var h,x;if(h=l++%A,x=c[h],f.renderFrame(i,h),A>1&&l/A<d)return f.animation._timeout=setTimeout(o,x.delay)})()},n.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},n.prototype.render=function(i){var o,l;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,o=i.getContext("2d"),this.animation?(this.decodeFrames(o),this.animate(o)):(l=o.createImageData(this.width,this.height),this.copyToImageData(l,this.decodePixels()),o.putImageData(l,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function o1e(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,s=e[t++],i=s>>7,o=1<<(7&s)+1;e[t++],e[t++];var l=null,c=null;i&&(l=t,c=o,t+=3*o);var A=!0,d=[],u=0,f=null,h=0,x=null;for(this.width=r,this.height=n;A&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,x=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((F=e[t++])>=0))throw Error("Invalid block size");if(F===0)break;t+=F}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var m=e[t++];u=e[t++]|e[t++]<<8,f=e[t++],!(1&m)&&(f=null),h=m>>2&7,t++;break;case 254:for(;;){if(!((F=e[t++])>=0))throw Error("Invalid block size");if(F===0)break;t+=F}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var g=e[t++]|e[t++]<<8,p=e[t++]|e[t++]<<8,v=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,B=e[t++],T=B>>6&1,_=1<<(7&B)+1,j=l,E=c,L=!1;B>>7&&(L=!0,j=t,E=_,t+=3*_);var M=t;for(t++;;){var F;if(!((F=e[t++])>=0))throw Error("Invalid block size");if(F===0)break;t+=F}d.push({x:g,y:p,width:v,height:w,has_local_palette:L,palette_offset:j,palette_size:E,data_offset:M,data_length:t-M,transparent_index:f,interlaced:!!T,delay:u,disposal:h});break;case 59:A=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return x},this.frameInfo=function(D){if(D<0||D>=d.length)throw new Error("Frame index out of range.");return d[D]},this.decodeAndBlitFrameBGRA=function(D,G){var K=this.frameInfo(D),ae=K.width*K.height,Z=new Uint8Array(ae);Wk(e,K.data_offset,Z,ae);var oe=K.palette_offset,Y=K.transparent_index;Y===null&&(Y=256);var R=K.width,z=r-R,ee=R,b=4*(K.y*r+K.x),O=4*((K.y+K.height)*r+K.x),S=b,I=4*z;K.interlaced===!0&&(I+=4*r*7);for(var U=8,Q=0,H=Z.length;Q<H;++Q){var X=Z[Q];if(ee===0&&(ee=R,(S+=I)>=O&&(I=4*z+4*r*(U-1),S=b+(R+z)*(U<<1),U>>=1)),X===Y)S+=4;else{var V=e[oe+3*X],Ae=e[oe+3*X+1],W=e[oe+3*X+2];G[S++]=W,G[S++]=Ae,G[S++]=V,G[S++]=255}--ee}},this.decodeAndBlitFrameRGBA=function(D,G){var K=this.frameInfo(D),ae=K.width*K.height,Z=new Uint8Array(ae);Wk(e,K.data_offset,Z,ae);var oe=K.palette_offset,Y=K.transparent_index;Y===null&&(Y=256);var R=K.width,z=r-R,ee=R,b=4*(K.y*r+K.x),O=4*((K.y+K.height)*r+K.x),S=b,I=4*z;K.interlaced===!0&&(I+=4*r*7);for(var U=8,Q=0,H=Z.length;Q<H;++Q){var X=Z[Q];if(ee===0&&(ee=R,(S+=I)>=O&&(I=4*z+4*r*(U-1),S=b+(R+z)*(U<<1),U>>=1)),X===Y)S+=4;else{var V=e[oe+3*X],Ae=e[oe+3*X+1],W=e[oe+3*X+2];G[S++]=V,G[S++]=Ae,G[S++]=W,G[S++]=255}--ee}}}function Wk(e,t,r,n){for(var s=e[t++],i=1<<s,o=i+1,l=o+1,c=s+1,A=(1<<c)-1,d=0,u=0,f=0,h=e[t++],x=new Int32Array(4096),m=null;;){for(;d<16&&h!==0;)u|=e[t++]<<d,d+=8,h===1?h=e[t++]:--h;if(d<c)break;var g=u&A;if(u>>=c,d-=c,g!==i){if(g===o)break;for(var p=g<l?g:m,v=0,w=p;w>i;)w=x[w]>>8,++v;var B=w;if(f+v+(p!==g?1:0)>n)return void dn.log("Warning, gif stream longer than expected.");r[f++]=B;var T=f+=v;for(p!==g&&(r[f++]=B),w=p;v--;)w=x[w],r[--T]=255&w,w>>=8;m!==null&&l<4096&&(x[l++]=m<<8|B,l>=A+1&&c<12&&(++c,A=A<<1|1)),m=g}else l=o+1,A=(1<<(c=s+1))-1,m=null}return f!==n&&dn.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function yb(e){var t,r,n,s,i,o=Math.floor,l=new Array(64),c=new Array(64),A=new Array(64),d=new Array(64),u=new Array(65535),f=new Array(65535),h=new Array(64),x=new Array(64),m=[],g=0,p=7,v=new Array(64),w=new Array(64),B=new Array(64),T=new Array(256),_=new Array(2048),j=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],E=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],L=[0,1,2,3,4,5,6,7,8,9,10,11],M=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],F=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],D=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],G=[0,1,2,3,4,5,6,7,8,9,10,11],K=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ae=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Z(b,O){for(var S=0,I=0,U=new Array,Q=1;Q<=16;Q++){for(var H=1;H<=b[Q];H++)U[O[I]]=[],U[O[I]][0]=S,U[O[I]][1]=Q,I++,S++;S*=2}return U}function oe(b){for(var O=b[0],S=b[1]-1;S>=0;)O&1<<S&&(g|=1<<p),S--,--p<0&&(g==255?(Y(255),Y(0)):Y(g),p=7,g=0)}function Y(b){m.push(b)}function R(b){Y(b>>8&255),Y(255&b)}function z(b,O,S,I,U){for(var Q,H=U[0],X=U[240],V=function(He,Ze){var xe,ue,Fe,ke,Te,Ne,et,Se,Ce,Be,Pe=0;for(Ce=0;Ce<8;++Ce){xe=He[Pe],ue=He[Pe+1],Fe=He[Pe+2],ke=He[Pe+3],Te=He[Pe+4],Ne=He[Pe+5],et=He[Pe+6];var Bt=xe+(Se=He[Pe+7]),tt=xe-Se,Ot=ue+et,vt=ue-et,Vt=Fe+Ne,pr=Fe-Ne,$t=ke+Te,Qr=ke-Te,ir=Bt+$t,Gr=Bt-$t,un=Ot+Vt,Nr=Ot-Vt;He[Pe]=ir+un,He[Pe+4]=ir-un;var Wt=.707106781*(Nr+Gr);He[Pe+2]=Gr+Wt,He[Pe+6]=Gr-Wt;var lt=.382683433*((ir=Qr+pr)-(Nr=vt+tt)),Et=.5411961*ir+lt,It=1.306562965*Nr+lt,Ee=.707106781*(un=pr+vt),Oe=tt+Ee,Re=tt-Ee;He[Pe+5]=Re+Et,He[Pe+3]=Re-Et,He[Pe+1]=Oe+It,He[Pe+7]=Oe-It,Pe+=8}for(Pe=0,Ce=0;Ce<8;++Ce){xe=He[Pe],ue=He[Pe+8],Fe=He[Pe+16],ke=He[Pe+24],Te=He[Pe+32],Ne=He[Pe+40],et=He[Pe+48];var Ye=xe+(Se=He[Pe+56]),ft=xe-Se,mt=ue+et,qt=ue-et,Nt=Fe+Ne,se=Fe-Ne,pe=ke+Te,he=ke-Te,me=Ye+pe,ge=Ye-pe,we=mt+Nt,ze=mt-Nt;He[Pe]=me+we,He[Pe+32]=me-we;var rt=.707106781*(ze+ge);He[Pe+16]=ge+rt,He[Pe+48]=ge-rt;var $e=.382683433*((me=he+se)-(ze=qt+ft)),Xe=.5411961*me+$e,Je=1.306562965*ze+$e,gt=.707106781*(we=se+qt),Ct=ft+gt,Ut=ft-gt;He[Pe+40]=Ut+Xe,He[Pe+24]=Ut-Xe,He[Pe+8]=Ct+Je,He[Pe+56]=Ct-Je,Pe++}for(Ce=0;Ce<64;++Ce)Be=He[Ce]*Ze[Ce],h[Ce]=Be>0?Be+.5|0:Be-.5|0;return h}(b,O),Ae=0;Ae<64;++Ae)x[j[Ae]]=V[Ae];var W=x[0]-S;S=x[0],W==0?oe(I[0]):(oe(I[f[Q=32767+W]]),oe(u[Q]));for(var J=63;J>0&&x[J]==0;)J--;if(J==0)return oe(H),S;for(var ve,de=1;de<=J;){for(var te=de;x[de]==0&&de<=J;)++de;var je=de-te;if(je>=16){ve=je>>4;for(var qe=1;qe<=ve;++qe)oe(X);je&=15}Q=32767+x[de],oe(U[(je<<4)+f[Q]]),oe(u[Q]),de++}return J!=63&&oe(H),S}function ee(b){b=Math.min(Math.max(b,1),100),i!=b&&(function(O){for(var S=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],I=0;I<64;I++){var U=o((S[I]*O+50)/100);U=Math.min(Math.max(U,1),255),l[j[I]]=U}for(var Q=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],H=0;H<64;H++){var X=o((Q[H]*O+50)/100);X=Math.min(Math.max(X,1),255),c[j[H]]=X}for(var V=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ae=0,W=0;W<8;W++)for(var J=0;J<8;J++)A[Ae]=1/(l[j[Ae]]*V[W]*V[J]*8),d[Ae]=1/(c[j[Ae]]*V[W]*V[J]*8),Ae++}(b<50?Math.floor(5e3/b):Math.floor(200-2*b)),i=b)}this.encode=function(b,O){O&&ee(O),m=new Array,g=0,p=7,R(65496),R(65504),R(16),Y(74),Y(70),Y(73),Y(70),Y(0),Y(1),Y(1),Y(0),R(1),R(1),Y(0),Y(0),function(){R(65499),R(132),Y(0);for(var ue=0;ue<64;ue++)Y(l[ue]);Y(1);for(var Fe=0;Fe<64;Fe++)Y(c[Fe])}(),function(ue,Fe){R(65472),R(17),Y(8),R(Fe),R(ue),Y(3),Y(1),Y(17),Y(0),Y(2),Y(17),Y(1),Y(3),Y(17),Y(1)}(b.width,b.height),function(){R(65476),R(418),Y(0);for(var ue=0;ue<16;ue++)Y(E[ue+1]);for(var Fe=0;Fe<=11;Fe++)Y(L[Fe]);Y(16);for(var ke=0;ke<16;ke++)Y(M[ke+1]);for(var Te=0;Te<=161;Te++)Y(F[Te]);Y(1);for(var Ne=0;Ne<16;Ne++)Y(D[Ne+1]);for(var et=0;et<=11;et++)Y(G[et]);Y(17);for(var Se=0;Se<16;Se++)Y(K[Se+1]);for(var Ce=0;Ce<=161;Ce++)Y(ae[Ce])}(),R(65498),R(12),Y(3),Y(1),Y(0),Y(2),Y(17),Y(3),Y(17),Y(0),Y(63),Y(0);var S=0,I=0,U=0;g=0,p=7,this.encode.displayName="_encode_";for(var Q,H,X,V,Ae,W,J,ve,de,te=b.data,je=b.width,qe=b.height,He=4*je,Ze=0;Ze<qe;){for(Q=0;Q<He;){for(Ae=He*Ze+Q,J=-1,ve=0,de=0;de<64;de++)W=Ae+(ve=de>>3)*He+(J=4*(7&de)),Ze+ve>=qe&&(W-=He*(Ze+1+ve-qe)),Q+J>=He&&(W-=Q+J-He+4),H=te[W++],X=te[W++],V=te[W++],v[de]=(_[H]+_[X+256>>0]+_[V+512>>0]>>16)-128,w[de]=(_[H+768>>0]+_[X+1024>>0]+_[V+1280>>0]>>16)-128,B[de]=(_[H+1280>>0]+_[X+1536>>0]+_[V+1792>>0]>>16)-128;S=z(v,A,S,t,n),I=z(w,d,I,r,s),U=z(B,d,U,r,s),Q+=32}Ze+=8}if(p>=0){var xe=[];xe[1]=p+1,xe[0]=(1<<p+1)-1,oe(xe)}return R(65497),new Uint8Array(m)},e=e||50,function(){for(var b=String.fromCharCode,O=0;O<256;O++)T[O]=b(O)}(),t=Z(E,L),r=Z(D,G),n=Z(M,F),s=Z(K,ae),function(){for(var b=1,O=2,S=1;S<=15;S++){for(var I=b;I<O;I++)f[32767+I]=S,u[32767+I]=[],u[32767+I][1]=S,u[32767+I][0]=I;for(var U=-(O-1);U<=-b;U++)f[32767+U]=S,u[32767+U]=[],u[32767+U][1]=S,u[32767+U][0]=O-1+U;b<<=1,O<<=1}}(),function(){for(var b=0;b<256;b++)_[b]=19595*b,_[b+256>>0]=38470*b,_[b+512>>0]=7471*b+32768,_[b+768>>0]=-11059*b,_[b+1024>>0]=-21709*b,_[b+1280>>0]=32768*b+8421375,_[b+1536>>0]=-27439*b,_[b+1792>>0]=-5329*b}(),ee(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function ko(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Xk(e){function t(E){if(!E)throw Error("assert :P")}function r(E,L,M){for(var F=0;4>F;F++)if(E[L+F]!=M.charCodeAt(F))return!0;return!1}function n(E,L,M,F,D){for(var G=0;G<D;G++)E[L+G]=M[F+G]}function s(E,L,M,F){for(var D=0;D<F;D++)E[L+D]=M}function i(E){return new Int32Array(E)}function o(E,L){for(var M=[],F=0;F<E;F++)M.push(new L);return M}function l(E,L){var M=[];return function F(D,G,K){for(var ae=K[G],Z=0;Z<ae&&(D.push(K.length>G+1?[]:new L),!(K.length<G+1));Z++)F(D[Z],G+1,K)}(M,0,E),M}var c=function(){var E=this;function L(y,N){for(var P=1<<N-1>>>0;y&P;)P>>>=1;return P?(y&P-1)+P:y}function M(y,N,P,q,re){t(!(q%P));do y[N+(q-=P)]=re;while(0<q)}function F(y,N,P,q,re){if(t(2328>=re),512>=re)var ie=i(512);else if((ie=i(re))==null)return 0;return function(le,ce,fe,ye,Ue,Ge){var We,Me,ht=ce,nt=1<<fe,De=i(16),Qe=i(16);for(t(Ue!=0),t(ye!=null),t(le!=null),t(0<fe),Me=0;Me<Ue;++Me){if(15<ye[Me])return 0;++De[ye[Me]]}if(De[0]==Ue)return 0;for(Qe[1]=0,We=1;15>We;++We){if(De[We]>1<<We)return 0;Qe[We+1]=Qe[We]+De[We]}for(Me=0;Me<Ue;++Me)We=ye[Me],0<ye[Me]&&(Ge[Qe[We]++]=Me);if(Qe[15]==1)return(ye=new D).g=0,ye.value=Ge[0],M(le,ht,1,nt,ye),nt;var At,xt=-1,ut=nt-1,Mt=0,_t=1,tr=1,Dt=1<<fe;for(Me=0,We=1,Ue=2;We<=fe;++We,Ue<<=1){if(_t+=tr<<=1,0>(tr-=De[We]))return 0;for(;0<De[We];--De[We])(ye=new D).g=We,ye.value=Ge[Me++],M(le,ht+Mt,Ue,Dt,ye),Mt=L(Mt,We)}for(We=fe+1,Ue=2;15>=We;++We,Ue<<=1){if(_t+=tr<<=1,0>(tr-=De[We]))return 0;for(;0<De[We];--De[We]){if(ye=new D,(Mt&ut)!=xt){for(ht+=Dt,At=1<<(xt=We)-fe;15>xt&&!(0>=(At-=De[xt]));)++xt,At<<=1;nt+=Dt=1<<(At=xt-fe),le[ce+(xt=Mt&ut)].g=At+fe,le[ce+xt].value=ht-ce-xt}ye.g=We-fe,ye.value=Ge[Me++],M(le,ht+(Mt>>fe),Ue,Dt,ye),Mt=L(Mt,We)}}return _t!=2*Qe[15]-1?0:nt}(y,N,P,q,re,ie)}function D(){this.value=this.g=0}function G(){this.value=this.g=0}function K(){this.G=o(5,D),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Rs,G)}function ae(y,N,P,q){t(y!=null),t(N!=null),t(2147483648>q),y.Ca=254,y.I=0,y.b=-8,y.Ka=0,y.oa=N,y.pa=P,y.Jd=N,y.Yc=P+q,y.Zc=4<=q?P+q-4+1:P,Q(y)}function Z(y,N){for(var P=0;0<N--;)P|=X(y,128)<<N;return P}function oe(y,N){var P=Z(y,N);return H(y)?-P:P}function Y(y,N,P,q){var re,ie=0;for(t(y!=null),t(N!=null),t(4294967288>q),y.Sb=q,y.Ra=0,y.u=0,y.h=0,4<q&&(q=4),re=0;re<q;++re)ie+=N[P+re]<<8*re;y.Ra=ie,y.bb=q,y.oa=N,y.pa=P}function R(y){for(;8<=y.u&&y.bb<y.Sb;)y.Ra>>>=8,y.Ra+=y.oa[y.pa+y.bb]<<fu-8>>>0,++y.bb,y.u-=8;S(y)&&(y.h=1,y.u=0)}function z(y,N){if(t(0<=N),!y.h&&N<=uu){var P=O(y)&du[N];return y.u+=N,R(y),P}return y.h=1,y.u=0}function ee(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function b(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function O(y){return y.Ra>>>(y.u&fu-1)>>>0}function S(y){return t(y.bb<=y.Sb),y.h||y.bb==y.Sb&&y.u>fu}function I(y,N){y.u=N,y.h=S(y)}function U(y){y.u>=S0&&(t(y.u>=S0),R(y))}function Q(y){t(y!=null&&y.oa!=null),y.pa<y.Zc?(y.I=(y.oa[y.pa++]|y.I<<8)>>>0,y.b+=8):(t(y!=null&&y.oa!=null),y.pa<y.Yc?(y.b+=8,y.I=y.oa[y.pa++]|y.I<<8):y.Ka?y.b=0:(y.I<<=8,y.b+=8,y.Ka=1))}function H(y){return Z(y,1)}function X(y,N){var P=y.Ca;0>y.b&&Q(y);var q=y.b,re=P*N>>>8,ie=(y.I>>>q>re)+0;for(ie?(P-=re,y.I-=re+1<<q>>>0):P=re+1,q=P,re=0;256<=q;)re+=8,q>>=8;return q=7^re+Oa[q],y.b-=q,y.Ca=(P<<q)-1,ie}function V(y,N,P){y[N+0]=P>>24&255,y[N+1]=P>>16&255,y[N+2]=P>>8&255,y[N+3]=P>>0&255}function Ae(y,N){return y[N+0]<<0|y[N+1]<<8}function W(y,N){return Ae(y,N)|y[N+2]<<16}function J(y,N){return Ae(y,N)|Ae(y,N+2)<<16}function ve(y,N){var P=1<<N;return t(y!=null),t(0<N),y.X=i(P),y.X==null?0:(y.Mb=32-N,y.Xa=N,1)}function de(y,N){t(y!=null),t(N!=null),t(y.Xa==N.Xa),n(N.X,0,y.X,0,1<<N.Xa)}function te(){this.X=[],this.Xa=this.Mb=0}function je(y,N,P,q){t(P!=null),t(q!=null);var re=P[0],ie=q[0];return re==0&&(re=(y*ie+N/2)/N),ie==0&&(ie=(N*re+y/2)/y),0>=re||0>=ie?0:(P[0]=re,q[0]=ie,1)}function qe(y,N){return y+(1<<N)-1>>>N}function He(y,N){return((4278255360&y)+(4278255360&N)>>>0&4278255360)+((16711935&y)+(16711935&N)>>>0&16711935)>>>0}function Ze(y,N){E[N]=function(P,q,re,ie,le,ce,fe){var ye;for(ye=0;ye<le;++ye){var Ue=E[y](ce[fe+ye-1],re,ie+ye);ce[fe+ye]=He(P[q+ye],Ue)}}}function xe(){this.ud=this.hd=this.jd=0}function ue(y,N){return((4278124286&(y^N))>>>1)+(y&N)>>>0}function Fe(y){return 0<=y&&256>y?y:0>y?0:255<y?255:void 0}function ke(y,N){return Fe(y+(y-N+.5>>1))}function Te(y,N,P){return Math.abs(N-P)-Math.abs(y-P)}function Ne(y,N,P,q,re,ie,le){for(q=ie[le-1],P=0;P<re;++P)ie[le+P]=q=He(y[N+P],q)}function et(y,N,P,q,re){var ie;for(ie=0;ie<P;++ie){var le=y[N+ie],ce=le>>8&255,fe=16711935&(fe=(fe=16711935&le)+((ce<<16)+ce));q[re+ie]=(4278255360&le)+fe>>>0}}function Se(y,N){N.jd=y>>0&255,N.hd=y>>8&255,N.ud=y>>16&255}function Ce(y,N,P,q,re,ie){var le;for(le=0;le<q;++le){var ce=N[P+le],fe=ce>>>8,ye=ce,Ue=255&(Ue=(Ue=ce>>>16)+((y.jd<<24>>24)*(fe<<24>>24)>>>5));ye=255&(ye=(ye=ye+((y.hd<<24>>24)*(fe<<24>>24)>>>5))+((y.ud<<24>>24)*(Ue<<24>>24)>>>5)),re[ie+le]=(4278255360&ce)+(Ue<<16)+ye}}function Be(y,N,P,q,re){E[N]=function(ie,le,ce,fe,ye,Ue,Ge,We,Me){for(fe=Ge;fe<We;++fe)for(Ge=0;Ge<Me;++Ge)ye[Ue++]=re(ce[q(ie[le++])])},E[y]=function(ie,le,ce,fe,ye,Ue,Ge){var We=8>>ie.b,Me=ie.Ea,ht=ie.K[0],nt=ie.w;if(8>We)for(ie=(1<<ie.b)-1,nt=(1<<We)-1;le<ce;++le){var De,Qe=0;for(De=0;De<Me;++De)De&ie||(Qe=q(fe[ye++])),Ue[Ge++]=re(ht[Qe&nt]),Qe>>=We}else E["VP8LMapColor"+P](fe,ye,ht,nt,Ue,Ge,le,ce,Me)}}function Pe(y,N,P,q,re){for(P=N+P;N<P;){var ie=y[N++];q[re++]=ie>>16&255,q[re++]=ie>>8&255,q[re++]=ie>>0&255}}function Bt(y,N,P,q,re){for(P=N+P;N<P;){var ie=y[N++];q[re++]=ie>>16&255,q[re++]=ie>>8&255,q[re++]=ie>>0&255,q[re++]=ie>>24&255}}function tt(y,N,P,q,re){for(P=N+P;N<P;){var ie=(le=y[N++])>>16&240|le>>12&15,le=le>>0&240|le>>28&15;q[re++]=ie,q[re++]=le}}function Ot(y,N,P,q,re){for(P=N+P;N<P;){var ie=(le=y[N++])>>16&248|le>>13&7,le=le>>5&224|le>>3&31;q[re++]=ie,q[re++]=le}}function vt(y,N,P,q,re){for(P=N+P;N<P;){var ie=y[N++];q[re++]=ie>>0&255,q[re++]=ie>>8&255,q[re++]=ie>>16&255}}function Vt(y,N,P,q,re,ie){if(ie==0)for(P=N+P;N<P;)V(q,((ie=y[N++])[0]>>24|ie[1]>>8&65280|ie[2]<<8&16711680|ie[3]<<24)>>>0),re+=32;else n(q,re,y,N,P)}function pr(y,N){E[N][0]=E[y+"0"],E[N][1]=E[y+"1"],E[N][2]=E[y+"2"],E[N][3]=E[y+"3"],E[N][4]=E[y+"4"],E[N][5]=E[y+"5"],E[N][6]=E[y+"6"],E[N][7]=E[y+"7"],E[N][8]=E[y+"8"],E[N][9]=E[y+"9"],E[N][10]=E[y+"10"],E[N][11]=E[y+"11"],E[N][12]=E[y+"12"],E[N][13]=E[y+"13"],E[N][14]=E[y+"0"],E[N][15]=E[y+"0"]}function $t(y){return y==w2||y==b2||y==$p||y==N2}function Qr(){this.eb=[],this.size=this.A=this.fb=0}function ir(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Gr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Qr,this.f.kb=new ir,this.sd=null}function un(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Nr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Wt(y){return alert("todo:WebPSamplerProcessPlane"),y.T}function lt(y,N){var P=y.T,q=N.ba.f.RGBA,re=q.eb,ie=q.fb+y.ka*q.A,le=$i[N.ba.S],ce=y.y,fe=y.O,ye=y.f,Ue=y.N,Ge=y.ea,We=y.W,Me=N.cc,ht=N.dc,nt=N.Mc,De=N.Nc,Qe=y.ka,At=y.ka+y.T,xt=y.U,ut=xt+1>>1;for(Qe==0?le(ce,fe,null,null,ye,Ue,Ge,We,ye,Ue,Ge,We,re,ie,null,null,xt):(le(N.ec,N.fc,ce,fe,Me,ht,nt,De,ye,Ue,Ge,We,re,ie-q.A,re,ie,xt),++P);Qe+2<At;Qe+=2)Me=ye,ht=Ue,nt=Ge,De=We,Ue+=y.Rc,We+=y.Rc,ie+=2*q.A,le(ce,(fe+=2*y.fa)-y.fa,ce,fe,Me,ht,nt,De,ye,Ue,Ge,We,re,ie-q.A,re,ie,xt);return fe+=y.fa,y.j+At<y.o?(n(N.ec,N.fc,ce,fe,xt),n(N.cc,N.dc,ye,Ue,ut),n(N.Mc,N.Nc,Ge,We,ut),P--):1&At||le(ce,fe,null,null,ye,Ue,Ge,We,ye,Ue,Ge,We,re,ie+q.A,null,null,xt),P}function Et(y,N,P){var q=y.F,re=[y.J];if(q!=null){var ie=y.U,le=N.ba.S,ce=le==Vp||le==$p;N=N.ba.f.RGBA;var fe=[0],ye=y.ka;fe[0]=y.T,y.Kb&&(ye==0?--fe[0]:(--ye,re[0]-=y.width),y.j+y.ka+y.T==y.o&&(fe[0]=y.o-y.j-ye));var Ue=N.eb;ye=N.fb+ye*N.A,y=mn(q,re[0],y.width,ie,fe,Ue,ye+(ce?0:3),N.A),t(P==fe),y&&$t(le)&&Hi(Ue,ye,ce,ie,fe,N.A)}return 0}function It(y){var N=y.ma,P=N.ba.S,q=11>P,re=P==Mp||P==Hp||P==Vp||P==v2||P==12||$t(P);if(N.memory=null,N.Ib=null,N.Jb=null,N.Nd=null,!j0(N.Oa,y,re?11:12))return 0;if(re&&$t(P)&&yt(),y.da)alert("todo:use_scaling");else{if(q){if(N.Ib=Wt,y.Kb){if(P=y.U+1>>1,N.memory=i(y.U+2*P),N.memory==null)return 0;N.ec=N.memory,N.fc=0,N.cc=N.ec,N.dc=N.fc+y.U,N.Mc=N.cc,N.Nc=N.dc+P,N.Ib=lt,yt()}}else alert("todo:EmitYUV");re&&(N.Jb=Et,q&&Ve())}if(q&&!rB){for(y=0;256>y;++y)_7[y]=89858*(y-128)+Kp>>qp,U7[y]=-22014*(y-128)+Kp,L7[y]=-45773*(y-128),I7[y]=113618*(y-128)+Kp>>qp;for(y=L0;y<B2;++y)N=76283*(y-16)+Kp>>qp,D7[y-L0]=ci(N,255),P7[y-L0]=ci(N+8>>4,15);rB=1}return 1}function Ee(y){var N=y.ma,P=y.U,q=y.T;return t(!(1&y.ka)),0>=P||0>=q?0:(P=N.Ib(y,N),N.Jb!=null&&N.Jb(y,N,P),N.Dc+=P,1)}function Oe(y){y.ma.memory=null}function Re(y,N,P,q){return z(y,8)!=47?0:(N[0]=z(y,14)+1,P[0]=z(y,14)+1,q[0]=z(y,1),z(y,3)!=0?0:!y.h)}function Ye(y,N){if(4>y)return y+1;var P=y-2>>1;return(2+(1&y)<<P)+z(N,P)+1}function ft(y,N){return 120<N?N-120:1<=(P=((P=g7[N-1])>>4)*y+(8-(15&P)))?P:1;var P}function mt(y,N,P){var q=O(P),re=y[N+=255&q].g-8;return 0<re&&(I(P,P.u+8),q=O(P),N+=y[N].value,N+=q&(1<<re)-1),I(P,P.u+y[N].g),y[N].value}function qt(y,N,P){return P.g+=y.g,P.value+=y.value<<N>>>0,t(8>=P.g),y.g}function Nt(y,N,P){var q=y.xc;return t((N=q==0?0:y.vc[y.md*(P>>q)+(N>>q)])<y.Wb),y.Ya[N]}function se(y,N,P,q){var re=y.ab,ie=y.c*N,le=y.C;N=le+N;var ce=P,fe=q;for(q=y.Ta,P=y.Ua;0<re--;){var ye=y.gc[re],Ue=le,Ge=N,We=ce,Me=fe,ht=(fe=q,ce=P,ye.Ea);switch(t(Ue<Ge),t(Ge<=ye.nc),ye.hc){case 2:Lp(We,Me,(Ge-Ue)*ht,fe,ce);break;case 0:var nt=Ue,De=Ge,Qe=fe,At=ce,xt=(Dt=ye).Ea;nt==0&&(g2(We,Me,null,null,1,Qe,At),Ne(We,Me+1,0,0,xt-1,Qe,At+1),Me+=xt,At+=xt,++nt);for(var ut=1<<Dt.b,Mt=ut-1,_t=qe(xt,Dt.b),tr=Dt.K,Dt=Dt.w+(nt>>Dt.b)*_t;nt<De;){var qr=tr,Jr=Dt,Dr=1;for(F0(We,Me,Qe,At-xt,1,Qe,At);Dr<xt;){var Er=(Dr&~Mt)+ut;Er>xt&&(Er=xt),(0,Nc[qr[Jr++]>>8&15])(We,Me+ +Dr,Qe,At+Dr-xt,Er-Dr,Qe,At+Dr),Dr=Er}Me+=xt,At+=xt,++nt&Mt||(Dt+=_t)}Ge!=ye.nc&&n(fe,ce-ht,fe,ce+(Ge-Ue-1)*ht,ht);break;case 1:for(ht=We,De=Me,xt=(We=ye.Ea)-(At=We&~(Qe=(Me=1<<ye.b)-1)),nt=qe(We,ye.b),ut=ye.K,ye=ye.w+(Ue>>ye.b)*nt;Ue<Ge;){for(Mt=ut,_t=ye,tr=new xe,Dt=De+At,qr=De+We;De<Dt;)Se(Mt[_t++],tr),OA(tr,ht,De,Me,fe,ce),De+=Me,ce+=Me;De<qr&&(Se(Mt[_t++],tr),OA(tr,ht,De,xt,fe,ce),De+=xt,ce+=xt),++Ue&Qe||(ye+=nt)}break;case 3:if(We==fe&&Me==ce&&0<ye.b){for(De=fe,We=ht=ce+(Ge-Ue)*ht-(At=(Ge-Ue)*qe(ye.Ea,ye.b)),Me=fe,Qe=ce,nt=[],At=(xt=At)-1;0<=At;--At)nt[At]=Me[Qe+At];for(At=xt-1;0<=At;--At)De[We+At]=nt[At];Ri(ye,Ue,Ge,fe,ht,fe,ce)}else Ri(ye,Ue,Ge,We,Me,fe,ce)}ce=q,fe=P}fe!=P&&n(q,P,ce,fe,ie)}function pe(y,N){var P=y.V,q=y.Ba+y.c*y.C,re=N-y.C;if(t(N<=y.l.o),t(16>=re),0<re){var ie=y.l,le=y.Ta,ce=y.Ua,fe=ie.width;if(se(y,re,P,q),re=ce=[ce],t((P=y.C)<(q=N)),t(ie.v<ie.va),q>ie.o&&(q=ie.o),P<ie.j){var ye=ie.j-P;P=ie.j,re[0]+=ye*fe}if(P>=q?P=0:(re[0]+=4*ie.v,ie.ka=P-ie.j,ie.U=ie.va-ie.v,ie.T=q-P,P=1),P){if(ce=ce[0],11>(P=y.ca).S){var Ue=P.f.RGBA,Ge=(q=P.S,re=ie.U,ie=ie.T,ye=Ue.eb,Ue.A),We=ie;for(Ue=Ue.fb+y.Ma*Ue.A;0<We--;){var Me=le,ht=ce,nt=re,De=ye,Qe=Ue;switch(q){case Qp:Ra(Me,ht,nt,De,Qe);break;case Mp:Na(Me,ht,nt,De,Qe);break;case w2:Na(Me,ht,nt,De,Qe),Hi(De,Qe,0,nt,1,0);break;case Kj:_l(Me,ht,nt,De,Qe);break;case Hp:Vt(Me,ht,nt,De,Qe,1);break;case b2:Vt(Me,ht,nt,De,Qe,1),Hi(De,Qe,0,nt,1,0);break;case Vp:Vt(Me,ht,nt,De,Qe,0);break;case $p:Vt(Me,ht,nt,De,Qe,0),Hi(De,Qe,1,nt,1,0);break;case v2:Cc(Me,ht,nt,De,Qe);break;case N2:Cc(Me,ht,nt,De,Qe),hn(De,Qe,nt,1,0);break;case zj:Tl(Me,ht,nt,De,Qe);break;default:t(0)}ce+=fe,Ue+=Ge}y.Ma+=ie}else alert("todo:EmitRescaledRowsYUVA");t(y.Ma<=P.height)}}y.C=N,t(y.C<=y.i)}function he(y){var N;if(0<y.ua)return 0;for(N=0;N<y.Wb;++N){var P=y.Ya[N].G,q=y.Ya[N].H;if(0<P[1][q[1]+0].g||0<P[2][q[2]+0].g||0<P[3][q[3]+0].g)return 0}return 1}function me(y,N,P,q,re,ie){if(y.Z!=0){var le=y.qd,ce=y.rd;for(t(Fc[y.Z]!=null);N<P;++N)Fc[y.Z](le,ce,q,re,q,re,ie),le=q,ce=re,re+=ie;y.qd=le,y.rd=ce}}function ge(y,N){var P=y.l.ma,q=P.Z==0||P.Z==1?y.l.j:y.C;if(q=y.C<q?q:y.C,t(N<=y.l.o),N>q){var re=y.l.width,ie=P.ca,le=P.tb+re*q,ce=y.V,fe=y.Ba+y.c*q,ye=y.gc;t(y.ab==1),t(ye[0].hc==3),Up(ye[0],q,N,ce,fe,ie,le),me(P,q,N,ie,le,re)}y.C=y.Ma=N}function we(y,N,P,q,re,ie,le){var ce=y.$/q,fe=y.$%q,ye=y.m,Ue=y.s,Ge=P+y.$,We=Ge;re=P+q*re;var Me=P+q*ie,ht=280+Ue.ua,nt=y.Pb?ce:16777216,De=0<Ue.ua?Ue.Wa:null,Qe=Ue.wc,At=Ge<Me?Nt(Ue,fe,ce):null;t(y.C<ie),t(Me<=re);var xt=!1;e:for(;;){for(;xt||Ge<Me;){var ut=0;if(ce>=nt){var Mt=Ge-P;t((nt=y).Pb),nt.wd=nt.m,nt.xd=Mt,0<nt.s.ua&&de(nt.s.Wa,nt.s.vb),nt=ce+v7}if(fe&Qe||(At=Nt(Ue,fe,ce)),t(At!=null),At.Qb&&(N[Ge]=At.qb,xt=!0),!xt)if(U(ye),At.jc){ut=ye,Mt=N;var _t=Ge,tr=At.pd[O(ut)&Rs-1];t(At.jc),256>tr.g?(I(ut,ut.u+tr.g),Mt[_t]=tr.value,ut=0):(I(ut,ut.u+tr.g-256),t(256<=tr.value),ut=tr.value),ut==0&&(xt=!0)}else ut=mt(At.G[0],At.H[0],ye);if(ye.h)break;if(xt||256>ut){if(!xt)if(At.nd)N[Ge]=(At.qb|ut<<8)>>>0;else{if(U(ye),xt=mt(At.G[1],At.H[1],ye),U(ye),Mt=mt(At.G[2],At.H[2],ye),_t=mt(At.G[3],At.H[3],ye),ye.h)break;N[Ge]=(_t<<24|xt<<16|ut<<8|Mt)>>>0}if(xt=!1,++Ge,++fe>=q&&(fe=0,++ce,le!=null&&ce<=ie&&!(ce%16)&&le(y,ce),De!=null))for(;We<Ge;)ut=N[We++],De.X[(506832829*ut&4294967295)>>>De.Mb]=ut}else if(280>ut){if(ut=Ye(ut-256,ye),Mt=mt(At.G[4],At.H[4],ye),U(ye),Mt=ft(q,Mt=Ye(Mt,ye)),ye.h)break;if(Ge-P<Mt||re-Ge<ut)break e;for(_t=0;_t<ut;++_t)N[Ge+_t]=N[Ge+_t-Mt];for(Ge+=ut,fe+=ut;fe>=q;)fe-=q,++ce,le!=null&&ce<=ie&&!(ce%16)&&le(y,ce);if(t(Ge<=re),fe&Qe&&(At=Nt(Ue,fe,ce)),De!=null)for(;We<Ge;)ut=N[We++],De.X[(506832829*ut&4294967295)>>>De.Mb]=ut}else{if(!(ut<ht))break e;for(xt=ut-280,t(De!=null);We<Ge;)ut=N[We++],De.X[(506832829*ut&4294967295)>>>De.Mb]=ut;ut=Ge,t(!(xt>>>(Mt=De).Xa)),N[ut]=Mt.X[xt],xt=!0}xt||t(ye.h==S(ye))}if(y.Pb&&ye.h&&Ge<re)t(y.m.h),y.a=5,y.m=y.wd,y.$=y.xd,0<y.s.ua&&de(y.s.vb,y.s.Wa);else{if(ye.h)break e;le!=null&&le(y,ce>ie?ie:ce),y.a=0,y.$=Ge-P}return 1}return y.a=3,0}function ze(y){t(y!=null),y.vc=null,y.yc=null,y.Ya=null;var N=y.Wa;N!=null&&(N.X=null),y.vb=null,t(y!=null)}function rt(){var y=new x2;return y==null?null:(y.a=0,y.xb=Xj,pr("Predictor","VP8LPredictors"),pr("Predictor","VP8LPredictors_C"),pr("PredictorAdd","VP8LPredictorsAdd"),pr("PredictorAdd","VP8LPredictorsAdd_C"),Lp=et,OA=Ce,Ra=Pe,Na=Bt,Cc=tt,Tl=Ot,_l=vt,E.VP8LMapColor32b=hu,E.VP8LMapColor8b=Dp,y)}function $e(y,N,P,q,re){var ie=1,le=[y],ce=[N],fe=q.m,ye=q.s,Ue=null,Ge=0;e:for(;;){if(P)for(;ie&&z(fe,1);){var We=le,Me=ce,ht=q,nt=1,De=ht.m,Qe=ht.gc[ht.ab],At=z(De,2);if(ht.Oc&1<<At)ie=0;else{switch(ht.Oc|=1<<At,Qe.hc=At,Qe.Ea=We[0],Qe.nc=Me[0],Qe.K=[null],++ht.ab,t(4>=ht.ab),At){case 0:case 1:Qe.b=z(De,3)+2,nt=$e(qe(Qe.Ea,Qe.b),qe(Qe.nc,Qe.b),0,ht,Qe.K),Qe.K=Qe.K[0];break;case 3:var xt,ut=z(De,8)+1,Mt=16<ut?0:4<ut?1:2<ut?2:3;if(We[0]=qe(Qe.Ea,Mt),Qe.b=Mt,xt=nt=$e(ut,1,0,ht,Qe.K)){var _t,tr=ut,Dt=Qe,qr=1<<(8>>Dt.b),Jr=i(qr);if(Jr==null)xt=0;else{var Dr=Dt.K[0],Er=Dt.w;for(Jr[0]=Dt.K[0][0],_t=1;_t<1*tr;++_t)Jr[_t]=He(Dr[Er+_t],Jr[_t-1]);for(;_t<4*qr;++_t)Jr[_t]=0;Dt.K[0]=null,Dt.K[0]=Jr,xt=1}}nt=xt;break;case 2:break;default:t(0)}ie=nt}}if(le=le[0],ce=ce[0],ie&&z(fe,1)&&!(ie=1<=(Ge=z(fe,4))&&11>=Ge)){q.a=3;break e}var An;if(An=ie)t:{var on,yr,As,Qa=q,ds=le,Ma=ce,Zr=Ge,di=P,ui=Qa.m,js=Qa.s,Qs=[null],ja=1,qi=0,Zo=y7[Zr];r:for(;;){if(di&&z(ui,1)){var Bs=z(ui,3)+2,Dl=qe(ds,Bs),VA=qe(Ma,Bs),yu=Dl*VA;if(!$e(Dl,VA,0,Qa,Qs))break r;for(Qs=Qs[0],js.xc=Bs,on=0;on<yu;++on){var Ec=Qs[on]>>8&65535;Qs[on]=Ec,Ec>=ja&&(ja=Ec+1)}}if(ui.h)break r;for(yr=0;5>yr;++yr){var Hn=Gj[yr];!yr&&0<Zr&&(Hn+=1<<Zr),qi<Hn&&(qi=Hn)}var S2=o(ja*Zo,D),aB=ja,iB=o(aB,K);if(iB==null)var Gp=null;else t(65536>=aB),Gp=iB;var U0=i(qi);if(Gp==null||U0==null||S2==null){Qa.a=1;break r}var Wp=S2;for(on=As=0;on<ja;++on){var Bo=Gp[on],vu=Bo.G,wu=Bo.H,oB=0,Xp=1,lB=0;for(yr=0;5>yr;++yr){Hn=Gj[yr],vu[yr]=Wp,wu[yr]=As,!yr&&0<Zr&&(Hn+=1<<Zr);s:{var Yp,F2=Hn,Jp=Qa,D0=U0,Q7=Wp,M7=As,E2=0,kc=Jp.m,H7=z(kc,1);if(s(D0,0,0,F2),H7){var V7=z(kc,1)+1,$7=z(kc,1),cB=z(kc,$7==0?1:8);D0[cB]=1,V7==2&&(D0[cB=z(kc,8)]=1);var Zp=1}else{var AB=i(19),dB=z(kc,4)+4;if(19<dB){Jp.a=3;var ex=0;break s}for(Yp=0;Yp<dB;++Yp)AB[x7[Yp]]=z(kc,3);var k2=void 0,P0=void 0,uB=Jp,q7=AB,tx=F2,fB=D0,T2=0,Tc=uB.m,hB=8,mB=o(128,D);n:for(;F(mB,0,7,q7,19);){if(z(Tc,1)){var K7=2+2*z(Tc,3);if((k2=2+z(Tc,K7))>tx)break n}else k2=tx;for(P0=0;P0<tx&&k2--;){U(Tc);var pB=mB[0+(127&O(Tc))];I(Tc,Tc.u+pB.g);var bu=pB.value;if(16>bu)fB[P0++]=bu,bu!=0&&(hB=bu);else{var z7=bu==16,xB=bu-16,G7=m7[xB],gB=z(Tc,h7[xB])+G7;if(P0+gB>tx)break n;for(var W7=z7?hB:0;0<gB--;)fB[P0++]=W7}}T2=1;break n}T2||(uB.a=3),Zp=T2}(Zp=Zp&&!kc.h)&&(E2=F(Q7,M7,8,D0,F2)),Zp&&E2!=0?ex=E2:(Jp.a=3,ex=0)}if(ex==0)break r;if(Xp&&p7[yr]==1&&(Xp=Wp[As].g==0),oB+=Wp[As].g,As+=ex,3>=yr){var O0,_2=U0[0];for(O0=1;O0<Hn;++O0)U0[O0]>_2&&(_2=U0[O0]);lB+=_2}}if(Bo.nd=Xp,Bo.Qb=0,Xp&&(Bo.qb=(vu[3][wu[3]+0].value<<24|vu[1][wu[1]+0].value<<16|vu[2][wu[2]+0].value)>>>0,oB==0&&256>vu[0][wu[0]+0].value&&(Bo.Qb=1,Bo.qb+=vu[0][wu[0]+0].value<<8)),Bo.jc=!Bo.Qb&&6>lB,Bo.jc){var rx,Pl=Bo;for(rx=0;rx<Rs;++rx){var _c=rx,Ic=Pl.pd[_c],nx=Pl.G[0][Pl.H[0]+_c];256<=nx.value?(Ic.g=nx.g+256,Ic.value=nx.value):(Ic.g=0,Ic.value=0,_c>>=qt(nx,8,Ic),_c>>=qt(Pl.G[1][Pl.H[1]+_c],16,Ic),_c>>=qt(Pl.G[2][Pl.H[2]+_c],0,Ic),qt(Pl.G[3][Pl.H[3]+_c],24,Ic))}}}js.vc=Qs,js.Wb=ja,js.Ya=Gp,js.yc=S2,An=1;break t}An=0}if(!(ie=An)){q.a=3;break e}if(0<Ge){if(ye.ua=1<<Ge,!ve(ye.Wa,Ge)){q.a=1,ie=0;break e}}else ye.ua=0;var I2=q,yB=le,X7=ce,L2=I2.s,U2=L2.xc;if(I2.c=yB,I2.i=X7,L2.md=qe(yB,U2),L2.wc=U2==0?-1:(1<<U2)-1,P){q.xb=S7;break e}if((Ue=i(le*ce))==null){q.a=1,ie=0;break e}ie=(ie=we(q,Ue,0,le,ce,ce,null))&&!fe.h;break e}return ie?(re!=null?re[0]=Ue:(t(Ue==null),t(P)),q.$=0,P||ze(ye)):ze(ye),ie}function Xe(y,N){var P=y.c*y.i,q=P+N+16*N;return t(y.c<=N),y.V=i(q),y.V==null?(y.Ta=null,y.Ua=0,y.a=1,0):(y.Ta=y.V,y.Ua=y.Ba+P+N,1)}function Je(y,N){var P=y.C,q=N-P,re=y.V,ie=y.Ba+y.c*P;for(t(N<=y.l.o);0<q;){var le=16<q?16:q,ce=y.l.ma,fe=y.l.width,ye=fe*le,Ue=ce.ca,Ge=ce.tb+fe*P,We=y.Ta,Me=y.Ua;se(y,le,re,ie),Xn(We,Me,Ue,Ge,ye),me(ce,P,P+le,Ue,Ge,fe),q-=le,re+=le*y.c,P+=le}t(P==N),y.C=y.Ma=N}function gt(){this.ub=this.yd=this.td=this.Rb=0}function Ct(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ut(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function wt(){this.Yb=function(){var y=[];return function N(P,q,re){for(var ie=re[q],le=0;le<ie&&(P.push(re.length>q+1?[]:0),!(re.length<q+1));le++)N(P[le],q+1,re)}(y,0,[3,11]),y}()}function Lt(){this.jb=i(3),this.Wc=l([4,8],wt),this.Xc=l([4,17],wt)}function or(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function Mr(){this.ld=this.La=this.dd=this.tc=0}function Wr(){this.Na=this.la=0}function Qn(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function li(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function bo(){this.uc=this.M=this.Nb=0,this.wa=Array(new Mr),this.Y=0,this.ya=Array(new li),this.aa=0,this.l=new Oi}function Pi(){this.y=i(16),this.f=i(8),this.ea=i(8)}function Pa(){this.cb=this.a=0,this.sc="",this.m=new ee,this.Od=new gt,this.Kc=new Ct,this.ed=new or,this.Qa=new Ut,this.Ic=this.$c=this.Aa=0,this.D=new bo,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,ee),this.ia=0,this.pb=o(4,Qn),this.Pa=new Lt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Pi),this.Hd=0,this.rb=Array(new Wr),this.sb=0,this.wa=Array(new Mr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new li),this.L=this.aa=0,this.gd=l([4,2],Mr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Oi(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Ke(){var y=new Pa;return y!=null&&(y.a=0,y.sc="OK",y.cb=0,y.Xb=0,I0||(I0=Gt)),y}function Le(y,N,P){return y.a==0&&(y.a=N,y.sc=P,y.cb=0),0}function ct(y,N,P){return 3<=P&&y[N+0]==157&&y[N+1]==1&&y[N+2]==42}function jt(y,N){if(y==null)return 0;if(y.a=0,y.sc="OK",N==null)return Le(y,2,"null VP8Io passed to VP8GetHeaders()");var P=N.data,q=N.w,re=N.ha;if(4>re)return Le(y,7,"Truncated header.");var ie=P[q+0]|P[q+1]<<8|P[q+2]<<16,le=y.Od;if(le.Rb=!(1&ie),le.td=ie>>1&7,le.yd=ie>>4&1,le.ub=ie>>5,3<le.td)return Le(y,3,"Incorrect keyframe parameters.");if(!le.yd)return Le(y,4,"Frame not displayable.");q+=3,re-=3;var ce=y.Kc;if(le.Rb){if(7>re)return Le(y,7,"cannot parse picture header");if(!ct(P,q,re))return Le(y,3,"Bad code word");ce.c=16383&(P[q+4]<<8|P[q+3]),ce.Td=P[q+4]>>6,ce.i=16383&(P[q+6]<<8|P[q+5]),ce.Ud=P[q+6]>>6,q+=7,re-=7,y.za=ce.c+15>>4,y.Ub=ce.i+15>>4,N.width=ce.c,N.height=ce.i,N.Da=0,N.j=0,N.v=0,N.va=N.width,N.o=N.height,N.da=0,N.ib=N.width,N.hb=N.height,N.U=N.width,N.T=N.height,s((ie=y.Pa).jb,0,255,ie.jb.length),t((ie=y.Qa)!=null),ie.Cb=0,ie.Bb=0,ie.Fb=1,s(ie.Zb,0,0,ie.Zb.length),s(ie.Lb,0,0,ie.Lb)}if(le.ub>re)return Le(y,7,"bad partition length");ae(ie=y.m,P,q,le.ub),q+=le.ub,re-=le.ub,le.Rb&&(ce.Ld=H(ie),ce.Kd=H(ie)),ce=y.Qa;var fe,ye=y.Pa;if(t(ie!=null),t(ce!=null),ce.Cb=H(ie),ce.Cb){if(ce.Bb=H(ie),H(ie)){for(ce.Fb=H(ie),fe=0;4>fe;++fe)ce.Zb[fe]=H(ie)?oe(ie,7):0;for(fe=0;4>fe;++fe)ce.Lb[fe]=H(ie)?oe(ie,6):0}if(ce.Bb)for(fe=0;3>fe;++fe)ye.jb[fe]=H(ie)?Z(ie,8):255}else ce.Bb=0;if(ie.Ka)return Le(y,3,"cannot parse segment header");if((ce=y.ed).zd=H(ie),ce.Tb=Z(ie,6),ce.wb=Z(ie,3),ce.Pc=H(ie),ce.Pc&&H(ie)){for(ye=0;4>ye;++ye)H(ie)&&(ce.vd[ye]=oe(ie,6));for(ye=0;4>ye;++ye)H(ie)&&(ce.od[ye]=oe(ie,6))}if(y.L=ce.Tb==0?0:ce.zd?1:2,ie.Ka)return Le(y,3,"cannot parse filter header");var Ue=re;if(re=fe=q,q=fe+Ue,ce=Ue,y.Xb=(1<<Z(y.m,2))-1,Ue<3*(ye=y.Xb))P=7;else{for(fe+=3*ye,ce-=3*ye,Ue=0;Ue<ye;++Ue){var Ge=P[re+0]|P[re+1]<<8|P[re+2]<<16;Ge>ce&&(Ge=ce),ae(y.Jc[+Ue],P,fe,Ge),fe+=Ge,ce-=Ge,re+=3}ae(y.Jc[+ye],P,fe,ce),P=fe<q?0:5}if(P!=0)return Le(y,P,"cannot parse partitions");for(P=Z(fe=y.m,7),re=H(fe)?oe(fe,4):0,q=H(fe)?oe(fe,4):0,ce=H(fe)?oe(fe,4):0,ye=H(fe)?oe(fe,4):0,fe=H(fe)?oe(fe,4):0,Ue=y.Qa,Ge=0;4>Ge;++Ge){if(Ue.Cb){var We=Ue.Zb[Ge];Ue.Fb||(We+=P)}else{if(0<Ge){y.pb[Ge]=y.pb[0];continue}We=P}var Me=y.pb[Ge];Me.Sc[0]=C2[ci(We+re,127)],Me.Sc[1]=j2[ci(We+0,127)],Me.Eb[0]=2*C2[ci(We+q,127)],Me.Eb[1]=101581*j2[ci(We+ce,127)]>>16,8>Me.Eb[1]&&(Me.Eb[1]=8),Me.Qc[0]=C2[ci(We+ye,117)],Me.Qc[1]=j2[ci(We+fe,127)],Me.lc=We+fe}if(!le.Rb)return Le(y,4,"Not a key frame.");for(H(ie),le=y.Pa,P=0;4>P;++P){for(re=0;8>re;++re)for(q=0;3>q;++q)for(ce=0;11>ce;++ce)ye=X(ie,j7[P][re][q][ce])?Z(ie,8):N7[P][re][q][ce],le.Wc[P][re].Yb[q][ce]=ye;for(re=0;17>re;++re)le.Xc[P][re]=le.Wc[P][B7[re]]}return y.kc=H(ie),y.kc&&(y.Bd=Z(ie,8)),y.cb=1}function Gt(y,N,P,q,re,ie,le){var ce=N[re].Yb[P];for(P=0;16>re;++re){if(!X(y,ce[P+0]))return re;for(;!X(y,ce[P+1]);)if(ce=N[++re].Yb[0],P=0,re==16)return 16;var fe=N[re+1].Yb;if(X(y,ce[P+2])){var ye=y,Ue=0;if(X(ye,(We=ce)[(Ge=P)+3]))if(X(ye,We[Ge+6])){for(ce=0,Ge=2*(Ue=X(ye,We[Ge+8]))+(We=X(ye,We[Ge+9+Ue])),Ue=0,We=w7[Ge];We[ce];++ce)Ue+=Ue+X(ye,We[ce]);Ue+=3+(8<<Ge)}else X(ye,We[Ge+7])?(Ue=7+2*X(ye,165),Ue+=X(ye,145)):Ue=5+X(ye,159);else Ue=X(ye,We[Ge+4])?3+X(ye,We[Ge+5]):2;ce=fe[2]}else Ue=1,ce=fe[1];fe=le+b7[re],0>(ye=y).b&&Q(ye);var Ge,We=ye.b,Me=(Ge=ye.Ca>>1)-(ye.I>>We)>>31;--ye.b,ye.Ca+=Me,ye.Ca|=1,ye.I-=(Ge+1&Me)<<We,ie[fe]=((Ue^Me)-Me)*q[(0<re)+0]}return 16}function er(y){var N=y.rb[y.sb-1];N.la=0,N.Na=0,s(y.zc,0,0,y.zc.length),y.ja=0}function Pt(y,N){if(y==null)return 0;if(N==null)return Le(y,2,"NULL VP8Io parameter in VP8Decode().");if(!y.cb&&!jt(y,N))return 0;if(t(y.cb),N.ac==null||N.ac(N)){N.ob&&(y.L=0);var P=zp[y.L];if(y.L==2?(y.yb=0,y.zb=0):(y.yb=N.v-P>>4,y.zb=N.j-P>>4,0>y.yb&&(y.yb=0),0>y.zb&&(y.zb=0)),y.Va=N.o+15+P>>4,y.Hb=N.va+15+P>>4,y.Hb>y.za&&(y.Hb=y.za),y.Va>y.Ub&&(y.Va=y.Ub),0<y.L){var q=y.ed;for(P=0;4>P;++P){var re;if(y.Qa.Cb){var ie=y.Qa.Lb[P];y.Qa.Fb||(ie+=q.Tb)}else ie=q.Tb;for(re=0;1>=re;++re){var le=y.gd[P][re],ce=ie;if(q.Pc&&(ce+=q.vd[0],re&&(ce+=q.od[0])),0<(ce=0>ce?0:63<ce?63:ce)){var fe=ce;0<q.wb&&(fe=4<q.wb?fe>>2:fe>>1)>9-q.wb&&(fe=9-q.wb),1>fe&&(fe=1),le.dd=fe,le.tc=2*ce+fe,le.ld=40<=ce?2:15<=ce?1:0}else le.tc=0;le.La=re}}}P=0}else Le(y,6,"Frame setup failed"),P=y.a;if(P=P==0){if(P){y.$c=0,0<y.Aa||(y.Ic=R7);e:{P=y.Ic,q=4*(fe=y.za);var ye=32*fe,Ue=fe+1,Ge=0<y.L?fe*(0<y.Aa?2:1):0,We=(y.Aa==2?2:1)*fe;if((le=q+832+(re=3*(16*P+zp[y.L])/2*ye)+(ie=y.Fa!=null&&0<y.Fa.length?y.Kc.c*y.Kc.i:0))!=le)P=0;else{if(le>y.Vb){if(y.Vb=0,y.Ec=i(le),y.Fc=0,y.Ec==null){P=Le(y,1,"no memory during frame initialization.");break e}y.Vb=le}le=y.Ec,ce=y.Fc,y.Ac=le,y.Bc=ce,ce+=q,y.Gd=o(ye,Pi),y.Hd=0,y.rb=o(Ue+1,Wr),y.sb=1,y.wa=Ge?o(Ge,Mr):null,y.Y=0,y.D.Nb=0,y.D.wa=y.wa,y.D.Y=y.Y,0<y.Aa&&(y.D.Y+=fe),t(!0),y.oc=le,y.pc=ce,ce+=832,y.ya=o(We,li),y.aa=0,y.D.ya=y.ya,y.D.aa=y.aa,y.Aa==2&&(y.D.aa+=fe),y.R=16*fe,y.B=8*fe,fe=(ye=zp[y.L])*y.R,ye=ye/2*y.B,y.sa=le,y.ta=ce+fe,y.qa=y.sa,y.ra=y.ta+16*P*y.R+ye,y.Ha=y.qa,y.Ia=y.ra+8*P*y.B+ye,y.$c=0,ce+=re,y.mb=ie?le:null,y.nb=ie?ce:null,t(ce+ie<=y.Fc+y.Vb),er(y),s(y.Ac,y.Bc,0,q),P=1}}if(P){if(N.ka=0,N.y=y.sa,N.O=y.ta,N.f=y.qa,N.N=y.ra,N.ea=y.Ha,N.Vd=y.Ia,N.fa=y.R,N.Rc=y.B,N.F=null,N.J=0,!Op){for(P=-255;255>=P;++P)gs[255+P]=0>P?-P:P;for(P=-1020;1020>=P;++P)Ll[1020+P]=-128>P?-128:127<P?127:P;for(P=-112;112>=P;++P)_0[112+P]=-16>P?-16:15<P?15:P;for(P=-255;510>=P;++P)gu[255+P]=0>P?0:255<P?255:P;Op=1}mu=n2,Il=Ys,E0=IA,Ca=tu,Qi=bp,Wn=Xs,pu=p0,Pp=DA,k0=p2,RA=x0,QA=m2,jc=iu,MA=g0,xu=Tp,HA=kp,Bc=Yo,T0=kl,Mi=h2,jo[0]=Xo,jo[1]=s2,jo[2]=l2,jo[3]=c2,jo[4]=jp,jo[5]=su,jo[6]=Bp,jo[7]=f0,jo[8]=d2,jo[9]=A2,Sc[0]=Np,Sc[1]=i2,Sc[2]=El,Sc[3]=ru,Sc[4]=Js,Sc[5]=o2,Sc[6]=Cp,Ul[0]=vc,Ul[1]=a2,Ul[2]=u2,Ul[3]=h0,Ul[4]=UA,Ul[5]=f2,Ul[6]=m0,P=1}else P=0}P&&(P=function(Me,ht){for(Me.M=0;Me.M<Me.Va;++Me.M){var nt,De=Me.Jc[Me.M&Me.Xb],Qe=Me.m,At=Me;for(nt=0;nt<At.za;++nt){var xt=Qe,ut=At,Mt=ut.Ac,_t=ut.Bc+4*nt,tr=ut.zc,Dt=ut.ya[ut.aa+nt];if(ut.Qa.Bb?Dt.$b=X(xt,ut.Pa.jb[0])?2+X(xt,ut.Pa.jb[2]):X(xt,ut.Pa.jb[1]):Dt.$b=0,ut.kc&&(Dt.Ad=X(xt,ut.Bd)),Dt.Za=!X(xt,145)+0,Dt.Za){var qr=Dt.Ob,Jr=0;for(ut=0;4>ut;++ut){var Dr,Er=tr[0+ut];for(Dr=0;4>Dr;++Dr){Er=C7[Mt[_t+Dr]][Er];for(var An=Wj[X(xt,Er[0])];0<An;)An=Wj[2*An+X(xt,Er[An])];Er=-An,Mt[_t+Dr]=Er}n(qr,Jr,Mt,_t,4),Jr+=4,tr[0+ut]=Er}}else Er=X(xt,156)?X(xt,128)?1:3:X(xt,163)?2:0,Dt.Ob[0]=Er,s(Mt,_t,Er,4),s(tr,0,Er,4);Dt.Dd=X(xt,142)?X(xt,114)?X(xt,183)?1:3:2:0}if(At.m.Ka)return Le(Me,7,"Premature end-of-partition0 encountered.");for(;Me.ja<Me.za;++Me.ja){if(At=De,xt=(Qe=Me).rb[Qe.sb-1],Mt=Qe.rb[Qe.sb+Qe.ja],nt=Qe.ya[Qe.aa+Qe.ja],_t=Qe.kc?nt.Ad:0)xt.la=Mt.la=0,nt.Za||(xt.Na=Mt.Na=0),nt.Hc=0,nt.Gc=0,nt.ia=0;else{var on,yr;if(xt=Mt,Mt=At,_t=Qe.Pa.Xc,tr=Qe.ya[Qe.aa+Qe.ja],Dt=Qe.pb[tr.$b],ut=tr.ad,qr=0,Jr=Qe.rb[Qe.sb-1],Er=Dr=0,s(ut,qr,0,384),tr.Za)var As=0,Qa=_t[3];else{An=i(16);var ds=xt.Na+Jr.Na;if(ds=I0(Mt,_t[1],ds,Dt.Eb,0,An,0),xt.Na=Jr.Na=(0<ds)+0,1<ds)mu(An,0,ut,qr);else{var Ma=An[0]+3>>3;for(An=0;256>An;An+=16)ut[qr+An]=Ma}As=1,Qa=_t[0]}var Zr=15&xt.la,di=15&Jr.la;for(An=0;4>An;++An){var ui=1&di;for(Ma=yr=0;4>Ma;++Ma)Zr=Zr>>1|(ui=(ds=I0(Mt,Qa,ds=ui+(1&Zr),Dt.Sc,As,ut,qr))>As)<<7,yr=yr<<2|(3<ds?3:1<ds?2:ut[qr+0]!=0),qr+=16;Zr>>=4,di=di>>1|ui<<7,Dr=(Dr<<8|yr)>>>0}for(Qa=Zr,As=di>>4,on=0;4>on;on+=2){for(yr=0,Zr=xt.la>>4+on,di=Jr.la>>4+on,An=0;2>An;++An){for(ui=1&di,Ma=0;2>Ma;++Ma)ds=ui+(1&Zr),Zr=Zr>>1|(ui=0<(ds=I0(Mt,_t[2],ds,Dt.Qc,0,ut,qr)))<<3,yr=yr<<2|(3<ds?3:1<ds?2:ut[qr+0]!=0),qr+=16;Zr>>=2,di=di>>1|ui<<5}Er|=yr<<4*on,Qa|=Zr<<4<<on,As|=(240&di)<<on}xt.la=Qa,Jr.la=As,tr.Hc=Dr,tr.Gc=Er,tr.ia=43690&Er?0:Dt.ia,_t=!(Dr|Er)}if(0<Qe.L&&(Qe.wa[Qe.Y+Qe.ja]=Qe.gd[nt.$b][nt.Za],Qe.wa[Qe.Y+Qe.ja].La|=!_t),At.Ka)return Le(Me,7,"Premature end-of-file encountered.")}if(er(Me),Qe=ht,At=1,nt=(De=Me).D,xt=0<De.L&&De.M>=De.zb&&De.M<=De.Va,De.Aa==0)e:{if(nt.M=De.M,nt.uc=xt,C0(De,nt),At=1,nt=(yr=De.D).Nb,xt=(Er=zp[De.L])*De.R,Mt=Er/2*De.B,An=16*nt*De.R,Ma=8*nt*De.B,_t=De.sa,tr=De.ta-xt+An,Dt=De.qa,ut=De.ra-Mt+Ma,qr=De.Ha,Jr=De.Ia-Mt+Ma,di=(Zr=yr.M)==0,Dr=Zr>=De.Va-1,De.Aa==2&&C0(De,yr),yr.uc)for(ui=(ds=De).D.M,t(ds.D.uc),yr=ds.yb;yr<ds.Hb;++yr){As=yr,Qa=ui;var js=(Qs=(Hn=ds).D).Nb;on=Hn.R;var Qs=Qs.wa[Qs.Y+As],ja=Hn.sa,qi=Hn.ta+16*js*on+16*As,Zo=Qs.dd,Bs=Qs.tc;if(Bs!=0)if(t(3<=Bs),Hn.L==1)0<As&&Bc(ja,qi,on,Bs+4),Qs.La&&Mi(ja,qi,on,Bs),0<Qa&&HA(ja,qi,on,Bs+4),Qs.La&&T0(ja,qi,on,Bs);else{var Dl=Hn.B,VA=Hn.qa,yu=Hn.ra+8*js*Dl+8*As,Ec=Hn.Ha,Hn=Hn.Ia+8*js*Dl+8*As;js=Qs.ld,0<As&&(Pp(ja,qi,on,Bs+4,Zo,js),RA(VA,yu,Ec,Hn,Dl,Bs+4,Zo,js)),Qs.La&&(jc(ja,qi,on,Bs,Zo,js),xu(VA,yu,Ec,Hn,Dl,Bs,Zo,js)),0<Qa&&(pu(ja,qi,on,Bs+4,Zo,js),k0(VA,yu,Ec,Hn,Dl,Bs+4,Zo,js)),Qs.La&&(QA(ja,qi,on,Bs,Zo,js),MA(VA,yu,Ec,Hn,Dl,Bs,Zo,js))}}if(De.ia&&alert("todo:DitherRow"),Qe.put!=null){if(yr=16*Zr,Zr=16*(Zr+1),di?(Qe.y=De.sa,Qe.O=De.ta+An,Qe.f=De.qa,Qe.N=De.ra+Ma,Qe.ea=De.Ha,Qe.W=De.Ia+Ma):(yr-=Er,Qe.y=_t,Qe.O=tr,Qe.f=Dt,Qe.N=ut,Qe.ea=qr,Qe.W=Jr),Dr||(Zr-=Er),Zr>Qe.o&&(Zr=Qe.o),Qe.F=null,Qe.J=null,De.Fa!=null&&0<De.Fa.length&&yr<Zr&&(Qe.J=b0(De,Qe,yr,Zr-yr),Qe.F=De.mb,Qe.F==null&&Qe.F.length==0)){At=Le(De,3,"Could not decode alpha data.");break e}yr<Qe.j&&(Er=Qe.j-yr,yr=Qe.j,t(!(1&Er)),Qe.O+=De.R*Er,Qe.N+=De.B*(Er>>1),Qe.W+=De.B*(Er>>1),Qe.F!=null&&(Qe.J+=Qe.width*Er)),yr<Zr&&(Qe.O+=Qe.v,Qe.N+=Qe.v>>1,Qe.W+=Qe.v>>1,Qe.F!=null&&(Qe.J+=Qe.v),Qe.ka=yr-Qe.j,Qe.U=Qe.va-Qe.v,Qe.T=Zr-yr,At=Qe.put(Qe))}nt+1!=De.Ic||Dr||(n(De.sa,De.ta-xt,_t,tr+16*De.R,xt),n(De.qa,De.ra-Mt,Dt,ut+8*De.B,Mt),n(De.Ha,De.Ia-Mt,qr,Jr+8*De.B,Mt))}if(!At)return Le(Me,6,"Output aborted.")}return 1}(y,N)),N.bc!=null&&N.bc(N),P&=1}return P?(y.cb=0,P):0}function xr(y,N,P,q,re){re=y[N+P+32*q]+(re>>3),y[N+P+32*q]=-256&re?0>re?0:255:re}function Xr(y,N,P,q,re,ie){xr(y,N,0,P,q+re),xr(y,N,1,P,q+ie),xr(y,N,2,P,q-ie),xr(y,N,3,P,q-re)}function Tr(y){return(20091*y>>16)+y}function fn(y,N,P,q){var re,ie=0,le=i(16);for(re=0;4>re;++re){var ce=y[N+0]+y[N+8],fe=y[N+0]-y[N+8],ye=(35468*y[N+4]>>16)-Tr(y[N+12]),Ue=Tr(y[N+4])+(35468*y[N+12]>>16);le[ie+0]=ce+Ue,le[ie+1]=fe+ye,le[ie+2]=fe-ye,le[ie+3]=ce-Ue,ie+=4,N++}for(re=ie=0;4>re;++re)ce=(y=le[ie+0]+4)+le[ie+8],fe=y-le[ie+8],ye=(35468*le[ie+4]>>16)-Tr(le[ie+12]),xr(P,q,0,0,ce+(Ue=Tr(le[ie+4])+(35468*le[ie+12]>>16))),xr(P,q,1,0,fe+ye),xr(P,q,2,0,fe-ye),xr(P,q,3,0,ce-Ue),ie++,q+=32}function Xs(y,N,P,q){var re=y[N+0]+4,ie=35468*y[N+4]>>16,le=Tr(y[N+4]),ce=35468*y[N+1]>>16;Xr(P,q,0,re+le,y=Tr(y[N+1]),ce),Xr(P,q,1,re+ie,y,ce),Xr(P,q,2,re-ie,y,ce),Xr(P,q,3,re-le,y,ce)}function Ys(y,N,P,q,re){fn(y,N,P,q),re&&fn(y,N+16,P,q+4)}function IA(y,N,P,q){Il(y,N+0,P,q,1),Il(y,N+32,P,q+128,1)}function tu(y,N,P,q){var re;for(y=y[N+0]+4,re=0;4>re;++re)for(N=0;4>N;++N)xr(P,q,N,re,y)}function bp(y,N,P,q){y[N+0]&&Ca(y,N+0,P,q),y[N+16]&&Ca(y,N+16,P,q+4),y[N+32]&&Ca(y,N+32,P,q+128),y[N+48]&&Ca(y,N+48,P,q+128+4)}function n2(y,N,P,q){var re,ie=i(16);for(re=0;4>re;++re){var le=y[N+0+re]+y[N+12+re],ce=y[N+4+re]+y[N+8+re],fe=y[N+4+re]-y[N+8+re],ye=y[N+0+re]-y[N+12+re];ie[0+re]=le+ce,ie[8+re]=le-ce,ie[4+re]=ye+fe,ie[12+re]=ye-fe}for(re=0;4>re;++re)le=(y=ie[0+4*re]+3)+ie[3+4*re],ce=ie[1+4*re]+ie[2+4*re],fe=ie[1+4*re]-ie[2+4*re],ye=y-ie[3+4*re],P[q+0]=le+ce>>3,P[q+16]=ye+fe>>3,P[q+32]=le-ce>>3,P[q+48]=ye-fe>>3,q+=64}function u0(y,N,P){var q,re=N-32,ie=Ai,le=255-y[re-1];for(q=0;q<P;++q){var ce,fe=ie,ye=le+y[N-1];for(ce=0;ce<P;++ce)y[N+ce]=fe[ye+y[re+ce]];N+=32}}function s2(y,N){u0(y,N,4)}function a2(y,N){u0(y,N,8)}function i2(y,N){u0(y,N,16)}function El(y,N){var P;for(P=0;16>P;++P)n(y,N+32*P,y,N-32,16)}function ru(y,N){var P;for(P=16;0<P;--P)s(y,N,y[N-1],16),N+=32}function nu(y,N,P){var q;for(q=0;16>q;++q)s(N,P+32*q,y,16)}function Np(y,N){var P,q=16;for(P=0;16>P;++P)q+=y[N-1+32*P]+y[N+P-32];nu(q>>5,y,N)}function Js(y,N){var P,q=8;for(P=0;16>P;++P)q+=y[N-1+32*P];nu(q>>4,y,N)}function o2(y,N){var P,q=8;for(P=0;16>P;++P)q+=y[N+P-32];nu(q>>4,y,N)}function Cp(y,N){nu(128,y,N)}function ur(y,N,P){return y+2*N+P+2>>2}function l2(y,N){var P,q=N-32;for(q=new Uint8Array([ur(y[q-1],y[q+0],y[q+1]),ur(y[q+0],y[q+1],y[q+2]),ur(y[q+1],y[q+2],y[q+3]),ur(y[q+2],y[q+3],y[q+4])]),P=0;4>P;++P)n(y,N+32*P,q,0,q.length)}function c2(y,N){var P=y[N-1],q=y[N-1+32],re=y[N-1+64],ie=y[N-1+96];V(y,N+0,16843009*ur(y[N-1-32],P,q)),V(y,N+32,16843009*ur(P,q,re)),V(y,N+64,16843009*ur(q,re,ie)),V(y,N+96,16843009*ur(re,ie,ie))}function Xo(y,N){var P,q=4;for(P=0;4>P;++P)q+=y[N+P-32]+y[N-1+32*P];for(q>>=3,P=0;4>P;++P)s(y,N+32*P,q,4)}function jp(y,N){var P=y[N-1+0],q=y[N-1+32],re=y[N-1+64],ie=y[N-1-32],le=y[N+0-32],ce=y[N+1-32],fe=y[N+2-32],ye=y[N+3-32];y[N+0+96]=ur(q,re,y[N-1+96]),y[N+1+96]=y[N+0+64]=ur(P,q,re),y[N+2+96]=y[N+1+64]=y[N+0+32]=ur(ie,P,q),y[N+3+96]=y[N+2+64]=y[N+1+32]=y[N+0+0]=ur(le,ie,P),y[N+3+64]=y[N+2+32]=y[N+1+0]=ur(ce,le,ie),y[N+3+32]=y[N+2+0]=ur(fe,ce,le),y[N+3+0]=ur(ye,fe,ce)}function Bp(y,N){var P=y[N+1-32],q=y[N+2-32],re=y[N+3-32],ie=y[N+4-32],le=y[N+5-32],ce=y[N+6-32],fe=y[N+7-32];y[N+0+0]=ur(y[N+0-32],P,q),y[N+1+0]=y[N+0+32]=ur(P,q,re),y[N+2+0]=y[N+1+32]=y[N+0+64]=ur(q,re,ie),y[N+3+0]=y[N+2+32]=y[N+1+64]=y[N+0+96]=ur(re,ie,le),y[N+3+32]=y[N+2+64]=y[N+1+96]=ur(ie,le,ce),y[N+3+64]=y[N+2+96]=ur(le,ce,fe),y[N+3+96]=ur(ce,fe,fe)}function su(y,N){var P=y[N-1+0],q=y[N-1+32],re=y[N-1+64],ie=y[N-1-32],le=y[N+0-32],ce=y[N+1-32],fe=y[N+2-32],ye=y[N+3-32];y[N+0+0]=y[N+1+64]=ie+le+1>>1,y[N+1+0]=y[N+2+64]=le+ce+1>>1,y[N+2+0]=y[N+3+64]=ce+fe+1>>1,y[N+3+0]=fe+ye+1>>1,y[N+0+96]=ur(re,q,P),y[N+0+64]=ur(q,P,ie),y[N+0+32]=y[N+1+96]=ur(P,ie,le),y[N+1+32]=y[N+2+96]=ur(ie,le,ce),y[N+2+32]=y[N+3+96]=ur(le,ce,fe),y[N+3+32]=ur(ce,fe,ye)}function f0(y,N){var P=y[N+0-32],q=y[N+1-32],re=y[N+2-32],ie=y[N+3-32],le=y[N+4-32],ce=y[N+5-32],fe=y[N+6-32],ye=y[N+7-32];y[N+0+0]=P+q+1>>1,y[N+1+0]=y[N+0+64]=q+re+1>>1,y[N+2+0]=y[N+1+64]=re+ie+1>>1,y[N+3+0]=y[N+2+64]=ie+le+1>>1,y[N+0+32]=ur(P,q,re),y[N+1+32]=y[N+0+96]=ur(q,re,ie),y[N+2+32]=y[N+1+96]=ur(re,ie,le),y[N+3+32]=y[N+2+96]=ur(ie,le,ce),y[N+3+64]=ur(le,ce,fe),y[N+3+96]=ur(ce,fe,ye)}function A2(y,N){var P=y[N-1+0],q=y[N-1+32],re=y[N-1+64],ie=y[N-1+96];y[N+0+0]=P+q+1>>1,y[N+2+0]=y[N+0+32]=q+re+1>>1,y[N+2+32]=y[N+0+64]=re+ie+1>>1,y[N+1+0]=ur(P,q,re),y[N+3+0]=y[N+1+32]=ur(q,re,ie),y[N+3+32]=y[N+1+64]=ur(re,ie,ie),y[N+3+64]=y[N+2+64]=y[N+0+96]=y[N+1+96]=y[N+2+96]=y[N+3+96]=ie}function d2(y,N){var P=y[N-1+0],q=y[N-1+32],re=y[N-1+64],ie=y[N-1+96],le=y[N-1-32],ce=y[N+0-32],fe=y[N+1-32],ye=y[N+2-32];y[N+0+0]=y[N+2+32]=P+le+1>>1,y[N+0+32]=y[N+2+64]=q+P+1>>1,y[N+0+64]=y[N+2+96]=re+q+1>>1,y[N+0+96]=ie+re+1>>1,y[N+3+0]=ur(ce,fe,ye),y[N+2+0]=ur(le,ce,fe),y[N+1+0]=y[N+3+32]=ur(P,le,ce),y[N+1+32]=y[N+3+64]=ur(q,P,le),y[N+1+64]=y[N+3+96]=ur(re,q,P),y[N+1+96]=ur(ie,re,q)}function u2(y,N){var P;for(P=0;8>P;++P)n(y,N+32*P,y,N-32,8)}function h0(y,N){var P;for(P=0;8>P;++P)s(y,N,y[N-1],8),N+=32}function LA(y,N,P){var q;for(q=0;8>q;++q)s(N,P+32*q,y,8)}function vc(y,N){var P,q=8;for(P=0;8>P;++P)q+=y[N+P-32]+y[N-1+32*P];LA(q>>4,y,N)}function f2(y,N){var P,q=4;for(P=0;8>P;++P)q+=y[N+P-32];LA(q>>3,y,N)}function UA(y,N){var P,q=4;for(P=0;8>P;++P)q+=y[N-1+32*P];LA(q>>3,y,N)}function m0(y,N){LA(128,y,N)}function au(y,N,P){var q=y[N-P],re=y[N+0],ie=3*(re-q)+y2[1020+y[N-2*P]-y[N+P]],le=Rp[112+(ie+4>>3)];y[N-P]=Ai[255+q+Rp[112+(ie+3>>3)]],y[N+0]=Ai[255+re-le]}function Sp(y,N,P,q){var re=y[N+0],ie=y[N+P];return Vi[255+y[N-2*P]-y[N-P]]>q||Vi[255+ie-re]>q}function Fp(y,N,P,q){return 4*Vi[255+y[N-P]-y[N+0]]+Vi[255+y[N-2*P]-y[N+P]]<=q}function Ep(y,N,P,q,re){var ie=y[N-3*P],le=y[N-2*P],ce=y[N-P],fe=y[N+0],ye=y[N+P],Ue=y[N+2*P],Ge=y[N+3*P];return 4*Vi[255+ce-fe]+Vi[255+le-ye]>q?0:Vi[255+y[N-4*P]-ie]<=re&&Vi[255+ie-le]<=re&&Vi[255+le-ce]<=re&&Vi[255+Ge-Ue]<=re&&Vi[255+Ue-ye]<=re&&Vi[255+ye-fe]<=re}function kp(y,N,P,q){var re=2*q+1;for(q=0;16>q;++q)Fp(y,N+q,P,re)&&au(y,N+q,P)}function Yo(y,N,P,q){var re=2*q+1;for(q=0;16>q;++q)Fp(y,N+q*P,1,re)&&au(y,N+q*P,1)}function kl(y,N,P,q){var re;for(re=3;0<re;--re)kp(y,N+=4*P,P,q)}function h2(y,N,P,q){var re;for(re=3;0<re;--re)Yo(y,N+=4,P,q)}function wc(y,N,P,q,re,ie,le,ce){for(ie=2*ie+1;0<re--;){if(Ep(y,N,P,ie,le))if(Sp(y,N,P,ce))au(y,N,P);else{var fe=y,ye=N,Ue=P,Ge=fe[ye-2*Ue],We=fe[ye-Ue],Me=fe[ye+0],ht=fe[ye+Ue],nt=fe[ye+2*Ue],De=27*(At=y2[1020+3*(Me-We)+y2[1020+Ge-ht]])+63>>7,Qe=18*At+63>>7,At=9*At+63>>7;fe[ye-3*Ue]=Ai[255+fe[ye-3*Ue]+At],fe[ye-2*Ue]=Ai[255+Ge+Qe],fe[ye-Ue]=Ai[255+We+De],fe[ye+0]=Ai[255+Me-De],fe[ye+Ue]=Ai[255+ht-Qe],fe[ye+2*Ue]=Ai[255+nt-At]}N+=q}}function No(y,N,P,q,re,ie,le,ce){for(ie=2*ie+1;0<re--;){if(Ep(y,N,P,ie,le))if(Sp(y,N,P,ce))au(y,N,P);else{var fe=y,ye=N,Ue=P,Ge=fe[ye-Ue],We=fe[ye+0],Me=fe[ye+Ue],ht=Rp[112+((nt=3*(We-Ge))+4>>3)],nt=Rp[112+(nt+3>>3)],De=ht+1>>1;fe[ye-2*Ue]=Ai[255+fe[ye-2*Ue]+De],fe[ye-Ue]=Ai[255+Ge+nt],fe[ye+0]=Ai[255+We-ht],fe[ye+Ue]=Ai[255+Me-De]}N+=q}}function p0(y,N,P,q,re,ie){wc(y,N,P,1,16,q,re,ie)}function DA(y,N,P,q,re,ie){wc(y,N,1,P,16,q,re,ie)}function m2(y,N,P,q,re,ie){var le;for(le=3;0<le;--le)No(y,N+=4*P,P,1,16,q,re,ie)}function iu(y,N,P,q,re,ie){var le;for(le=3;0<le;--le)No(y,N+=4,1,P,16,q,re,ie)}function p2(y,N,P,q,re,ie,le,ce){wc(y,N,re,1,8,ie,le,ce),wc(P,q,re,1,8,ie,le,ce)}function x0(y,N,P,q,re,ie,le,ce){wc(y,N,1,re,8,ie,le,ce),wc(P,q,1,re,8,ie,le,ce)}function g0(y,N,P,q,re,ie,le,ce){No(y,N+4*re,re,1,8,ie,le,ce),No(P,q+4*re,re,1,8,ie,le,ce)}function Tp(y,N,P,q,re,ie,le,ce){No(y,N+4,1,re,8,ie,le,ce),No(P,q+4,1,re,8,ie,le,ce)}function ou(){this.ba=new Gr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Nr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function y0(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function v0(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function _p(){this.ua=0,this.Wa=new te,this.vb=new te,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new K,this.yc=new D}function x2(){this.xb=this.a=0,this.l=new Oi,this.ca=new Gr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new b,this.Pb=0,this.wd=new b,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new _p,this.ab=0,this.gc=o(4,v0),this.Oc=0}function lu(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Oi,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function PA(y,N,P,q,re,ie,le){for(y=y==null?0:y[N+0],N=0;N<le;++N)re[ie+N]=y+P[q+N]&255,y=re[ie+N]}function w0(y,N,P,q,re,ie,le){var ce;if(y==null)PA(null,null,P,q,re,ie,le);else for(ce=0;ce<le;++ce)re[ie+ce]=y[N+ce]+P[q+ce]&255}function bc(y,N,P,q,re,ie,le){if(y==null)PA(null,null,P,q,re,ie,le);else{var ce,fe=y[N+0],ye=fe,Ue=fe;for(ce=0;ce<le;++ce)ye=Ue+(fe=y[N+ce])-ye,Ue=P[q+ce]+(-256&ye?0>ye?0:255:ye)&255,ye=fe,re[ie+ce]=Ue}}function b0(y,N,P,q){var re=N.width,ie=N.o;if(t(y!=null&&N!=null),0>P||0>=q||P+q>ie)return null;if(!y.Cc){if(y.ga==null){var le;if(y.ga=new lu,(le=y.ga==null)||(le=N.width*N.o,t(y.Gb.length==0),y.Gb=i(le),y.Uc=0,y.Gb==null?le=0:(y.mb=y.Gb,y.nb=y.Uc,y.rc=null,le=1),le=!le),!le){le=y.ga;var ce=y.Fa,fe=y.P,ye=y.qc,Ue=y.mb,Ge=y.nb,We=fe+1,Me=ye-1,ht=le.l;if(t(ce!=null&&Ue!=null&&N!=null),Fc[0]=null,Fc[1]=PA,Fc[2]=w0,Fc[3]=bc,le.ca=Ue,le.tb=Ge,le.c=N.width,le.i=N.height,t(0<le.c&&0<le.i),1>=ye)N=0;else if(le.$a=ce[fe+0]>>0&3,le.Z=ce[fe+0]>>2&3,le.Lc=ce[fe+0]>>4&3,fe=ce[fe+0]>>6&3,0>le.$a||1<le.$a||4<=le.Z||1<le.Lc||fe)N=0;else if(ht.put=Ee,ht.ac=It,ht.bc=Oe,ht.ma=le,ht.width=N.width,ht.height=N.height,ht.Da=N.Da,ht.v=N.v,ht.va=N.va,ht.j=N.j,ht.o=N.o,le.$a)e:{t(le.$a==1),N=rt();t:for(;;){if(N==null){N=0;break e}if(t(le!=null),le.mc=N,N.c=le.c,N.i=le.i,N.l=le.l,N.l.ma=le,N.l.width=le.c,N.l.height=le.i,N.a=0,Y(N.m,ce,We,Me),!$e(le.c,le.i,1,N,null)||(N.ab==1&&N.gc[0].hc==3&&he(N.s)?(le.ic=1,ce=N.c*N.i,N.Ta=null,N.Ua=0,N.V=i(ce),N.Ba=0,N.V==null?(N.a=1,N=0):N=1):(le.ic=0,N=Xe(N,le.c)),!N))break t;N=1;break e}le.mc=null,N=0}else N=Me>=le.c*le.i;le=!N}if(le)return null;y.ga.Lc!=1?y.Ga=0:q=ie-P}t(y.ga!=null),t(P+q<=ie);e:{if(N=(ce=y.ga).c,ie=ce.l.o,ce.$a==0){if(We=y.rc,Me=y.Vc,ht=y.Fa,fe=y.P+1+P*N,ye=y.mb,Ue=y.nb+P*N,t(fe<=y.P+y.qc),ce.Z!=0)for(t(Fc[ce.Z]!=null),le=0;le<q;++le)Fc[ce.Z](We,Me,ht,fe,ye,Ue,N),We=ye,Me=Ue,Ue+=N,fe+=N;else for(le=0;le<q;++le)n(ye,Ue,ht,fe,N),We=ye,Me=Ue,Ue+=N,fe+=N;y.rc=We,y.Vc=Me}else{if(t(ce.mc!=null),N=P+q,t((le=ce.mc)!=null),t(N<=le.i),le.C>=N)N=1;else if(ce.ic||Ve(),ce.ic){ce=le.V,We=le.Ba,Me=le.c;var nt=le.i,De=(ht=1,fe=le.$/Me,ye=le.$%Me,Ue=le.m,Ge=le.s,le.$),Qe=Me*nt,At=Me*N,xt=Ge.wc,ut=De<At?Nt(Ge,ye,fe):null;t(De<=Qe),t(N<=nt),t(he(Ge));t:for(;;){for(;!Ue.h&&De<At;){if(ye&xt||(ut=Nt(Ge,ye,fe)),t(ut!=null),U(Ue),256>(nt=mt(ut.G[0],ut.H[0],Ue)))ce[We+De]=nt,++De,++ye>=Me&&(ye=0,++fe<=N&&!(fe%16)&&ge(le,fe));else{if(!(280>nt)){ht=0;break t}nt=Ye(nt-256,Ue);var Mt,_t=mt(ut.G[4],ut.H[4],Ue);if(U(Ue),!(De>=(_t=ft(Me,_t=Ye(_t,Ue)))&&Qe-De>=nt)){ht=0;break t}for(Mt=0;Mt<nt;++Mt)ce[We+De+Mt]=ce[We+De+Mt-_t];for(De+=nt,ye+=nt;ye>=Me;)ye-=Me,++fe<=N&&!(fe%16)&&ge(le,fe);De<At&&ye&xt&&(ut=Nt(Ge,ye,fe))}t(Ue.h==S(Ue))}ge(le,fe>N?N:fe);break t}!ht||Ue.h&&De<Qe?(ht=0,le.a=Ue.h?5:3):le.$=De,N=ht}else N=we(le,le.V,le.Ba,le.c,le.i,N,Je);if(!N){q=0;break e}}P+q>=ie&&(y.Cc=1),q=1}if(!q)return null;if(y.Cc&&((q=y.ga)!=null&&(q.mc=null),y.ga=null,0<y.Ga))return alert("todo:WebPDequantizeLevels"),null}return y.nb+P*re}function k(y,N,P,q,re,ie){for(;0<re--;){var le,ce=y,fe=N+(P?1:0),ye=y,Ue=N+(P?0:3);for(le=0;le<q;++le){var Ge=ye[Ue+4*le];Ge!=255&&(Ge*=32897,ce[fe+4*le+0]=ce[fe+4*le+0]*Ge>>23,ce[fe+4*le+1]=ce[fe+4*le+1]*Ge>>23,ce[fe+4*le+2]=ce[fe+4*le+2]*Ge>>23)}N+=ie}}function ne(y,N,P,q,re){for(;0<q--;){var ie;for(ie=0;ie<P;++ie){var le=y[N+2*ie+0],ce=15&(ye=y[N+2*ie+1]),fe=4369*ce,ye=(240&ye|ye>>4)*fe>>16;y[N+2*ie+0]=(240&le|le>>4)*fe>>16&240|(15&le|le<<4)*fe>>16>>4&15,y[N+2*ie+1]=240&ye|ce}N+=re}}function be(y,N,P,q,re,ie,le,ce){var fe,ye,Ue=255;for(ye=0;ye<re;++ye){for(fe=0;fe<q;++fe){var Ge=y[N+fe];ie[le+4*fe]=Ge,Ue&=Ge}N+=P,le+=ce}return Ue!=255}function _e(y,N,P,q,re){var ie;for(ie=0;ie<re;++ie)P[q+ie]=y[N+ie]>>8}function Ve(){Hi=k,hn=ne,mn=be,Xn=_e}function it(y,N,P){E[y]=function(q,re,ie,le,ce,fe,ye,Ue,Ge,We,Me,ht,nt,De,Qe,At,xt){var ut,Mt=xt-1>>1,_t=ce[fe+0]|ye[Ue+0]<<16,tr=Ge[We+0]|Me[ht+0]<<16;t(q!=null);var Dt=3*_t+tr+131074>>2;for(N(q[re+0],255&Dt,Dt>>16,nt,De),ie!=null&&(Dt=3*tr+_t+131074>>2,N(ie[le+0],255&Dt,Dt>>16,Qe,At)),ut=1;ut<=Mt;++ut){var qr=ce[fe+ut]|ye[Ue+ut]<<16,Jr=Ge[We+ut]|Me[ht+ut]<<16,Dr=_t+qr+tr+Jr+524296,Er=Dr+2*(qr+tr)>>3;Dt=Er+_t>>1,_t=(Dr=Dr+2*(_t+Jr)>>3)+qr>>1,N(q[re+2*ut-1],255&Dt,Dt>>16,nt,De+(2*ut-1)*P),N(q[re+2*ut-0],255&_t,_t>>16,nt,De+(2*ut-0)*P),ie!=null&&(Dt=Dr+tr>>1,_t=Er+Jr>>1,N(ie[le+2*ut-1],255&Dt,Dt>>16,Qe,At+(2*ut-1)*P),N(ie[le+2*ut+0],255&_t,_t>>16,Qe,At+(2*ut+0)*P)),_t=qr,tr=Jr}1&xt||(Dt=3*_t+tr+131074>>2,N(q[re+xt-1],255&Dt,Dt>>16,nt,De+(xt-1)*P),ie!=null&&(Dt=3*tr+_t+131074>>2,N(ie[le+xt-1],255&Dt,Dt>>16,Qe,At+(xt-1)*P)))}}function yt(){$i[Qp]=F7,$i[Mp]=Yj,$i[Kj]=E7,$i[Hp]=Jj,$i[Vp]=Zj,$i[v2]=eB,$i[zj]=k7,$i[w2]=Yj,$i[b2]=Jj,$i[$p]=Zj,$i[N2]=eB}function Qt(y){return y&~T7?0>y?0:255:y>>tB}function Yt(y,N){return Qt((19077*y>>8)+(26149*N>>8)-14234)}function gr(y,N,P){return Qt((19077*y>>8)-(6419*N>>8)-(13320*P>>8)+8708)}function fr(y,N){return Qt((19077*y>>8)+(33050*N>>8)-17685)}function Ir(y,N,P,q,re){q[re+0]=Yt(y,P),q[re+1]=gr(y,N,P),q[re+2]=fr(y,N)}function Ln(y,N,P,q,re){q[re+0]=fr(y,N),q[re+1]=gr(y,N,P),q[re+2]=Yt(y,P)}function Mn(y,N,P,q,re){var ie=gr(y,N,P);N=ie<<3&224|fr(y,N)>>3,q[re+0]=248&Yt(y,P)|ie>>5,q[re+1]=N}function cs(y,N,P,q,re){var ie=240&fr(y,N)|15;q[re+0]=240&Yt(y,P)|gr(y,N,P)>>4,q[re+1]=ie}function Zs(y,N,P,q,re){q[re+0]=255,Ir(y,N,P,q,re+1)}function Cs(y,N,P,q,re){Ln(y,N,P,q,re),q[re+3]=255}function Co(y,N,P,q,re){Ir(y,N,P,q,re),q[re+3]=255}function ci(y,N){return 0>y?0:y>N?N:y}function Jo(y,N,P){E[y]=function(q,re,ie,le,ce,fe,ye,Ue,Ge){for(var We=Ue+(-2&Ge)*P;Ue!=We;)N(q[re+0],ie[le+0],ce[fe+0],ye,Ue),N(q[re+1],ie[le+0],ce[fe+0],ye,Ue+P),re+=2,++le,++fe,Ue+=2*P;1&Ge&&N(q[re+0],ie[le+0],ce[fe+0],ye,Ue)}}function Ip(y,N,P){return P==0?y==0?N==0?6:5:N==0?4:0:P}function N0(y,N,P,q,re){switch(y>>>30){case 3:Il(N,P,q,re,0);break;case 2:Wn(N,P,q,re);break;case 1:Ca(N,P,q,re)}}function C0(y,N){var P,q,re=N.M,ie=N.Nb,le=y.oc,ce=y.pc+40,fe=y.oc,ye=y.pc+584,Ue=y.oc,Ge=y.pc+600;for(P=0;16>P;++P)le[ce+32*P-1]=129;for(P=0;8>P;++P)fe[ye+32*P-1]=129,Ue[Ge+32*P-1]=129;for(0<re?le[ce-1-32]=fe[ye-1-32]=Ue[Ge-1-32]=129:(s(le,ce-32-1,127,21),s(fe,ye-32-1,127,9),s(Ue,Ge-32-1,127,9)),q=0;q<y.za;++q){var We=N.ya[N.aa+q];if(0<q){for(P=-1;16>P;++P)n(le,ce+32*P-4,le,ce+32*P+12,4);for(P=-1;8>P;++P)n(fe,ye+32*P-4,fe,ye+32*P+4,4),n(Ue,Ge+32*P-4,Ue,Ge+32*P+4,4)}var Me=y.Gd,ht=y.Hd+q,nt=We.ad,De=We.Hc;if(0<re&&(n(le,ce-32,Me[ht].y,0,16),n(fe,ye-32,Me[ht].f,0,8),n(Ue,Ge-32,Me[ht].ea,0,8)),We.Za){var Qe=le,At=ce-32+16;for(0<re&&(q>=y.za-1?s(Qe,At,Me[ht].y[15],4):n(Qe,At,Me[ht+1].y,0,4)),P=0;4>P;P++)Qe[At+128+P]=Qe[At+256+P]=Qe[At+384+P]=Qe[At+0+P];for(P=0;16>P;++P,De<<=2)Qe=le,At=ce+nB[P],jo[We.Ob[P]](Qe,At),N0(De,nt,16*+P,Qe,At)}else if(Qe=Ip(q,re,We.Ob[0]),Sc[Qe](le,ce),De!=0)for(P=0;16>P;++P,De<<=2)N0(De,nt,16*+P,le,ce+nB[P]);for(P=We.Gc,Qe=Ip(q,re,We.Dd),Ul[Qe](fe,ye),Ul[Qe](Ue,Ge),De=nt,Qe=fe,At=ye,255&(We=P>>0)&&(170&We?E0(De,256,Qe,At):Qi(De,256,Qe,At)),We=Ue,De=Ge,255&(P>>=8)&&(170&P?E0(nt,320,We,De):Qi(nt,320,We,De)),re<y.Ub-1&&(n(Me[ht].y,0,le,ce+480,16),n(Me[ht].f,0,fe,ye+224,8),n(Me[ht].ea,0,Ue,Ge+224,8)),P=8*ie*y.B,Me=y.sa,ht=y.ta+16*q+16*ie*y.R,nt=y.qa,We=y.ra+8*q+P,De=y.Ha,Qe=y.Ia+8*q+P,P=0;16>P;++P)n(Me,ht+P*y.R,le,ce+32*P,16);for(P=0;8>P;++P)n(nt,We+P*y.B,fe,ye+32*P,8),n(De,Qe+P*y.B,Ue,Ge+32*P,8)}}function cu(y,N,P,q,re,ie,le,ce,fe){var ye=[0],Ue=[0],Ge=0,We=fe!=null?fe.kd:0,Me=fe??new y0;if(y==null||12>P)return 7;Me.data=y,Me.w=N,Me.ha=P,N=[N],P=[P],Me.gb=[Me.gb];e:{var ht=N,nt=P,De=Me.gb;if(t(y!=null),t(nt!=null),t(De!=null),De[0]=0,12<=nt[0]&&!r(y,ht[0],"RIFF")){if(r(y,ht[0]+8,"WEBP")){De=3;break e}var Qe=J(y,ht[0]+4);if(12>Qe||4294967286<Qe){De=3;break e}if(We&&Qe>nt[0]-8){De=7;break e}De[0]=Qe,ht[0]+=12,nt[0]-=12}De=0}if(De!=0)return De;for(Qe=0<Me.gb[0],P=P[0];;){e:{var At=y;nt=N,De=P;var xt=ye,ut=Ue,Mt=ht=[0];if((Dt=Ge=[Ge])[0]=0,8>De[0])De=7;else{if(!r(At,nt[0],"VP8X")){if(J(At,nt[0]+4)!=10){De=3;break e}if(18>De[0]){De=7;break e}var _t=J(At,nt[0]+8),tr=1+W(At,nt[0]+12);if(2147483648<=tr*(At=1+W(At,nt[0]+15))){De=3;break e}Mt!=null&&(Mt[0]=_t),xt!=null&&(xt[0]=tr),ut!=null&&(ut[0]=At),nt[0]+=18,De[0]-=18,Dt[0]=1}De=0}}if(Ge=Ge[0],ht=ht[0],De!=0)return De;if(nt=!!(2&ht),!Qe&&Ge)return 3;if(ie!=null&&(ie[0]=!!(16&ht)),le!=null&&(le[0]=nt),ce!=null&&(ce[0]=0),le=ye[0],ht=Ue[0],Ge&&nt&&fe==null){De=0;break}if(4>P){De=7;break}if(Qe&&Ge||!Qe&&!Ge&&!r(y,N[0],"ALPH")){P=[P],Me.na=[Me.na],Me.P=[Me.P],Me.Sa=[Me.Sa];e:{_t=y,De=N,Qe=P;var Dt=Me.gb;xt=Me.na,ut=Me.P,Mt=Me.Sa,tr=22,t(_t!=null),t(Qe!=null),At=De[0];var qr=Qe[0];for(t(xt!=null),t(Mt!=null),xt[0]=null,ut[0]=null,Mt[0]=0;;){if(De[0]=At,Qe[0]=qr,8>qr){De=7;break e}var Jr=J(_t,At+4);if(4294967286<Jr){De=3;break e}var Dr=8+Jr+1&-2;if(tr+=Dr,0<Dt&&tr>Dt){De=3;break e}if(!r(_t,At,"VP8 ")||!r(_t,At,"VP8L")){De=0;break e}if(qr[0]<Dr){De=7;break e}r(_t,At,"ALPH")||(xt[0]=_t,ut[0]=At+8,Mt[0]=Jr),At+=Dr,qr-=Dr}}if(P=P[0],Me.na=Me.na[0],Me.P=Me.P[0],Me.Sa=Me.Sa[0],De!=0)break}P=[P],Me.Ja=[Me.Ja],Me.xa=[Me.xa];e:if(Dt=y,De=N,Qe=P,xt=Me.gb[0],ut=Me.Ja,Mt=Me.xa,_t=De[0],At=!r(Dt,_t,"VP8 "),tr=!r(Dt,_t,"VP8L"),t(Dt!=null),t(Qe!=null),t(ut!=null),t(Mt!=null),8>Qe[0])De=7;else{if(At||tr){if(Dt=J(Dt,_t+4),12<=xt&&Dt>xt-12){De=3;break e}if(We&&Dt>Qe[0]-8){De=7;break e}ut[0]=Dt,De[0]+=8,Qe[0]-=8,Mt[0]=tr}else Mt[0]=5<=Qe[0]&&Dt[_t+0]==47&&!(Dt[_t+4]>>5),ut[0]=Qe[0];De=0}if(P=P[0],Me.Ja=Me.Ja[0],Me.xa=Me.xa[0],N=N[0],De!=0)break;if(4294967286<Me.Ja)return 3;if(ce==null||nt||(ce[0]=Me.xa?2:1),le=[le],ht=[ht],Me.xa){if(5>P){De=7;break}ce=le,We=ht,nt=ie,y==null||5>P?y=0:5<=P&&y[N+0]==47&&!(y[N+4]>>5)?(Qe=[0],Dt=[0],xt=[0],Y(ut=new b,y,N,P),Re(ut,Qe,Dt,xt)?(ce!=null&&(ce[0]=Qe[0]),We!=null&&(We[0]=Dt[0]),nt!=null&&(nt[0]=xt[0]),y=1):y=0):y=0}else{if(10>P){De=7;break}ce=ht,y==null||10>P||!ct(y,N+3,P-3)?y=0:(We=y[N+0]|y[N+1]<<8|y[N+2]<<16,nt=16383&(y[N+7]<<8|y[N+6]),y=16383&(y[N+9]<<8|y[N+8]),1&We||3<(We>>1&7)||!(We>>4&1)||We>>5>=Me.Ja||!nt||!y?y=0:(le&&(le[0]=nt),ce&&(ce[0]=y),y=1))}if(!y||(le=le[0],ht=ht[0],Ge&&(ye[0]!=le||Ue[0]!=ht)))return 3;fe!=null&&(fe[0]=Me,fe.offset=N-fe.w,t(4294967286>N-fe.w),t(fe.offset==fe.ha-P));break}return De==0||De==7&&Ge&&fe==null?(ie!=null&&(ie[0]|=Me.na!=null&&0<Me.na.length),q!=null&&(q[0]=le),re!=null&&(re[0]=ht),0):De}function j0(y,N,P){var q=N.width,re=N.height,ie=0,le=0,ce=q,fe=re;if(N.Da=y!=null&&0<y.Da,N.Da&&(ce=y.cd,fe=y.bd,ie=y.v,le=y.j,11>P||(ie&=-2,le&=-2),0>ie||0>le||0>=ce||0>=fe||ie+ce>q||le+fe>re))return 0;if(N.v=ie,N.j=le,N.va=ie+ce,N.o=le+fe,N.U=ce,N.T=fe,N.da=y!=null&&0<y.da,N.da){if(!je(ce,fe,P=[y.ib],ie=[y.hb]))return 0;N.ib=P[0],N.hb=ie[0]}return N.ob=y!=null&&y.ob,N.Kb=y==null||!y.Sd,N.da&&(N.ob=N.ib<3*q/4&&N.hb<3*re/4,N.Kb=0),1}function B0(y){if(y==null)return 2;if(11>y.S){var N=y.f.RGBA;N.fb+=(y.height-1)*N.A,N.A=-N.A}else N=y.f.kb,y=y.height,N.O+=(y-1)*N.fa,N.fa=-N.fa,N.N+=(y-1>>1)*N.Ab,N.Ab=-N.Ab,N.W+=(y-1>>1)*N.Db,N.Db=-N.Db,N.F!=null&&(N.J+=(y-1)*N.lb,N.lb=-N.lb);return 0}function Au(y,N,P,q){if(q==null||0>=y||0>=N)return 2;if(P!=null){if(P.Da){var re=P.cd,ie=P.bd,le=-2&P.v,ce=-2&P.j;if(0>le||0>ce||0>=re||0>=ie||le+re>y||ce+ie>N)return 2;y=re,N=ie}if(P.da){if(!je(y,N,re=[P.ib],ie=[P.hb]))return 2;y=re[0],N=ie[0]}}q.width=y,q.height=N;e:{var fe=q.width,ye=q.height;if(y=q.S,0>=fe||0>=ye||!(y>=Qp&&13>y))y=2;else{if(0>=q.Rd&&q.sd==null){le=ie=re=N=0;var Ue=(ce=fe*sB[y])*ye;if(11>y||(ie=(ye+1)/2*(N=(fe+1)/2),y==12&&(le=(re=fe)*ye)),(ye=i(Ue+2*ie+le))==null){y=1;break e}q.sd=ye,11>y?((fe=q.f.RGBA).eb=ye,fe.fb=0,fe.A=ce,fe.size=Ue):((fe=q.f.kb).y=ye,fe.O=0,fe.fa=ce,fe.Fd=Ue,fe.f=ye,fe.N=0+Ue,fe.Ab=N,fe.Cd=ie,fe.ea=ye,fe.W=0+Ue+ie,fe.Db=N,fe.Ed=ie,y==12&&(fe.F=ye,fe.J=0+Ue+2*ie),fe.Tc=le,fe.lb=re)}if(N=1,re=q.S,ie=q.width,le=q.height,re>=Qp&&13>re)if(11>re)y=q.f.RGBA,N&=(ce=Math.abs(y.A))*(le-1)+ie<=y.size,N&=ce>=ie*sB[re],N&=y.eb!=null;else{y=q.f.kb,ce=(ie+1)/2,Ue=(le+1)/2,fe=Math.abs(y.fa),ye=Math.abs(y.Ab);var Ge=Math.abs(y.Db),We=Math.abs(y.lb),Me=We*(le-1)+ie;N&=fe*(le-1)+ie<=y.Fd,N&=ye*(Ue-1)+ce<=y.Cd,N=(N&=Ge*(Ue-1)+ce<=y.Ed)&fe>=ie&ye>=ce&Ge>=ce,N&=y.y!=null,N&=y.f!=null,N&=y.ea!=null,re==12&&(N&=We>=ie,N&=Me<=y.Tc,N&=y.F!=null)}else N=0;y=N?0:2}}return y!=0||P!=null&&P.fd&&(y=B0(q)),y}var Rs=64,du=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],uu=24,fu=32,S0=8,Oa=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ze("Predictor0","PredictorAdd0"),E.Predictor0=function(){return 4278190080},E.Predictor1=function(y){return y},E.Predictor2=function(y,N,P){return N[P+0]},E.Predictor3=function(y,N,P){return N[P+1]},E.Predictor4=function(y,N,P){return N[P-1]},E.Predictor5=function(y,N,P){return ue(ue(y,N[P+1]),N[P+0])},E.Predictor6=function(y,N,P){return ue(y,N[P-1])},E.Predictor7=function(y,N,P){return ue(y,N[P+0])},E.Predictor8=function(y,N,P){return ue(N[P-1],N[P+0])},E.Predictor9=function(y,N,P){return ue(N[P+0],N[P+1])},E.Predictor10=function(y,N,P){return ue(ue(y,N[P-1]),ue(N[P+0],N[P+1]))},E.Predictor11=function(y,N,P){var q=N[P+0];return 0>=Te(q>>24&255,y>>24&255,(N=N[P-1])>>24&255)+Te(q>>16&255,y>>16&255,N>>16&255)+Te(q>>8&255,y>>8&255,N>>8&255)+Te(255&q,255&y,255&N)?q:y},E.Predictor12=function(y,N,P){var q=N[P+0];return(Fe((y>>24&255)+(q>>24&255)-((N=N[P-1])>>24&255))<<24|Fe((y>>16&255)+(q>>16&255)-(N>>16&255))<<16|Fe((y>>8&255)+(q>>8&255)-(N>>8&255))<<8|Fe((255&y)+(255&q)-(255&N)))>>>0},E.Predictor13=function(y,N,P){var q=N[P-1];return(ke((y=ue(y,N[P+0]))>>24&255,q>>24&255)<<24|ke(y>>16&255,q>>16&255)<<16|ke(y>>8&255,q>>8&255)<<8|ke(y>>0&255,q>>0&255))>>>0};var g2=E.PredictorAdd0;E.PredictorAdd1=Ne,Ze("Predictor2","PredictorAdd2"),Ze("Predictor3","PredictorAdd3"),Ze("Predictor4","PredictorAdd4"),Ze("Predictor5","PredictorAdd5"),Ze("Predictor6","PredictorAdd6"),Ze("Predictor7","PredictorAdd7"),Ze("Predictor8","PredictorAdd8"),Ze("Predictor9","PredictorAdd9"),Ze("Predictor10","PredictorAdd10"),Ze("Predictor11","PredictorAdd11"),Ze("Predictor12","PredictorAdd12"),Ze("Predictor13","PredictorAdd13");var F0=E.PredictorAdd2;Be("ColorIndexInverseTransform","MapARGB","32b",function(y){return y>>8&255},function(y){return y}),Be("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(y){return y},function(y){return y>>8&255});var Lp,Ri=E.ColorIndexInverseTransform,hu=E.MapARGB,Up=E.VP8LColorIndexInverseTransformAlpha,Dp=E.MapAlpha,Nc=E.VP8LPredictorsAdd=[];Nc.length=16,(E.VP8LPredictors=[]).length=16,(E.VP8LPredictorsAdd_C=[]).length=16,(E.VP8LPredictors_C=[]).length=16;var OA,Ra,Na,Cc,Tl,_l,mu,Il,Wn,E0,Ca,Qi,pu,Pp,k0,RA,QA,jc,MA,xu,HA,Bc,T0,Mi,Hi,hn,mn,Xn,gs=i(511),Ll=i(2041),_0=i(225),gu=i(767),Op=0,y2=Ll,Rp=_0,Ai=gu,Vi=gs,Qp=0,Mp=1,Kj=2,Hp=3,Vp=4,v2=5,zj=6,w2=7,b2=8,$p=9,N2=10,h7=[2,3,7],m7=[3,3,11],Gj=[280,256,256,256,40],p7=[0,1,1,1,0],x7=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],g7=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],y7=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],v7=8,C2=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],j2=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],I0=null,w7=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],b7=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Wj=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],N7=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],C7=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],j7=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],B7=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Sc=[],jo=[],Ul=[],S7=1,Xj=2,Fc=[],$i=[];it("UpsampleRgbLinePair",Ir,3),it("UpsampleBgrLinePair",Ln,3),it("UpsampleRgbaLinePair",Co,4),it("UpsampleBgraLinePair",Cs,4),it("UpsampleArgbLinePair",Zs,4),it("UpsampleRgba4444LinePair",cs,2),it("UpsampleRgb565LinePair",Mn,2);var F7=E.UpsampleRgbLinePair,E7=E.UpsampleBgrLinePair,Yj=E.UpsampleRgbaLinePair,Jj=E.UpsampleBgraLinePair,Zj=E.UpsampleArgbLinePair,eB=E.UpsampleRgba4444LinePair,k7=E.UpsampleRgb565LinePair,qp=16,Kp=1<<qp-1,L0=-227,B2=482,tB=6,T7=(256<<tB)-1,rB=0,_7=i(256),I7=i(256),L7=i(256),U7=i(256),D7=i(B2-L0),P7=i(B2-L0);Jo("YuvToRgbRow",Ir,3),Jo("YuvToBgrRow",Ln,3),Jo("YuvToRgbaRow",Co,4),Jo("YuvToBgraRow",Cs,4),Jo("YuvToArgbRow",Zs,4),Jo("YuvToRgba4444Row",cs,2),Jo("YuvToRgb565Row",Mn,2);var nB=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],zp=[0,2,8],O7=[8,7,6,4,4,2,2,2,1,1,1,1],R7=1;this.WebPDecodeRGBA=function(y,N,P,q,re){var ie=Mp,le=new ou,ce=new Gr;le.ba=ce,ce.S=ie,ce.width=[ce.width],ce.height=[ce.height];var fe=ce.width,ye=ce.height,Ue=new un;if(Ue==null||y==null)var Ge=2;else t(Ue!=null),Ge=cu(y,N,P,Ue.width,Ue.height,Ue.Pd,Ue.Qd,Ue.format,null);if(Ge!=0?fe=0:(fe!=null&&(fe[0]=Ue.width[0]),ye!=null&&(ye[0]=Ue.height[0]),fe=1),fe){ce.width=ce.width[0],ce.height=ce.height[0],q!=null&&(q[0]=ce.width),re!=null&&(re[0]=ce.height);e:{if(q=new Oi,(re=new y0).data=y,re.w=N,re.ha=P,re.kd=1,N=[0],t(re!=null),((y=cu(re.data,re.w,re.ha,null,null,null,N,null,re))==0||y==7)&&N[0]&&(y=4),(N=y)==0){if(t(le!=null),q.data=re.data,q.w=re.w+re.offset,q.ha=re.ha-re.offset,q.put=Ee,q.ac=It,q.bc=Oe,q.ma=le,re.xa){if((y=rt())==null){le=1;break e}if(function(We,Me){var ht=[0],nt=[0],De=[0];t:for(;;){if(We==null)return 0;if(Me==null)return We.a=2,0;if(We.l=Me,We.a=0,Y(We.m,Me.data,Me.w,Me.ha),!Re(We.m,ht,nt,De)){We.a=3;break t}if(We.xb=Xj,Me.width=ht[0],Me.height=nt[0],!$e(ht[0],nt[0],1,We,null))break t;return 1}return t(We.a!=0),0}(y,q)){if(q=(N=Au(q.width,q.height,le.Oa,le.ba))==0){t:{q=y;r:for(;;){if(q==null){q=0;break t}if(t(q.s.yc!=null),t(q.s.Ya!=null),t(0<q.s.Wb),t((P=q.l)!=null),t((re=P.ma)!=null),q.xb!=0){if(q.ca=re.ba,q.tb=re.tb,t(q.ca!=null),!j0(re.Oa,P,Hp)){q.a=2;break r}if(!Xe(q,P.width)||P.da)break r;if((P.da||$t(q.ca.S))&&Ve(),11>q.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),q.ca.f.kb.F!=null&&Ve()),q.Pb&&0<q.s.ua&&q.s.vb.X==null&&!ve(q.s.vb,q.s.Wa.Xa)){q.a=1;break r}q.xb=0}if(!we(q,q.V,q.Ba,q.c,q.i,P.o,pe))break r;re.Dc=q.Ma,q=1;break t}t(q.a!=0),q=0}q=!q}q&&(N=y.a)}else N=y.a}else{if((y=new Ke)==null){le=1;break e}if(y.Fa=re.na,y.P=re.P,y.qc=re.Sa,jt(y,q)){if((N=Au(q.width,q.height,le.Oa,le.ba))==0){if(y.Aa=0,P=le.Oa,t((re=y)!=null),P!=null){if(0<(fe=0>(fe=P.Md)?0:100<fe?255:255*fe/100)){for(ye=Ue=0;4>ye;++ye)12>(Ge=re.pb[ye]).lc&&(Ge.ia=fe*O7[0>Ge.lc?0:Ge.lc]>>3),Ue|=Ge.ia;Ue&&(alert("todo:VP8InitRandom"),re.ia=1)}re.Ga=P.Id,100<re.Ga?re.Ga=100:0>re.Ga&&(re.Ga=0)}Pt(y,q)||(N=y.a)}}else N=y.a}N==0&&le.Oa!=null&&le.Oa.fd&&(N=B0(le.ba))}le=N}ie=le!=0?null:11>ie?ce.f.RGBA.eb:ce.f.kb.y}else ie=null;return ie};var sB=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function A(E,L){for(var M="",F=0;F<4;F++)M+=String.fromCharCode(E[L++]);return M}function d(E,L){return(E[L+0]<<0|E[L+1]<<8|E[L+2]<<16)>>>0}function u(E,L){return(E[L+0]<<0|E[L+1]<<8|E[L+2]<<16|E[L+3]<<24)>>>0}new c;var f=[0],h=[0],x=[],m=new c,g=e,p=function(E,L){var M={},F=0,D=!1,G=0,K=0;if(M.frames=[],!function(O,S,I,U){for(var Q=0;Q<U;Q++)if(O[S+Q]!=I.charCodeAt(Q))return!0;return!1}(E,L,"RIFF",4)){var ae,Z;for(u(E,L+=4),L+=8;L<E.length;){var oe=A(E,L),Y=u(E,L+=4);L+=4;var R=Y+(1&Y);switch(oe){case"VP8 ":case"VP8L":M.frames[F]===void 0&&(M.frames[F]={}),(b=M.frames[F]).src_off=D?K:L-8,b.src_size=G+Y+8,F++,D&&(D=!1,G=0,K=0);break;case"VP8X":(b=M.header={}).feature_flags=E[L];var z=L+4;b.canvas_width=1+d(E,z),z+=3,b.canvas_height=1+d(E,z),z+=3;break;case"ALPH":D=!0,G=R+8,K=L-8;break;case"ANIM":(b=M.header).bgcolor=u(E,L),z=L+4,b.loop_count=(ae=E)[(Z=z)+0]<<0|ae[Z+1]<<8,z+=2;break;case"ANMF":var ee,b;(b=M.frames[F]={}).offset_x=2*d(E,L),L+=3,b.offset_y=2*d(E,L),L+=3,b.width=1+d(E,L),L+=3,b.height=1+d(E,L),L+=3,b.duration=d(E,L),L+=3,ee=E[L++],b.dispose=1&ee,b.blend=ee>>1&1}oe!="ANMF"&&(L+=R)}return M}}(g,0);p.response=g,p.rgbaoutput=!0,p.dataurl=!1;var v=p.header?p.header:null,w=p.frames?p.frames:null;if(v){v.loop_counter=v.loop_count,f=[v.canvas_height],h=[v.canvas_width];for(var B=0;B<w.length&&w[B].blend!=0;B++);}var T=w[0],_=m.WebPDecodeRGBA(g,T.src_off,T.src_size,h,f);T.rgba=_,T.imgwidth=h[0],T.imgheight=f[0];for(var j=0;j<h[0]*f[0]*4;j++)x[j]=_[j];return this.width=h,this.height=f,this.data=x,this}(function(e){var t=function(){return typeof _5=="function"},r=function(f,h,x,m){var g=4,p=o;switch(m){case e.image_compression.FAST:g=1,p=i;break;case e.image_compression.MEDIUM:g=6,p=l;break;case e.image_compression.SLOW:g=9,p=c}f=n(f,h,x,p);var v=_5(f,{level:g});return e.__addimage__.arrayBufferToBinaryString(v)},n=function(f,h,x,m){for(var g,p,v,w=f.length/h,B=new Uint8Array(f.length+w),T=d(),_=0;_<w;_+=1){if(v=_*h,g=f.subarray(v,v+h),m)B.set(m(g,x,p),v+_);else{for(var j,E=T.length,L=[];j<E;j+=1)L[j]=T[j](g,x,p);var M=u(L.concat());B.set(L[M],v+_)}p=g}return B},s=function(f){var h=Array.apply([],f);return h.unshift(0),h},i=function(f,h){var x,m=[],g=f.length;m[0]=1;for(var p=0;p<g;p+=1)x=f[p-h]||0,m[p+1]=f[p]-x+256&255;return m},o=function(f,h,x){var m,g=[],p=f.length;g[0]=2;for(var v=0;v<p;v+=1)m=x&&x[v]||0,g[v+1]=f[v]-m+256&255;return g},l=function(f,h,x){var m,g,p=[],v=f.length;p[0]=3;for(var w=0;w<v;w+=1)m=f[w-h]||0,g=x&&x[w]||0,p[w+1]=f[w]+256-(m+g>>>1)&255;return p},c=function(f,h,x){var m,g,p,v,w=[],B=f.length;w[0]=4;for(var T=0;T<B;T+=1)m=f[T-h]||0,g=x&&x[T]||0,p=x&&x[T-h]||0,v=A(m,g,p),w[T+1]=f[T]-v+256&255;return w},A=function(f,h,x){if(f===h&&h===x)return f;var m=Math.abs(h-x),g=Math.abs(f-x),p=Math.abs(f+h-x-x);return m<=g&&m<=p?f:g<=p?h:x},d=function(){return[s,i,o,l,c]},u=function(f){var h=f.map(function(x){return x.reduce(function(m,g){return m+Math.abs(g)},0)});return h.indexOf(Math.min.apply(null,h))};e.processPNG=function(f,h,x,m){var g,p,v,w,B,T,_,j,E,L,M,F,D,G,K,ae=this.decode.FLATE_DECODE,Z="";if(this.__addimage__.isArrayBuffer(f)&&(f=new Uint8Array(f)),this.__addimage__.isArrayBufferView(f)){if(f=(v=new i1e(f)).imgData,p=v.bits,g=v.colorSpace,B=v.colors,[4,6].indexOf(v.colorType)!==-1){if(v.bits===8){E=(j=v.pixelBitlength==32?new Uint32Array(v.decodePixels().buffer):v.pixelBitlength==16?new Uint16Array(v.decodePixels().buffer):new Uint8Array(v.decodePixels().buffer)).length,M=new Uint8Array(E*v.colors),L=new Uint8Array(E);var oe,Y=v.pixelBitlength-v.bits;for(G=0,K=0;G<E;G++){for(D=j[G],oe=0;oe<Y;)M[K++]=D>>>oe&255,oe+=v.bits;L[G]=D>>>oe&255}}if(v.bits===16){E=(j=new Uint32Array(v.decodePixels().buffer)).length,M=new Uint8Array(E*(32/v.pixelBitlength)*v.colors),L=new Uint8Array(E*(32/v.pixelBitlength)),F=v.colors>1,G=0,K=0;for(var R=0;G<E;)D=j[G++],M[K++]=D>>>0&255,F&&(M[K++]=D>>>16&255,D=j[G++],M[K++]=D>>>0&255),L[R++]=D>>>16&255;p=8}m!==e.image_compression.NONE&&t()?(f=r(M,v.width*v.colors,v.colors,m),_=r(L,v.width,1,m)):(f=M,_=L,ae=void 0)}if(v.colorType===3&&(g=this.color_spaces.INDEXED,T=v.palette,v.transparency.indexed)){var z=v.transparency.indexed,ee=0;for(G=0,E=z.length;G<E;++G)ee+=z[G];if((ee/=255)===E-1&&z.indexOf(0)!==-1)w=[z.indexOf(0)];else if(ee!==E){for(j=v.decodePixels(),L=new Uint8Array(j.length),G=0,E=j.length;G<E;G++)L[G]=z[j[G]];_=r(L,v.width,1)}}var b=function(O){var S;switch(O){case e.image_compression.FAST:S=11;break;case e.image_compression.MEDIUM:S=13;break;case e.image_compression.SLOW:S=14;break;default:S=12}return S}(m);return ae===this.decode.FLATE_DECODE&&(Z="/Predictor "+b+" "),Z+="/Colors "+B+" /BitsPerComponent "+p+" /Columns "+v.width,(this.__addimage__.isArrayBuffer(f)||this.__addimage__.isArrayBufferView(f))&&(f=this.__addimage__.arrayBufferToBinaryString(f)),(_&&this.__addimage__.isArrayBuffer(_)||this.__addimage__.isArrayBufferView(_))&&(_=this.__addimage__.arrayBufferToBinaryString(_)),{alias:x,data:f,index:h,filter:ae,decodeParameters:Z,transparency:w,palette:T,sMask:_,predictor:b,width:v.width,height:v.height,bitsPerComponent:p,colorSpace:g}}}})(lr.API),function(e){e.processGIF89A=function(t,r,n,s){var i=new o1e(t),o=i.width,l=i.height,c=[];i.decodeAndBlitFrameRGBA(0,c);var A={data:c,width:o,height:l},d=new yb(100).encode(A,100);return e.processJPEG.call(this,d,r,n,s)},e.processGIF87A=e.processGIF89A}(lr.API),ko.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:s,green:n,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},ko.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){dn.log("bit decode error:"+r)}},ko.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,s=0;s<t;s++)for(var i=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*s*4,l=0;l<8&&8*s+l<this.width;l++){var c=this.palette[i>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},ko.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<e;s++){var i=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*s*4,l=i>>4,c=15&i,A=this.palette[l];if(this.data[o]=A.blue,this.data[o+1]=A.green,this.data[o+2]=A.red,this.data[o+3]=255,2*s+1>=this.width)break;A=this.palette[c],this.data[o+4]=A.blue,this.data[o+4+1]=A.green,this.data[o+4+2]=A.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},ko.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*n;if(s<this.palette.length){var o=this.palette[s];this.data[i]=o.red,this.data[i+1]=o.green,this.data[i+2]=o.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}e!==0&&(this.pos+=4-e)}},ko.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&t)/t*255|0,l=(i>>5&t)/t*255|0,c=(i>>10&t)/t*255|0,A=i>>15?255:0,d=n*this.width*4+4*s;this.data[d]=c,this.data[d+1]=l,this.data[d+2]=o,this.data[d+3]=A}this.pos+=e}},ko.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&t)/t*255|0,c=(o>>5&r)/r*255|0,A=(o>>11)/t*255|0,d=s*this.width*4+4*i;this.data[d]=A,this.data[d+1]=c,this.data[d+2]=l,this.data[d+3]=255}this.pos+=e}},ko.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=i,this.data[o+1]=s,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},ko.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=i,this.data[l+1]=s,this.data[l+2]=n,this.data[l+3]=o}},ko.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,s){var i=new ko(t,!1),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},A=new yb(100).encode(c,100);return e.processJPEG.call(this,A,r,n,s)}}(lr.API),Xk.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,s){var i=new Xk(t),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},A=new yb(100).encode(c,100);return e.processJPEG.call(this,A,r,n,s)}}(lr.API),lr.API.processRGBA=function(e,t,r){for(var n=e.data,s=n.length,i=new Uint8Array(s/4*3),o=new Uint8Array(s/4),l=0,c=0,A=0;A<s;A+=4){var d=n[A],u=n[A+1],f=n[A+2],h=n[A+3];i[l++]=d,i[l++]=u,i[l++]=f,o[c++]=h}var x=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:x,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},lr.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Du=lr.API,gg=Du.getCharWidthsArray=function(e,t){var r,n,s=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:s.metadata.Unicode.widths,c=l.fof?l.fof:1,A=t.kerning?t.kerning:s.metadata.Unicode.kerning,d=A.fof?A.fof:1,u=t.doKerning!==!1,f=0,h=e.length,x=0,m=l[0]||c,g=[];for(r=0;r<h;r++)n=e.charCodeAt(r),typeof s.metadata.widthOfString=="function"?g.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+o*(1e3/i)||0)/1e3):(f=u&&Ur(A[n])==="object"&&!isNaN(parseInt(A[n][x],10))?A[n][x]/d:0,g.push((l[n]||m)/c+f)),x=n;return g},Kk=Du.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),s=t.charSpace||this.internal.getCharSpace();return Du.processArabic&&(e=Du.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,s)/r:gg.apply(this,arguments).reduce(function(i,o){return i+o},0)},zk=function(e,t,r,n){for(var s=[],i=0,o=e.length,l=0;i!==o&&l+t[i]<r;)l+=t[i],i++;s.push(e.slice(0,i));var c=i;for(l=0;i!==o;)l+t[i]>n&&(s.push(e.slice(c,i)),l=0,c=i),l+=t[i],i++;return c!==i&&s.push(e.slice(c,i)),s},Gk=function(e,t,r){r||(r={});var n,s,i,o,l,c,A,d=[],u=[d],f=r.textIndent||0,h=0,x=0,m=e.split(" "),g=gg.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?m[0].length+2:r.lineIndent||0){var p=Array(c).join(" "),v=[];m.map(function(B){(B=B.split(/\s*\n/)).length>1?v=v.concat(B.map(function(T,_){return(_&&T.length?`
`:"")+T})):v.push(B[0])}),m=v,c=Kk.apply(this,[p,r])}for(i=0,o=m.length;i<o;i++){var w=0;if(n=m[i],c&&n[0]==`
`&&(n=n.substr(1),w=1),f+h+(x=(s=gg.apply(this,[n,r])).reduce(function(B,T){return B+T},0))>t||w){if(x>t){for(l=zk.apply(this,[n,s,t-(f+h),t]),d.push(l.shift()),d=[l.pop()];l.length;)u.push([l.shift()]);x=s.slice(n.length-(d[0]?d[0].length:0)).reduce(function(B,T){return B+T},0)}else d=[n];u.push(d),f=x+c,h=g}else d.push(n),f+=h+x,h=g}return A=c?function(B,T){return(T?p:"")+B.join(" ")}:function(B){return B.join(" ")},u.map(A)},Du.splitTextToSize=function(e,t,r){var n,s=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var u=this.internal.getFont(d.fontName,d.fontStyle);return u.metadata.Unicode?{widths:u.metadata.Unicode.widths||{0:1},kerning:u.metadata.Unicode.kerning||{}}:{font:u.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/s;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/s:0,i.lineIndent=r.lineIndent;var l,c,A=[];for(l=0,c=n.length;l<c;l++)A=A.concat(Gk.apply(this,[n[l],o,i]));return A},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",r={},n={},s=0;s<t.length;s++)r[t[s]]="0123456789abcdef"[s],n["0123456789abcdef"[s]]=t[s];var i=function(u){return"0x"+parseInt(u,10).toString(16)},o=e.__fontmetrics__.compress=function(u){var f,h,x,m,g=["{"];for(var p in u){if(f=u[p],isNaN(parseInt(p,10))?h="'"+p+"'":(p=parseInt(p,10),h=(h=i(p).slice(2)).slice(0,-1)+n[h.slice(-1)]),typeof f=="number")f<0?(x=i(f).slice(3),m="-"):(x=i(f).slice(2),m=""),x=m+x.slice(0,-1)+n[x.slice(-1)];else{if(Ur(f)!=="object")throw new Error("Don't know what to do with value type "+Ur(f)+".");x=o(f)}g.push(h+x)}return g.push("}"),g.join("")},l=e.__fontmetrics__.uncompress=function(u){if(typeof u!="string")throw new Error("Invalid argument passed to uncompress.");for(var f,h,x,m,g={},p=1,v=g,w=[],B="",T="",_=u.length-1,j=1;j<_;j+=1)(m=u[j])=="'"?f?(x=f.join(""),f=void 0):f=[]:f?f.push(m):m=="{"?(w.push([v,x]),v={},x=void 0):m=="}"?((h=w.pop())[0][h[1]]=v,x=void 0,v=h[0]):m=="-"?p=-1:x===void 0?r.hasOwnProperty(m)?(B+=r[m],x=parseInt(B,16)*p,p=1,B=""):B+=m:r.hasOwnProperty(m)?(T+=r[m],v[x]=parseInt(T,16)*p,p=1,x=void 0,T=""):T+=m;return g},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},A={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},d={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(u){var f=u.font,h=d.Unicode[f.postScriptName];h&&(f.metadata.Unicode={},f.metadata.Unicode.widths=h.widths,f.metadata.Unicode.kerning=h.kerning);var x=A.Unicode[f.postScriptName];x&&(f.metadata.Unicode.encoding=x,f.encoding=x.codePages[0])}])}(lr.API),function(e){var t=function(r){for(var n=r.length,s=new Uint8Array(n),i=0;i<n;i++)s[i]=r.charCodeAt(i);return s};e.API.events.push(["addFont",function(r){var n=void 0,s=r.font,i=r.instance;if(!s.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=i.existsFileInVFS(s.postScriptName)===!1?i.loadFile(s.postScriptName):i.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?t(l):t(Gh(l)),o.metadata=e.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(s,n)}}])}(lr),function(e){function t(){return(cr.canvg?Promise.resolve(cr.canvg):S5(()=>import("./index.es-D27Wuaf0.js"),[])).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}lr.API.addSvgAsImage=function(r,n,s,i,o,l,c,A){if(isNaN(n)||isNaN(s))throw dn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(o))throw dn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var d=document.createElement("canvas");d.width=i,d.height=o;var u=d.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,d.width,d.height);var f={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return t().then(function(x){return x.fromString(u,r,f)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(x){return x.render(f)}).then(function(){h.addImage(d.toDataURL("image/jpeg",1),n,s,i,o,c,A)})}}(),lr.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(t,r);return this},lr.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,s,i,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],A=0,d=0,u=0;function f(x,m){var g,p=!1;for(g=0;g<x.length;g+=1)x[g]===m&&(p=!0);return p}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var h=l.length;for(u=0;u<h;u+=1)r[l[u]].value=r[l[u]].defaultValue,r[l[u]].explicitSet=!1}if(Ur(e)==="object"){for(s in e)if(i=e[s],f(l,s)&&i!==void 0){if(r[s].type==="boolean"&&typeof i=="boolean")r[s].value=i;else if(r[s].type==="name"&&f(r[s].valueSet,i))r[s].value=i;else if(r[s].type==="integer"&&Number.isInteger(i))r[s].value=i;else if(r[s].type==="array"){for(A=0;A<i.length;A+=1)if(n=!0,i[A].length===1&&typeof i[A][0]=="number")c.push(String(i[A]-1));else if(i[A].length>1){for(d=0;d<i[A].length;d+=1)typeof i[A][d]!="number"&&(n=!1);n===!0&&c.push([i[A][0]-1,i[A][1]-1].join(" "))}r[s].value="["+c.join(" ")+"]"}else r[s].value=r[s].defaultValue;r[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var x,m=[];for(x in r)r[x].explicitSet===!0&&(r[x].type==="name"?m.push("/"+x+" /"+r[x].value):m.push("/"+x+" "+r[x].value));m.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+m.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),A=i.length+o.length+l.length+s.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+A+" >>"),this.internal.write("stream"),this.internal.write(s+i+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(lr.API),function(e){var t=e.API,r=t.pdfEscape16=function(i,o){for(var l,c=o.metadata.Unicode.widths,A=["","0","00","000","0000"],d=[""],u=0,f=i.length;u<f;++u){if(l=o.metadata.characterToGlyph(i.charCodeAt(u)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=i.charCodeAt(u),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return d.join("");l=l.toString(16),d.push(A[4-l.length],l)}return d.join("")},n=function(i){var o,l,c,A,d,u,f;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],u=0,f=(l=Object.keys(i).sort(function(h,x){return h-x})).length;u<f;u++)o=l[u],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),i[o]!==void 0&&i[o]!==null&&typeof i[o].toString=="function"&&(A=("0000"+i[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+A+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,A=o.newObject,d=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="Identity-H"){for(var u=l.metadata.Unicode.widths,f=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),h="",x=0;x<f.length;x++)h+=String.fromCharCode(f[x]);var m=A();d({data:h,addLength1:!0,objectId:m}),c("endobj");var g=A();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:g}),c("endobj");var p=A();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Hu(l.fontName)),c("/FontFile2 "+m+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var v=A();c("<<"),c("/Type /Font"),c("/BaseFont /"+Hu(l.fontName)),c("/FontDescriptor "+p+" 0 R"),c("/W "+e.API.PDFObject.convert(u)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=A(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+g+" 0 R"),c("/BaseFont /"+Hu(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+v+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,A=o.newObject,d=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var u=l.metadata.rawData,f="",h=0;h<u.length;h++)f+=String.fromCharCode(u[h]);var x=A();d({data:f,addLength1:!0,objectId:x}),c("endobj");var m=A();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:m}),c("endobj");var g=A();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+x+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Hu(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=A();for(var p=0;p<l.metadata.hmtx.widths.length;p++)l.metadata.hmtx.widths[p]=parseInt(l.metadata.hmtx.widths[p]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+m+" 0 R/BaseFont/"+Hu(l.fontName)+"/FontDescriptor "+g+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]);var s=function(i){var o,l=i.text||"",c=i.x,A=i.y,d=i.options||{},u=i.mutex||{},f=u.pdfEscape,h=u.activeFontKey,x=u.fonts,m=h,g="",p=0,v="",w=x[m].encoding;if(x[m].encoding!=="Identity-H")return{text:l,x:c,y:A,options:d,mutex:u};for(v=l,m=h,Array.isArray(l)&&(v=l[0]),p=0;p<v.length;p+=1)x[m].metadata.hasOwnProperty("cmap")&&(o=x[m].metadata.cmap.unicode.codeMap[v[p].charCodeAt(0)]),o||v[p].charCodeAt(0)<256&&x[m].metadata.hasOwnProperty("Unicode")?g+=v[p]:g+="";var B="";return parseInt(m.slice(1))<14||w==="WinAnsiEncoding"?B=f(g,m).split("").map(function(T){return T.charCodeAt(0).toString(16)}).join(""):w==="Identity-H"&&(B=r(g,x[m])),u.isHex=!0,{text:B,x:c,y:A,options:d,mutex:u}};t.events.push(["postProcessText",function(i){var o=i.text||"",l=[],c={text:o,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(o)){var A=0;for(A=0;A<o.length;A+=1)Array.isArray(o[A])&&o[A].length===3?l.push([s(Object.assign({},c,{text:o[A][0]})).text,o[A][1],o[A][2]]):l.push(s(Object.assign({},c,{text:o[A]})).text);i.text=l}else i.text=s(Object.assign({},c,{text:o})).text}])}(lr),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(lr.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var s,i,o,l,c,A,d,u=t,f=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],x={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},m={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},g=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],p=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),v=!1,w=0;this.__bidiEngine__={};var B=function(F){var D=F.charCodeAt(),G=D>>8,K=m[G];return K!==void 0?u[256*K+(255&D)]:G===252||G===253?"AL":p.test(G)?"L":G===8?"R":"N"},T=function(F){for(var D,G=0;G<F.length;G++){if((D=B(F.charAt(G)))==="L")return!1;if(D==="R")return!0}return!1},_=function(F,D,G,K){var ae,Z,oe,Y,R=D[K];switch(R){case"L":case"R":v=!1;break;case"N":case"AN":break;case"EN":v&&(R="AN");break;case"AL":v=!0,R="R";break;case"WS":R="N";break;case"CS":K<1||K+1>=D.length||(ae=G[K-1])!=="EN"&&ae!=="AN"||(Z=D[K+1])!=="EN"&&Z!=="AN"?R="N":v&&(Z="AN"),R=Z===ae?Z:"N";break;case"ES":R=(ae=K>0?G[K-1]:"B")==="EN"&&K+1<D.length&&D[K+1]==="EN"?"EN":"N";break;case"ET":if(K>0&&G[K-1]==="EN"){R="EN";break}if(v){R="N";break}for(oe=K+1,Y=D.length;oe<Y&&D[oe]==="ET";)oe++;R=oe<Y&&D[oe]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(Y=D.length,oe=K+1;oe<Y&&D[oe]==="NSM";)oe++;if(oe<Y){var z=F[K],ee=z>=1425&&z<=2303||z===64286;if(ae=D[oe],ee&&(ae==="R"||ae==="AL")){R="R";break}}}R=K<1||(ae=D[K-1])==="B"?"N":G[K-1];break;case"B":v=!1,s=!0,R=w;break;case"S":i=!0,R="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":v=!1;break;case"BN":R="N"}return R},j=function(F,D,G){var K=F.split("");return G&&E(K,G,{hiLevel:w}),K.reverse(),D&&D.reverse(),K.join("")},E=function(F,D,G){var K,ae,Z,oe,Y,R=-1,z=F.length,ee=0,b=[],O=w?h:f,S=[];for(v=!1,s=!1,i=!1,ae=0;ae<z;ae++)S[ae]=B(F[ae]);for(Z=0;Z<z;Z++){if(Y=ee,b[Z]=_(F,S,b,Z),K=240&(ee=O[Y][x[b[Z]]]),ee&=15,D[Z]=oe=O[ee][5],K>0)if(K===16){for(ae=R;ae<Z;ae++)D[ae]=1;R=-1}else R=-1;if(O[ee][6])R===-1&&(R=Z);else if(R>-1){for(ae=R;ae<Z;ae++)D[ae]=oe;R=-1}S[Z]==="B"&&(D[Z]=0),G.hiLevel|=oe}i&&function(I,U,Q){for(var H=0;H<Q;H++)if(I[H]==="S"){U[H]=w;for(var X=H-1;X>=0&&I[X]==="WS";X--)U[X]=w}}(S,D,z)},L=function(F,D,G,K,ae){if(!(ae.hiLevel<F)){if(F===1&&w===1&&!s)return D.reverse(),void(G&&G.reverse());for(var Z,oe,Y,R,z=D.length,ee=0;ee<z;){if(K[ee]>=F){for(Y=ee+1;Y<z&&K[Y]>=F;)Y++;for(R=ee,oe=Y-1;R<oe;R++,oe--)Z=D[R],D[R]=D[oe],D[oe]=Z,G&&(Z=G[R],G[R]=G[oe],G[oe]=Z);ee=Y}ee++}}},M=function(F,D,G){var K=F.split(""),ae={hiLevel:w};return G||(G=[]),E(K,G,ae),function(Z,oe,Y){if(Y.hiLevel!==0&&d)for(var R,z=0;z<Z.length;z++)oe[z]===1&&(R=g.indexOf(Z[z]))>=0&&(Z[z]=g[R+1])}(K,G,ae),L(2,K,D,G,ae),L(1,K,D,G,ae),K.join("")};return this.__bidiEngine__.doBidiReorder=function(F,D,G){if(function(ae,Z){if(Z)for(var oe=0;oe<ae.length;oe++)Z[oe]=oe;l===void 0&&(l=T(ae)),A===void 0&&(A=T(ae))}(F,D),o||!c||A)if(o&&c&&l^A)w=l?1:0,F=j(F,D,G);else if(!o&&c&&A)w=l?1:0,F=M(F,D,G),F=j(F,D);else if(!o||l||c||A){if(o&&!c&&l^A)F=j(F,D),l?(w=0,F=M(F,D,G)):(w=1,F=M(F,D,G),F=j(F,D));else if(o&&l&&!c&&A)w=1,F=M(F,D,G),F=j(F,D);else if(!o&&!c&&l^A){var K=d;l?(w=1,F=M(F,D,G),w=0,d=!1,F=M(F,D,G),d=K):(w=0,F=M(F,D,G),F=j(F,D),w=1,d=!1,F=M(F,D,G),d=K,F=j(F,D))}}else w=0,F=M(F,D,G);else w=l?1:0,F=M(F,D,G);return F},this.__bidiEngine__.setOptions=function(F){F&&(o=F.isInputVisual,c=F.isOutputVisual,l=F.isInputRtl,A=F.isOutputRtl,d=F.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var s=n.text,i=(n.x,n.y,n.options||{}),o=(n.mutex,i.lang,[]);if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(s)==="[object Array]"){var l=0;for(o=[],l=0;l<s.length;l+=1)Object.prototype.toString.call(s[l])==="[object Array]"?o.push([r.doBidiReorder(s[l][0]),s[l][1],s[l][2]]):o.push([r.doBidiReorder(s[l])]);n.text=o}else n.text=r.doBidiReorder(s);r.setOptions({isInputVisual:!0})}])}(lr),lr.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new jA(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new b1e(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new l1e(this.contents),this.head=new A1e(this),this.name=new m1e(this),this.cmap=new lO(this),this.toUnicode={},this.hhea=new d1e(this),this.maxp=new p1e(this),this.hmtx=new x1e(this),this.post=new f1e(this),this.os2=new u1e(this),this.loca=new w1e(this),this.glyf=new g1e(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,s,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,A;for(A=[],o=0,l=(c=this.bbox).length;o<l;o++)t=c[o],A.push(Math.round(t*this.scaleFactor));return A}).call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),32768&(r=s>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var s,i,o,l;for(o=0,i=0,l=(t=""+t).length;0<=l?i<l:i>l;i=0<=l?++i:--i)s=t.charCodeAt(i),o+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/r)||0;return o*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var Wo,jA=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,s;for(s=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)s.push(this.writeByte(t.charCodeAt(r)));return s},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,s,i,o,l,c;return t=this.readByte(),r=this.readByte(),n=this.readByte(),s=this.readByte(),i=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^i)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*s+16777216*i+65536*o+256*l+c},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,s,i;for(i=[],n=0,s=t.length;n<s;n++)r=t[n],i.push(this.writeByte(r));return i},e}(),l1e=function(){var e;function t(r){var n,s,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},s=0,i=this.tableCount;0<=i?s<i:s>i;s=0<=i?++s:--s)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,s,i,o,l,c,A,d,u,f,h,x,m;for(m in h=Object.keys(r).length,c=Math.log(2),u=16*Math.floor(Math.log(h)/c),o=Math.floor(u/c),d=16*h-u,(s=new jA).writeInt(this.scalarType),s.writeShort(h),s.writeShort(u),s.writeShort(o),s.writeShort(d),i=16*h,A=s.pos+i,l=null,x=[],r)for(f=r[m],s.writeString(m),s.writeInt(e(f)),s.writeInt(A),s.writeInt(f.length),x=x.concat(f),m==="head"&&(l=A),A+=f.length;A%4;)x.push(0),A++;return s.write(x),n=2981146554-e(s.data),s.pos=l+8,s.writeUInt32(n),s.data},e=function(r){var n,s,i,o;for(r=cO.call(r);r.length%4;)r.push(0);for(i=new jA(r),s=0,n=0,o=r.length;n<o;n=n+=4)s+=i.readUInt32();return 4294967295&s},t}(),c1e={}.hasOwnProperty,Fl=function(e,t){for(var r in t)c1e.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};Wo=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var A1e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Fl(t,Wo),t.prototype.tag="head",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},t.prototype.encode=function(r){var n;return(n=new jA).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},t}(),Yk=function(){function e(t,r){var n,s,i,o,l,c,A,d,u,f,h,x,m,g,p,v,w;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),u=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(h=t.readUInt16(),f=h/2,t.pos+=6,i=function(){var B,T;for(T=[],c=B=0;0<=f?B<f:B>f;c=0<=f?++B:--B)T.push(t.readUInt16());return T}(),t.pos+=2,m=function(){var B,T;for(T=[],c=B=0;0<=f?B<f:B>f;c=0<=f?++B:--B)T.push(t.readUInt16());return T}(),A=function(){var B,T;for(T=[],c=B=0;0<=f?B<f:B>f;c=0<=f?++B:--B)T.push(t.readUInt16());return T}(),d=function(){var B,T;for(T=[],c=B=0;0<=f?B<f:B>f;c=0<=f?++B:--B)T.push(t.readUInt16());return T}(),s=(this.length-t.pos+this.offset)/2,l=function(){var B,T;for(T=[],c=B=0;0<=s?B<s:B>s;c=0<=s?++B:--B)T.push(t.readUInt16());return T}(),c=p=0,w=i.length;p<w;c=++p)for(g=i[c],n=v=x=m[c];x<=g?v<=g:v>=g;n=x<=g?++v:--v)d[c]===0?o=n+A[c]:(o=l[d[c]/2+(n-x)-(f-c)]||0)!==0&&(o+=A[c]),this.codeMap[n]=65535&o}t.pos=u}return e.encode=function(t,r){var n,s,i,o,l,c,A,d,u,f,h,x,m,g,p,v,w,B,T,_,j,E,L,M,F,D,G,K,ae,Z,oe,Y,R,z,ee,b,O,S,I,U,Q,H,X,V,Ae,W;switch(K=new jA,o=Object.keys(t).sort(function(J,ve){return J-ve}),r){case"macroman":for(m=0,g=function(){var J=[];for(x=0;x<256;++x)J.push(0);return J}(),v={0:0},i={},ae=0,R=o.length;ae<R;ae++)v[X=t[s=o[ae]]]==null&&(v[X]=++m),i[s]={old:t[s],new:v[t[s]]},g[s]=v[t[s]];return K.writeUInt16(1),K.writeUInt16(0),K.writeUInt32(12),K.writeUInt16(0),K.writeUInt16(262),K.writeUInt16(0),K.write(g),{charMap:i,subtable:K.data,maxGlyphID:m+1};case"unicode":for(D=[],u=[],w=0,v={},n={},p=A=null,Z=0,z=o.length;Z<z;Z++)v[T=t[s=o[Z]]]==null&&(v[T]=++w),n[s]={old:T,new:v[T]},l=v[T]-s,p!=null&&l===A||(p&&u.push(p),D.push(s),A=l),p=s;for(p&&u.push(p),u.push(65535),D.push(65535),M=2*(L=D.length),E=2*Math.pow(Math.log(L)/Math.LN2,2),f=Math.log(E/2)/Math.LN2,j=2*L-E,c=[],_=[],h=[],x=oe=0,ee=D.length;oe<ee;x=++oe){if(F=D[x],d=u[x],F===65535){c.push(0),_.push(0);break}if(F-(G=n[F].new)>=32768)for(c.push(0),_.push(2*(h.length+L-x)),s=Y=F;F<=d?Y<=d:Y>=d;s=F<=d?++Y:--Y)h.push(n[s].new);else c.push(G-F),_.push(0)}for(K.writeUInt16(3),K.writeUInt16(1),K.writeUInt32(12),K.writeUInt16(4),K.writeUInt16(16+8*L+2*h.length),K.writeUInt16(0),K.writeUInt16(M),K.writeUInt16(E),K.writeUInt16(f),K.writeUInt16(j),Q=0,b=u.length;Q<b;Q++)s=u[Q],K.writeUInt16(s);for(K.writeUInt16(0),H=0,O=D.length;H<O;H++)s=D[H],K.writeUInt16(s);for(V=0,S=c.length;V<S;V++)l=c[V],K.writeUInt16(l);for(Ae=0,I=_.length;Ae<I;Ae++)B=_[Ae],K.writeUInt16(B);for(W=0,U=h.length;W<U;W++)m=h[W],K.writeUInt16(m);return{charMap:n,subtable:K.data,maxGlyphID:w+1}}},e}(),lO=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Fl(t,Wo),t.prototype.tag="cmap",t.prototype.parse=function(r){var n,s,i;for(r.pos=this.offset,this.version=r.readUInt16(),i=r.readUInt16(),this.tables=[],this.unicode=null,s=0;0<=i?s<i:s>i;s=0<=i?++s:--s)n=new Yk(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(r,n){var s,i;return n==null&&(n="macroman"),s=Yk.encode(r,n),(i=new jA).writeUInt16(0),i.writeUInt16(1),s.table=i.data.concat(s.subtable),s},t}(),d1e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Fl(t,Wo),t.prototype.tag="hhea",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},t}(),u1e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Fl(t,Wo),t.prototype.tag="OS/2",t.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var n,s;for(s=[],n=0;n<10;++n)s.push(r.readByte());return s}(),this.charRange=function(){var n,s;for(s=[],n=0;n<4;++n)s.push(r.readInt());return s}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var n,s;for(s=[],n=0;n<2;n=++n)s.push(r.readInt());return s}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},t}(),f1e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Fl(t,Wo),t.prototype.tag="post",t.prototype.parse=function(r){var n,s,i;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var o;for(s=r.readUInt16(),this.glyphNameIndex=[],o=0;0<=s?o<s:o>s;o=0<=s?++o:--o)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],i=[];r.pos<this.offset+this.length;)n=r.readByte(),i.push(this.names.push(r.readString(n)));return i;case 151552:return s=r.readUInt16(),this.offsets=r.read(s);case 196608:break;case 262144:return this.map=(function(){var l,c,A;for(A=[],o=l=0,c=this.file.maxp.numGlyphs;0<=c?l<c:l>c;o=0<=c?++l:--l)A.push(r.readUInt32());return A}).call(this)}},t}(),h1e=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},m1e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Fl(t,Wo),t.prototype.tag="name",t.prototype.parse=function(r){var n,s,i,o,l,c,A,d,u,f,h;for(r.pos=this.offset,r.readShort(),n=r.readShort(),c=r.readShort(),s=[],o=0;0<=n?o<n:o>n;o=0<=n?++o:--o)s.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+c+r.readShort()});for(A={},o=u=0,f=s.length;u<f;o=++u)i=s[o],r.pos=i.offset,d=r.readString(i.length),l=new h1e(d,i),A[h=i.nameID]==null&&(A[h]=[]),A[i.nameID].push(l);this.strings=A,this.copyright=A[0],this.fontFamily=A[1],this.fontSubfamily=A[2],this.uniqueSubfamily=A[3],this.fontName=A[4],this.version=A[5];try{this.postscriptName=A[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=A[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=A[7],this.manufacturer=A[8],this.designer=A[9],this.description=A[10],this.vendorUrl=A[11],this.designerUrl=A[12],this.license=A[13],this.licenseUrl=A[14],this.preferredFamily=A[15],this.preferredSubfamily=A[17],this.compatibleFull=A[18],this.sampleText=A[19]},t}(),p1e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Fl(t,Wo),t.prototype.tag="maxp",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},t}(),x1e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Fl(t,Wo),t.prototype.tag="hmtx",t.prototype.parse=function(r){var n,s,i,o,l,c,A;for(r.pos=this.offset,this.metrics=[],n=0,c=this.file.hhea.numberOfMetrics;0<=c?n<c:n>c;n=0<=c?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,u;for(u=[],n=d=0;0<=i?d<i:d>i;n=0<=i?++d:--d)u.push(r.readInt16());return u}(),this.widths=(function(){var d,u,f,h;for(h=[],d=0,u=(f=this.metrics).length;d<u;d++)o=f[d],h.push(o.advance);return h}).call(this),s=this.widths[this.widths.length-1],A=[],n=l=0;0<=i?l<i:l>i;n=0<=i?++l:--l)A.push(this.widths.push(s));return A},t.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},t}(),cO=[].slice,g1e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Fl(t,Wo),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(r){var n,s,i,o,l,c,A,d,u,f;return r in this.cache?this.cache[r]:(o=this.file.loca,n=this.file.contents,s=o.indexOf(r),(i=o.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+s,l=(c=new jA(n.read(i))).readShort(),d=c.readShort(),f=c.readShort(),A=c.readShort(),u=c.readShort(),this.cache[r]=l===-1?new v1e(c,d,f,A,u):new y1e(c,l,d,f,A,u),this.cache[r]))},t.prototype.encode=function(r,n,s){var i,o,l,c,A;for(l=[],o=[],c=0,A=n.length;c<A;c++)i=r[n[c]],o.push(l.length),i&&(l=l.concat(i.encode(s)));return o.push(l.length),{table:l,offsets:o}},t}(),y1e=function(){function e(t,r,n,s,i,o){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=s,this.xMax=i,this.yMax=o,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),v1e=function(){function e(t,r,n,s,i){var o,l;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=s,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new jA(cO.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),w1e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Fl(t,Wo),t.prototype.tag="loca",t.prototype.parse=function(r){var n,s;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var i,o;for(o=[],s=0,i=this.length;s<i;s+=2)o.push(2*r.readUInt16());return o}).call(this):(function(){var i,o;for(o=[],s=0,i=this.length;s<i;s+=4)o.push(r.readUInt32());return o}).call(this)},t.prototype.indexOf=function(r){return this.offsets[r]},t.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},t.prototype.encode=function(r,n){for(var s=new Uint32Array(this.offsets.length),i=0,o=0,l=0;l<s.length;++l)if(s[l]=i,o<n.length&&n[o]==l){++o,s[l]=i;var c=this.offsets[l],A=this.offsets[l+1]-c;A>0&&(i+=A)}for(var d=new Array(4*s.length),u=0;u<s.length;++u)d[4*u+3]=255&s[u],d[4*u+2]=(65280&s[u])>>8,d[4*u+1]=(16711680&s[u])>>16,d[4*u]=(4278190080&s[u])>>24;return d},t}(),b1e=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,s,i;for(r in s=this.font.cmap.tables[0].codeMap,t={},i=this.subset)n=i[r],t[r]=s[n];return t},e.prototype.glyphsFor=function(t){var r,n,s,i,o,l,c;for(s={},o=0,l=t.length;o<l;o++)s[i=t[o]]=this.font.glyf.glyphFor(i);for(i in r=[],s)(n=s[i])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(i in c=this.glyphsFor(r))n=c[i],s[i]=n;return s},e.prototype.encode=function(t,r){var n,s,i,o,l,c,A,d,u,f,h,x,m,g,p;for(s in n=lO.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),h={0:0},p=n.charMap)h[(c=p[s]).old]=c.new;for(x in f=n.maxGlyphID,o)x in h||(h[x]=f++);return d=function(v){var w,B;for(w in B={},v)B[v[w]]=w;return B}(h),u=Object.keys(d).sort(function(v,w){return v-w}),m=function(){var v,w,B;for(B=[],v=0,w=u.length;v<w;v++)l=u[v],B.push(d[l]);return B}(),i=this.font.glyf.encode(o,m,h),A=this.font.loca.encode(i.offsets,m),g={cmap:this.font.cmap.raw(),glyf:i.table,loca:A,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(g["OS/2"]=this.font.os2.raw()),this.font.directory.encode(g)},e}();lr.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,s,i,o;if(Array.isArray(r))return"["+function(){var l,c,A;for(A=[],l=0,c=r.length;l<c;l++)n=r[l],A.push(t.convert(n));return A}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(s in i=["<<"],r)o=r[s],i.push("/"+s+" "+t.convert(o));return i.push(">>"),i.join(`
`)}return""+r},t}();const AO=({request:e,generateSectionHTML:t})=>{const r=async()=>{if(e)try{const l=new lr({orientation:"portrait",unit:"mm",format:"a4",compress:!0}),c=l.internal.pageSize.getWidth(),A=l.internal.pageSize.getHeight(),d=c-15*2,u=A-15*2,f=[{id:"commercial-details",title:"Commercial Details"},{id:"procurement-details",title:"Procurement Details"},{id:"supplies-details",title:"Product/Services Details"},{id:"compliance-details",title:"Compliance Details"},{id:"approval-logs",title:"Approval Logs"}],h=document.createElement("div");h.style.position="absolute",h.style.left="-9999px",h.style.width=d*3.779528+"px",h.style.padding="0",h.style.boxSizing="border-box",h.style.fontSize="10px",document.body.appendChild(h),n(l,e,c,A,15);for(let x=0;x<f.length;x++){const m=f[x];if(l.addPage(),s(l,m.title,c,15),l.setTextColor(0,0,0),h.innerHTML="",m.id==="supplies-details"){h.style.width=d*3.779528+"px";const _=document.createElement("style");_.textContent=`
                        table { width: 100%; border-collapse: collapse; table-layout: fixed; font-size: 9px; }
                        th, td { border: 1px solid #ddd; padding: 4px; overflow: hidden; text-overflow: ellipsis; }
                        th { background-color: rgba(128, 194, 66, 0.1); }
                        td { word-break: break-word; }
                    `,h.appendChild(_)}h.innerHTML+=t(m.id,m.title),h.querySelectorAll("table").forEach(_=>{_.style.fontSize="9px",_.style.width="100%",_.style.tableLayout="fixed",_.querySelectorAll("td").forEach(E=>{E.style.maxWidth="100%",E.style.overflow="hidden",E.style.textOverflow="ellipsis",E.style.wordWrap="break-word"})});const p=await HP(h,{scale:3,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff",logging:!1,letterRendering:!0}),v=p.width,w=p.height,B=Math.min(d/(v/3),(u-30)/(w/3)),T=p.toDataURL("image/jpeg",1);l.addImage(T,"JPEG",15,35,v/3*B,w/3*B),i(l,x+2,f.length+1,c,A,15)}l.save(`Request_${e.reqid||"Details"}_${new Date().toISOString().slice(0,10)}.pdf`),document.body.removeChild(h),Ie!=null&&Ie.success&&Ie.success("PDF generated successfully")}catch(o){console.error("Error generating PDF:",o),Ie!=null&&Ie.error&&Ie.error("Error generating PDF")}},n=(o,l,c,A,d)=>{const u=c/2,f=A/2-40;if(l.title){o.setFontSize(18),o.setFont("helvetica","bold");const p=o.getStringUnitWidth(l.title)*18/o.internal.scaleFactor;o.text(l.title,u-p/2,f)}o.setFontSize(14),o.setFont("helvetica","bold"),o.text("Requestor Information",u,f+25,{align:"center"}),o.setFont("helvetica","normal"),o.setFontSize(12);const h=`Request ID: ${l.reqid||"N/A"}`;o.text(h,u,f+40,{align:"center"});const x=`Created At: ${Ov(l.createdAt)||"N/A"}`;o.text(x,u,f+55,{align:"center"});const m=`Requestor ID: ${l.userId||"N/A"}`;o.text(m,u,f+70,{align:"center"});const g=`Requestor: ${l.userName||"N/A"}`;o.text(g,u,f+80,{align:"center"}),o.setFontSize(10),o.setFont("helvetica","normal"),o.setTextColor(100,100,100),o.text(`Generated: ${new Date().toLocaleDateString()}`,u,A-d,{align:"center"}),o.setDrawColor(128,194,66),o.setLineWidth(.5),o.line(d,A-d-10,c-d,A-d-10)},s=(o,l,c,A)=>{o.setFillColor(128,194,66),o.rect(0,0,c,25,"F"),o.setFont("helvetica","bold"),o.setFontSize(16),o.setTextColor(255,255,255),o.text(l,A,A)},i=(o,l,c,A,d,u)=>{o.setFontSize(10),o.setFont("helvetica","normal"),o.setTextColor(100,100,100),o.text(`Page ${l} of ${c}`,A-u-30,d-u),o.setDrawColor(128,194,66),o.setLineWidth(.5),o.line(u,d-u-10,A-u,d-u-10)};return{handleGeneratePDF:r}},dO=({activeSection:e,setActiveSection:t})=>{const r=[{key:"preview",icon:G4,label:"Request Preview",color:"text-primary hover:bg-primary/10",description:"View detailed request information"},{key:"chat",icon:W4,label:"Discussions",color:"text-primary hover:bg-primary/10",description:"Comments and discussions"},{key:"logs",icon:B1,label:"Logs",color:"text-primary hover:bg-primary/10",description:"Approval timeline and history"}],n=s=>{e!==s&&t(s)};return a.jsx("div",{className:"flex border-b bg-white shadow-sm",children:r.map(s=>{const i=s.icon,o=e===s.key;return a.jsxs("button",{onClick:()=>n(s.key),className:`
                            flex-1 p-4 flex items-center justify-center 
                            transition-all duration-300 ease-in-out
                            border-b-2 border-transparent
                            ${o?"bg-primary/10 border-primary text-primary":"hover:bg-gray-100 text-gray-600 hover:text-gray-800"}
                            ${s.color}
                            focus:outline-none focus:ring-2 focus:ring-primary focus:ring-inset
                            relative group
                        `,"aria-label":`Switch to ${s.label}`,role:"tab","aria-selected":o,children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(i,{className:`
                                    transition-transform duration-200
                                    ${o?"scale-110":"group-hover:scale-105"}
                                `,size:20}),a.jsx("span",{className:"font-semibold text-sm md:text-base",children:s.label})]}),o&&a.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary transform scale-x-100 transition-transform duration-200"}),a.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10",children:s.description})]},s.key)})})},N1e=({request:e,extractDateAndTime:t,handleShowFile:r})=>{var n,s;return a.jsxs("div",{className:"p-5 space-y-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-primary border-b pb-2",children:"Commercial Details"}),e.commercials&&Object.values(e.commercials).some(i=>i)&&a.jsxs("div",{className:"grid gap-6 p-4",children:[a.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Request ID"}),a.jsx("div",{className:"text-gray-800 font-semibold mt-1",children:e.reqid})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Business Unit"}),a.jsx("div",{className:"text-gray-800 font-semibold mt-1",children:e.commercials.businessUnit})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Created At"}),a.jsx("div",{className:"text-gray-800 font-semibold mt-1",children:t(e.createdAt)})]})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Entity"}),a.jsx("div",{className:"text-gray-800 font-semibold mt-1",children:e.commercials.entity})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"City"}),a.jsx("div",{className:"text-gray-800 font-semibold mt-1",children:e.commercials.city})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Site"}),a.jsx("div",{className:"text-gray-800 font-semibold mt-1",children:e.commercials.site})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-gray-50 p-3 sm:p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Requestor Details"}),a.jsxs("div",{className:"mt-2 space-y-1",children:[e.userId&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500 text-sm",children:"ID:"}),a.jsx("div",{className:"text-gray-800 font-semibold",children:e.userId})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500 text-sm",children:"Name:"}),a.jsx("div",{className:"text-gray-800 font-semibold",children:e.userName||"N/A"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500 text-sm",children:"Department:"}),a.jsx("div",{className:"text-gray-800 font-semibold",children:e.empDepartment||"N/A"})]})]})]}),a.jsxs("div",{className:"bg-gray-50 p-3 sm:p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"HOD Details"}),a.jsxs("div",{className:"mt-2 space-y-1",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500 text-sm",children:"Name:"}),a.jsx("div",{className:"text-gray-800 font-semibold",children:e.commercials.hod||"N/A"})]}),e.commercials.hodId&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500 text-sm",children:"ID:"}),a.jsx("div",{className:"text-gray-800 font-semibold",children:e.commercials.hodId})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500 text-sm",children:"Department:"}),a.jsx("div",{className:"text-gray-800 font-semibold",children:e.commercials.department||"N/A"})]})]})]}),e.commercials.additionalApprover&&a.jsxs("div",{className:"bg-blue-50 p-3 sm:p-4 rounded-lg border border-blue-200",children:[a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx(Xm,{className:"w-4 h-4 text-blue-600 mr-2"}),a.jsx("span",{className:"text-blue-800 font-medium",children:"Additional Approver"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-blue-600 text-sm",children:"ID:"}),a.jsx("div",{className:"text-blue-800 font-semibold",children:e.commercials.additionalApprover})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-blue-600 text-sm",children:"Name:"}),a.jsx("div",{className:"text-blue-800 font-semibold",children:e.commercials.additionalApproverName||"N/A"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-blue-600 text-sm",children:"Email:"}),a.jsx("div",{className:"text-blue-800 font-semibold text-xs break-all",children:e.commercials.additionalApproverEmail||"N/A"})]}),e.commercials.additionalApproverProof&&e.commercials.additionalApproverProof.length>0&&a.jsxs("div",{className:"mt-2",children:[a.jsx("span",{className:"text-blue-600 text-sm",children:"Proof Documents:"}),a.jsx("div",{className:"flex gap-2 mt-1",children:e.commercials.additionalApproverProof.map((i,o)=>a.jsxs("button",{onClick:()=>r(i),className:"flex items-center px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs hover:bg-blue-200 transition-colors",children:[a.jsx(jr,{className:"w-3 h-3 mr-1"}),"Proof"," ",o+1]},o))})]})]})]})]}),a.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg w-full",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Bill To"}),a.jsx("div",{className:"text-gray-800 font-semibold mt-1 whitespace-pre-line",children:e.commercials.billTo})]}),a.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg w-full",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Ship To"}),a.jsx("div",{className:"text-gray-800 font-semibold mt-1 whitespace-pre-line",children:e.commercials.shipTo})]})]})]}),((s=(n=e.commercials)==null?void 0:n.paymentTerms)==null?void 0:s.length)>0&&a.jsxs("div",{className:"mt-6",children:[a.jsx("h3",{className:"text-xl font-semibold text-primary mb-4",children:"Payment Terms"}),a.jsx("div",{className:"bg-white shadow-lg rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-primary/10",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-4 text-left text-primary font-semibold",children:"Percentage"}),a.jsx("th",{className:"px-6 py-4 text-left text-primary font-semibold",children:"Payment Term"}),a.jsx("th",{className:"px-6 py-4 text-left text-primary font-semibold",children:"Type"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:e.commercials.paymentTerms.map((i,o)=>{var l,c;return a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsxs("td",{className:"px-6 py-4 text-left font-medium",children:[i.percentageTerm,"%"]}),a.jsxs("td",{className:"px-3 sm:px-6 py-3 sm:py-4 capitalize",children:[(l=i.paymentTerm)==null?void 0:l.toLowerCase(),i.customPaymentTerm?` - ${i.customPaymentTerm.toLowerCase()}`:""]}),a.jsxs("td",{className:"px-3 sm:px-6 py-3 sm:py-4 capitalize",children:[(c=i.paymentType)==null?void 0:c.toLowerCase(),i.customPaymentType?` - ${i.customPaymentType.toLowerCase()}`:""]})]},o)})})]})})]})]})},C1e=({request:e,formatDateToDDMMYY:t,renderUploadedFiles:r})=>{var n;return console.log("request",e),a.jsxs("div",{className:"p-5 space-y-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-primary border-b pb-3",children:"Procurement Details"}),e.procurements&&Object.values(e.procurements).some(s=>s)&&a.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:[{label:"Vendor ID",value:e.procurements.vendor},{label:"Vendor Name",value:e.procurements.vendorName},{label:"Quotation Number",value:e.procurements.quotationNumber},{label:"Quotation Date",value:e.procurements.quotationDate?t(e.procurements.quotationDate):null},{label:"Service Period",value:e.procurements.servicePeriod},{label:"PO Valid From",value:e.procurements.poValidFrom?t(e.procurements.poValidFrom):null},{label:"PO Valid To",value:e.procurements.poValidTo?t(e.procurements.poValidTo):null}].filter(s=>s.value).map((s,i)=>a.jsxs("div",{className:"flex justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:s.label}),a.jsx("span",{className:"text-gray-800 font-semibold",children:s.value})]},i))}),((n=e.procurements)==null?void 0:n.uploadedFiles)&&a.jsxs("div",{className:"mt-6",children:[a.jsx("h3",{className:"text-xl font-semibold text-primary mb-4",children:"Uploaded Files"}),a.jsxs("div",{className:"bg-white shadow-md rounded-lg p-4",children:[Object.keys(e.procurements.uploadedFiles).length>0?a.jsxs("div",{className:"text-green-600 flex items-center mb-4",children:[a.jsx(ca,{className:"mr-2",size:20}),"Files uploaded successfully"]}):a.jsx("div",{className:"text-gray-500 flex items-center",children:"No files uploaded"}),r(e.procurements.uploadedFiles)]})]})]})},j1e=({request:e,parseFloat:t,formatCurrency:r})=>{var n,s,i,o;return a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-primary border-b pb-3",children:"Product/Services Details"}),((s=(n=e.supplies)==null?void 0:n.services)==null?void 0:s.length)>0&&a.jsx("div",{className:"mt-6",children:a.jsx("div",{className:"overflow-x-auto w-full",children:a.jsxs("table",{className:"min-w-full bg-white shadow-md rounded-lg",children:[a.jsx("thead",{className:"bg-primary/10",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-3 text-left text-primary min-w-40",children:"Product Names"}),a.jsx("th",{className:"p-3 text-left text-primary min-w-48",children:"Description"}),a.jsx("th",{className:"p-3 text-left text-primary min-w-40",children:"Purpose"}),a.jsx("th",{className:"p-3 text-left text-primary min-w-24",children:"Quantity"}),a.jsx("th",{className:"p-3 text-left text-primary min-w-24",children:"Price"}),a.jsx("th",{className:"p-3 text-left text-primary min-w-20",children:"Tax (%)"}),a.jsx("th",{className:"p-3 text-left text-primary min-w-24",children:"Total"})]})}),a.jsx("tbody",{children:e.supplies.services.map((l,c)=>{const A=t(l.quantity)||0,d=t(l.price)||0,u=t(l.tax)||0,f=A*d*(1+u/100);return a.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[a.jsx("td",{className:"p-3",children:a.jsx("div",{className:"whitespace-normal break-words max-w-40",children:l.productName||"N/A"})}),a.jsx("td",{className:"p-3",children:a.jsx("div",{className:"whitespace-normal break-words max-w-48",children:l.productDescription||"N/A"})}),a.jsx("td",{className:"p-3",children:a.jsx("div",{className:"whitespace-normal break-words max-w-40",children:l.productPurpose||"N/A"})}),a.jsx("td",{className:"p-3",children:l.quantity}),a.jsx("td",{className:"p-3",children:r(l.price)}),a.jsx("td",{className:"p-3",children:l.tax||"N/A"}),a.jsx("td",{className:"p-3 font-semibold",children:r(f)})]},c)})})]})})}),((i=e.supplies)==null?void 0:i.totalValue)!==void 0&&a.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg flex justify-between",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Total Value"}),a.jsx("span",{className:"text-gray-800 font-semibold",children:r(e.supplies.totalValue)})]}),((o=e.supplies)==null?void 0:o.remarks)&&a.jsxs("div",{className:"mt-6",children:[a.jsx("h3",{className:"text-xl font-semibold text-primary mb-4",children:"Remarks"}),a.jsx("p",{children:e.supplies.remarks})]})]})},B1e=({request:e,openInfoModal:t,handleShowFile:r})=>{var n,s;return a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-primary border-b pb-3",children:"Compliance Details"}),e.complinces&&(e!=null&&e.complinces)?a.jsx("div",{className:"space-y-4",children:((n=Object.keys(e==null?void 0:e.complinces))==null?void 0:n.length)>0?(s=Object.entries(e==null?void 0:e.complinces))==null?void 0:s.map(([i,o],l)=>{var c,A,d;return a.jsxs("div",{className:`p-3 sm:p-4 rounded-lg ${o.deviation?"bg-red-50 border border-red-200":"bg-green-50 border border-green-200"}`,children:[a.jsxs("div",{className:"flex items-start ",children:[a.jsx("h3",{className:`text-base sm:text-lg font-semibold ${o.deviation?"text-red-800":"text-green-800"}`,children:o.question}),a.jsx("button",{onClick:()=>t(o.question,o.description),className:"ml-2 text-gray-500 hover:text-gray-700 focus:outline-none","aria-label":"More information",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2h-1V9a1 1 0 00-1-1z",clipRule:"evenodd"})})})]}),a.jsx("p",{className:`mt-2 font-medium ${o.deviation?"text-red-600":"text-green-600"}`,children:o.answer?"Yes":"No"}),o.department&&a.jsxs("p",{className:"mt-2 text-xs sm:text-sm text-gray-600",children:[a.jsx("strong",{children:"Department:"})," ",o.department]}),o.deviation&&a.jsx("div",{className:"mt-2 p-2 sm:p-3 bg-red-100 rounded",children:a.jsxs("p",{className:"text-xs sm:text-sm text-red-700",children:[a.jsx("strong",{children:"Deviation Reason:"})," ",o.deviation.reason]})}),((A=(c=o==null?void 0:o.deviation)==null?void 0:c.attachments)==null?void 0:A.length)>0&&a.jsxs("div",{className:"mt-4",children:[a.jsx("strong",{className:"text-xs sm:text-sm text-red-700",children:"Attachments:"}),a.jsx("ul",{className:"list-disc pl-4 sm:pl-6 mt-2",children:(d=o==null?void 0:o.deviation)==null?void 0:d.attachments.map((u,f)=>a.jsx("li",{className:"text-xs sm:text-sm",children:a.jsxs("button",{onClick:()=>r(u.data.fileUrls[f]),className:"text-red-600 hover:text-red-800 underline",children:["Attachment"," ",f+1]})},f))})]})]},i)}):a.jsx("div",{className:"text-gray-500",children:"No compliance details available"})}):a.jsx("div",{className:"text-gray-500",children:"No compliance data available"})]})},uO=({request:e,extractDateAndTime:t,formatDateToDDMMYY:r,formatCurrency:n,openInfoModal:s,showFileUrl:i})=>{if(!e)return a.jsx("div",{className:"flex items-center justify-center py-20",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading request details..."})]})});const o=async c=>{try{const A=await i(c);A.status===200?window.open(A.data.presignedUrl,"_blank"):console.error("No presigned URL received")}catch(A){console.error("Error fetching presigned URL:",A)}},l=c=>{if(!c||c.length===0)return null;const A=c.reduce((d,u)=>(Object.entries(u).forEach(([f,h])=>{h&&h.urls&&Array.isArray(h.urls)?d[f]={files:h.urls,agreementValidFrom:h.agreementValidFrom,agreementValidTo:h.agreementValidTo}:Array.isArray(h)&&(d[f]={files:h,agreementValidFrom:null,agreementValidTo:null})}),d),{});return a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(A).map(([d,u],f)=>a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-3 capitalize border-b pb-2",children:d.replace(/_/g," ")}),(u.agreementValidFrom||u.agreementValidTo)&&a.jsxs("div",{className:"mb-3 text-xs text-gray-600 bg-gray-50 p-2 rounded",children:[u.agreementValidFrom&&a.jsxs("div",{children:["Valid From:"," ",r(u.agreementValidFrom)]}),u.agreementValidTo&&a.jsxs("div",{children:["Valid To:"," ",r(u.agreementValidTo)]})]}),a.jsx("div",{className:"grid grid-cols-3 gap-2",children:u.files&&u.files.length>0?u.files.map((h,x)=>a.jsx("div",{className:"flex flex-col items-center bg-gray-50 rounded p-2",children:a.jsxs("button",{onClick:()=>o(h),className:"text-xs text-primary hover:text-blue-800 truncate max-w-full text-center",children:[a.jsx("img",{src:lv,alt:`${d} file ${x+1}`,className:"w-10 h-10 object-cover mb-2"}),a.jsxs("span",{className:"block",children:["File ",x+1]})]})},x)):a.jsx("div",{className:"col-span-3 text-center text-gray-500 text-xs",children:"No files available"})})]},f))})};return a.jsxs("div",{className:"space-y-8",id:"request-preview-content",children:[a.jsx(N1e,{request:e,extractDateAndTime:t,handleShowFile:o}),a.jsx(C1e,{request:e,formatDateToDDMMYY:r,renderUploadedFiles:l}),a.jsx(j1e,{request:e,parseFloat,formatCurrency:n}),a.jsx(B1e,{request:e,openInfoModal:s,handleShowFile:o})]})},py=({isVisible:e=!0,message:t="Please wait...",subMessage:r=null,showProgress:n=!1,progress:s=0,variant:i="default"})=>{if(!e)return null;const l=(A=>{const d={default:{bgColor:"bg-black bg-opacity-50",cardBg:"bg-white",iconColor:"text-primary",message:"Please wait..."},processing:{bgColor:"bg-blue-900 bg-opacity-60",cardBg:"bg-white",iconColor:"text-blue-600",message:"Processing request..."},uploading:{bgColor:"bg-green-900 bg-opacity-60",cardBg:"bg-white",iconColor:"text-green-600",message:"Uploading file..."},generating:{bgColor:"bg-purple-900 bg-opacity-60",cardBg:"bg-white",iconColor:"text-purple-600",message:"Generating PDF..."}};return d[A]||d.default})(i),c=t||l.message;return a.jsx("div",{className:`fixed inset-0 ${l.bgColor} flex items-center justify-center z-50 backdrop-blur-sm`,role:"dialog","aria-modal":"true","aria-labelledby":"loading-message",children:a.jsxs("div",{className:`${l.cardBg} p-8 rounded-lg shadow-xl flex flex-col items-center max-w-sm mx-4 transform transition-all duration-300 scale-100`,children:[a.jsxs("div",{className:"relative mb-4",children:[a.jsx(If,{className:`h-12 w-12 animate-spin ${l.iconColor}`}),n&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsxs("span",{className:`text-xs font-bold ${l.iconColor}`,children:[Math.round(s),"%"]})})]}),a.jsx("p",{id:"loading-message",className:"text-lg font-semibold text-gray-700 text-center mb-2",children:c}),r&&a.jsx("p",{className:"text-sm text-gray-500 text-center mb-4",children:r}),n&&a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-4",children:a.jsx("div",{className:`${l.iconColor.replace("text-","bg-")} h-2 rounded-full transition-all duration-300 ease-out`,style:{width:`${Math.min(100,Math.max(0,s))}%`}})}),a.jsx("div",{className:"flex space-x-1",children:[0,1,2].map(A=>a.jsx("div",{className:`w-2 h-2 ${l.iconColor.replace("text-","bg-")} rounded-full animate-pulse`,style:{animationDelay:`${A*.15}s`,animationDuration:"1s"}},A))})]})})},Jk=({selectedFile:e,onClear:t})=>{const[r,n]=mr.useState(null),[s,i]=mr.useState(null),[o,l]=mr.useState(null),[c,A]=mr.useState(!1);return mr.useEffect(()=>{if(!e){n(null),i(null),l(null);return}if(l(null),n(null),e.type.startsWith("image/")){i("image");const d=new FileReader;d.onloadend=()=>n(d.result),d.onerror=()=>l("Failed to load preview"),d.readAsDataURL(e)}else if(e.type==="application/pdf"){i("pdf");const d=new FileReader;d.onloadend=()=>n(d.result),d.onerror=()=>l("Failed to load preview"),d.readAsDataURL(e)}else{i("other");const d=new FileReader;d.onloadend=()=>n(d.result),d.onerror=()=>l("Failed to load preview"),d.readAsDataURL(e)}},[e]),e?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"relative w-14 h-14 bg-white rounded-lg shadow-sm border border-gray-200 cursor-pointer",onClick:()=>A(!0),children:[a.jsx("button",{onClick:d=>{d.stopPropagation(),t()},className:"absolute -top-1 -right-1 bg-gray-100 hover:bg-gray-200 text-gray-600 rounded-full p-0.5 transition-colors z-10","aria-label":"Clear file",children:a.jsx(_r,{size:12})}),s==="image"&&r?a.jsx("div",{className:"w-full h-full rounded-lg overflow-hidden",children:a.jsx("img",{src:r,alt:"File preview",className:"w-full h-full object-cover"})}):a.jsx("div",{className:"w-full h-full rounded-lg flex items-center justify-center bg-gray-50",children:s==="pdf"?a.jsx(jr,{size:20,className:"text-red-500"}):a.jsx(B1,{size:20,className:"text-blue-500"})})]}),c&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"relative bg-white rounded-lg max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"border-b p-4 flex justify-between items-center",children:[a.jsx("h3",{className:"text-lg font-medium truncate",children:e.name}),a.jsx("button",{onClick:()=>A(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsx(_r,{size:20})})]}),a.jsx("div",{className:"p-4 overflow-auto max-h-[calc(90vh-8rem)]",children:s==="image"&&r?a.jsx("img",{src:r,alt:"Preview",className:"max-w-full h-auto mx-auto"}):s==="pdf"&&r?a.jsx("embed",{src:r,type:"application/pdf",className:"w-full h-[70vh]"}):r?a.jsxs("div",{className:"bg-gray-50 p-4 rounded",children:[a.jsxs("p",{className:"text-sm text-gray-600",children:["Preview not available for this file type. Filename: ",e.name]}),a.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["File size:"," ",(e.size/1024/1024).toFixed(2)," ","MB"]}),a.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["File type:"," ",e.type||"Unknown"]})]}):a.jsx("div",{className:"flex items-center justify-center h-32",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})})}),o&&a.jsx("div",{className:"p-4 bg-red-50 border-t border-red-100",children:a.jsx("p",{className:"text-sm text-red-600",children:o})})]})})]}):null},fO=({request:e,role:t,disable:r,isLoading:n,isUploading:s,isGeneratingPDF:i,selectedImage:o,setSelectedImage:l,setShowDialog:c,handleStatus:A,handleUploadPo:d,handleUploadInvoice:u,handleGeneratePDF:f})=>{const[h,x]=C.useState(""),[m,g]=C.useState(""),p=()=>e.status==="Approved"?a.jsx("div",{}):a.jsxs("button",{onClick:()=>c(!0),className:"flex items-center gap-1 sm:gap-2 px-3 sm:px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors duration-200 font-medium text-xs sm:text-sm shadow-sm active:scale-95 transform",children:[a.jsx(j1,{size:14,className:"sm:w-4 sm:h-4 animate-bounce"}),a.jsx("span",{className:"hidden sm:inline",children:"Nudge"}),a.jsx("span",{className:"sm:hidden",children:"N"})]}),v=()=>{if(t==="Employee"||r)return null;const _=(j=>({Pending:[{action:"Reject",icon:Ea,color:"bg-red-600",label:"Reject",shortLabel:"R"},{action:"Hold",icon:Yi,color:"bg-yellow-600",label:"Hold",shortLabel:"H"},{action:"Approved",icon:ca,color:"bg-green-600",label:"Approve",shortLabel:"A"}],Hold:[{action:"Reject",icon:Ea,color:"bg-red-600",label:"Reject",shortLabel:"R"},{action:"Approved",icon:ca,color:"bg-green-600",label:"Approve",shortLabel:"A"}],Rejected:[{action:"Hold",icon:Yi,color:"bg-yellow-600",label:"Hold",shortLabel:"H"},{action:"Approved",icon:ca,color:"bg-green-600",label:"Approve",shortLabel:"A"}]})[j]||[])(e.status);return _.length===0?null:a.jsx("div",{className:"flex space-x-2 sm:space-x-4",children:_.map(({action:j,icon:E,color:L,label:M,shortLabel:F})=>a.jsxs("button",{onClick:()=>A(j),disabled:n,className:`px-3 sm:px-6 py-2 rounded-lg flex items-center ${L} text-white disabled:opacity-50 disabled:cursor-not-allowed text-xs sm:text-sm`,children:[a.jsx(E,{className:"mr-1 sm:mr-2",size:14}),a.jsx("span",{className:"hidden sm:inline",children:M}),a.jsx("span",{className:"sm:hidden",children:F})]},j))})},w=()=>{if(!((e.status==="PO-Pending"||e.status==="Approved")&&t==="Head of Finance"))return null;const _=()=>{if(!h.trim()){alert("Please enter PO number");return}d(h.trim())};return a.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between w-full space-y-4 lg:space-y-0",children:[a.jsx("div",{className:"flex justify-start",children:a.jsx("button",{onClick:f,disabled:i,className:"flex items-center px-3 sm:px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/80 transition-colors text-xs sm:text-sm",children:i?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin -ml-1 mr-1 sm:mr-2 h-3 w-3 sm:h-4 sm:w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),a.jsx("span",{className:"hidden sm:inline",children:"Generating PDF..."}),a.jsx("span",{className:"sm:hidden",children:"Gen..."})]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 sm:h-5 sm:w-5 mr-1 sm:mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),a.jsx("span",{className:"hidden sm:inline",children:"Download PDF"}),a.jsx("span",{className:"sm:hidden",children:"PDF"})]})})}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-4 w-full lg:w-auto",children:[a.jsx("div",{className:"order-1 sm:order-none",children:a.jsx(Jk,{selectedFile:o,onClear:()=>l(null)})}),a.jsx("input",{type:"text",placeholder:"Enter PO Number",value:h,onChange:j=>x(j.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-xs sm:text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent w-full sm:w-auto"}),a.jsxs("label",{className:"flex items-center justify-center px-4 sm:px-6 py-2 rounded-lg border border-gray-300 cursor-pointer bg-white hover:bg-gray-50 w-full sm:w-auto",children:[a.jsx(Ds,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-500 mr-1 sm:mr-2"}),a.jsxs("span",{className:"text-xs sm:text-sm text-gray-600",children:[a.jsx("span",{className:"hidden sm:inline",children:"Select PO"}),a.jsx("span",{className:"sm:hidden",children:"PO File"})]}),a.jsx("input",{type:"file",className:"hidden",accept:"image/*,.pdf,application/pdf",onChange:j=>{const E=j.target.files[0];E&&l(E)}})]}),a.jsxs("button",{onClick:_,disabled:!o||!h.trim()||s,className:"px-4 sm:px-6 py-2 rounded-lg flex items-center justify-center bg-primary text-white disabled:opacity-50 disabled:cursor-not-allowed text-xs sm:text-sm w-full sm:w-auto",children:[a.jsx(jr,{className:"w-4 h-4 sm:w-5 sm:h-5 mr-1 sm:mr-2"}),s?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"hidden sm:inline",children:"Uploading..."}),a.jsx("span",{className:"sm:hidden",children:"Up..."})]}):"Submit"]})]})]})},B=()=>{if(!((e.status==="Invoice-Pending"||e.status==="Approved")&&(t==="Employee"||t==="HOD Department"||t==="Admin")))return null;const _=()=>{if(!m.trim()){alert("Please enter Invoice number");return}u(m.trim())};return a.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-4 w-full lg:w-auto",children:[a.jsx("div",{className:"order-1 sm:order-none",children:a.jsx(Jk,{selectedFile:o,onClear:()=>l(null)})}),a.jsx("input",{type:"text",placeholder:"Enter Invoice Number",value:m,onChange:j=>g(j.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-xs sm:text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent w-full sm:w-auto"}),a.jsxs("label",{className:"flex items-center justify-center px-4 sm:px-6 py-2 rounded-lg border border-gray-300 cursor-pointer bg-white hover:bg-gray-50 w-full sm:w-auto",children:[a.jsx(Ds,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-500 mr-1 sm:mr-2"}),a.jsxs("span",{className:"text-xs sm:text-sm text-gray-600",children:[a.jsx("span",{className:"hidden sm:inline",children:"Select Invoice"}),a.jsx("span",{className:"sm:hidden",children:"Invoice File"})]}),a.jsx("input",{type:"file",className:"hidden",accept:"image/*,.pdf,application/pdf",onChange:j=>{const E=j.target.files[0];E&&l(E)}})]}),a.jsxs("button",{onClick:_,disabled:!o||!m.trim()||s,className:"px-4 sm:px-6 py-2 rounded-lg flex items-center justify-center bg-primary text-white disabled:opacity-50 disabled:cursor-not-allowed text-xs sm:text-sm w-full sm:w-auto",children:[a.jsx(jr,{className:"w-4 h-4 sm:w-5 sm:h-5 mr-1 sm:mr-2"}),s?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"hidden sm:inline",children:"Uploading..."}),a.jsx("span",{className:"sm:hidden",children:"Up..."})]}):"Submit"]})]})};return a.jsxs("div",{className:"bg-white p-3 sm:p-4 flex flex-col lg:flex-row lg:justify-between lg:items-center border-t shadow-md space-y-3 lg:space-y-0 gap-4",children:[a.jsx("div",{className:"flex justify-start",children:p()}),a.jsxs("div",{className:"flex flex-col lg:flex-row items-stretch lg:items-center gap-3 lg:gap-4 lg:ml-auto",children:[v(),w(),B()]})]})},hO=({reqId:e,reqid:t})=>{const r=localStorage.getItem("capEmpId"),[n,s]=C.useState([]),[i,o]=C.useState(""),[l,c]=C.useState(null),[A,d]=C.useState(null),[u,f]=C.useState(null),[h,x]=C.useState(!1),[m,g]=C.useState(!1),[p,v]=C.useState(!0),w=C.useRef(null),B=C.useRef(null),[T,_]=C.useState([]),[j,E]=C.useState(null),L=["Head of Dept","Business Finance","Vendor Management","Legal Team","Info Security","Head of Finance","Requestor"],M=ee=>ee==="Head of Finance"?"Po Team":ee,F=()=>{var ee;(ee=B.current)==null||ee.scrollIntoView({behavior:"smooth"})};C.useEffect(()=>{(async()=>{try{const b=await J$(e);b.status===200&&(s(b.data.chatData.commentLogs),setTimeout(F,100))}catch(b){console.error("Error fetching chats:",b)}})()},[e]),C.useEffect(()=>{F()},[n]),C.useEffect(()=>{(async()=>{if(l){console.log(l);try{const b=await lq(l,e);b.status===200&&(_(b.data.empData||[]),E(null))}catch(b){console.error("Error fetching employees for topic:",b),_([])}}else _([]),E(null)})()},[l]),C.useEffect(()=>{const ee=()=>{window.innerWidth<768?v(!1):v(!0)};return ee(),window.addEventListener("resize",ee),()=>{window.removeEventListener("resize",ee)}},[]);const D=ee=>new Promise((b,O)=>{const S=new FileReader;S.readAsDataURL(ee),S.onload=()=>b(S.result),S.onerror=I=>O(I)}),G=async ee=>{const b=ee.target.files[0];if(b){d(b);try{const O=await D(b);f(O)}catch(O){console.error("Error converting file to base64:",O)}}},K=async ee=>{try{if(ee.startsWith("data:"))return ee;const O=await(await fetch(ee)).blob();return new Promise((S,I)=>{const U=new FileReader;U.onloadend=()=>S(U.result),U.onerror=I,U.readAsDataURL(O)})}catch(b){throw console.error("Error converting to base64:",b),b}},ae=async(ee,b)=>{try{const O=await K(ee),S=document.createElement("a");S.href=O,S.download=b||"download",document.body.appendChild(S),S.click(),document.body.removeChild(S)}catch(O){console.error("Error downloading file:",O),window.open(ee,"_blank")}},Z=async()=>{if(!(!i.trim()&&!A||h||m))try{x(!0),g(!0);let ee=null,b=null,O=null,S=null;if(A)try{S=u,b=A.type,O=A.name;const Q=await Ac(A,"chat",t);if(Q&&Q.data.fileUrls[0])ee=Q.data.fileUrls[0];else throw new Error("Upload response is invalid")}catch(Q){console.error("Error uploading file:",Q),x(!1),g(!1);return}const I={reqId:e,senderId:r,senderName:"You",userImage:null,message:i.trim(),attachmentUrl:ee,attachmentType:b,attachmentName:O,attachmentBase64:S,timestamp:new Date().toISOString(),topic:l||"General Discussion",taggedEmployeeId:(j==null?void 0:j._id)||null,taggedEmployeeName:(j==null?void 0:j.full_name)||(j==null?void 0:j.hodName)||null,taggedEmployeeEmail:(j==null?void 0:j.company_email_id)||(j==null?void 0:j.hodEmail)};(await Y$(I)).status===200&&(s(Q=>[...Q,{...I,timestamp:new Date(I.timestamp)}]),o(""),d(null),f(null),w.current&&(w.current.value=""))}catch(ee){console.error("Error sending message:",ee)}finally{x(!1),g(!1)}},oe=ee=>ee?ee.startsWith("image/")?gH:ee.includes("pdf")?jr:B1:B1,Y=(ee,b,O,S)=>{const I=S||ee,U=b==null?void 0:b.startsWith("image/"),Q=b==null?void 0:b.includes("pdf"),H=oe(b),X=O||"Attachment",V=async J=>{J.preventDefault(),await ae(I,O)},Ae=async J=>{try{if(J.startsWith("data:")){const ve=window.open();ve&&(U?ve.document.write(`<img src="${J}" alt="${X}" style="max-width:100%; max-height:100%;">`):Q&&J.startsWith("data:application/pdf")?ve.document.write(`<iframe src="${J}" width="100%" height="100%" style="border:none;"></iframe>`):ve.document.write(`<a href="${J}" download="${X}">Download ${X}</a>`))}else{const ve=await Zy(J);ve.status===200?window.open(ve.data.presignedUrl,"_blank"):console.error("No presigned URL received")}}catch(ve){console.error("Error displaying file:",ve)}},W=a.jsxs("button",{onClick:V,className:"flex items-center space-x-2 text-primary hover:text-primary/80 mt-2",children:[a.jsx(_n,{size:16}),a.jsxs("span",{className:"text-sm",children:["Download ",U?"Image":Q?"PDF":"File"]})]});return U?a.jsxs("div",{className:"max-w-xs bg-gray-50 p-2 rounded-lg",children:[a.jsx("div",{className:"overflow-hidden rounded-lg",children:a.jsx("button",{onClick:()=>Ae(I),children:a.jsx("img",{src:I,alt:X,className:"max-w-full max-h-48 rounded-lg object-contain bg-white",onError:J=>{console.error("Image failed to load:",I),J.target.src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect width='18' height='18' x='3' y='3' rx='2' ry='2'/%3E%3Ccircle cx='9' cy='9' r='2'/%3E%3Cpath d='m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21'/%3E%3C/svg%3E",J.target.className="w-12 h-12 mx-auto text-gray-400"}})})}),a.jsxs("div",{className:"mt-2",children:[a.jsx("div",{className:"text-sm text-gray-600 truncate",children:X}),W]})]}):Q?a.jsxs("div",{className:"max-w-xs bg-gray-50 p-2 rounded-lg",children:[a.jsxs("div",{className:"border rounded-lg p-2 bg-white",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx(jr,{size:20,className:"text-primary"}),a.jsx("span",{className:"text-sm font-medium truncate",children:X})]}),a.jsx("div",{className:"w-full h-48 bg-gray-100 rounded flex items-center justify-center",children:a.jsxs("button",{onClick:()=>Ae(I),className:"text-primary hover:underline flex items-center",children:[a.jsx(jr,{className:"mr-1",size:20}),"View PDF"]})})]}),W]}):a.jsxs("div",{className:"max-w-xs bg-gray-50 p-4 rounded-lg",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[a.jsx(H,{size:24,className:"text-primary"}),a.jsx("span",{className:"text-sm font-medium truncate",children:X})]}),a.jsxs("button",{onClick:()=>Ae(I),className:"flex items-center space-x-2 text-primary hover:text-primary/80 mt-2 mr-4",children:[a.jsx(jr,{size:16}),a.jsx("span",{className:"text-sm",children:"View File"})]}),W]})},R=l?n.filter(ee=>ee.topic===l):n,z=ee=>{c(ee),window.innerWidth<768&&v(!1)};return a.jsxs("div",{className:"flex flex-col md:flex-row h-screen relative",children:[a.jsxs("div",{className:"md:hidden bg-primary text-white p-4 flex justify-between items-center",children:[a.jsx("h3",{className:"text-lg font-semibold",children:l?M(l):"All Discussions"}),a.jsx("button",{onClick:()=>v(!p),className:"p-1 rounded-lg",children:p?a.jsx(_r,{size:24}):a.jsx(z4,{size:24})})]}),a.jsxs("div",{className:`${p?"block":"hidden"} md:block bg-gray-100 border-r p-4 overflow-y-auto w-full md:w-1/4 lg:w-1/5 absolute md:relative z-10 h-[calc(100%-4rem)] md:h-full`,children:[a.jsx("h3",{className:"text-xl font-semibold text-primary mb-4 hidden md:block",children:"Chat Topics"}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{onClick:()=>z(null),className:`p-3 rounded-lg cursor-pointer ${l===null?"bg-primary text-white":"hover:bg-gray-200"}`,children:"All Discussions"}),L.map((ee,b)=>a.jsx("div",{onClick:()=>z(ee),className:`p-3 rounded-lg cursor-pointer ${l===ee?"bg-primary text-white":"hover:bg-gray-200"}`,children:M(ee)},b))]})]}),a.jsxs("div",{className:`${p?"hidden md:flex":"flex"} flex-col flex-1 h-[calc(100%-4rem)] md:h-full`,children:[a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[R.map((ee,b)=>a.jsxs("div",{className:"flex items-start space-x-3",children:[ee.userImage?a.jsx("img",{src:ee.userImage,alt:ee.senderName,className:"w-10 h-10 rounded-full"}):a.jsx(M_,{className:"w-10 h-10 text-gray-400"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex justify-between items-center flex-wrap",children:[a.jsx("span",{className:"font-semibold",children:ee.senderName}),a.jsx("span",{className:"text-xs text-gray-500",children:new Date(ee.timestamp).toLocaleString()})]}),a.jsxs("div",{className:"bg-gray-100 p-3 rounded-lg mt-1",children:[a.jsx("p",{className:"break-words",children:ee.message}),(ee.attachmentUrl||ee.attachmentBase64)&&a.jsx("div",{className:"mt-2",children:Y(ee.attachmentUrl,ee.attachmentType,ee.attachmentName,ee.attachmentBase64)}),ee.topic&&a.jsxs("span",{className:"text-xs text-primary mt-1 block",children:["Tag to: ",M(ee.topic)]}),ee.taggedEmployeeName&&a.jsxs("span",{className:"text-xs text-green-600 mt-1 block",children:["Tagged: ",ee.taggedEmployeeName]})]})]})]},b)),a.jsx("div",{ref:B})]}),a.jsx("div",{className:"border-t p-2 md:p-4 bg-white",children:a.jsxs("div",{className:"flex flex-col space-y-2 md:space-y-0 md:flex-row md:items-center",children:[a.jsxs("div",{className:"flex flex-1 items-center space-x-2",children:[a.jsx("input",{id:"message",type:"text",value:i,onChange:ee=>o(ee.target.value),placeholder:"Type your message...",className:"flex-1 p-2 border rounded-lg",autoComplete:"off"}),a.jsx("input",{type:"file",ref:w,onChange:G,className:"hidden",id:"file-upload"}),a.jsx("label",{htmlFor:"file-upload",className:"cursor-pointer p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(CH,{size:20,className:`${A?"text-primary":"text-gray-500"} ${h?"animate-pulse":""}`})})]}),A&&a.jsx("div",{className:"md:hidden px-2",children:a.jsx("span",{className:"text-xs text-gray-500 truncate block",children:A.name})}),a.jsxs("div",{className:"flex items-center space-x-2",children:[l&&T.length>0&&a.jsxs("select",{value:(j==null?void 0:j._id)||"",onChange:ee=>{const b=T.find(O=>O._id===ee.target.value||O.company_email_id===ee.target.value);E(b||null)},className:"p-2 border rounded-lg text-sm w-full md:w-auto",children:[a.jsx("option",{value:"",children:"Tag Employee"}),T.map(ee=>a.jsx("option",{value:ee._id||ee.company_email_id,children:ee.full_name},ee._id||ee.company_email_id))]}),A&&a.jsx("span",{className:"hidden md:inline text-xs text-gray-500 truncate max-w-[150px]",children:A.name}),a.jsx("button",{onClick:Z,disabled:h||m||!i.trim()&&!A,className:`${h||m||!i.trim()&&!A?"bg-gray-400 cursor-not-allowed":"bg-primary hover:bg-primary/90"} text-white p-2 rounded-lg flex items-center justify-center`,children:m?a.jsx(If,{size:20,className:"animate-spin"}):a.jsx(W4,{size:20})})]})]})})]})]})},S1e=(e,t)=>{if(!e||!t)return{days:"-",hours:"-",minutes:"-"};const r=new Date(e),s=new Date(t)-r;if(s<0)return{days:"-",hours:"-",minutes:"-"};const i=Math.floor(s/(1e3*60*60*24)),o=Math.floor(s%(1e3*60*60*24)/(1e3*60*60)),l=Math.floor(s%(1e3*60*60)/(1e3*60));return{days:i,hours:o,minutes:l}},F1e=e=>{if(e.days==="-")return"Pending";const t=[];return e.days>0&&t.push(`${e.days}d`),e.hours>0&&t.push(`${e.hours}h`),e.minutes>0&&t.push(`${e.minutes}m`),t.length>0?t.join(" "):"Less than 1m"},mO=e=>{const t={approved:{bg:"bg-green-100",text:"text-green-800",border:"border-green-200"},rejected:{bg:"bg-red-100",text:"text-red-800",border:"border-red-200"},pending:{bg:"bg-yellow-100",text:"text-yellow-800",border:"border-yellow-200"},hold:{bg:"bg-orange-100",text:"text-orange-800",border:"border-orange-200"},"po-pending":{bg:"bg-blue-100",text:"text-blue-800",border:"border-blue-200"},"invoice-pending":{bg:"bg-indigo-100",text:"text-indigo-800",border:"border-indigo-200"},default:{bg:"bg-gray-100",text:"text-gray-800",border:"border-gray-200"}},r=e.toLowerCase();if(t[r])return`${t[r].bg} ${t[r].text} ${t[r].border} rounded-full px-3 py-1 text-xs font-medium border`;for(const[n,s]of Object.entries(t))if(r.includes(n))return`${s.bg} ${s.text} ${s.border} rounded-full px-3 py-1 text-xs font-medium border`;return`${t.default.bg} ${t.default.text} ${t.default.border} rounded-full px-3 py-1 text-xs font-medium border`},Zk=({requestDetails:e,serialNumber:t=1})=>{if(!e)return null;const{date:r,time:n}=e.reqCreatedAt?qg(e.reqCreatedAt):{date:"N/A",time:"N/A"};return a.jsxs("div",{className:"bg-white rounded-2xl shadow-md overflow-hidden mb-6 border border-gray-100",children:[a.jsx("div",{className:"p-5 border-b border-gray-100 flex items-center justify-between",children:a.jsxs("h3",{className:"text-xl font-bold text-gray-800 flex items-center",children:[a.jsx(Xm,{className:"mr-3 text-blue-500",size:24}),"Requestor Details"]})}),a.jsx("table",{className:"w-full",children:a.jsx("tbody",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("td",{className:"p-4 w-1/3",children:a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Requestor"}),a.jsx("p",{className:"text-base text-gray-900 font-semibold",children:e.requestorName||"N/A"}),a.jsx("p",{className:"text-sm text-gray-500",children:e.requestorDepartment||"N/A"})]})}),a.jsx("td",{className:"p-4 w-1/3",children:a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Current Status"}),a.jsx("span",{className:mO(e.currentStatus),children:e.currentStatus||"N/A"})]})}),a.jsx("td",{className:"p-4 w-1/3",children:a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Submission Date"}),a.jsx("p",{className:"text-base text-gray-900",children:r}),a.jsx("p",{className:"text-sm text-gray-500",children:n})]})})]})})})]})},pO=({createdAt:e,logData:t,reqLogs:r})=>!t||t.length===0?a.jsxs(a.Fragment,{children:[a.jsx(Zk,{requestDetails:r}),a.jsxs("div",{className:"flex flex-col items-center justify-center p-8 bg-gray-50 rounded-2xl",children:[a.jsx(jr,{className:"text-gray-400 mb-4",size:64}),a.jsx("p",{className:"text-lg text-gray-600 text-center",children:"No approval logs available"})]})]}):a.jsxs(a.Fragment,{children:[a.jsx(Zk,{requestDetails:r}),a.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-100",children:[a.jsxs("div",{className:"p-5 bg-gray-50 border-b border-gray-200 flex items-center justify-between relative",children:[a.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center",children:[a.jsx(ql,{className:"mr-3 text-blue-500",size:24}),"Approval Logs"]}),a.jsxs("div",{className:"flex items-center gap-4",children:[" ",a.jsx("span",{className:"text-sm text-gray-600",children:"Turn Around Time"}),a.jsxs("span",{className:"relative inline-flex items-center justify-center w-5 h-5 bg-gray-200 rounded-full cursor-help group",children:[a.jsx(Fi,{size:12,className:"text-gray-600"}),a.jsx("span",{className:"absolute hidden group-hover:flex items-center z-50 right-0 mr-4 top-1/2 -translate-y-1/2 px-3 py-1 text-xs text-white bg-gray-800 rounded-lg whitespace-nowrap shadow-lg",children:"Turn around time includes non-working hours"})]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-100",children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Sl.No"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Approved By"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Created On"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Received On"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Updated On"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"TAT"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Proceeded To"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:t.map((n,s)=>{const{date:i,time:o}=qg(n.approvalDate),{date:l,time:c}=qg(e),{date:A,time:d}=qg(n.receivedOn),u=S1e(n.receivedOn,n.approvalDate),f=F1e(u);return a.jsxs("tr",{className:"hover:bg-gray-50/50 transition-colors",children:[a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:"text-sm font-medium text-gray-900",children:s+1})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:n.approvalId||"NA"}),a.jsx("p",{className:"text-sm text-gray-600",children:n.approverName||"NA"}),a.jsx("p",{className:"text-xs text-gray-500",children:n.departmentName==="Head of Finance"?"PO team":n.departmentName||"NA"})]})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"space-y-2",children:[a.jsx("span",{className:mO(n.status),children:n.status}),n.remarks&&a.jsx("div",{className:"relative",children:a.jsx("div",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded-lg border border-gray-200",children:a.jsx("p",{className:"whitespace-pre-wrap",children:n.remarks})})})]})}),a.jsxs("td",{className:"px-4 py-3",children:[a.jsx("p",{className:"text-sm text-gray-900",children:l}),a.jsx("p",{className:"text-xs text-gray-500",children:c})]}),a.jsxs("td",{className:"px-4 py-3",children:[a.jsx("p",{className:"text-sm text-gray-900",children:A||"NA"}),a.jsx("p",{className:"text-xs text-gray-500",children:d||"NA"})]}),a.jsxs("td",{className:"px-4 py-3",children:[a.jsx("p",{className:"text-sm text-gray-900",children:i}),a.jsx("p",{className:"text-xs text-gray-500",children:o})]}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:"text-sm font-medium text-gray-900",children:f})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx("span",{className:"text-sm text-gray-900",children:n.nextDepartment==="Head of Finance"?"PO team":n.nextDepartment}),a.jsx(Wf,{size:16,className:"text-gray-400"})]})})]},n._id||s)})})]})})]})]}),xO=({request:e})=>{const t=["Invoice-Pending","Approved"].includes(e.status),r=o=>{try{let l=o.split("/").pop();return l=l.split("?")[0],l=decodeURIComponent(l),l=l.replace(/[-_]/g," ").split(" ").map(c=>c.charAt(0).toUpperCase()+c.slice(1)).join(" "),l.replace(/\.[^/.]+$/,"")}catch(l){return console.error("Error parsing filename:",l),"Document"}},n=async o=>{try{const l=await Zy(o);l.status===200?window.open(l.data.presignedUrl,"_blank"):console.error("No presigned URL received")}catch(l){console.error("Error fetching presigned URL:",l)}};if(!t)return null;const s=({title:o,documents:l,isPO:c=!1})=>a.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden w-full",children:[a.jsx("div",{className:"bg-primary/10 px-3 sm:px-6 py-3 sm:py-4",children:a.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-primary",children:o})}),a.jsx("div",{className:"p-3 sm:p-6",children:c?l!=null&&l.poLink?a.jsx(i,{link:l.poLink,poNumber:l.poNumber,uploadInfo:l.uploadedBy,uploadDate:l.uploadedOn}):a.jsx("p",{className:"text-gray-500 italic text-sm sm:text-base",children:"No PO documents available"}):(l==null?void 0:l.length)>0?a.jsx("div",{className:"space-y-4 sm:space-y-6",children:l.map((A,d)=>a.jsx(i,{link:A.uploadedBy.invoiceLink,uploadInfo:A.uploadedBy,uploadDate:A.uploadedOn,showDivider:d!==l.length-1},d))}):a.jsx("p",{className:"text-gray-500 italic text-sm sm:text-base",children:"No invoice documents available"})})]}),i=({link:o,poNumber:l,uploadInfo:c,uploadDate:A,showDivider:d=!1})=>a.jsxs("div",{className:`${d?"border-b pb-4 sm:pb-6":""}`,children:[a.jsxs("div",{onClick:()=>n(o),className:"group flex items-center gap-2 sm:gap-3 p-3 sm:p-4 rounded-lg bg-gray-50 hover:bg-gray-100 transition-all duration-200 cursor-pointer",children:[a.jsx("div",{className:"p-1.5 sm:p-2 bg-red-50 rounded-lg group-hover:bg-red-100 transition-colors flex-shrink-0",children:a.jsx(ep,{className:"text-red-500 text-lg sm:text-xl"})}),a.jsx("span",{className:"text-gray-700 font-medium group-hover:text-primary transition-colors text-sm sm:text-base truncate",children:r(o)})]}),a.jsxs("div",{className:"mt-2 sm:mt-3 px-2 sm:px-4 space-y-1",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2",children:[a.jsx("span",{className:"text-gray-600 font-medium text-xs sm:text-sm",children:c.docType==="Invoice"?"Invoice Number:":"PO Number:"}),a.jsx("span",{className:"text-gray-700 text-xs sm:text-sm break-all",children:c.docType==="Invoice"?c.invoiceNumber:l})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2",children:[a.jsx("span",{className:"text-gray-600 font-medium text-xs sm:text-sm",children:"Uploaded by:"}),a.jsx("span",{className:"text-gray-700 text-xs sm:text-sm",children:c.empName})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2",children:[a.jsx("span",{className:"text-gray-600 font-medium text-xs sm:text-sm",children:"Department:"}),a.jsx("span",{className:"text-gray-700 text-xs sm:text-sm",children:c.department})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2",children:[a.jsx("span",{className:"text-gray-600 font-medium text-xs sm:text-sm",children:"Date:"}),a.jsx("span",{className:"text-gray-700 text-xs sm:text-sm",children:so(c.uploadedOn)})]})]})]});return a.jsxs("div",{className:"space-y-6 sm:space-y-8 px-2 sm:px-0",children:[a.jsx("div",{className:"border-b pb-2",children:a.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-primary",children:"Documents"})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 lg:gap-8",children:[a.jsx(s,{title:"Purchase Order Document",documents:e.poDocuments,isPO:!0}),a.jsx(s,{title:"Invoice Documents",documents:e.invoiceDocumets})]})]})},gO=({closeModal:e,modalContent:t})=>a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6 relative",children:[a.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:t.title}),a.jsx("p",{className:"text-gray-600",children:t.description}),a.jsx("div",{className:"mt-4 flex justify-end",children:a.jsx("button",{onClick:e,className:"px-4 py-2 bg-primary text-white rounded hover:bg-primary/90 transition-colors",children:"Close"})})]})}),yO=({setShowDialog:e,handleNotify:t})=>a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[a.jsxs("div",{className:"flex flex-col items-center mb-6",children:[a.jsx("div",{className:"w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mb-4",children:a.jsx(j1,{className:"text-primary w-8 h-8"})}),a.jsx("h3",{className:"text-xl font-semibold",children:"Notify"}),a.jsx("p",{className:"mt-2 text-gray-600 text-center",children:"Do you want to make a reminder?"})]}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx("button",{onClick:()=>e(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-100 text-gray-700 font-medium transition-colors duration-200",children:"No"}),a.jsxs("button",{onClick:t,className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary/90 transition-colors duration-200 font-medium flex items-center gap-2",children:[a.jsx(j1,{size:16}),"Yes"]})]})]})}),vO=({approveStatus:e,needsReason:t,setReason:r,setSubmissionDialog:n,approveRequest:s,reason:i,newStatus:o})=>a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96 md:w-[32rem]",children:[a.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Confirm Submission"}),a.jsx("p",{className:"mb-4",children:`Are you sure you want to ${e.toLowerCase()} the request?`}),t&&a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Please provide a reason"}),a.jsx("textarea",{value:i,onChange:l=>r(l.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-primary focus:border-primary",rows:4,placeholder:`Enter reason for ${e.toLowerCase()}ing the request...`,required:!0})]}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx("button",{onClick:()=>{n(!1),r("")},className:"px-4 py-2 border rounded-lg hover:bg-gray-100",children:"Cancel"}),a.jsx("button",{onClick:()=>{s(o),n(!1)},disabled:t&&!i.trim(),className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-dark disabled:opacity-50 disabled:cursor-not-allowed",children:e})]})]})}),eT=()=>{const e=Sr(),t=yo(),r=localStorage.getItem("capEmpId"),n=localStorage.getItem("role"),s=localStorage.getItem("department"),i=localStorage.getItem("email"),{request:o,currencies:l,reqLogs:c,isLoading:A,isDisabled:d,canApprove:u,formatCurrency:f,refreshRequestData:h,updateRequestStatus:x}=DD(t.id,r,n),{isLoading:m,isUploading:g,isGeneratingPDF:p,isAnyActionInProgress:v,approveRequest:w,sendReminderNotification:B,uploadPODocument:T,uploadInvoiceDocument:_,setPDFGenerating:j,getLoadingMessage:E}=PD(r,n,i,s),[L,M]=C.useState("preview"),[F,D]=C.useState(null),[G,K]=C.useState(!1),[ae,Z]=C.useState(!1),[oe,Y]=C.useState(),[R,z]=C.useState(),[ee,b]=C.useState(""),[O,S]=C.useState(!1),[I,U]=C.useState({title:"",description:""});C.useState(""),C.useState("");const Q=(He,Ze)=>{U({title:He,description:Ze||"No additional information available for this question."}),S(!0)},H=()=>{S(!1)},{generateSectionHTML:X}=OD({request:o,currencies:l}),{handleGeneratePDF:V}=AO({request:o,generateSectionHTML:X}),Ae=async()=>{j(!0);try{await V()}finally{j(!1)}},W=He=>{Y(He),z(He==="Approve"?"Approved":He),Z(!0)},J=async()=>{(await w(t.id,oe,ee)).success&&(x(R),Z(!1),setTimeout(()=>{window.location.reload()},1e3)),Z(!1)},ve=async()=>{(await B(o._id)).success&&K(!1)},de=async He=>{(await T(t.id,o.reqid,F,He)).success&&e("/approval-request-list")},te=async He=>{(await _(t.id,o.reqid,F,He)).success&&e("/req-list-table")},je=()=>{if(!o)return null;switch(L){case"preview":return a.jsx(uO,{request:o,extractDateAndTime:Ov,formatDateToDDMMYY:so,formatCurrency:f,openInfoModal:Q,showFileUrl:Zy});case"chat":return a.jsx(hO,{reqId:t.id,reqid:o.reqid});case"logs":return a.jsx(pO,{createdAt:o.createdAt,logData:o.approvals,reqLogs:c});default:return null}};if(A)return a.jsx(py,{isVisible:!0,message:"Loading request details..."});if(!o)return a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-lg text-gray-600 mb-4",children:"Request not found"}),a.jsx("button",{onClick:()=>e(-1),className:"px-4 py-2 bg-primary text-white rounded-lg",children:"Go Back"})]})});const qe=["Hold","Reject"].includes(oe);return a.jsxs("div",{className:"flex flex-col bg-white min-h-screen",children:[a.jsx(py,{isVisible:v,message:E(),variant:p?"generating":g?"uploading":"processing"}),a.jsx("div",{className:"bg-primary text-white p-4 text-center shadow-md",children:a.jsx("h1",{className:"text-2xl font-bold",children:"Purchase Order Preview"})}),a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[a.jsx(dO,{activeSection:L,setActiveSection:M}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[je(),a.jsx(xO,{request:o})]})]}),a.jsx(fO,{request:o,role:n,disable:d,isLoading:m,isUploading:g,isGeneratingPDF:p,selectedImage:F,setSelectedImage:D,setShowDialog:K,handleStatus:W,handleUploadPo:de,handleUploadInvoice:te,handleGeneratePDF:Ae}),G&&a.jsx(yO,{setShowDialog:K,handleNotify:ve}),ae&&a.jsx(vO,{approveStatus:oe,needsReason:qe,setReason:b,setSubmissionDialog:Z,approveRequest:J,reason:ee,newStatus:R}),O&&a.jsx(gO,{closeModal:H,modalContent:I}),a.jsx(In,{position:"top-right",autoClose:5e3})]})},E1e=({currentUsers:e,navigate:t,getStatusBackgroundColor:r,handleCopyReqId:n,renderActionColumn:s,handleOpenInNewTab:i,formatCurrency:o,searchTerm:l,dateFilters:c,viewMode:A,startIndex:d})=>a.jsx("div",{className:"border border-gray-200 rounded-lg w-full",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsx("div",{className:"inline-block min-w-full align-middle",children:a.jsx("div",{className:"overflow-hidden",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-primary",children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[5%]",children:"SNo"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[10%]",children:"ReqId"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[15%]",children:"Business Unit"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[15%]",children:"Vendor"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[8%]",children:"Amount"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[10%]",children:"Status"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[10%]",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.length>0?e.map((u,f)=>{var h,x,m,g,p,v,w,B;return a.jsxs("tr",{className:`hover:bg-gray-200 cursor-pointer ${r(u.approvalStatus.color)}`,onClick:()=>t(`/approval-request-list/preview-one-req/${u._id}`),children:[a.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:d+f+1}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"block font-medium",children:u.reqid}),a.jsxs("div",{className:"flex space-x-1",children:[a.jsx("button",{onClick:T=>n(u.reqid,T),className:"text-gray-400 hover:text-blue-500 transition-colors",title:"Copy Request ID",children:a.jsx(Gl,{className:"h-3 w-3 md:h-4 md:w-4"})}),a.jsx("button",{onClick:T=>i(u._id,T),className:"text-gray-400 hover:text-green-500 transition-colors",title:"Open in new tab",children:a.jsx(Xf,{className:"h-3 w-3 md:h-4 md:w-4"})})]})]}),a.jsx("span",{className:"block font-medium",children:u.userName||"Employee"}),a.jsx("span",{className:"block",children:(h=u.commercials)==null?void 0:h.department})]})}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:a.jsxs("div",{children:[a.jsx("span",{className:"block font-medium",children:((x=u.commercials)==null?void 0:x.businessUnit)||"NA"}),a.jsx("span",{className:"block font-medium",children:((m=u.commercials)==null?void 0:m.entity)||"NA"}),a.jsx("span",{className:"block",children:((g=u.commercials)==null?void 0:g.site)||"NA"})]})}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:a.jsxs("div",{children:[a.jsx("span",{className:"block font-medium",children:(p=u.procurements)==null?void 0:p.vendor}),a.jsx("span",{className:"block",children:(v=u.procurements)==null?void 0:v.vendorName})]})}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:o((w=u.supplies)==null?void 0:w.totalValue,(B=u.supplies)==null?void 0:B.selectedCurrency)}),a.jsx("td",{className:"px-6 py-4 text-sm ",children:u.isCompleted?a.jsxs(a.Fragment,{children:[u.status!=="Approved"&&a.jsxs(a.Fragment,{children:[u.nextDepartment||u.cDepartment," ",a.jsx("br",{})," : "]}),a.jsx("span",{className:"font-medium",children:u.status||"Pending"})]}):a.jsx("span",{className:"text-red-500 font-medium",children:"Draft"})}),s(u)]},u._id)}):a.jsx("tr",{children:a.jsx("td",{colSpan:"10",className:"px-6 py-4 text-center text-gray-500",children:l||c.fromDate||c.toDate?"No matching results found.":A==="pending"?"No pending requests available.":"No data available."})})})]})})})})}),k1e=()=>{const e=localStorage.getItem("capEmpId"),t=localStorage.getItem("role"),r=localStorage.getItem("email"),n=Sr(),s=localStorage.getItem("multiRole"),[i,o]=C.useState([]),[l,c]=C.useState([]),[A,d]=C.useState([]),[u,f]=C.useState(""),[h,x]=C.useState(!1),[m,g]=C.useState(1),[p,v]=C.useState(!0),[w,B]=C.useState(null),[T,_]=C.useState(!1),[j,E]=C.useState(null),[L,M]=C.useState(!1),[F,D]=C.useState("pending"),[G,K]=C.useState(""),[ae,Z]=C.useState(""),[oe,Y]=C.useState([]),[R,z]=C.useState(!1),[ee,b]=C.useState([]),[O,S]=C.useState(null),[I,U]=C.useState({fromDate:"",toDate:""}),Q=20,H=["Pending","Rejected","Hold"],X=(Ce,Be)=>H.includes(Ce)?Be.filter(tt=>tt.status===Ce).map(tt=>tt.nextDepartment).filter(tt=>tt&&tt.trim()!=="").filter((tt,Ot,vt)=>vt.indexOf(tt)===Ot).sort():[];C.useEffect(()=>{if(G&&H.includes(G)){const Ce=X(G,i);Y(Ce),ae&&!Ce.includes(ae)&&Z("")}else Y([])},[G,i,ae]),C.useEffect(()=>{(async()=>{const Be=await mo();Be.status===200&&b(Be.data.data)})()},[]),C.useEffect(()=>{(async()=>{const Be=await ev();Be.status===200&&B(Be.data.data)})()},[]);const V=async(Ce=!0)=>{v(!0);try{const Be=await E1(e,"Pending");if(console.log("response",Be),Be.status===200){const Pe=Be.data.reqData;if(Ce){const Bt=Pe.filter(tt=>{var $t;const Ot=tt.approvals,vt=Ot[Ot.length-1];console.log("lastLevelApproval",vt);const Vt=(($t=tt.approvalStatus)==null?void 0:$t.color)==="red",pr=tt.firstLevelApproval.hodEmail===r&&tt.firstLevelApproval.approved===!1||vt.nextDepartment===t||vt.approvalId===e&&vt.status!="Approved";return console.log(`Request ID: ${tt.reqid||"N/A"}`,{isRed:Vt,isApproved:pr}),Vt&&pr});c(Bt),o(Bt)}else{const Bt=await E1(e,"All");c(Pe),o(Pe)}}}catch(Be){console.error("Error fetching requests:",Be)}finally{setTimeout(()=>{v(!1)},500)}};C.useEffect(()=>{V(F==="pending")},[e,t]),C.useEffect(()=>{(()=>{let Be=i;F==="pending"&&(Be=i.filter(tt=>tt.approvalStatus&&tt.approvalStatus.color==="red"));const Bt=Be.filter(tt=>{var Gr,un,Nr,Wt,lt;const Ot=u.toLowerCase(),vt=(Gr=tt.reqid)==null?void 0:Gr.toLowerCase().includes(Ot),Vt=(un=tt.userName)==null?void 0:un.toLowerCase().includes(Ot),pr=(Wt=(Nr=tt.commercials)==null?void 0:Nr.department)==null?void 0:Wt.toLowerCase().includes(Ot),$t=(lt=tt.nextDepartment)==null?void 0:lt.toLowerCase().includes(Ot),Qr=!G||G==="Draft"&&!tt.isCompleted||G&&tt.status===G,ir=!ae||!H.includes(G)||tt.nextDepartment===ae;return console.log(`Filtering ${tt.reqid}:`,{statusFilter:G,departmentFilter:ae,userStatus:tt.status,userNextDept:tt.nextDepartment,statusMatch:Qr,departmentMatch:ir}),(vt||Vt||pr||$t)&&Qr&&ir}).filter(tt=>{if(!I.fromDate&&!I.toDate)return!0;const Ot=new Date(tt.createdAt),vt=I.fromDate?new Date(I.fromDate):null,Vt=I.toDate?new Date(I.toDate):null;return vt&&Vt?Ot>=vt&&Ot<=Vt:vt?Ot>=vt:Vt?Ot<=Vt:!0});console.log(`Final filtered results: ${Bt.length} records`),c(Bt)})()},[u,i,I,F,G,ae]);const Ae=()=>{f(""),U({fromDate:"",toDate:""}),K(""),Z(""),Y([]),z(!1),x(!1)},W=Ce=>{const Be=Ce.target.value;K(Be),Z(""),z(H.includes(Be))},J=Ce=>{Z(Ce.target.value)},ve=Ce=>{D(Ce),g(1),Ae(),V(Ce==="pending")},de=async(Ce,Be)=>{Be.stopPropagation();try{await navigator.clipboard.writeText(Ce),S(Ce),setTimeout(()=>{S(null)},2e3)}catch(Pe){console.error("Failed to copy: ",Pe);const Bt=document.createElement("textarea");Bt.value=Ce,document.body.appendChild(Bt),Bt.focus(),Bt.select();try{document.execCommand("copy"),S(Ce),setTimeout(()=>{S(null)},2e3)}catch(tt){console.error("Fallback copy failed: ",tt)}document.body.removeChild(Bt)}},te=(Ce,Be)=>{Be.stopPropagation();const Pe=`/approval-request-list/preview-one-req/${Ce}`;window.open(Pe,"_blank")},je=(Ce,Be)=>{if(!Ce)return"N/A";const Pe=ee.find(Bt=>Bt.code===Be);if(!Pe)return Ce;try{return new Intl.NumberFormat(Pe.locale,{style:"currency",currency:Pe.code,minimumFractionDigits:2,maximumFractionDigits:2}).format(Ce)}catch(Bt){return console.error("Currency formatting error:",Bt),Ce}},qe=Ce=>{f(Ce.target.value)},He=Ce=>{const{name:Be,value:Pe}=Ce.target;U(Bt=>({...Bt,[Be]:Pe}))},Ze=async(Ce,Be)=>{Ce.stopPropagation(),n(`/req-list-table/edit-req/${Be}`)},xe=async Ce=>{try{(await Zm(Ce)).status===200&&(o(i.filter(Pe=>Pe._id!==Ce)),_(!1))}catch(Be){console.error("Error deleting request:",Be)}},ue=Ce=>{Ce>=1&&Ce<=ke&&(g(Ce),d([]))},Fe=Ce=>{switch(Ce){case"red":return"bg-red-200";default:return"bg-white"}},ke=Math.ceil(l.length/Q),Te=(m-1)*Q,Ne=Te+Q,et=l.slice(Te,Ne),Se=Ce=>Ce.status==="Approved"?a.jsx("td",{className:"text-sm text-gray-500 text-center md:px-6 md:py-4 px-2 py-2",children:a.jsx("span",{className:"text-xs text-gray-400",children:"No actions"})}):Ce.isCompleted?t==="Admin"||t==="Head of Finance"||t==="HOD Department"||s==1?a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-sm text-gray-500",children:a.jsxs("div",{className:"flex justify-center items-center space-x-2",children:[a.jsx("button",{className:"text-blue-500 hover:text-blue-700",onClick:Be=>Ze(Be,Ce._id),children:a.jsx(Us,{className:"h-4 w-4 md:h-5 md:w-5"})}),t==="Admin"&&a.jsx("button",{className:"text-red-500 hover:text-red-700",onClick:Be=>{Be.stopPropagation(),E(Ce._id),_(!0)},children:a.jsx($r,{className:"h-4 w-4 md:h-5 md:w-5"})})]})}):a.jsx("td",{className:"text-sm text-gray-500 text-center md:px-6 md:py-4 px-2 py-2",children:a.jsx("button",{className:"px-2 py-1 bg-primary text-white rounded-md hover:bg-primary text-xs md:text-sm",onClick:Be=>{Be.stopPropagation(),M(!0),E(Ce._id)},children:"Request Edit"})}):a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-sm text-gray-500",children:a.jsxs("div",{className:"flex justify-center items-center space-x-2",children:[a.jsx("button",{className:"text-blue-500 hover:text-blue-700",onClick:Be=>Ze(Be,Ce._id),children:a.jsx(Us,{className:"h-4 w-4 md:h-5 md:w-5"})}),a.jsx("button",{className:"text-red-500 hover:text-red-700",onClick:Be=>{Be.stopPropagation(),E(Ce._id),_(!0)},children:a.jsx($r,{className:"h-4 w-4 md:h-5 md:w-5"})})]})});return a.jsxs(a.Fragment,{children:[p&&a.jsx(Fd,{}),O&&a.jsx("div",{className:"fixed top-4 right-4 z-50",children:a.jsxs("div",{className:"bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg flex items-center space-x-2",children:[a.jsx(ho,{className:"h-4 w-4"}),a.jsxs("span",{className:"text-sm font-medium",children:['ReqID "',O,'" copied successfully!']})]})}),a.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-sm h-full",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Approval List"}),a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-6",children:[a.jsxs("div",{className:"relative flex-1 min-w-[300px] max-w-md",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none",children:a.jsx(rn,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{type:"text",value:u,onChange:qe,placeholder:"Search by ID, name, department, or next department...",className:"w-full pl-11 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"flex rounded-md overflow-hidden",children:[a.jsx("button",{className:`px-4 py-2.5 text-sm font-medium ${F==="pending"?"bg-primary text-white":"bg-white text-gray-700 border border-gray-300"}`,onClick:()=>ve("pending"),children:"Pending"}),a.jsx("button",{className:`px-4 py-2.5 text-sm font-medium ${F==="all"?"bg-primary text-white":"bg-white text-gray-700 border border-gray-300"}`,onClick:()=>ve("all"),children:"All"})]}),a.jsxs("button",{className:"inline-flex items-center px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",onClick:()=>x(!h),children:[a.jsx(ti,{className:"h-4 w-4 mr-2"}),"Filter",h?a.jsx(bl,{className:"h-4 w-4 ml-1"}):a.jsx(vo,{className:"h-4 w-4 ml-1"})]}),w&&a.jsxs("a",{href:w,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2.5 border border-blue-300 rounded-lg text-sm font-medium text-blue-700 bg-blue-50 hover:bg-blue-100",children:[a.jsx(jr,{className:"h-4 w-4 mr-2"}),"View PO Policy"]}),a.jsxs("button",{className:"inline-flex items-center px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",onClick:()=>Ud(i),children:[a.jsx(_n,{className:"h-4 w-4 mr-2"}),"Export"]}),a.jsxs("button",{className:"inline-flex items-center px-4 py-2.5 bg-primary text-white rounded-lg text-sm font-medium hover:bg-primary/90",onClick:()=>n("/req-list-table/create-request"),children:[a.jsx(yn,{className:"h-4 w-4 mr-2"}),"Add Request"]})]})]}),h&&a.jsxs("div",{className:"mt-4 w-full md:w-80 p-4 bg-white rounded-lg shadow-lg border border-gray-200 absolute right-0 md:right-8 z-20",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:"Filters"}),a.jsx("button",{onClick:()=>x(!1),className:"text-gray-500 hover:text-gray-700",children:a.jsx(_r,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Status"}),a.jsxs("select",{value:G,onChange:W,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary",children:[a.jsx("option",{value:"",children:"All Statuses"}),a.jsx("option",{value:"Pending",children:"Pending"}),a.jsx("option",{value:"Hold",children:"Hold"}),a.jsx("option",{value:"Rejected",children:"Rejected"}),a.jsx("option",{value:"PO-Pending",children:"PO-Pending"}),a.jsx("option",{value:"Invoice-Pending",children:"Invoice-Pending"}),a.jsx("option",{value:"Approved",children:"Approved"})]})]}),H.includes(G)&&oe.length>0&&a.jsxs("div",{className:"mb-4",children:[a.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:["Next Department (",G,")"]}),a.jsxs("select",{value:ae,onChange:J,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary",children:[a.jsx("option",{value:"",children:"All Departments"}),oe.map(Ce=>a.jsx("option",{value:Ce,children:Ce},Ce))]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Showing ",oe.length," departments for"," ",G," status"]})]}),H.includes(G)&&oe.length===0&&a.jsxs("div",{className:"mb-4",children:[a.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:["Next Department (",G,")"]}),a.jsxs("div",{className:"px-3 py-2 text-sm text-gray-500 bg-gray-50 rounded-md border",children:["No departments available for ",G," status"]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Date Range"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:"From"}),a.jsx("input",{type:"date",name:"fromDate",value:I.fromDate,onChange:He,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:"To"}),a.jsx("input",{type:"date",name:"toDate",value:I.toDate,onChange:He,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary"})]})]})]}),a.jsxs("div",{className:"flex justify-between pt-3 border-t border-gray-200",children:[a.jsx("button",{onClick:()=>x(!1),className:"px-3 py-1.5 text-sm text-gray-600 hover:text-gray-800 font-medium",children:"Close"}),a.jsx("button",{onClick:Ae,className:"px-4 py-1.5 bg-gray-100 text-gray-700 text-sm font-medium rounded-md hover:bg-gray-200",children:"Clear Filters"})]})]})]}),a.jsx(E1e,{currentUsers:et,navigate:n,getStatusBackgroundColor:Fe,handleCopyReqId:de,renderActionColumn:Se,handleOpenInNewTab:te,formatCurrency:je,searchTerm:u,dateFilters:I,viewMode:F,startIndex:Te}),l.length>0&&a.jsx(tp,{currentPage:m,totalPages:ke,handlePageChange:ue,itemsPerPage:Q,totalItems:l.length}),T&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-auto",children:[a.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Do you really want to delete this request"}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx("button",{onClick:()=>_(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-100",children:"Cancel"}),a.jsx("button",{onClick:()=>xe(j),className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary/90",children:"Yes Delete"})]})]})}),L&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-auto",children:[a.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Request Edit Permission"}),a.jsx("p",{className:"mb-4",children:"Your edit request has been sent to the administrator."}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{onClick:()=>M(!1),className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary/90",children:"Close"})})]})})]})]})},T1e=({formData:e,setFormData:t,onNext:r,reqId:n})=>{const s=localStorage.getItem("department"),i=localStorage.getItem("userId"),[o,l]=C.useState(!1),[c,A]=C.useState([]);C.useState([]);const[d,u]=C.useState(null),[f,h]=C.useState([]),[x,m]=C.useState([]),[g,p]=C.useState(""),[v,w]=C.useState([]),[B,T]=C.useState([]),[_,j]=C.useState([]),[E,L]=C.useState([]),[M,F]=C.useState([]),[D,G]=C.useState(""),[K,ae]=C.useState([]),[Z,oe]=C.useState([]),Y=[{id:"CAP-651",name:"Anant Choubey",email:"anant.choubey@capillarytech.com",department:"Corporate (12CCRM01)"},{id:"CAP-005",name:"Aneesh Reddy Boddu",email:"aneesh@capillarytech.com",department:"Corporate (12CCRM01)"}].sort((Ee,Oe)=>Ee.name.localeCompare(Oe.name)),[R,z]=C.useState({entity:(e==null?void 0:e.entity)||"",city:(e==null?void 0:e.city)||"",site:(e==null?void 0:e.site)||"",department:(e==null?void 0:e.department)||"",amount:(e==null?void 0:e.amount)||"",entityId:(e==null?void 0:e.entityId)||"",paymentTerms:(e==null?void 0:e.paymentTerms)||[{percentageTerm:0,paymentTerm:"",paymentType:"",customPaymentTerm:"",customPaymentType:""}],billTo:(e==null?void 0:e.billTo)||"",shipTo:(e==null?void 0:e.shipTo)||"",hod:(e==null?void 0:e.hod)||"",hodEmail:(e==null?void 0:e.hodEmail)||"",businessUnit:(e==null?void 0:e.businessUnit)||"",isCreditCardSelected:(e==null?void 0:e.isCreditCardSelected)||!1,additionalApprover:(e==null?void 0:e.additionalApprover)||"",additionalApproverName:(e==null?void 0:e.additionalApproverName)||"",additionalApproverEmail:(e==null?void 0:e.additionalApproverEmail)||"",additionalApproverProof:(e==null?void 0:e.additionalApproverProof)||null}),[ee,b]=C.useState([]),[O,S]=C.useState(null),[I,U]=C.useState({}),[Q,H]=C.useState([]),[X,V]=C.useState(""),[Ae,W]=C.useState(!1),[J,ve]=C.useState([]),[de,te]=C.useState([]),[je,qe]=C.useState(new Map);C.useEffect(()=>{if(F(Y),e!=null&&e.additionalApprover&&G(e.additionalApprover),e!=null&&e.additionalApproverProof){const Oe=(Array.isArray(e.additionalApproverProof)?e.additionalApproverProof:[e.additionalApproverProof]).map((Re,Ye)=>({name:`Existing File ${Ye+1}`,uploadedUrl:Re,type:"application/pdf",size:0,preview:null}));ae(Oe),oe(Oe)}},[e]),C.useEffect(()=>()=>{Z.forEach(Ee=>{Ee.preview&&URL.revokeObjectURL(Ee.preview)})},[Z]),C.useEffect(()=>{if(e){const Ee={entity:e.entity||"",city:e.city||"",site:e.site||"",department:e.department||s||"",paymentMode:e.paymentMode||"",paymentTerms:e.paymentTerms||[{percentageTerm:0,paymentTerm:"",paymentType:"",customPaymentTerm:"",customPaymentType:""}],billTo:e.billTo||"",shipTo:e.shipTo||"",hod:e.hod||"",hodEmail:e.hodEmail||"",businessUnit:e.businessUnit||"",isCreditCardSelected:e.isCreditCardSelected||!1,additionalApprover:e.additionalApprover||"",additionalApproverName:e.additionalApproverName||"",additionalApproverEmail:e.additionalApproverEmail||"",additionalApproverProof:e.additionalApproverProof||null};z(Ee),V(e.department||"")}},[e,s]);const He=Ee=>{const Oe=Ee.target.value;G(Oe);const Re=M.find(ft=>ft.id===Oe),Ye={...R,additionalApprover:Oe,additionalApproverName:Re?Re.name:"",additionalApproverEmail:Re?Re.email:""};Oe||(Ye.additionalApproverProof=null,ae([]),oe([])),z(Ye),t(Ye)};C.useEffect(()=>{if(e!=null&&e.entity&&ee.length>0){const Ee=ee.filter(Oe=>Oe.entityName===e.entity);if(Ee.length>0){m(Ee);const Oe=[...new Set(Ee.map(mt=>mt.city).filter(mt=>mt))],Re=[...new Set(Ee.map(mt=>mt.area||mt.site).filter(mt=>mt))],Ye=Ee.map(mt=>({value:`${mt.addressLine}

Tax ID: ${mt.taxId||"N/A"}
Tax Type: ${mt.type||"N/A"}`,label:`${mt.addressLine} - ${mt.city||"N/A"}`,entity:mt})),ft=Ee.map(mt=>({value:`${mt.addressLine}

Tax ID: ${mt.taxId||"N/A"}
Tax Type: ${mt.type||"N/A"}`,label:`${mt.addressLine} - ${mt.city||"N/A"}`,entity:mt}));if(j(Oe),L(Re),w(Ye),T(ft),e.entityId){const mt=Ee.find(qt=>qt._id===e.entityId);mt&&(S(mt),p(mt._id))}}}},[e==null?void 0:e.entity,e==null?void 0:e.entityId,ee]);const Ze=async Ee=>{const Oe=Array.from(Ee.target.files);if(Oe.length!==0)try{const Re=Oe.map(async qt=>{let Nt={file:qt,name:qt.name,size:qt.size,type:qt.type,preview:null,uploadedUrl:null};qt.type.startsWith("image/")&&(Nt.preview=URL.createObjectURL(qt));const se=await Ac(qt,qt.type,n);return Nt.uploadedUrl=se.data.fileUrls[0],Nt}),Ye=await Promise.all(Re);ae(qt=>[...qt,...Ye]),oe(qt=>[...qt,...Ye]);const ft=[...K,...Ye].map(qt=>qt.uploadedUrl),mt={...R,additionalApproverProof:ft};z(mt),t(mt),Ee.target.value=""}catch(Re){console.error("File upload failed:",Re),Ie.error("File upload failed. Please try again.")}},xe=Ee=>{const Oe=K[Ee];Oe!=null&&Oe.preview&&URL.revokeObjectURL(Oe.preview);const Re=K.filter((qt,Nt)=>Nt!==Ee),Ye=Z.filter((qt,Nt)=>Nt!==Ee);ae(Re),oe(Ye);const ft=Re.map(qt=>qt.uploadedUrl),mt={...R,additionalApproverProof:ft.length>0?ft:null};z(mt),t(mt)},ue=Ee=>{Ee.uploadedUrl?window.open(Ee.uploadedUrl,"_blank"):Ee.preview&&window.open(Ee.preview,"_blank")},Fe=()=>!K||K.length===0?null:a.jsxs("div",{className:"mt-3 space-y-2",children:[a.jsxs("h4",{className:"text-sm font-medium text-gray-700",children:["Uploaded Files (",K.length,")"]}),K.map((Ee,Oe)=>a.jsx("div",{className:"p-3 border border-gray-200 rounded-lg bg-gray-50",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[Ee.preview&&Ee.type.startsWith("image/")?a.jsx("img",{src:Ee.preview,alt:"File preview",className:"w-12 h-12 object-cover rounded border flex-shrink-0"}):a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded border flex items-center justify-center flex-shrink-0",children:Ee.type==="application/pdf"?a.jsx("span",{className:"text-red-600 text-xs font-bold",children:"PDF"}):Ee.type.includes("word")||Ee.name.endsWith(".doc")||Ee.name.endsWith(".docx")?a.jsx("span",{className:"text-blue-600 text-xs font-bold",children:"DOC"}):a.jsx("span",{className:"text-blue-600 text-xs font-medium",children:Ee.name.split(".").pop().toUpperCase()})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:Ee.name}),a.jsx("p",{className:"text-xs text-gray-500",children:Ee.size?(Ee.size/1024).toFixed(1)+" KB":"Unknown size"}),Ee.uploadedUrl&&a.jsx("p",{className:"text-xs text-green-600",children:" Uploaded"})]})]}),a.jsxs("div",{className:"flex items-center space-x-2 ml-2",children:[a.jsx("button",{type:"button",onClick:()=>ue(Ee),className:"text-blue-500 hover:text-blue-700 transition duration-200 text-xs px-2 py-1 border border-blue-300 rounded",title:"View file",children:"View"}),a.jsx("button",{type:"button",onClick:()=>xe(Oe),className:"text-red-500 hover:text-red-700 transition duration-200",title:"Remove file",children:a.jsx(_r,{size:16})})]})]})},Oe))]});C.useEffect(()=>{(async()=>{try{const Oe=await Zf(i);if(Oe.status===200){const Re=(Oe.data.entities||[]).sort((Ye,ft)=>Ye.entityName.localeCompare(ft.entityName));if(b(Re),H(Oe.data.department||[]),l(Oe.data.isDropDown),Oe.data.isDropDown&&Array.isArray(Oe.data.department)){const Ye=new Set;Oe.data.department.forEach(mt=>{mt.businessUnit&&Ye.add(mt.businessUnit)});const ft=Array.from(Ye).sort().map(mt=>({value:mt,label:mt}));if(h(ft),R.businessUnit){const mt=Oe.data.department.filter(se=>{var pe;return((pe=se.businessUnit)==null?void 0:pe.toLowerCase())===R.businessUnit.toLowerCase()}),qt=new Map;mt.forEach(se=>{const pe=se.department;qt.has(pe)||qt.set(pe,{department:se.department,businessUnit:se.businessUnit,approvers:mt.filter(he=>he.department===se.department).map(he=>({hod:he.hod,hodEmail:he.hod_email_id}))})}),qe(qt);const Nt=Array.from(qt.values());if(te(Nt),ve(Nt),R.department){const se=Nt.find(pe=>pe.department===R.department);se&&(A(se.approvers),u(se),V(R.department))}}}else{const Ye=U1.sort((ft,mt)=>ft.label.localeCompare(mt.label));h(Ye)}if(!Oe.data.isDropDown&&R.department){const Ye=Oe.data.department.find(ft=>ft.department===R.department);Ye&&(z(ft=>({...ft,businessUnit:e.businessUnit,department:Ye.department,hod:Ye.hod,hodEmail:Ye.hod_email_id})),t(ft=>({...ft,businessUnit:e.businessUnit,department:Ye.department,hod:Ye.hod,hodEmail:Ye.hod_email_id})))}}}catch(Oe){console.error("Error fetching entities:",Oe),H([]),ve([]),te([]),qe(new Map),h(o?[]:U1.sort((Re,Ye)=>Re.label.localeCompare(Ye.label)))}})()},[i,R.businessUnit,R.department]);const ke=Ee=>{const{name:Oe,value:Re}=Ee.target;if(o){const Ye={...R,[Oe]:Re,department:"",hod:"",hodEmail:""};z(Ye),t(Ye),V(""),u(null),A([])}else{const Ye={...R,[Oe]:Re};z(Ye),t(Ye),V(""),u(null),A([])}I[Oe]&&U(Ye=>{const ft={...Ye};return delete ft[Oe],ft})},Te=Ee=>{u(Ee),A(Ee.approvers);const Oe={...R,department:Ee.department,hod:"",hodEmail:""};z(Oe),t(Oe),V(Ee.department),W(!1)},Ne=Ee=>{const Oe=c.find(Re=>Re.hod===Ee.target.value);if(Oe){const Re={...R,hod:Oe.hod,hodEmail:Oe.hodEmail};z(Re),t(Re)}},et=async()=>{try{return await a8.validate(R,{abortEarly:!1}),U({}),!0}catch(Ee){if(Ee.inner){const Oe=Ee.inner.reduce((Ye,ft)=>(Ye[ft.path]=ft.message,Ye),{});U(Oe);const Re=Object.keys(Oe)[0];Re&&Ie.error(Oe[Re])}return!1}},Se=Ee=>{const{name:Oe,value:Re}=Ee.target;let Ye={...R,[Oe]:Re};Oe==="paymentMode"&&Re==="creditcard"?(Ye.paymentTerms=[{percentageTerm:"100",paymentTerm:"Immediate",paymentType:"Full Payment"}],Ye.isCreditCardSelected=!0):Oe==="paymentMode"&&(Ye.isCreditCardSelected=!1),z(Ye),t(Ye),I[Oe]&&U(ft=>{const mt={...ft};return delete mt[Oe],mt})},Ce=Ee=>{const Oe=Ee.target.value;m([]),S(null),p(""),j([]),L([]),w([]),T([]);const Re=ee.filter(Ye=>Ye.entityName===Oe);if(Re.length>0){m(Re);const Ye=[...new Set(Re.map(Nt=>Nt.city).filter(Nt=>Nt))],ft=[...new Set(Re.map(Nt=>Nt.area||Nt.site).filter(Nt=>Nt))],mt=Re.map(Nt=>({value:`${Nt.addressLine}

Tax ID: ${Nt.taxId||"N/A"}
Tax Type: ${Nt.type||"N/A"}`,label:`${Nt.addressLine} - ${Nt.city||"N/A"}`,entity:Nt})),qt=Re.map(Nt=>({value:`${Nt.addressLine}

Tax ID: ${Nt.taxId||"N/A"}
Tax Type: ${Nt.type||"N/A"}`,label:`${Nt.addressLine} - ${Nt.city||"N/A"}`,entity:Nt}));if(j(Ye),L(ft),w(mt),T(qt),Re.length===1){const Nt=Re[0];S(Nt),p(Nt._id);const se=`${Nt.addressLine}

Tax ID: ${Nt.taxId||"N/A"}
Tax Type: ${Nt.type||"N/A"}`,pe={...R,entity:Oe,entityId:Nt._id,city:Nt.city||"",site:Nt.area||Nt.site||"",billTo:se,shipTo:se};z(pe),t(pe)}else{const Nt={...R,entity:Oe,entityId:"",city:"",site:"",billTo:"",shipTo:""};z(Nt),t(Nt)}I.entity&&U(Nt=>{const se={...Nt};return delete se.entity,se})}else{const Ye={...R,entity:Oe,entityId:"",city:"",site:"",billTo:"",shipTo:""};z(Ye),t(Ye)}},Be=()=>a.jsxs("div",{className:"w-full",children:[a.jsxs("label",{className:"block text-sm font-semibold text-primary mb-2",children:["Entity ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{name:"entity",value:R.entity,onChange:Ce,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg appearance-none focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300",children:[a.jsx("option",{value:"",children:"Select Entity"}),[...new Set(ee.map(Ee=>Ee.entityName))].sort().map((Ee,Oe)=>a.jsx("option",{value:Ee,children:Ee},Oe))]}),I.entity&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:I.entity})]}),Pe=Ee=>{const Oe=Ee.target.value,Re=x.filter(ft=>ft.city===Oe),Ye={...R,city:Oe};if(Re.length===1){const ft=Re[0],mt=`${ft.addressLine}

Tax ID: ${ft.taxId||"N/A"}
Tax Type: ${ft.type||"N/A"}`;Ye.entityId=ft._id,Ye.site=ft.area||ft.site||"",Ye.billTo=mt,Ye.shipTo=mt,S(ft)}z(Ye),t(Ye),I.city&&U(ft=>{const mt={...ft};return delete mt.city,mt})},Bt=Ee=>{const Oe=Ee.target.value,Re=x.filter(ft=>ft.area===Oe||ft.site===Oe),Ye={...R,site:Oe};if(Re.length===1){const ft=Re[0],mt=`${ft.addressLine}

Tax ID: ${ft.taxId||"N/A"}
Tax Type: ${ft.type||"N/A"}`;Ye.entityId=ft._id,Ye.city=ft.city||"",Ye.billTo=mt,Ye.shipTo=mt,S(ft)}z(Ye),t(Ye),I.site&&U(ft=>{const mt={...ft};return delete mt.site,mt})},tt=Ee=>{const Oe=Ee.target.value,Re=v.find(Ye=>Ye.value===Oe);if(Re){const Ye={...R,billTo:Oe,city:Re.entity.city||"",site:Re.entity.area||Re.entity.site||"",entityId:Re.entity._id};z(Ye),t(Ye),S(Re.entity)}},Ot=Ee=>{const Oe=Ee.target.value,Re={...R,shipTo:Oe};z(Re),t(Re)},vt=(Ee,Oe)=>{var Nt,se;const{name:Re,value:Ye}=Ee.target,ft=[...R.paymentTerms],mt={...ft[Oe]};Re==="paymentTerm"?(mt[Re]=Ye,Ye!=="Others"&&(mt.customPaymentTerm="")):Re==="paymentType"?(mt[Re]=Ye,Ye!=="Others"&&(mt.customPaymentType="")):mt[Re]=Ye,ft[Oe]=mt;const qt={...R,paymentTerms:ft};z(qt),t(qt),(se=(Nt=I.paymentTerms)==null?void 0:Nt[Oe])!=null&&se[Re]&&U(pe=>{var me;const he={...pe};return(me=he.paymentTerms)!=null&&me[Oe]&&delete he.paymentTerms[Oe][Re],he})},Vt=(Ee,Oe,Re)=>{const{value:Ye}=Ee.target,ft=[...R.paymentTerms];ft[Oe]={...ft[Oe],[Re]:Ye};const mt={...R,paymentTerms:ft};z(mt),t(mt)},pr=()=>{const Ee={...R};return Ee.paymentTerms=R.paymentTerms.map(Oe=>{const Re={...Oe};return Oe.paymentTerm==="Others"&&Oe.customPaymentTerm&&(Re.paymentTerm=Oe.customPaymentTerm),Oe.paymentType==="Others"&&Oe.customPaymentType&&(Re.paymentType=Oe.customPaymentType),delete Re.customPaymentTerm,delete Re.customPaymentType,Re}),Ee},$t=()=>{const Ee={...R,paymentTerms:[...R.paymentTerms,{percentageTerm:"",paymentTerm:"",paymentType:"",customPaymentTerm:"",customPaymentType:""}]};z(Ee),t(Ee)},Qr=Ee=>{const Oe=R.paymentTerms.filter((Ye,ft)=>ft!==Ee),Re={...R,paymentTerms:Oe};z(Re),t(Re)},ir=async()=>{if(await et()){const Oe=pr(),Re=await sq(Oe,i,n);Re.status===201&&(t(Ye=>({...Ye,newReqId:Re.data.reqid})),Ie.success("Commercial details updated successfully"),r())}};C.useEffect(()=>{const Ee=Oe=>{Oe.target.closest(".relative")||W(!1)};return document.addEventListener("mousedown",Ee),()=>{document.removeEventListener("mousedown",Ee)}},[]);const Gr=()=>o?a.jsxs("div",{className:"relative w-full",children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Cost Center ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:X,onChange:Ee=>{V(Ee.target.value);const Oe=de.filter(Re=>Re.department.toLowerCase().includes(Ee.target.value.toLowerCase()));ve(Oe)},onFocus:()=>W(!0),placeholder:"Search department...",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300"}),a.jsx(rn,{className:"absolute right-3 top-3.5 text-gray-400",size:20})]}),Ae&&a.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:J.length>0?J.map(Ee=>a.jsxs("div",{className:"px-4 py-3 hover:bg-gray-100 cursor-pointer flex flex-col border-b border-gray-100",onClick:()=>Te(Ee),children:[a.jsx("span",{className:"font-medium",children:Ee.department}),a.jsx("span",{className:"text-sm text-gray-500",children:Ee.businessUnit})]},Ee.department)):a.jsx("div",{className:"px-4 py-3 text-gray-500",children:"No departments found"})}),I.department&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:I.department})]}):a.jsxs("div",{className:"relative w-full",children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Cost Center ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",value:e.department||s,className:"w-full px-4 py-3 border-2 bg-gray-100 border-gray-500 rounded-lg",placeholder:"",readOnly:!0}),I.department&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:I.department})]}),un=()=>o?a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 w-full",children:[a.jsxs("div",{className:"w-full",children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Approver ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{value:R.hod,onChange:Ne,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300",disabled:!d,children:[a.jsx("option",{value:"",children:"Select Approver"}),c.map((Ee,Oe)=>a.jsx("option",{value:Ee.hod,children:Ee.hod},Oe))]}),I.hod&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:I.hod})]}),a.jsxs("div",{className:"w-full",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Additional Approver"}),a.jsxs("select",{value:D,onChange:He,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300",children:[a.jsx("option",{value:"",children:"Select Additional Approver"}),M.map(Ee=>a.jsxs("option",{value:Ee.id,children:[Ee.id," - ",Ee.name," -"," ",Ee.email," - ",Ee.department]},Ee.id))]}),D&&a.jsxs("div",{className:"mt-3",children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Upload Proof"," ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("label",{className:"flex items-center px-4 py-2 bg-gray-100 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-200 transition duration-300",children:[a.jsx(Ds,{size:16,className:"mr-2"}),"Choose Files",a.jsx("input",{type:"file",className:"hidden",onChange:Ze,accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",multiple:!0})]}),a.jsx("span",{className:"text-xs text-gray-500",children:"PDF, DOC, DOCX, JPG, PNG (Max 5MB each) - Multiple files allowed"})]}),a.jsx(Fe,{})]})]})]})]}):a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 w-full",children:[a.jsxs("div",{className:"w-full",children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Approver ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"hod",value:R.hod,readOnly:!0,className:"w-full px-4 py-3 border-2 border-gray-500 rounded-lg bg-gray-100",placeholder:"HOD will be auto-populated"}),I.hod&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:I.hod})]}),a.jsxs("div",{className:"w-full",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Additional Approver"}),a.jsxs("select",{value:D,onChange:He,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300",children:[a.jsx("option",{value:"",children:"Select Additional Approver"}),M.map(Ee=>a.jsxs("option",{value:Ee.id,children:[Ee.id," - ",Ee.name," -"," ",Ee.email," - ",Ee.department]},Ee.id))]}),D&&a.jsxs("div",{className:"mt-3",children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Upload Proof"," ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("label",{className:"flex items-center px-4 py-2 bg-gray-100 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-200 transition duration-300",children:[a.jsx(Ds,{size:16,className:"mr-2"}),"Choose Files",a.jsx("input",{type:"file",className:"hidden",onChange:Ze,accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",multiple:!0})]}),a.jsx("span",{className:"text-xs text-gray-500",children:"PDF, DOC, DOCX, JPG, PNG (Max 5MB each) - Multiple files allowed"})]}),a.jsx(Fe,{})]})]})]})]}),Nr=()=>a.jsxs("div",{className:"w-full",children:[a.jsxs("label",{className:"block text-sm font-semibold text-primary mb-2",children:["Business Unit ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{onChange:ke,value:R.businessUnit,name:"businessUnit",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg appearance-none focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300",children:[a.jsx("option",{value:"",children:"Select Business Unit"}),f.map(Ee=>a.jsx("option",{value:Ee.value,children:Ee.label},Ee.value))]}),I.businessUnit&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:I.businessUnit})]}),Wt=()=>_.length>1?a.jsxs("div",{className:"w-full",children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["City ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{name:"city",value:R.city,onChange:Pe,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300",children:[a.jsx("option",{value:"",children:"Select City"}),_.map((Ee,Oe)=>a.jsx("option",{value:Ee,children:Ee},Oe))]}),I.city&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:I.city})]}):a.jsxs("div",{className:"w-full",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"City"}),a.jsx("input",{type:"text",name:"city",value:R.city,onChange:Se,readOnly:!!O,className:`w-full px-4 py-3 border-2 rounded-lg focus:outline-none transition duration-300 ${O?"border-gray-500 bg-gray-100":"border-gray-300 focus:ring-2 focus:ring-primary focus:border-transparent"}`,placeholder:"Enter City"}),I.city&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:I.city})]}),lt=()=>x.length>1&&E.length>1?a.jsxs("div",{className:"w-full",children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Site ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{name:"site",value:R.site,onChange:Bt,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300",children:[a.jsx("option",{value:"",children:"Select Site"}),E.map((Ee,Oe)=>a.jsx("option",{value:Ee,children:Ee},Oe))]}),I.site&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:I.site})]}):a.jsxs("div",{className:"w-full",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Site"}),a.jsx("input",{type:"text",name:"site",value:R.site,onChange:Se,readOnly:!!O,className:`w-full px-4 py-3 border-2 rounded-lg focus:outline-none transition duration-300 ${O?"border-gray-500 bg-gray-100":"border-gray-300 focus:ring-2 focus:ring-primary focus:border-transparent"}`,placeholder:"Enter Site"}),I.site&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:I.site})]}),Et=()=>x.length>1&&v.length>1?a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Bill To ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{name:"billTo",value:R.billTo,onChange:tt,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300",children:[a.jsx("option",{value:"",children:"Select Bill To Address"}),v.map((Ee,Oe)=>a.jsx("option",{value:Ee.value,children:Ee.label},Oe))]}),I.billTo&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:I.billTo})]}):a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Bill To ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{name:"billTo",value:R.billTo,readOnly:!!O,onChange:O?void 0:Se,className:`w-full px-4 py-3 border-2 rounded-lg focus:outline-none transition duration-300 ${O?"border-gray-500 bg-gray-100":"border-gray-300 focus:ring-2 focus:ring-primary focus:border-transparent"}`,placeholder:"Enter Bill To",rows:"6"}),I.billTo&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:I.billTo})]}),It=()=>x.length>1&&B.length>1?a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Ship To ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{name:"shipTo",value:R.shipTo,onChange:Ot,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300",children:[a.jsx("option",{value:"",children:"Select Ship To Address"}),B.map((Ee,Oe)=>a.jsx("option",{value:Ee.value,children:Ee.label},Oe))]}),I.shipTo&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:I.shipTo})]}):a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Ship To ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{name:"shipTo",value:R.shipTo,readOnly:!!O,onChange:O?void 0:Se,className:`w-full px-4 py-3 border-2 rounded-lg focus:outline-none transition duration-300 ${O?"border-gray-500 bg-gray-100":"border-gray-300 focus:ring-2 focus:ring-primary focus:border-transparent"}`,placeholder:"Enter Ship To",rows:"6"}),I.shipTo&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:I.shipTo})]});return a.jsxs("div",{className:"w-full mx-auto bg-white shadow-2xl rounded-2xl overflow-hidden",children:[a.jsx("div",{className:"bg-gradient-to-r from-primary to-primary p-4 sm:p-6",children:a.jsx("h2",{className:"text-xl sm:text-2xl md:text-3xl font-extrabold text-white text-center",children:"Commercial Details"})}),a.jsxs("div",{className:"p-4 sm:p-6 md:p-8 space-y-4 sm:space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 sm:gap-6",children:[Nr(),Be(),Wt(),lt()]}),a.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:gap-6",children:[Gr(),un()]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"mb-2 sm:mb-4",children:a.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-700",children:"Payment Term"})}),a.jsx("div",{className:"overflow-x-auto -mx-4 sm:mx-0 px-4 sm:px-0",children:a.jsx("div",{className:"min-w-max sm:min-w-0 sm:w-full",children:a.jsxs("table",{className:"w-full table-auto border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-100 border-b-2 border-gray-200",children:[a.jsxs("th",{className:"px-2 sm:px-4 py-2 sm:py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:["Percentage Term"," ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("th",{className:"px-2 sm:px-4 py-2 sm:py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:["Payment Term"," ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("th",{className:"px-2 sm:px-4 py-2 sm:py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:["Payment Type"," ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("th",{className:"px-2 sm:px-4 py-2 sm:py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{children:R.paymentTerms.map((Ee,Oe)=>{var Re,Ye,ft,mt,qt,Nt,se,pe,he,me;return a.jsxs("tr",{className:"border-b hover:bg-gray-50 transition duration-200",children:[a.jsxs("td",{className:"px-2 sm:px-4 py-2 sm:py-3",children:[a.jsx("input",{type:"number",name:"percentageTerm",value:Ee.percentageTerm,onChange:ge=>vt(ge,Oe),disabled:R.isCreditCardSelected,className:`w-full px-2 sm:px-3 py-1 sm:py-2 border-2 border-gray-300 rounded-lg ${R.isCreditCardSelected?"bg-gray-100 cursor-not-allowed":"focus:ring-2 focus:ring-primary"} focus:outline-none focus:border-transparent transition duration-300`,placeholder:"Enter %",style:{appearance:"none",MozAppearance:"textfield",WebkitAppearance:"none"}}),((Ye=(Re=I.paymentTerms)==null?void 0:Re[Oe])==null?void 0:Ye.percentageTerm)&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:I.paymentTerms[Oe].percentageTerm})]}),a.jsxs("td",{className:"px-2 sm:px-4 py-2 sm:py-3",children:[a.jsxs("select",{name:"paymentTerm",value:Ee.paymentTerm,onChange:ge=>vt(ge,Oe),disabled:R.isCreditCardSelected,className:`w-full px-2 sm:px-3 py-1 sm:py-2 border-2 border-gray-300 rounded-lg text-xs sm:text-sm ${R.isCreditCardSelected?"bg-gray-100 cursor-not-allowed":"focus:ring-2 focus:ring-primary"} focus:outline-none focus:border-transparent transition duration-300`,children:[a.jsx("option",{value:"",children:"Select Payment Term"}),a.jsx("option",{value:"Immediate",children:"Immediate"}),a.jsx("option",{value:"30 days credit period",children:"30 days credit period"}),a.jsx("option",{value:"45 days credit period",children:"45 days credit period"}),a.jsx("option",{value:"60 days credit period",children:"60 days credit period"}),a.jsx("option",{value:"90 days credit period",children:"90 days credit period"}),a.jsx("option",{value:"Others",children:"Others"})]}),Ee.paymentTerm==="Others"&&a.jsx("input",{type:"text",value:Ee.customPaymentTerm||"",onChange:ge=>Vt(ge,Oe,"customPaymentTerm"),disabled:R.isCreditCardSelected,className:"w-full mt-2 px-2 sm:px-3 py-1 sm:py-2 border-2 border-gray-300 rounded-lg text-xs sm:text-sm focus:ring-2 focus:ring-primary focus:outline-none focus:border-transparent transition duration-300",placeholder:"Specify payment term"}),((mt=(ft=I.paymentTerms)==null?void 0:ft[Oe])==null?void 0:mt.paymentTerm)&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:I.paymentTerms[Oe].paymentTerm}),Ee.paymentTerm==="Others"&&((Nt=(qt=I.paymentTerms)==null?void 0:qt[Oe])==null?void 0:Nt.customPaymentTerm)&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:I.paymentTerms[Oe].customPaymentTerm})]}),a.jsxs("td",{className:"px-2 sm:px-4 py-2 sm:py-3",children:[a.jsxs("select",{name:"paymentType",value:Ee.paymentType,onChange:ge=>vt(ge,Oe),disabled:R.isCreditCardSelected,className:`w-full px-2 sm:px-3 py-1 sm:py-2 border-2 border-gray-300 rounded-lg text-xs sm:text-sm ${R.isCreditCardSelected?"bg-gray-100 cursor-not-allowed":"focus:ring-2 focus:ring-primary"} focus:outline-none focus:border-transparent transition duration-300`,children:[a.jsx("option",{value:"",children:"Select Payment Type"}),a.jsx("option",{value:"Full Payment",children:"Full Payment"}),a.jsx("option",{value:"Advance Payment",children:"Advance Payment"}),a.jsx("option",{value:"Payment on Delivery",children:"Payment on Delivery"}),a.jsx("option",{value:"Part Payment",children:"Part Payment"}),a.jsx("option",{value:"Others",children:"Others"})]}),Ee.paymentType==="Others"&&a.jsx("input",{type:"text",value:Ee.customPaymentType||"",onChange:ge=>Vt(ge,Oe,"customPaymentType"),disabled:R.isCreditCardSelected,className:"w-full mt-2 px-2 sm:px-3 py-1 sm:py-2 border-2 border-gray-300 rounded-lg text-xs sm:text-sm focus:ring-2 focus:ring-primary focus:outline-none focus:border-transparent transition duration-300",placeholder:"Specify payment type"}),((pe=(se=I.paymentTerms)==null?void 0:se[Oe])==null?void 0:pe.paymentType)&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:I.paymentTerms[Oe].paymentType}),Ee.paymentType==="Others"&&((me=(he=I.paymentTerms)==null?void 0:he[Oe])==null?void 0:me.customPaymentType)&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:I.paymentTerms[Oe].customPaymentType})]}),a.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3 text-right",children:a.jsx("div",{className:"flex justify-end",children:a.jsxs("button",{type:"button",onClick:()=>Qr(Oe),disabled:R.isCreditCardSelected||Oe===0,className:`flex items-center px-2 sm:px-4 py-1 sm:py-2 rounded-lg transition duration-300 text-xs sm:text-sm ${R.isCreditCardSelected||Oe===0?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-red-500 text-white hover:bg-red-700"}`,children:[a.jsx($r,{size:16,className:"mr-1 sm:mr-2 hidden sm:inline"}),"Delete"]})})})]},Oe)})})]})})}),a.jsx("div",{className:"mt-2 sm:mt-4 flex justify-start",children:a.jsxs("button",{type:"button",onClick:$t,className:`${R.isCreditCardSelected?"bg-gray-300 text-black":"bg-primary text-white"} flex items-center px-3 py-2 sm:px-4 sm:py-2 rounded-lg hover:bg-primary-dark transition duration-300 text-xs sm:text-sm`,disabled:R.isCreditCardSelected,children:[a.jsx(Ky,{size:16,className:"mr-1 sm:mr-2"}),"Add Payment Term"]})})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[Et(),It()]}),a.jsx("div",{className:"mt-4 sm:mt-8 flex justify-end",children:a.jsx("button",{type:"button",onClick:ir,className:"px-6 sm:px-10 py-2 sm:py-3 bg-gradient-to-r from-primary to-primary text-white font-bold rounded-lg shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition duration-300 ease-in-out",children:"Next"})})]})]})},_1e=({formData:e,setFormData:t,onBack:r,onNext:n,reqId:s})=>{const[i,o]=C.useState([]),[l,c]=C.useState(""),[A,d]=C.useState(!1),[u,f]=C.useState(!1),h=C.useRef(null),[x,m]=C.useState({vendor:"",servicePeriod:"",poValidFrom:"",poValidTo:"",quotationDate:"",documents:""}),[g,p]=C.useState([{id:Date.now(),fileType:"",otherType:"",files:[],urls:[],agreementValidFrom:"",agreementValidTo:""}]),v=[{value:"agreement",label:"Agreement"},{value:"competitive",label:"Competitive"},{value:"engagementwork",label:"Engagement Letter (EL)"},{value:"finalQuotation",label:"Final Quotation"},{value:"Other",label:"Other"},{value:"statementofwork",label:"Statement Of Work (SOW)"}].sort((S,I)=>S.label.localeCompare(I.label)),w=S=>S?new Date(S).toISOString().split("T")[0]:"",B=()=>{const S=new Date;return S.setDate(S.getDate()-10),S.toISOString().split("T")[0]},T=()=>new Date().toISOString().split("T")[0],_=()=>({min:B(),max:T()});C.useEffect(()=>{if(e!=null&&e.vendor&&(e!=null&&e.vendorName)){const S=`${e==null?void 0:e.vendor} - ${e==null?void 0:e.vendorName}`;c(S)}},[e==null?void 0:e.vendor,e==null?void 0:e.vendorName]),C.useEffect(()=>{(async()=>{try{const I=await tC();if(I.status===200){const U=I.data.vendors.sort((Q,H)=>{const X=(Q.firstName||Q.Name||Q.name||Q.vendorName||"").toLowerCase(),V=(H.firstName||H.Name||H.name||H.vendorName||"").toLowerCase();return X.localeCompare(V)});if(o(U),e.vendor){const Q=U.find(H=>H.vendorId===e.vendor||H.ID===e.vendor);if(Q){const H=D(Q);c(H)}}}}catch(I){console.error("Error fetching vendors:",I)}})()},[e==null?void 0:e.vendor]),C.useEffect(()=>{if(e!=null&&e.uploadedFiles&&(Array.isArray(e==null?void 0:e.uploadedFiles)?(e==null?void 0:e.uploadedFiles.length)>0:Object.keys(e==null?void 0:e.uploadedFiles).length>0)){let S={};Array.isArray(e==null?void 0:e.uploadedFiles)&&(e==null?void 0:e.uploadedFiles.length)>0?S=(e==null?void 0:e.uploadedFiles[0])||{}:S=e==null?void 0:e.uploadedFiles;const I=Object.entries(S).map(([U,Q])=>({id:Date.now()+Math.random(),fileType:U,otherType:U==="Other"?U:"",files:[],urls:Array.isArray(Q)?Q:Q.urls||Q,agreementValidFrom:Q.agreementValidFrom||"",agreementValidTo:Q.agreementValidTo||""}));p(I.length>0?I:[{id:Date.now(),fileType:"",otherType:"",files:[],urls:[],agreementValidFrom:"",agreementValidTo:""}])}},[]),C.useEffect(()=>{if(!(e!=null&&e.quotationDate)){const S=new Date().toISOString().split("T")[0];t(I=>({...I,quotationDate:S,servicePeriod:"One Time"}))}},[t,e==null?void 0:e.quotationDate]),C.useEffect(()=>{const S=I=>{h.current&&!h.current.contains(I.target)&&f(!1)};return document.addEventListener("mousedown",S),()=>document.removeEventListener("mousedown",S)},[]);const j=()=>l?i.filter(S=>{const I=(S.firstName||S.Name||S.name||S.vendorName||"").toLowerCase(),U=(S.ID||S.vendorId||"").toString().toLowerCase(),Q=l.toLowerCase();return I.includes(Q)||U.includes(Q)}):[],E=S=>S.fileType==="Other"?S.otherType:S.fileType,L=()=>{let S={},I=!0;e!=null&&e.vendor||(S.vendor="Vendor selection is required",I=!1);let U=!1;if(e!=null&&e.uploadedFiles)if(Array.isArray(e.uploadedFiles)){const Q=e.uploadedFiles[0]||{};U=Object.values(Q).some(H=>(H.urls||(Array.isArray(H)?H:[])).length>0)}else U=Object.values(e.uploadedFiles).some(Q=>(Q.urls||(Array.isArray(Q)?Q:[])).length>0);if(U||(S.documents="At least one document must be uploaded",I=!1),e!=null&&e.servicePeriod||(S.servicePeriod="Service period is required",I=!1),(e==null?void 0:e.servicePeriod)==="custom"){if(!(e!=null&&e.poValidFrom))S.poValidFrom="Valid from date is required",I=!1;else{const Q=new Date(e.poValidFrom),H=new Date;H.setDate(H.getDate()-11),Q<=H&&(S.poValidFrom="Date cannot be more than 10 days in the past",I=!1)}if(!e.poValidTo)S.poValidTo="Valid to date is required",I=!1;else{const Q=new Date(e.poValidTo),H=new Date;H.setDate(H.getDate()-11),Q<=H&&(S.poValidTo="Date cannot be more than 10 days in the past",I=!1)}e!=null&&e.poValidFrom&&(e!=null&&e.poValidTo)&&new Date(e==null?void 0:e.poValidFrom)>new Date(e==null?void 0:e.poValidTo)&&(S.poValidTo="Valid to date must be after valid from date",I=!1)}if(!(e!=null&&e.quotationDate))S.quotationDate="Quotation date is required",I=!1;else{const Q=new Date(e.quotationDate),H=new Date;H.setDate(H.getDate()-11);const X=new Date;Q<=H?(S.quotationDate="Quotation date cannot be more than 10 days in the past",I=!1):Q>X&&(S.quotationDate="Quotation date cannot be in the future",I=!1)}if(e.uploadedFiles){const Q=Array.isArray(e.uploadedFiles)?e.uploadedFiles[0]||{}:e.uploadedFiles;Object.entries(Q).forEach(([H,X])=>{X.agreementValidFrom&&X.agreementValidTo&&new Date(X.agreementValidFrom)>new Date(X.agreementValidTo)&&(S[`${H}_agreementDates`]=`${H}: Agreement Valid To date must be after Valid From date`,I=!1)})}return m(S),I},M=S=>{const{name:I,value:U}=S.target;if(d(!0),(I==="poValidFrom"||I==="poValidTo")&&U){const Q=new Date(U),H=new Date;if(H.setDate(H.getDate()-11),Q<=H){m(X=>({...X,[I]:"Date cannot be more than 10 days in the past"}));return}else m(X=>({...X,[I]:""}))}if(I==="quotationDate"&&U){const Q=new Date(U),H=new Date;H.setDate(H.getDate()-11);const X=new Date;if(Q<H){m(V=>({...V,quotationDate:"Quotation date cannot be more than 10 days in the past"}));return}else if(Q>X){m(V=>({...V,quotationDate:"Quotation date cannot be in the future"}));return}else m(V=>({...V,quotationDate:""}))}if(I==="vendor"){const Q=i.find(H=>H.vendorId===U);t(H=>({...H,vendor:U,vendorName:Q?Q.vendorName||Q.Name||Q.name:"",email:Q.email,isNewVendor:Q.isNewVendor}))}else t(Q=>({...Q,[I]:U}))},F=S=>{const I=S.ID||S.vendorId,U=S.firstName||S.Name||S.name||S.vendorName;t(Q=>({...Q,vendor:I,vendorName:U,email:S.email,isNewVendor:S.isNewVendor})),c(D(S)),f(!1),d(!0),m(Q=>({...Q,vendor:""}))},D=S=>{if(S.isNewVendor)return`${S.firstName} (New Vendor)`;const I=S.firstName||S.Name||S.name||S.vendorName;return`${S.vendorId||S.ID} - ${I}`},G=async(S,I)=>{const U=Array.from(S.target.files),Q=g[I],H=E(Q);if(d(!0),!H){Ie.error("Please select a file type first");return}try{const X=await Promise.all(U.map(async V=>(await Ac(V,H,s)).data.fileUrls[0]));p(V=>V.map((Ae,W)=>W===I?{...Ae,files:[...Ae.files,...U],urls:[...Ae.urls,...X]}:Ae)),t(V=>{const Ae=Array.isArray(V.uploadedFiles)?V.uploadedFiles[0]||{}:V.uploadedFiles||{},W=Ae[H]||{urls:[],agreementValidFrom:"",agreementValidTo:""},J={...Ae,[H]:{urls:[...W.urls||W,...X],agreementValidFrom:W.agreementValidFrom||"",agreementValidTo:W.agreementValidTo||""}};return Array.isArray(V.uploadedFiles)?{...V,uploadedFiles:[J]}:{...V,uploadedFiles:J}})}catch(X){console.error("Error uploading files:",X),Ie.error("Error uploading files. Please try again.")}},K=async(S,I,U)=>{d(!0),t(Q=>{let H;if(Array.isArray(Q.uploadedFiles)?H={...Q.uploadedFiles[0]}:H={...Q.uploadedFiles},H[S]){const X=H[S],Ae=(X.urls||X).filter((W,J)=>J!==I);Ae.length===0?delete H[S]:H[S]={...X,urls:Ae}}return Array.isArray(Q.uploadedFiles)?{...Q,uploadedFiles:[H]}:{...Q,uploadedFiles:H}}),p(Q=>Q.map(H=>{if(E(H)===S){const V=H.urls.filter((Ae,W)=>W!==I);return V.length!==H.urls.length?{...H,urls:V}:H}return H}))},ae=(S,I)=>{const U=S.target.value;p(X=>{const V=[...X];return V[I]={...V[I],fileType:U,otherType:U==="Other"?V[I].otherType:""},V});const Q=E(g[I]),H=U==="Other"?g[I].otherType:U;Q&&Q!==H&&t(X=>{const V={...X.uploadedFiles};return g[I].urls.length>0&&(V[H]={urls:g[I].urls,agreementValidFrom:g[I].agreementValidFrom,agreementValidTo:g[I].agreementValidTo}),delete V[Q],{...X,uploadedFiles:V}})},Z=(S,I)=>{const U=[...g];U[I].otherType=S.target.value,p(U)},oe=(S,I,U)=>{const{value:Q}=S.target,H=g[I],X=E(H);p(V=>V.map((Ae,W)=>W===I?{...Ae,[U]:Q}:Ae)),X&&t(V=>{let Ae;return Array.isArray(V.uploadedFiles)?Ae={...V.uploadedFiles[0]}:Ae={...V.uploadedFiles},Ae[X]||(Ae[X]={urls:[],agreementValidFrom:"",agreementValidTo:""}),Ae[X]={...Ae[X],[U]:Q},Array.isArray(V.uploadedFiles)?{...V,uploadedFiles:[Ae]}:{...V,uploadedFiles:Ae}})},Y=()=>{p(S=>[...S,{id:Date.now()+Math.random(),fileType:"",otherType:"",files:[],urls:[],agreementValidFrom:"",agreementValidTo:""}])},R=S=>{const I=E(g[S]),U=g.filter((Q,H)=>H!==S);p(U),I&&t(Q=>{let H;return Array.isArray(Q.uploadedFiles)?H={...Q.uploadedFiles[0]}:H={...Q.uploadedFiles},delete H[I],Array.isArray(Q.uploadedFiles)?{...Q,uploadedFiles:[H]}:{...Q,uploadedFiles:H}})},z=()=>{const S=j();return a.jsxs("div",{className:"relative",ref:h,children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Choose Vendor",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(s8,{className:"text-gray-400"})}),a.jsx("input",{type:"text",placeholder:"Search vendor by name or ID...",value:l,onChange:I=>{c(I.target.value),f(!0)},onClick:()=>f(!0),className:"w-full pl-10 px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300"})]}),u&&a.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:S.length>0?S.map(I=>a.jsxs("div",{className:"px-4 py-2 hover:bg-gray-100 cursor-pointer transition duration-200",onClick:()=>F(I),children:[a.jsx("div",{className:"font-medium",children:D(I)}),I.email&&a.jsx("div",{className:"text-sm text-gray-500",children:I.email})]},I._id)):a.jsx("div",{className:"px-4 py-3 text-gray-500",children:"No vendors found"})}),a.jsx(O,{error:x.vendor})]})},ee=S=>{const I=g[S],U=E(I);if(!U||!I.urls.length)return null;const Q=I.fileType==="Other"?I.otherType:I.fileType;return a.jsx("div",{className:"flex flex-col gap-4",children:a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:Q}),a.jsx("div",{className:"flex flex-wrap gap-2",children:I.urls.map((H,X)=>a.jsxs("div",{className:"flex items-center bg-gray-100 rounded-lg p-2",children:[a.jsxs("a",{href:H,target:"_blank",rel:"noopener noreferrer",className:"flex items-center",children:[a.jsx(ep,{size:24,className:"text-red-500"}),a.jsx("span",{className:"ml-1 text-sm md:text-base truncate max-w-xs",children:`${U}-${X+1}`})]}),a.jsx("button",{onClick:()=>K(U,X),className:"ml-2 text-red-500 hover:text-red-700",children:""})]},X))}),(I.agreementValidFrom||I.agreementValidTo)&&a.jsx("div",{className:"mt-2 text-xs text-gray-600",children:I.agreementValidFrom&&I.agreementValidTo&&a.jsxs("span",{children:["Valid: ",I.agreementValidFrom," to"," ",I.agreementValidTo]})})]})})},b=async()=>{if(!L()){Ie.error("Please fill in all required fields correctly");return}A?(await kI(e,s)).status===200&&(d(!1),Ie.success("Procurement details updated successfully"),n()):n()},O=({error:S})=>S?a.jsx("p",{className:"text-red-500 text-sm mt-1",children:S}):null;return a.jsxs("div",{className:"mx-auto bg-white shadow-2xl rounded-2xl overflow-hidden max-w-full",children:[a.jsx("div",{className:"bg-gradient-to-r from-primary to-primary p-4 sm:p-6",children:a.jsx("h2",{className:"text-xl sm:text-2xl md:text-3xl font-extrabold text-white text-center",children:"Procurement Details"})}),a.jsx("div",{className:"p-4 sm:p-8 space-y-4 sm:space-y-6",children:a.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:gap-6",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[a.jsx("div",{className:"sm:col-span-1 w-full",children:z()}),a.jsxs("div",{className:"w-full",children:[a.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-2",children:["Quotation Date",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"date",name:"quotationDate",value:w((e==null?void 0:e.quotationDate)||""),onChange:M,min:_().min,max:_().max,className:"w-full px-3 py-2 sm:px-4 sm:py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300",placeholder:"Enter Quotation Number"})]}),a.jsxs("div",{className:"w-full",children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-2",children:"Quotation Number"}),a.jsx("input",{type:"text",name:"quotationNumber",value:(e==null?void 0:e.quotationNumber)||"",onChange:M,className:"w-full px-3 py-2 sm:px-4 sm:py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300",placeholder:"Enter Quotation Number"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 sm:gap-6",children:[a.jsxs("div",{className:"w-full",children:[a.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-2",children:["Service Period",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{name:"servicePeriod",value:(e==null?void 0:e.servicePeriod)||"oneTime",onChange:S=>{M(S),S.target.value==="oneTime"&&t(I=>({...I,poValidFrom:"",poValidTo:""}))},className:"w-full px-3 py-2 sm:px-4 sm:py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300",children:[a.jsx("option",{value:"oneTime",children:"One Time"}),a.jsx("option",{value:"custom",children:"Custom"})]}),a.jsx(O,{error:x.servicePeriod})]}),(e==null?void 0:e.servicePeriod)==="custom"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"w-full",children:[a.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-2",children:["Service Valid From",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"date",name:"poValidFrom",value:w(e==null?void 0:e.poValidFrom)||"",onChange:M,min:_().min,max:_().max,className:"w-full px-3 py-2 sm:px-4 sm:py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300"}),a.jsx(O,{error:x.poValidFrom})]}),a.jsxs("div",{className:"w-full",children:[a.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-2",children:["Service Valid To",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"date",name:"poValidTo",value:w(e==null?void 0:e.poValidTo)||"",onChange:M,min:_().min,className:"w-full px-3 py-2 sm:px-4 sm:py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300"}),a.jsx(O,{error:x.poValidTo})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[a.jsxs("div",{className:"w-full",children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-2",children:"Project Code"}),a.jsx("input",{type:"text",name:"projectCode",value:(e==null?void 0:e.projectCode)||"",onChange:M,className:"w-full px-3 py-2 sm:px-4 sm:py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300"})]}),a.jsxs("div",{className:"w-full",children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-2",children:"Client Name"}),a.jsx("input",{type:"text",name:"clientName",value:(e==null?void 0:e.clientName)||"",onChange:M,className:"w-full px-3 py-2 sm:px-4 sm:py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-300"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-700 mb-2",children:"Upload Documents"}),x.documents&&a.jsx("p",{className:"text-red-500 text-sm mt-1 mb-2",children:x.documents}),Object.entries(x).map(([S,I])=>S.includes("_agreementDates")?a.jsx(O,{error:I},S):null),a.jsxs("div",{className:"overflow-x-auto",children:[a.jsx("div",{className:"md:hidden",children:g.map((S,I)=>a.jsxs("div",{className:"mb-4 p-4 border rounded-lg shadow-sm",children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"block text-xs font-semibold text-gray-600 uppercase mb-2",children:"File Type"}),a.jsxs("select",{value:S.fileType,onChange:U=>ae(U,I),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",children:[a.jsx("option",{value:"",children:"Select File Type"}),v.map(U=>a.jsx("option",{value:U.value,children:U.label},U.value))]}),S.fileType==="Other"&&a.jsx("input",{type:"text",placeholder:"Enter other file type",value:S.otherType,onChange:U=>Z(U,I),className:"mt-2 w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-gray-600 uppercase mb-2",children:"Agreement Valid From"}),a.jsx("input",{type:"date",value:S.agreementValidFrom,onChange:U=>oe(U,I,"agreementValidFrom"),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-gray-600 uppercase mb-2",children:"Agreement Valid To"}),a.jsx("input",{type:"date",value:S.agreementValidTo,onChange:U=>oe(U,I,"agreementValidTo"),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary"})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"block text-xs font-semibold text-gray-600 uppercase mb-2",children:"Upload File"}),a.jsx("input",{type:"file",onChange:U=>G(U,I),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",multiple:!0,disabled:!S.fileType})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"block text-xs font-semibold text-gray-600 uppercase mb-2",children:"Uploaded Files"}),ee(I)]}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{onClick:()=>R(I),className:`bg-red-500 text-white hover:bg-red-700 px-4 py-2 rounded-lg transition duration-300 ${I===0?"cursor-not-allowed opacity-50":""}`,disabled:I===0,children:"Remove"})})]},S.id))}),a.jsx("div",{className:"hidden md:block",children:a.jsxs("table",{className:"w-full table-auto border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-100 border-b-2 border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"File Type"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Agreement Valid From"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Agreement Valid To"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Upload File"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Uploaded Files"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{children:g.map((S,I)=>a.jsxs("tr",{className:"border-b hover:bg-gray-50 transition duration-200",children:[a.jsxs("td",{className:"px-4 py-3",children:[a.jsxs("select",{value:S.fileType,onChange:U=>ae(U,I),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",children:[a.jsx("option",{value:"",children:"Select File Type"}),v.map(U=>a.jsx("option",{value:U.value,children:U.label},U.value))]}),S.fileType==="Other"&&a.jsx("input",{type:"text",placeholder:"Enter other file type",value:S.otherType,onChange:U=>Z(U,I),className:"mt-2 w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary"})]}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("input",{type:"date",value:S.agreementValidFrom,onChange:U=>oe(U,I,"agreementValidFrom"),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary"})}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("input",{type:"date",value:S.agreementValidTo,onChange:U=>oe(U,I,"agreementValidTo"),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary"})}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("input",{type:"file",onChange:U=>G(U,I),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",multiple:!0,disabled:!S.fileType})}),a.jsx("td",{className:"px-4 py-3",children:ee(I)}),a.jsx("td",{className:"px-4 py-3 text-right",children:a.jsx("button",{onClick:()=>R(I),className:`bg-red-500 text-white hover:bg-red-700 px-4 py-2 rounded-lg transition duration-300 ${I===0?"cursor-not-allowed opacity-50":""}`,disabled:I===0,children:"Remove"})})]},S.id))})]})})]}),a.jsx("div",{className:"mt-4 flex justify-start",children:a.jsx("button",{onClick:Y,className:"bg-primary text-white flex items-center px-3 py-2 sm:px-4 sm:py-2 rounded-lg hover:bg-primary-dark transition duration-300 text-xs sm:text-sm",children:"Add Row"})})]}),a.jsxs("div",{className:"mt-6 sm:mt-8 flex justify-between space-x-4",children:[a.jsx("div",{}),a.jsx("button",{onClick:b,className:"px-4 py-2 sm:px-6 sm:py-2 w-1/2 sm:w-40 text-xs sm:text-sm font-semibold text-white bg-primary rounded-lg hover:bg-primary-dark",children:"Next"})]})]})})]})},I1e=ri().shape({services:ov().of(ri().shape({productName:St().required("Product Name is required"),productDescription:St().required("Product Description is required"),quantity:Lf().typeError("Quantity must be a number").required("Quantity is required").min(1,"Quantity must be at least 1"),price:Lf().typeError("Price must be a number").required("Price is required").min(0,"Price cannot be negative")}))}),vb=[{code:"USD",symbol:"$",locale:"en-US"},{code:"EUR",symbol:"",locale:"de-DE"},{code:"GBP",symbol:"",locale:"en-GB"},{code:"INR",symbol:"",locale:"en-IN"},{code:"AED",symbol:".",locale:"ar-AE"},{code:"IDR",symbol:"Rp",locale:"id-ID"},{code:"MYR",symbol:"RM",locale:"ms-MY"},{code:"SGD",symbol:"S$",locale:"en-SG"},{code:"PHP",symbol:"",locale:"fil-PH"}],L1e=({formData:e,setFormData:t,onBack:r,onSubmit:n,onNext:s,reqId:i})=>{const o={productName:"",productDescription:"",quantity:"",price:"",tax:""},[l,c]=C.useState((e==null?void 0:e.services)||[o]),[A,d]=C.useState(!1),[u,f]=C.useState((e==null?void 0:e.selectedCurrency)||"INR"),h=T=>{const _=vb.find(j=>j.code===u);return new Intl.NumberFormat(_.locale,{style:"currency",currency:_.code,minimumFractionDigits:2,maximumFractionDigits:2}).format(T)},x=T=>{const _=T.target.value;f(_),t(j=>({...j,selectedCurrency:_}))},m=(T,_)=>{const{name:j,value:E}=T.target,L=[...l];L[_][j]=E,c(L)},g=()=>{c([...l,{...o}])},p=T=>{if(l.length>1){const _=l.filter((j,E)=>E!==T);c(_)}},v=T=>{const _=parseFloat(T.quantity||0),j=parseFloat(T.price||0),E=parseFloat(T.tax||0);return Number((_*j*(1+E/100)).toFixed(2))},w=l.reduce((T,_)=>T+v(_),0),B=async()=>{const T={...e,services:l,totalValue:w,selectedCurrency:u};try{await I1e.validate({services:l},{abortEarly:!1}),t(j=>({...j,...T})),d(!0),n&&n(T);const _=await TI(T,i);console.log("Supplies",_),_.status===200&&s()}catch(_){if(_.inner){const j=_.inner.map(E=>E.message).join(`
`);Ie.error(j);return}}};return a.jsxs("div",{className:"mx-auto bg-white shadow-2xl rounded-2xl overflow-hidden",children:[a.jsx("div",{className:"bg-gradient-to-r from-primary to-primary p-6",children:a.jsx("h2",{className:"text-3xl font-extrabold text-white text-center",children:"Product/Services"})}),a.jsxs("div",{className:"p-8 space-y-6",children:[a.jsxs("div",{className:"overflow-x-auto",children:[a.jsxs("table",{className:"w-full border-collapse hidden md:table",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-100 border-b-2 border-gray-200",children:[a.jsxs("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider w-56",children:["Product / Service Name",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider w-56",children:["Product / Service Description",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider w-56",children:["Product / Service Purpose",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider w-28",children:["Quantity",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider w-2",children:["Price",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider w-24",children:"Tax (%)"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider w-24",children:"Row Total"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider"})]})}),a.jsx("tbody",{children:l==null?void 0:l.map((T,_)=>a.jsxs("tr",{className:"border-b hover:bg-gray-50 transition duration-200",children:[a.jsx("td",{className:"px-4 w-24",children:a.jsx("input",{type:"text",name:"productName",value:T==null?void 0:T.productName,onChange:j=>m(j,_),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300",placeholder:"Product Name"})}),a.jsx("td",{className:"px-3 py-5 w-56",children:a.jsx("textarea",{name:"productDescription",value:T==null?void 0:T.productDescription,onChange:j=>m(j,_),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300 resize-y",placeholder:"Description",rows:3})}),a.jsx("td",{className:"px-3 py-4 w-56",children:a.jsx("textarea",{name:"productPurpose",value:T==null?void 0:T.productPurpose,onChange:j=>m(j,_),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300 resize-y",placeholder:"Product Purpose",rows:3})}),a.jsx("td",{className:"px-3 py-4 w-28",children:a.jsx("input",{type:"number",name:"quantity",value:T==null?void 0:T.quantity,onChange:j=>m(j,_),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300",placeholder:"Quantity",min:"0"})}),a.jsx("td",{className:"px-3 py-4 w-48",children:a.jsx("input",{type:"number",name:"price",value:T==null?void 0:T.price,onChange:j=>m(j,_),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300",placeholder:"Price",min:"0",step:"0.01"})}),a.jsx("td",{className:"px-3 py-4 w-28",children:a.jsx("input",{type:"number",name:"tax",value:T==null?void 0:T.tax,onChange:j=>m(j,_),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300",placeholder:"Tax (%)",min:"0",step:"0.01"})}),a.jsx("td",{className:"px-3 py-4 w-52",children:a.jsx("input",{type:"text",value:h(v(T)),readOnly:!0,className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed",placeholder:"Row Total"})}),a.jsx("td",{className:"px-3 py-4 text-right",children:a.jsx("button",{type:"button",onClick:()=>p(_),className:`text-red-500 hover:text-red-700 transition duration-300 ${l.length===1?"cursor-not-allowed opacity-50":""}`,disabled:l.length===1,children:a.jsx($r,{className:"w-5 h-5"})})})]},_))}),a.jsx("tfoot",{children:a.jsxs("tr",{className:"bg-gray-100",children:[a.jsx("td",{colSpan:"4",className:"px-4 py-3 font-bold text-gray-700",children:"Total Amount:"}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("select",{value:u,onChange:x,className:"px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300",children:vb.map(T=>a.jsxs("option",{value:T.code,children:[T.code," (",T.symbol,")"]},T.code))})}),a.jsx("td",{className:"px-4 py-3 font-bold text-blue-600",children:h(w)}),a.jsx("td",{})]})})]}),a.jsx("div",{className:"md:hidden space-y-4",children:l==null?void 0:l.map((T,_)=>a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-semibold text-gray-600 mb-1",children:["Product Name",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"productName",value:T==null?void 0:T.productName,onChange:j=>m(j,_),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300",placeholder:"Product Name"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-semibold text-gray-600 mb-1",children:["Quantity",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"number",name:"quantity",value:T==null?void 0:T.quantity,onChange:j=>m(j,_),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300",placeholder:"Quantity",min:"0"})]})]}),a.jsxs("div",{className:"mt-4",children:[a.jsxs("label",{className:"block text-xs font-semibold text-gray-600 mb-1",children:["Description",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{name:"productDescription",value:T==null?void 0:T.productDescription,onChange:j=>m(j,_),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300 resize-y",placeholder:"Description",rows:3})]}),a.jsxs("div",{className:"mt-4",children:[a.jsxs("label",{className:"block text-xs font-semibold text-gray-600 mb-1",children:["Product Purpose",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{name:"productPurpose",value:T==null?void 0:T.productPurpose,onChange:j=>m(j,_),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300 resize-y",placeholder:"Product Purpose",rows:3})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-semibold text-gray-600 mb-1",children:["Price",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"number",name:"price",value:T==null?void 0:T.price,onChange:j=>m(j,_),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300",placeholder:"Price",min:"0",step:"0.01"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-gray-600 mb-1",children:"Tax (%)"}),a.jsx("input",{type:"number",name:"tax",value:T==null?void 0:T.tax,onChange:j=>m(j,_),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300",placeholder:"Tax (%)",min:"0",step:"0.01"})]})]}),a.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-gray-600 mb-1",children:"Row Total"}),a.jsx("input",{type:"text",value:h(v(T)),readOnly:!0,className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed",placeholder:"Row Total"})]}),a.jsx("button",{type:"button",onClick:()=>p(_),className:`text-red-500 hover:text-red-700 transition duration-300 ${l.length===1?"cursor-not-allowed opacity-50":""}`,disabled:l.length===1,children:a.jsx($r,{className:"w-5 h-5"})})]})]},_))})]}),a.jsx("div",{className:"mt-4",children:a.jsxs("button",{type:"button",onClick:g,className:"flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary transition duration-300 shadow-md hover:shadow-lg",children:[a.jsx(Ky,{className:"w-5 h-5"}),"Add Product/Service"]})}),a.jsx("div",{className:"mt-4 md:hidden",children:a.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg flex justify-between items-center",children:[a.jsx("span",{className:"font-bold text-gray-700",children:"Total Amount:"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("select",{value:u,onChange:x,className:"px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300",children:vb.map(T=>a.jsxs("option",{value:T.code,children:[T.code," (",T.symbol,")"]},T.code))}),a.jsx("span",{className:"font-bold text-blue-600",children:h(w)})]})]})}),a.jsxs("div",{className:"mt-6",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Remarks"}),a.jsx("textarea",{name:"remarks",value:e==null?void 0:e.remarks,onChange:T=>t({...e,remarks:T.target.value}),rows:4,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition duration-300",placeholder:"Enter additional remarks or notes here..."})]}),a.jsxs("div",{className:"mt-8 flex flex-col md:flex-row justify-between space-y-4 md:space-y-0",children:[a.jsx("div",{}),a.jsxs("button",{onClick:B,className:"bg-primary text-white px-6 py-2 rounded-md hover:bg-primary transition-colors flex items-center justify-center",children:[a.jsx(ca,{className:"mr-2"})," Next"]})]})]})]})},U1e=({formData:e,setFormData:t,onNext:r,onBack:n,reqId:s})=>{console.log("FormData",e.riskAccepted);const[i,o]=C.useState([]),[l,c]=C.useState({}),[A,d]=C.useState({}),[u,f]=C.useState(!0),[h,x]=C.useState({}),[m,g]=C.useState(e.riskAccepted||!1),[p,v]=C.useState({}),[w,B]=C.useState(!1),[T,_]=C.useState(!1),[j,E]=C.useState({title:"",description:""}),[L,M]=C.useState(!1),[F,D]=C.useState(!1);C.useEffect(()=>{(async()=>{try{f(!0);const H=(await SI()).data.data;console.log("questionData",H),o(H);const X={},V={},Ae={},W={};[...new Set(H.map(je=>je.createdBy.department))].forEach(je=>{W[je]=!0,Ae[je]=!1});const ve=Array.isArray(e.complinces)&&e.complinces.length>0?[...e.complinces]:new Array(H.length).fill(null);H.forEach((je,qe)=>{const He=je.createdBy.department,Ze=je._id;if(ve[qe]){console.log("Using existing compliance data for index",qe);const xe=ve[qe];X[qe]=xe.answer,V[qe]=xe.deviation||{reason:"",attachments:[]},xe.answer!==je.expectedAnswer&&(Ae[He]=!0)}else console.log("Creating new compliance data for index",qe),X[qe]=je.expectedAnswer,V[qe]={reason:"",attachments:[]},ve[qe]={questionId:Ze,question:je.question,answer:je.expectedAnswer,department:He,deviation:null,expectedAnswer:je.expectedAnswer,description:je.description}});const de=H.some((je,qe)=>X[qe]!==je.expectedAnswer);c(X),d(V),x(Ae),v(W);const te=typeof e.riskAccepted=="boolean"?e.riskAccepted:!de;g(te),t(je=>({...je,complinces:ve,hasDeviations:Object.values(Ae).some(qe=>qe)?1:0,departmentDeviations:Ae,riskAccepted:te})),f(!1)}catch(Q){console.error("Error fetching questions:",Q),f(!1)}})()},[]);const G=U=>{v(Q=>({...Q,[U]:!Q[U]}))},K=(U,Q)=>{const H=i[U],X=H==null?void 0:H.createdBy.department,V=Q!==(H==null?void 0:H.expectedAnswer);c(J=>({...J,[U]:Q})),t(J=>{const ve=[...J.complinces||[]];ve[U]={questionId:H._id,question:H.question,answer:Q,department:X,deviation:V?A[U]:null,expectedAnswer:H.expectedAnswer,description:H.description};const de={...J.departmentDeviations},je=i.map((qe,He)=>qe.createdBy.department===X?He:null).filter(qe=>qe!==null).some(qe=>(qe===U?Q:l[qe])!==i[qe].expectedAnswer);return de[X]=je,{...J,complinces:ve,departmentDeviations:de,hasDeviations:Object.values(de).some(qe=>qe)?1:0}});const Ae={...l,[U]:Q},W=i.some((J,ve)=>Ae[ve]!==J.expectedAnswer);g(!W),t(J=>({...J,riskAccepted:!W}))},ae=(U,Q,H)=>{const X={...A[U],[Q]:H};d(V=>({...V,[U]:X})),t(V=>{const Ae=[...V.complinces];return Ae[U]={...Ae[U],deviation:X},{...V,complinces:Ae}})},Z=async(U,Q)=>{var H;try{const X=Array.from(Q).map(J=>Ac(J,"compliances",s)),Ae=(await Promise.all(X)).flatMap(J=>J.data.fileUrls[0]),W=[...((H=A[U])==null?void 0:H.attachments)||[],...Ae];ae(U,"attachments",W)}catch(X){console.error("Upload error:",X)}},oe=()=>{if(i.some((Q,H)=>l[H]!==Q.expectedAnswer)){g(!1),t(Q=>({...Q,riskAccepted:!1})),ee(!1);return}M(!0),D(m??!1)},Y=(U,Q)=>{var X;const H=(X=A[U])==null?void 0:X.attachments.filter(V=>V!==Q);ae(U,"attachments",H)},R=(U,Q)=>{E({title:U,description:Q}),_(!0)},z=()=>{_(!1)},ee=async(U=null)=>{try{if(B(!0),i.every((Ae,W)=>l[W]===Ae.expectedAnswer)&&!((U??m)===!0)){M(!0),D(!1),B(!1);return}const X={...e,complinces:[...e.complinces],hasDeviations:Object.values(h).some(Ae=>Ae)?1:0,departmentDeviations:{...h},riskAccepted:U??m};(await _I(X,s)).status===200&&r()}catch(Q){console.error("Error saving data:",Q)}finally{B(!1)}},b=U=>{try{let Q=U.split("/").pop();return Q=Q.split("?")[0],Q=decodeURIComponent(Q),Q=Q.replace(/[-_]/g," ").split(" ").map(H=>H.charAt(0).toUpperCase()+H.slice(1)).join(" "),Q=Q.replace(/\.[^/.]+$/,""),Q}catch(Q){return console.error("Error parsing filename:",Q),"Document"}},O=i.reduce((U,Q)=>{const H=Q.createdBy.department;return U[H]||(U[H]=[]),U[H].push(Q),U},{}),S=i.some((U,Q)=>l[Q]!==U.expectedAnswer);if(u)return a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})});const I=({files:U,onRemove:Q})=>a.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:U.map((H,X)=>a.jsxs("div",{className:"flex items-center gap-2 bg-white px-3 py-2 rounded-md border border-gray-200 w-full sm:w-auto",children:[a.jsxs("a",{href:H,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 hover:text-primary flex-1 min-w-0",children:[a.jsx(ep,{size:14,className:"text-red-500 shrink-0"}),a.jsx("span",{className:"text-sm text-gray-600 truncate",children:b(H)})]}),a.jsx("button",{onClick:()=>Q(H),className:"p-1 hover:bg-gray-100 rounded-full shrink-0",title:"Remove file",children:a.jsx(_r,{size:12,className:"text-gray-500"})})]},X))});return a.jsxs("div",{className:"w-full max-w-7xl mx-auto px-4 sm:px-6",children:[a.jsxs("div",{className:"mb-6 bg-white rounded-xl shadow-lg overflow-hidden",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Agreement Compliance Assessment"}),a.jsx("p",{className:"mt-2 text-gray-600",children:"Review and respond to compliance questions from different departments. Any deviations from expected answers will require justification."})]}),a.jsx("div",{className:"p-6 flex flex-col sm:flex-row sm:items-center gap-4 sm:gap-8 bg-gray-50",children:a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"flex items-center gap-3",children:S?a.jsxs("div",{className:"flex items-center gap-2 text-red-600",children:[a.jsx(sd,{className:"h-5 w-5"}),a.jsx("span",{className:"font-semibold",children:"Deviations Present"})]}):a.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[a.jsx($a,{className:"h-5 w-5"}),a.jsx("span",{className:"font-semibold",children:"All Compliant"})]})}),a.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[Object.keys(O).length," ","departments, ",i.length," total questions"]})]})})]}),a.jsxs("div",{className:"space-y-6",children:[Object.entries(O).map(([U,Q])=>{const H=h[U]||!1,X=p[U]||!1;return a.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden",children:[a.jsxs("button",{onClick:()=>G(U),className:`w-full px-6 py-4 flex justify-between items-center ${H?"bg-red-50 hover:bg-red-100":"bg-primary/10 hover:bg-primary/15"} transition-colors`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:U}),H&&a.jsxs("div",{className:"flex items-center gap-2 bg-red-100 px-3 py-1 rounded-full",children:[a.jsx(sd,{className:"text-red-500 h-4 w-4"}),a.jsxs("span",{className:"text-sm font-medium text-red-600",children:[Q.filter((V,Ae)=>{const W=i.findIndex(J=>J._id===V._id);return l[W]!==V.expectedAnswer}).length," ","Deviation(s)"]})]})]}),X?a.jsx(bl,{className:"h-5 w-5 text-gray-500"}):a.jsx(vo,{className:"h-5 w-5 text-gray-500"})]}),X&&a.jsx("div",{className:"divide-y divide-gray-100",children:Q.map(V=>{var de,te;const Ae=i.findIndex(je=>je._id===V._id),W=l[Ae],J=A[Ae],ve=W!==V.expectedAnswer;return a.jsxs("div",{className:`p-6 hover:bg-gray-50 transition-colors ${ve?"bg-red-50/50":""}`,children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4",children:[a.jsx("div",{className:"flex items-start space-x-2 flex-1",children:a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-lg text-gray-800 font-medium",children:V.question}),V.description&&a.jsx("div",{className:"mt-2 flex items-center",children:a.jsxs("button",{onClick:()=>R(V.question,V.description),className:"text-sm text-primary hover:text-primary/80 flex items-center gap-1 transition-colors",children:[a.jsx(Fi,{size:14}),a.jsx("span",{children:"View more details"})]})})]})}),a.jsx("div",{className:"flex items-center gap-6 shrink-0",children:a.jsxs("div",{className:`flex items-center gap-4 p-3 rounded-lg ${W?"bg-green-50/70":"bg-red-50/70"}`,children:[a.jsxs("label",{className:"inline-flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"radio",name:V._id,checked:W===!0,onChange:()=>K(Ae,!0),className:"w-5 h-5 text-primary"}),a.jsx("span",{className:"text-base text-gray-700 font-medium",children:"Yes"})]}),a.jsxs("label",{className:"inline-flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"radio",name:V._id,checked:W===!1,onChange:()=>K(Ae,!1),className:"w-5 h-5 text-primary"}),a.jsx("span",{className:"text-base text-gray-700 font-medium",children:"No"})]})]})})]}),ve&&a.jsxs("div",{className:"mt-5 bg-red-50 rounded-lg p-4 border border-red-100",children:[a.jsxs("h4",{className:"text-red-700 font-medium mb-3 flex items-center gap-2",children:[a.jsx(sd,{size:16}),"Justification Required"]}),a.jsx("textarea",{placeholder:"Please provide justification for this deviation...",value:(J==null?void 0:J.reason)||"",onChange:je=>ae(Ae,"reason",je.target.value),className:"w-full p-3 border rounded-lg resize-none focus:ring-2 focus:ring-primary/50 focus:border-primary",rows:3}),a.jsxs("div",{className:"mt-4 space-y-3",children:[a.jsxs("div",{className:"flex flex-col xs:flex-row xs:items-center xs:justify-between gap-2",children:[a.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 bg-white rounded-lg border hover:bg-gray-50 cursor-pointer w-full xs:w-auto transition-colors",children:[a.jsx(Ds,{size:16,className:"text-primary shrink-0"}),a.jsx("span",{className:"text-sm font-medium truncate",children:"Upload Supporting Documents"}),a.jsx("input",{type:"file",multiple:!0,className:"hidden",onChange:je=>Z(Ae,je.target.files)})]}),a.jsxs("span",{className:"text-sm text-gray-600",children:[((de=J==null?void 0:J.attachments)==null?void 0:de.length)||0," ","files attached"]})]}),((te=J==null?void 0:J.attachments)==null?void 0:te.length)>0&&a.jsx(I,{files:J.attachments,onRemove:je=>Y(Ae,je)})]})]})]},V._id)})})]},U)}),i.length>0&&i.every((U,Q)=>l[Q]===U.expectedAnswer)&&m&&a.jsxs("div",{className:"mt-2 mb-2 flex items-center gap-2 text-green-700 bg-green-50 border border-green-200 rounded-md px-3 py-2",children:[a.jsx(Fi,{size:16,className:"text-green-600"}),a.jsx("span",{className:"text-sm font-medium",children:"You have accepted the risk."})]}),a.jsxs("div",{className:"flex justify-between pt-4 mb-8",children:[a.jsx("div",{}),a.jsx("button",{onClick:oe,disabled:w,className:`px-5 py-3 bg-primary text-white font-medium rounded-lg shadow-md flex items-center gap-2 ${w?"opacity-50 cursor-not-allowed":"hover:bg-primary/90"}`,children:w?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full mr-2"}),"Saving..."]}):a.jsxs(a.Fragment,{children:["Continue to Preview",a.jsx(yN,{size:18})]})})]})]}),T&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6 relative",children:[a.jsx("button",{onClick:z,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx(_r,{size:20})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:j.title}),a.jsx("p",{className:"text-gray-600",children:j.description}),a.jsx("div",{className:"mt-6 flex justify-end",children:a.jsx("button",{onClick:z,className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors",children:"Close"})})]})}),L&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Risk Acceptance"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Please acknowledge the risk to proceed to preview."}),a.jsxs("label",{className:"flex items-center gap-3 mb-4",children:[a.jsx("input",{type:"checkbox",checked:F,onChange:U=>D(U.target.checked),className:"w-5 h-5 text-primary rounded"}),a.jsx("span",{className:"text-sm text-gray-800",children:"I accept the risk and confirm the information is accurate to the best of my knowledge."})]}),a.jsxs("div",{className:"flex justify-end gap-3",children:[a.jsx("button",{onClick:()=>M(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:()=>{g(!0),t(U=>({...U,riskAccepted:!0})),M(!1),ee(!0)},disabled:!F,className:`px-4 py-2 rounded-lg text-white ${F?"bg-primary hover:bg-primary/90":"bg-gray-300 cursor-not-allowed"}`,children:"Accept & Continue"})]})]})})]})},D1e=[{code:"USD",symbol:"$",locale:"en-US"},{code:"EUR",symbol:"",locale:"de-DE"},{code:"GBP",symbol:"",locale:"en-GB"},{code:"INR",symbol:"",locale:"en-IN"},{code:"AED",symbol:".",locale:"ar-AE"},{code:"IDR",symbol:"Rp",locale:"id-ID"},{code:"MYR",symbol:"RM",locale:"ms-MY"},{code:"SGD",symbol:"S$",locale:"en-SG"},{code:"PHP",symbol:"",locale:"fil-PH"}],P1e=({formData:e,onSubmit:t,onBack:r})=>{var l,c,A,d,u,f,h,x,m,g;console.log("Preview formData",e);const[n,s]=C.useState(!1),i=p=>{const v=D1e.find(w=>w.code===e.supplies.selectedCurrency);return!v||!p?"N/A":new Intl.NumberFormat(v.locale,{style:"currency",currency:v.code,minimumFractionDigits:2,maximumFractionDigits:2}).format(p)},o=p=>{var v;return!p||((v=Object.keys(p))==null?void 0:v.length)===0?a.jsx("div",{className:"text-gray-500",children:"No files uploaded"}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(p).map(([w,B])=>B&&B.length>0&&a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-3 capitalize border-b pb-2",children:w.replace(/([A-Z])/g," $1").toLowerCase()}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:B.map((T,_)=>a.jsx("div",{className:"flex flex-col items-center bg-gray-50 rounded p-2",children:a.jsxs("a",{href:T,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:text-blue-800 truncate max-w-full text-center",children:[" ",a.jsx("img",{src:lv,alt:`Icon ${_+1}`,className:"w-10 h-10 object-cover mb-2"})]})},_))})]},w))})};return a.jsxs("div",{className:"max-w-8xl mx-auto bg-white shadow-lg rounded-lg overflow-hidden",children:[a.jsxs("div",{className:"space-y-8 p-6",children:[a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center space-x-2 text-primary",children:[a.jsx(q4,{size:24}),a.jsx("h2",{className:"text-2xl font-bold border-b pb-3",children:"Commercials Details"})]}),e.commercials&&Object.values(e.commercials).some(p=>p)&&a.jsxs("div",{className:"grid gap-6 p-4",children:[a.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Business Unit"}),a.jsx("div",{className:"text-gray-800 font-semibold mt-1",children:e.commercials.businessUnit})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Entity"}),a.jsx("div",{className:"text-gray-800 font-semibold mt-1",children:e.commercials.entity})]})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"City"}),a.jsx("div",{className:"text-gray-800 font-semibold mt-1",children:e.commercials.city})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Site"}),a.jsx("div",{className:"text-gray-800 font-semibold mt-1",children:e.commercials.site})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Cost Centre"}),a.jsx("div",{className:"text-gray-800 font-semibold mt-1",children:e.commercials.costCentre})]})]}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Department"}),a.jsx("div",{className:"text-gray-800 font-semibold mt-1",children:e.commercials.department})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Head of Department"}),a.jsx("div",{className:"text-gray-800 font-semibold mt-1",children:e.commercials.hod})]})]}),a.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Payment Mode"}),a.jsx("div",{className:"text-gray-800 font-semibold mt-1",children:e.commercials.paymentMode})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Credit Card Selected"}),a.jsx("div",{className:"text-gray-800 font-semibold mt-1",children:e.commercials.isCreditCardSelected?"Yes":"No"})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Bill To"}),a.jsx("div",{className:"text-gray-800 font-semibold mt-1",children:e.commercials.billTo})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Ship To"}),a.jsx("div",{className:"text-gray-800 font-semibold mt-1",children:e.commercials.shipTo})]})]})]}),((c=(l=e.commercials)==null?void 0:l.paymentTerms)==null?void 0:c.length)>0&&a.jsxs("div",{className:"mt-6",children:[a.jsx("h3",{className:"text-xl font-semibold text-primary mb-4",children:"Payment Terms"}),a.jsx("div",{className:"bg-white shadow-lg rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-primary/10",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-4 text-left text-primary font-semibold",children:"Percentage"}),a.jsx("th",{className:"px-6 py-4 text-left text-primary font-semibold",children:"Payment Term"}),a.jsx("th",{className:"px-6 py-4 text-left text-primary font-semibold",children:"Type"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:e.commercials.paymentTerms.map((p,v)=>{var w,B;return a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsxs("td",{className:"px-6 py-4 text-left font-medium",children:[p.percentageTerm,"%"]}),a.jsxs("td",{className:"px-3 sm:px-6 py-3 sm:py-4 capitalize",children:[(w=p.paymentTerm)==null?void 0:w.toLowerCase(),p.customPaymentTerm?` - ${p.customPaymentTerm.toLowerCase()}`:""]}),a.jsxs("td",{className:"px-3 sm:px-6 py-3 sm:py-4 capitalize",children:[(B=p.paymentType)==null?void 0:B.toLowerCase(),p.customPaymentType?` - ${p.customPaymentType.toLowerCase()}`:""]})]},v)})})]})})]})]}),a.jsxs("div",{className:"space-y-6 mt-8",children:[a.jsxs("div",{className:"flex items-center space-x-2 text-primary",children:[a.jsx(G4,{size:24}),a.jsx("h2",{className:"text-2xl font-bold border-b pb-3",children:"Procurements Details"})]}),e.procurements&&Object.values(e.procurements).some(p=>p)&&a.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:[{label:"Vendor ID",value:e.procurements.vendor},{label:"Vendor Name",value:e.procurements.vendorName},{label:"Quotation Number",value:e.procurements.quotationNumber},{label:"Quotation Date",value:e.procurements.quotationDate?so(e.procurements.quotationDate):null},{label:"Service Period",value:e.procurements.servicePeriod},{label:"PO Valid From",value:e.procurements.poValidFrom?so(e.procurements.poValidFrom):null},{label:"PO Valid To",value:e.procurements.poValidTo?so(e.procurements.poValidTo):null}].filter(p=>p.value).map((p,v)=>a.jsxs("div",{className:"flex justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:p.label}),a.jsx("span",{className:"text-gray-800 font-semibold",children:p.value})]},v))}),((A=e.procurements)==null?void 0:A.uploadedFiles)&&a.jsxs("div",{className:"mt-6",children:[a.jsx("h3",{className:"text-xl font-semibold text-primary mb-4",children:"Uploaded Files"}),a.jsxs("div",{className:"bg-white shadow-md rounded-lg p-4",children:[Object.keys(e.procurements.uploadedFiles).length>0?a.jsxs("div",{className:"text-green-600 flex items-center mb-4",children:[a.jsx(ca,{className:"mr-2",size:20}),"Files uploaded successfully"]}):a.jsx("div",{className:"text-gray-500 flex items-center",children:"No files uploaded"}),o(e.procurements.uploadedFiles)]})]})]}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-primary border-b pb-3",children:"Product/Services Details"}),((u=(d=e.supplies)==null?void 0:d.services)==null?void 0:u.length)>0&&a.jsx("div",{className:"mt-6",children:a.jsx("div",{className:"overflow-x-auto w-full",children:a.jsxs("table",{className:"min-w-full bg-white shadow-md rounded-lg",children:[a.jsx("thead",{className:"bg-primary/10",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-3 text-left text-primary min-w-40",children:"Product Names"}),a.jsx("th",{className:"p-3 text-left text-primary min-w-48",children:"Description"}),a.jsx("th",{className:"p-3 text-left text-primary min-w-40",children:"Purpose"}),a.jsx("th",{className:"p-3 text-left text-primary min-w-24",children:"Quantity"}),a.jsx("th",{className:"p-3 text-left text-primary min-w-24",children:"Price"}),a.jsx("th",{className:"p-3 text-left text-primary min-w-20",children:"Tax (%)"}),a.jsx("th",{className:"p-3 text-left text-primary min-w-24",children:"Total"})]})}),a.jsx("tbody",{children:e.supplies.services.map((p,v)=>{const w=parseFloat(p.quantity)||0,B=parseFloat(p.price)||0,T=parseFloat(p.tax)||0,_=w*B*(1+T/100);return a.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[a.jsx("td",{className:"p-3",children:a.jsx("div",{className:"whitespace-normal break-words max-w-40",children:p.productName||"N/A"})}),a.jsx("td",{className:"p-3",children:a.jsx("div",{className:"whitespace-normal break-words max-w-48",children:p.productDescription||"N/A"})}),a.jsx("td",{className:"p-3",children:a.jsx("div",{className:"whitespace-normal break-words max-w-40",children:p.productPurpose||"N/A"})}),a.jsx("td",{className:"p-3",children:p.quantity}),a.jsx("td",{className:"p-3",children:i(p.price)}),a.jsx("td",{className:"p-3",children:p.tax||"N/A"}),a.jsx("td",{className:"p-3 font-semibold",children:i(_)})]},v)})})]})})}),((f=e.supplies)==null?void 0:f.totalValue)!==void 0&&a.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg flex justify-between",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Total Value"}),a.jsx("span",{className:"text-gray-800 font-semibold",children:i(e.supplies.totalValue)})]}),((h=e.supplies)==null?void 0:h.remarks)&&a.jsxs("div",{className:"mt-6",children:[a.jsx("h3",{className:"text-xl font-semibold text-primary mb-4",children:"Remarks"}),a.jsx("p",{children:e.supplies.remarks})]})]}),a.jsxs("div",{className:"space-y-6 mt-8",children:[a.jsxs("div",{className:"flex items-center space-x-2 text-primary",children:[a.jsx(jr,{size:24}),a.jsx("h2",{className:"text-2xl font-bold border-b pb-3",children:"Compliances Details"})]}),e.complinces&&(e!=null&&e.complinces)?a.jsx("div",{className:"space-y-4",children:((x=Object.keys(e==null?void 0:e.complinces))==null?void 0:x.length)>0?(m=Object.entries(e==null?void 0:e.complinces))==null?void 0:m.map(([p,v],w)=>{var B,T,_;return a.jsxs("div",{className:`p-4 rounded-lg ${v.expectedAnswer!==v.answer?"bg-red-50 border border-red-200":"bg-green-50 border border-green-200"}`,children:[a.jsx("h3",{className:`text-lg font-semibold ${v.expectedAnswer!==v.answer?"text-red-800":"text-green-800"}`,children:v.question}),a.jsx("p",{className:`mt-2 font-medium ${v.expectedAnswer!==v.answer?"text-red-600":"text-green-600"}`,children:v.answer?"Yes":"No"}),v.department&&a.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:[a.jsx("strong",{children:"Department:"})," ",v.department]}),v.deviation&&v.expectedAnswer!==v.answer&&a.jsx("div",{className:"mt-2 p-3 bg-red-100 rounded",children:a.jsxs("p",{className:"text-sm text-red-700",children:[a.jsx("strong",{children:"Deviation Reason:"})," ",v.deviation.reason]})}),((T=(B=v==null?void 0:v.deviation)==null?void 0:B.attachments)==null?void 0:T.length)>0&&a.jsxs("div",{className:"mt-4",children:[a.jsx("strong",{className:"text-red-700",children:"Attachments:"}),a.jsx("ul",{className:"list-disc pl-6 mt-2",children:(_=v==null?void 0:v.deviation)==null?void 0:_.attachments.map((j,E)=>a.jsx("li",{children:a.jsxs("a",{href:j,target:"_blank",rel:"noopener noreferrer",className:"text-red-600 hover:text-red-800 underline",children:["Attachment"," ",E+1]})},E))})]})]},p)}):a.jsx("div",{className:"text-gray-500",children:"No compliance details available"})}):a.jsx("div",{className:"text-gray-500",children:"No compliance data available"})]}),a.jsxs("div",{className:"p-6 border rounded-lg shadow-sm bg-gray-50",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx(Xm,{className:"w-8 h-8 text-blue-600"}),a.jsx("h3",{className:"font-semibold text-2xl",children:"Approver"})]}),a.jsxs("div",{className:"flex items-center gap-8 p-4",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-gray-600 text-sm",children:"Department"}),a.jsx("div",{className:"font-medium",children:e.commercials.department})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-gray-600 text-sm",children:"Head of Department"}),a.jsx("div",{className:"font-medium",children:e.commercials.hod||"No HOD found"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-gray-600 text-sm",children:"HOD Email"}),a.jsx("div",{className:"font-medium",children:((g=e==null?void 0:e.commercials)==null?void 0:g.hodEmail)||"No email found"})]})]})]})]}),a.jsxs("div",{className:"p-6 flex justify-between items-center border-t mt-8",children:[a.jsx("div",{}),a.jsxs("button",{onClick:()=>s(!0),className:"flex items-center bg-primary text-white px-6 py-2 rounded-md hover:bg-primary-dark transition-colors duration-300",children:[a.jsx(q_,{className:"mr-2",size:20}),"Submit"]})]}),n&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[a.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Confirm Submission"}),a.jsx("p",{className:"mb-6",children:"Are you sure you want to submit this form?"}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx("button",{onClick:()=>s(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-100",children:"Cancel"}),a.jsx("button",{onClick:()=>{t(),s(!1)},className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary",children:"Submit Request"})]})]})})]})},O1e=()=>{const{id:e}=yo(),t=Sr(),r=localStorage.getItem("capEmpId"),[n,s]=C.useState([]),[i,o]=C.useState({}),[l,c]=C.useState(!1),[A,d]=C.useState([0,1,2,3,4]),[u,f]=C.useState(!0);C.useEffect(()=>{(async()=>{try{f(!0);const v=await FI(e);console.log("response.data.data",v.data.data),v.status===200&&(o(v.data.data),s([0,1,2,3,4]))}catch(v){console.error("Error fetching request data:",v),Ie.error("Failed to load request data")}finally{f(!1)}})()},[e]);const h=async()=>{c(!0);try{console.log("Form Submitted:",i);const p=await BI(r,i);console.log("response updated",p),p.status===200&&(Ie.success("Request is updated"),setTimeout(()=>{t(`/req-list-table/preview-one-req/${e}`)},1500))}catch(p){console.log("Error in submit req",p),Ie.error("Failed to update request")}finally{c(!1)}},x=[{title:"Commercials",icon:jr,description:"Edit commercial details and information",content:a.jsx(T1e,{formData:i==null?void 0:i.commercials,setFormData:p=>o(v=>({...v,commercials:typeof p=="function"?p(v==null?void 0:v.commercials):p})),onNext:()=>m(0),reqId:e})},{title:"Procurements",icon:$4,description:"Edit procurement details and requirements",content:a.jsx(_1e,{formData:i==null?void 0:i.procurements,setFormData:p=>o(v=>({...v,procurements:typeof p=="function"?p(v==null?void 0:v.procurements):p})),onNext:()=>m(1),onBack:()=>{},reqId:i.reqid})},{title:"Supplies",icon:W_,description:"Edit supply items and logistics information",content:a.jsx(L1e,{formData:i==null?void 0:i.supplies,setFormData:p=>o(v=>({...v,supplies:typeof p=="function"?p(v==null?void 0:v.supplies):p})),remarks:i==null?void 0:i.remarks,onBack:()=>{},onNext:()=>m(2),reqId:i.reqid})},{title:"Agreement Compliances",icon:jr,description:"Edit compliance requirements",content:a.jsx(U1e,{formData:i,setFormData:p=>o(v=>{const w=typeof p=="function"?p(v):p;return{...v,complinces:Array.isArray(w.complinces)?w.complinces:v.complinces||[]}}),onSubmit:h,onBack:()=>{},onNext:()=>m(3),reqId:i.reqid})},{title:"Preview",icon:ho,description:"Review all changes before updating",content:a.jsx(P1e,{formData:i,onSubmit:h,onBack:()=>{},isSubmitting:l})}],m=p=>{console.log("Step completed:",p,i),n.includes(p)||s([...n,p])},g=p=>{d(v=>v.includes(p)?v.filter(w=>w!==p):[...v,p])};return u?a.jsx("div",{className:"w-full mx-auto bg-gray-50 p-4 sm:p-6 flex items-center justify-center min-h-64",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(If,{className:"w-6 h-6 animate-spin text-primary"}),a.jsx("span",{className:"text-gray-700",children:"Loading request data..."})]})}):a.jsxs("div",{className:"w-full mx-auto bg-gray-50 p-2 sm:p-4 md:p-6",children:[l&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white p-4 rounded-lg flex items-center gap-3",children:[a.jsx(If,{className:"w-6 h-6 animate-spin text-primary"}),a.jsx("span",{className:"text-gray-700",children:"Updating request..."})]})}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:["Edit Request #",i==null?void 0:i.reqid]}),a.jsx("p",{className:"text-gray-600",children:"Modify the sections below as needed. All sections are loaded with existing data."})]}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[a.jsx("span",{children:"Sections Loaded"}),a.jsxs("span",{children:[n.length," of ",x.length," sections"]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${n.length/x.length*100}%`}})})]}),a.jsx("div",{className:"space-y-4",children:x.map((p,v)=>{const w=p.icon,B=n.includes(v),T=A.includes(v);return a.jsxs("div",{id:`step-${v}`,className:`bg-white rounded-lg border transition-all duration-200 ${B?"border-green-300 shadow-md":T?"border-primary shadow-lg":"border-gray-200 shadow-sm"}`,children:[a.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer hover:bg-gray-50",onClick:()=>g(v),children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center border-2 ${B?"border-green-500 bg-green-500 text-white":T?"border-primary bg-primary text-white":"border-gray-300 bg-gray-100 text-gray-400"}`,children:B?a.jsx(ho,{className:"w-6 h-6"}):a.jsx(w,{className:"w-6 h-6"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("h3",{className:`font-semibold text-lg ${B?"text-green-700":T?"text-primary":"text-gray-700"}`,children:[v+1,". ",p.title]}),B&&a.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs rounded-full font-medium",children:"Loaded"})]}),a.jsx("p",{className:"text-gray-600 text-sm mt-1",children:p.description})]})]}),a.jsx("div",{className:"flex-shrink-0",children:T?a.jsx(bl,{className:"w-5 h-5 text-gray-400"}):a.jsx(vo,{className:"w-5 h-5 text-gray-400"})})]}),T&&a.jsx("div",{className:"px-4 pb-4",children:a.jsx("div",{className:"border-t border-gray-200 pt-4",children:p.content})})]},v)})}),a.jsx(In,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,pauseOnFocusLoss:!0})]})};/*!
* sweetalert2 v11.15.10
* Released under the MIT License.
*/function wO(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}function R1e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tT(e,t){return e.get(wO(e,t))}function Q1e(e,t,r){R1e(e,t),t.set(e,r)}function M1e(e,t,r){return e.set(wO(e,t),r),r}const H1e=100,nr={},V1e=()=>{nr.previousActiveElement instanceof HTMLElement?(nr.previousActiveElement.focus(),nr.previousActiveElement=null):document.body&&document.body.focus()},$1e=e=>new Promise(t=>{if(!e)return t();const r=window.scrollX,n=window.scrollY;nr.restoreFocusTimeout=setTimeout(()=>{V1e(),t()},H1e),window.scrollTo(r,n)}),bO="swal2-",q1e=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","default-outline","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"],st=q1e.reduce((e,t)=>(e[t]=bO+t,e),{}),K1e=["success","warning","info","question","error"],xy=K1e.reduce((e,t)=>(e[t]=bO+t,e),{}),NO="SweetAlert2:",Tj=e=>e.charAt(0).toUpperCase()+e.slice(1),ii=e=>{console.warn(`${NO} ${typeof e=="object"?e.join(" "):e}`)},Zd=e=>{console.error(`${NO} ${e}`)},rT=[],z1e=e=>{rT.includes(e)||(rT.push(e),ii(e))},CO=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;z1e(`"${e}" is deprecated and will be removed in the next major release.${t?` Use "${t}" instead.`:""}`)},Jv=e=>typeof e=="function"?e():e,_j=e=>e&&typeof e.toPromise=="function",pp=e=>_j(e)?e.toPromise():Promise.resolve(e),Ij=e=>e&&Promise.resolve(e)===e,oi=()=>document.body.querySelector(`.${st.container}`),xp=e=>{const t=oi();return t?t.querySelector(e):null},Ui=e=>xp(`.${e}`),Vr=()=>Ui(st.popup),l0=()=>Ui(st.icon),G1e=()=>Ui(st["icon-content"]),jO=()=>Ui(st.title),Lj=()=>Ui(st["html-container"]),BO=()=>Ui(st.image),Uj=()=>Ui(st["progress-steps"]),Zv=()=>Ui(st["validation-message"]),vl=()=>xp(`.${st.actions} .${st.confirm}`),c0=()=>xp(`.${st.actions} .${st.cancel}`),eu=()=>xp(`.${st.actions} .${st.deny}`),W1e=()=>Ui(st["input-label"]),A0=()=>xp(`.${st.loader}`),gp=()=>Ui(st.actions),SO=()=>Ui(st.footer),e2=()=>Ui(st["timer-progress-bar"]),Dj=()=>Ui(st.close),X1e=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,Pj=()=>{const e=Vr();if(!e)return[];const t=e.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),r=Array.from(t).sort((i,o)=>{const l=parseInt(i.getAttribute("tabindex")||"0"),c=parseInt(o.getAttribute("tabindex")||"0");return l>c?1:l<c?-1:0}),n=e.querySelectorAll(X1e),s=Array.from(n).filter(i=>i.getAttribute("tabindex")!=="-1");return[...new Set(r.concat(s))].filter(i=>ei(i))},Oj=()=>ac(document.body,st.shown)&&!ac(document.body,st["toast-shown"])&&!ac(document.body,st["no-backdrop"]),t2=()=>{const e=Vr();return e?ac(e,st.toast):!1},Y1e=()=>{const e=Vr();return e?e.hasAttribute("data-loading"):!1},Di=(e,t)=>{if(e.textContent="",t){const n=new DOMParser().parseFromString(t,"text/html"),s=n.querySelector("head");s&&Array.from(s.childNodes).forEach(o=>{e.appendChild(o)});const i=n.querySelector("body");i&&Array.from(i.childNodes).forEach(o=>{o instanceof HTMLVideoElement||o instanceof HTMLAudioElement?e.appendChild(o.cloneNode(!0)):e.appendChild(o)})}},ac=(e,t)=>{if(!t)return!1;const r=t.split(/\s+/);for(let n=0;n<r.length;n++)if(!e.classList.contains(r[n]))return!1;return!0},J1e=(e,t)=>{Array.from(e.classList).forEach(r=>{!Object.values(st).includes(r)&&!Object.values(xy).includes(r)&&!Object.values(t.showClass||{}).includes(r)&&e.classList.remove(r)})},Ti=(e,t,r)=>{if(J1e(e,t),!t.customClass)return;const n=t.customClass[r];if(n){if(typeof n!="string"&&!n.forEach){ii(`Invalid type of customClass.${r}! Expected string or iterable object, got "${typeof n}"`);return}Lr(e,n)}},r2=(e,t)=>{if(!t)return null;switch(t){case"select":case"textarea":case"file":return e.querySelector(`.${st.popup} > .${st[t]}`);case"checkbox":return e.querySelector(`.${st.popup} > .${st.checkbox} input`);case"radio":return e.querySelector(`.${st.popup} > .${st.radio} input:checked`)||e.querySelector(`.${st.popup} > .${st.radio} input:first-child`);case"range":return e.querySelector(`.${st.popup} > .${st.range} input`);default:return e.querySelector(`.${st.popup} > .${st.input}`)}},FO=e=>{if(e.focus(),e.type!=="file"){const t=e.value;e.value="",e.value=t}},EO=(e,t,r)=>{!e||!t||(typeof t=="string"&&(t=t.split(/\s+/).filter(Boolean)),t.forEach(n=>{Array.isArray(e)?e.forEach(s=>{r?s.classList.add(n):s.classList.remove(n)}):r?e.classList.add(n):e.classList.remove(n)}))},Lr=(e,t)=>{EO(e,t,!0)},xo=(e,t)=>{EO(e,t,!1)},rA=(e,t)=>{const r=Array.from(e.children);for(let n=0;n<r.length;n++){const s=r[n];if(s instanceof HTMLElement&&ac(s,t))return s}},wd=(e,t,r)=>{r===`${parseInt(r)}`&&(r=parseInt(r)),r||parseInt(r)===0?e.style.setProperty(t,typeof r=="number"?`${r}px`:r):e.style.removeProperty(t)},Ps=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"flex";e&&(e.style.display=t)},wa=e=>{e&&(e.style.display="none")},Rj=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"block";e&&new MutationObserver(()=>{yp(e,e.innerHTML,t)}).observe(e,{childList:!0,subtree:!0})},nT=(e,t,r,n)=>{const s=e.querySelector(t);s&&s.style.setProperty(r,n)},yp=function(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"flex";t?Ps(e,r):wa(e)},ei=e=>!!(e&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)),Z1e=()=>!ei(vl())&&!ei(eu())&&!ei(c0()),sT=e=>e.scrollHeight>e.clientHeight,kO=e=>{const t=window.getComputedStyle(e),r=parseFloat(t.getPropertyValue("animation-duration")||"0"),n=parseFloat(t.getPropertyValue("transition-duration")||"0");return r>0||n>0},Qj=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e2();r&&ei(r)&&(t&&(r.style.transition="none",r.style.width="100%"),setTimeout(()=>{r.style.transition=`width ${e/1e3}s linear`,r.style.width="0%"},10))},eye=()=>{const e=e2();if(!e)return;const t=parseInt(window.getComputedStyle(e).width);e.style.removeProperty("transition"),e.style.width="100%";const r=parseInt(window.getComputedStyle(e).width),n=t/r*100;e.style.width=`${n}%`},tye=()=>typeof window>"u"||typeof document>"u",rye=`
 <div aria-labelledby="${st.title}" aria-describedby="${st["html-container"]}" class="${st.popup}" tabindex="-1">
   <button type="button" class="${st.close}"></button>
   <ul class="${st["progress-steps"]}"></ul>
   <div class="${st.icon}"></div>
   <img class="${st.image}" />
   <h2 class="${st.title}" id="${st.title}"></h2>
   <div class="${st["html-container"]}" id="${st["html-container"]}"></div>
   <input class="${st.input}" id="${st.input}" />
   <input type="file" class="${st.file}" />
   <div class="${st.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${st.select}" id="${st.select}"></select>
   <div class="${st.radio}"></div>
   <label class="${st.checkbox}">
     <input type="checkbox" id="${st.checkbox}" />
     <span class="${st.label}"></span>
   </label>
   <textarea class="${st.textarea}" id="${st.textarea}"></textarea>
   <div class="${st["validation-message"]}" id="${st["validation-message"]}"></div>
   <div class="${st.actions}">
     <div class="${st.loader}"></div>
     <button type="button" class="${st.confirm}"></button>
     <button type="button" class="${st.deny}"></button>
     <button type="button" class="${st.cancel}"></button>
   </div>
   <div class="${st.footer}"></div>
   <div class="${st["timer-progress-bar-container"]}">
     <div class="${st["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),nye=()=>{const e=oi();return e?(e.remove(),xo([document.documentElement,document.body],[st["no-backdrop"],st["toast-shown"],st["has-column"]]),!0):!1},KA=()=>{nr.currentInstance.resetValidationMessage()},sye=()=>{const e=Vr(),t=rA(e,st.input),r=rA(e,st.file),n=e.querySelector(`.${st.range} input`),s=e.querySelector(`.${st.range} output`),i=rA(e,st.select),o=e.querySelector(`.${st.checkbox} input`),l=rA(e,st.textarea);t.oninput=KA,r.onchange=KA,i.onchange=KA,o.onchange=KA,l.oninput=KA,n.oninput=()=>{KA(),s.value=n.value},n.onchange=()=>{KA(),s.value=n.value}},aye=e=>typeof e=="string"?document.querySelector(e):e,iye=e=>{const t=Vr();t.setAttribute("role",e.toast?"alert":"dialog"),t.setAttribute("aria-live",e.toast?"polite":"assertive"),e.toast||t.setAttribute("aria-modal","true")},oye=e=>{window.getComputedStyle(e).direction==="rtl"&&Lr(oi(),st.rtl)},lye=e=>{const t=nye();if(tye()){Zd("SweetAlert2 requires document to initialize");return}const r=document.createElement("div");r.className=st.container,t&&Lr(r,st["no-transition"]),Di(r,rye);const n=aye(e.target);n.appendChild(r),iye(e),oye(n),sye()},Mj=(e,t)=>{e instanceof HTMLElement?t.appendChild(e):typeof e=="object"?cye(e,t):e&&Di(t,e)},cye=(e,t)=>{e.jquery?Aye(t,e):Di(t,e.toString())},Aye=(e,t)=>{if(e.textContent="",0 in t)for(let r=0;r in t;r++)e.appendChild(t[r].cloneNode(!0));else e.appendChild(t.cloneNode(!0))},dye=(e,t)=>{const r=gp(),n=A0();!r||!n||(!t.showConfirmButton&&!t.showDenyButton&&!t.showCancelButton?wa(r):Ps(r),Ti(r,t,"actions"),uye(r,n,t),Di(n,t.loaderHtml||""),Ti(n,t,"loader"))};function uye(e,t,r){const n=vl(),s=eu(),i=c0();!n||!s||!i||(wb(n,"confirm",r),wb(s,"deny",r),wb(i,"cancel",r),fye(n,s,i,r),r.reverseButtons&&(r.toast?(e.insertBefore(i,n),e.insertBefore(s,n)):(e.insertBefore(i,t),e.insertBefore(s,t),e.insertBefore(n,t))))}function fye(e,t,r,n){if(!n.buttonsStyling){xo([e,t,r],st.styled);return}Lr([e,t,r],st.styled),n.confirmButtonColor&&(e.style.backgroundColor=n.confirmButtonColor,Lr(e,st["default-outline"])),n.denyButtonColor&&(t.style.backgroundColor=n.denyButtonColor,Lr(t,st["default-outline"])),n.cancelButtonColor&&(r.style.backgroundColor=n.cancelButtonColor,Lr(r,st["default-outline"]))}function wb(e,t,r){const n=Tj(t);yp(e,r[`show${n}Button`],"inline-block"),Di(e,r[`${t}ButtonText`]||""),e.setAttribute("aria-label",r[`${t}ButtonAriaLabel`]||""),e.className=st[t],Ti(e,r,`${t}Button`)}const hye=(e,t)=>{const r=Dj();r&&(Di(r,t.closeButtonHtml||""),Ti(r,t,"closeButton"),yp(r,t.showCloseButton),r.setAttribute("aria-label",t.closeButtonAriaLabel||""))},mye=(e,t)=>{const r=oi();r&&(pye(r,t.backdrop),xye(r,t.position),gye(r,t.grow),Ti(r,t,"container"))};function pye(e,t){typeof t=="string"?e.style.background=t:t||Lr([document.documentElement,document.body],st["no-backdrop"])}function xye(e,t){t&&(t in st?Lr(e,st[t]):(ii('The "position" parameter is not valid, defaulting to "center"'),Lr(e,st.center)))}function gye(e,t){t&&Lr(e,st[`grow-${t}`])}var vn={innerParams:new WeakMap,domCache:new WeakMap};const yye=["input","file","range","select","radio","checkbox","textarea"],vye=(e,t)=>{const r=Vr();if(!r)return;const n=vn.innerParams.get(e),s=!n||t.input!==n.input;yye.forEach(i=>{const o=rA(r,st[i]);o&&(Nye(i,t.inputAttributes),o.className=st[i],s&&wa(o))}),t.input&&(s&&wye(t),Cye(t))},wye=e=>{if(!e.input)return;if(!es[e.input]){Zd(`Unexpected type of input! Expected ${Object.keys(es).join(" | ")}, got "${e.input}"`);return}const t=TO(e.input);if(!t)return;const r=es[e.input](t,e);Ps(t),e.inputAutoFocus&&setTimeout(()=>{FO(r)})},bye=e=>{for(let t=0;t<e.attributes.length;t++){const r=e.attributes[t].name;["id","type","value","style"].includes(r)||e.removeAttribute(r)}},Nye=(e,t)=>{const r=Vr();if(!r)return;const n=r2(r,e);if(n){bye(n);for(const s in t)n.setAttribute(s,t[s])}},Cye=e=>{if(!e.input)return;const t=TO(e.input);t&&Ti(t,e,"input")},Hj=(e,t)=>{!e.placeholder&&t.inputPlaceholder&&(e.placeholder=t.inputPlaceholder)},vp=(e,t,r)=>{if(r.inputLabel){const n=document.createElement("label"),s=st["input-label"];n.setAttribute("for",e.id),n.className=s,typeof r.customClass=="object"&&Lr(n,r.customClass.inputLabel),n.innerText=r.inputLabel,t.insertAdjacentElement("beforebegin",n)}},TO=e=>{const t=Vr();if(t)return rA(t,st[e]||st.input)},gy=(e,t)=>{["string","number"].includes(typeof t)?e.value=`${t}`:Ij(t)||ii(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof t}"`)},es={};es.text=es.email=es.password=es.number=es.tel=es.url=es.search=es.date=es["datetime-local"]=es.time=es.week=es.month=(e,t)=>(gy(e,t.inputValue),vp(e,e,t),Hj(e,t),e.type=t.input,e);es.file=(e,t)=>(vp(e,e,t),Hj(e,t),e);es.range=(e,t)=>{const r=e.querySelector("input"),n=e.querySelector("output");return gy(r,t.inputValue),r.type=t.input,gy(n,t.inputValue),vp(r,e,t),e};es.select=(e,t)=>{if(e.textContent="",t.inputPlaceholder){const r=document.createElement("option");Di(r,t.inputPlaceholder),r.value="",r.disabled=!0,r.selected=!0,e.appendChild(r)}return vp(e,e,t),e};es.radio=e=>(e.textContent="",e);es.checkbox=(e,t)=>{const r=r2(Vr(),"checkbox");r.value="1",r.checked=!!t.inputValue;const n=e.querySelector("span");return Di(n,t.inputPlaceholder||t.inputLabel),r};es.textarea=(e,t)=>{gy(e,t.inputValue),Hj(e,t),vp(e,e,t);const r=n=>parseInt(window.getComputedStyle(n).marginLeft)+parseInt(window.getComputedStyle(n).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const n=parseInt(window.getComputedStyle(Vr()).width),s=()=>{if(!document.body.contains(e))return;const i=e.offsetWidth+r(e);i>n?Vr().style.width=`${i}px`:wd(Vr(),"width",t.width)};new MutationObserver(s).observe(e,{attributes:!0,attributeFilter:["style"]})}}),e};const jye=(e,t)=>{const r=Lj();r&&(Rj(r),Ti(r,t,"htmlContainer"),t.html?(Mj(t.html,r),Ps(r,"block")):t.text?(r.textContent=t.text,Ps(r,"block")):wa(r),vye(e,t))},Bye=(e,t)=>{const r=SO();r&&(Rj(r),yp(r,t.footer,"block"),t.footer&&Mj(t.footer,r),Ti(r,t,"footer"))},Sye=(e,t)=>{const r=vn.innerParams.get(e),n=l0();if(n){if(r&&t.icon===r.icon){iT(n,t),aT(n,t);return}if(!t.icon&&!t.iconHtml){wa(n);return}if(t.icon&&Object.keys(xy).indexOf(t.icon)===-1){Zd(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${t.icon}"`),wa(n);return}Ps(n),iT(n,t),aT(n,t),Lr(n,t.showClass&&t.showClass.icon)}},aT=(e,t)=>{for(const[r,n]of Object.entries(xy))t.icon!==r&&xo(e,n);Lr(e,t.icon&&xy[t.icon]),Tye(e,t),Fye(),Ti(e,t,"icon")},Fye=()=>{const e=Vr();if(!e)return;const t=window.getComputedStyle(e).getPropertyValue("background-color"),r=e.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let n=0;n<r.length;n++)r[n].style.backgroundColor=t},Eye=`
  <div class="swal2-success-circular-line-left"></div>
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>
  <div class="swal2-success-circular-line-right"></div>
`,kye=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,iT=(e,t)=>{if(!t.icon&&!t.iconHtml)return;let r=e.innerHTML,n="";t.iconHtml?n=oT(t.iconHtml):t.icon==="success"?(n=Eye,r=r.replace(/ style=".*?"/g,"")):t.icon==="error"?n=kye:t.icon&&(n=oT({question:"?",warning:"!",info:"i"}[t.icon])),r.trim()!==n.trim()&&Di(e,n)},Tye=(e,t)=>{if(t.iconColor){e.style.color=t.iconColor,e.style.borderColor=t.iconColor;for(const r of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])nT(e,r,"background-color",t.iconColor);nT(e,".swal2-success-ring","border-color",t.iconColor)}},oT=e=>`<div class="${st["icon-content"]}">${e}</div>`,_ye=(e,t)=>{const r=BO();if(r){if(!t.imageUrl){wa(r);return}Ps(r,""),r.setAttribute("src",t.imageUrl),r.setAttribute("alt",t.imageAlt||""),wd(r,"width",t.imageWidth),wd(r,"height",t.imageHeight),r.className=st.image,Ti(r,t,"image")}};let Vj=!1,_O=0,IO=0,LO=0,UO=0;const Iye=e=>{e.addEventListener("mousedown",yy),document.body.addEventListener("mousemove",vy),e.addEventListener("mouseup",wy),e.addEventListener("touchstart",yy),document.body.addEventListener("touchmove",vy),e.addEventListener("touchend",wy)},Lye=e=>{e.removeEventListener("mousedown",yy),document.body.removeEventListener("mousemove",vy),e.removeEventListener("mouseup",wy),e.removeEventListener("touchstart",yy),document.body.removeEventListener("touchmove",vy),e.removeEventListener("touchend",wy)},yy=e=>{const t=Vr();if(e.target===t||l0().contains(e.target)){Vj=!0;const r=DO(e);_O=r.clientX,IO=r.clientY,LO=parseInt(t.style.insetInlineStart)||0,UO=parseInt(t.style.insetBlockStart)||0,Lr(t,"swal2-dragging")}},vy=e=>{const t=Vr();if(Vj){let{clientX:r,clientY:n}=DO(e);t.style.insetInlineStart=`${LO+(r-_O)}px`,t.style.insetBlockStart=`${UO+(n-IO)}px`}},wy=()=>{const e=Vr();Vj=!1,xo(e,"swal2-dragging")},DO=e=>{let t=0,r=0;return e.type.startsWith("mouse")?(t=e.clientX,r=e.clientY):e.type.startsWith("touch")&&(t=e.touches[0].clientX,r=e.touches[0].clientY),{clientX:t,clientY:r}},Uye=(e,t)=>{const r=oi(),n=Vr();if(!(!r||!n)){if(t.toast){wd(r,"width",t.width),n.style.width="100%";const s=A0();s&&n.insertBefore(s,l0())}else wd(n,"width",t.width);wd(n,"padding",t.padding),t.color&&(n.style.color=t.color),t.background&&(n.style.background=t.background),wa(Zv()),Dye(n,t),t.draggable&&!t.toast?(Lr(n,st.draggable),Iye(n)):(xo(n,st.draggable),Lye(n))}},Dye=(e,t)=>{const r=t.showClass||{};e.className=`${st.popup} ${ei(e)?r.popup:""}`,t.toast?(Lr([document.documentElement,document.body],st["toast-shown"]),Lr(e,st.toast)):Lr(e,st.modal),Ti(e,t,"popup"),typeof t.customClass=="string"&&Lr(e,t.customClass),t.icon&&Lr(e,st[`icon-${t.icon}`])},Pye=(e,t)=>{const r=Uj();if(!r)return;const{progressSteps:n,currentProgressStep:s}=t;if(!n||n.length===0||s===void 0){wa(r);return}Ps(r),r.textContent="",s>=n.length&&ii("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),n.forEach((i,o)=>{const l=Oye(i);if(r.appendChild(l),o===s&&Lr(l,st["active-progress-step"]),o!==n.length-1){const c=Rye(t);r.appendChild(c)}})},Oye=e=>{const t=document.createElement("li");return Lr(t,st["progress-step"]),Di(t,e),t},Rye=e=>{const t=document.createElement("li");return Lr(t,st["progress-step-line"]),e.progressStepsDistance&&wd(t,"width",e.progressStepsDistance),t},Qye=(e,t)=>{const r=jO();r&&(Rj(r),yp(r,t.title||t.titleText,"block"),t.title&&Mj(t.title,r),t.titleText&&(r.innerText=t.titleText),Ti(r,t,"title"))},PO=(e,t)=>{Uye(e,t),mye(e,t),Pye(e,t),Sye(e,t),_ye(e,t),Qye(e,t),hye(e,t),jye(e,t),dye(e,t),Bye(e,t);const r=Vr();typeof t.didRender=="function"&&r&&t.didRender(r),nr.eventEmitter.emit("didRender",r)},Mye=()=>ei(Vr()),OO=()=>{var e;return(e=vl())===null||e===void 0?void 0:e.click()},Hye=()=>{var e;return(e=eu())===null||e===void 0?void 0:e.click()},Vye=()=>{var e;return(e=c0())===null||e===void 0?void 0:e.click()},d0=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),RO=e=>{e.keydownTarget&&e.keydownHandlerAdded&&(e.keydownTarget.removeEventListener("keydown",e.keydownHandler,{capture:e.keydownListenerCapture}),e.keydownHandlerAdded=!1)},$ye=(e,t,r)=>{RO(e),t.toast||(e.keydownHandler=n=>Kye(t,n,r),e.keydownTarget=t.keydownListenerCapture?window:Vr(),e.keydownListenerCapture=t.keydownListenerCapture,e.keydownTarget.addEventListener("keydown",e.keydownHandler,{capture:e.keydownListenerCapture}),e.keydownHandlerAdded=!0)},R5=(e,t)=>{var r;const n=Pj();if(n.length){e=e+t,e===n.length?e=0:e===-1&&(e=n.length-1),n[e].focus();return}(r=Vr())===null||r===void 0||r.focus()},QO=["ArrowRight","ArrowDown"],qye=["ArrowLeft","ArrowUp"],Kye=(e,t,r)=>{e&&(t.isComposing||t.keyCode===229||(e.stopKeydownPropagation&&t.stopPropagation(),t.key==="Enter"?zye(t,e):t.key==="Tab"?Gye(t):[...QO,...qye].includes(t.key)?Wye(t.key):t.key==="Escape"&&Xye(t,e,r)))},zye=(e,t)=>{if(!Jv(t.allowEnterKey))return;const r=r2(Vr(),t.input);if(e.target&&r&&e.target instanceof HTMLElement&&e.target.outerHTML===r.outerHTML){if(["textarea","file"].includes(t.input))return;OO(),e.preventDefault()}},Gye=e=>{const t=e.target,r=Pj();let n=-1;for(let s=0;s<r.length;s++)if(t===r[s]){n=s;break}e.shiftKey?R5(n,-1):R5(n,1),e.stopPropagation(),e.preventDefault()},Wye=e=>{const t=gp(),r=vl(),n=eu(),s=c0();if(!t||!r||!n||!s)return;const i=[r,n,s];if(document.activeElement instanceof HTMLElement&&!i.includes(document.activeElement))return;const o=QO.includes(e)?"nextElementSibling":"previousElementSibling";let l=document.activeElement;if(l){for(let c=0;c<t.children.length;c++){if(l=l[o],!l)return;if(l instanceof HTMLButtonElement&&ei(l))break}l instanceof HTMLButtonElement&&l.focus()}},Xye=(e,t,r)=>{Jv(t.allowEscapeKey)&&(e.preventDefault(),r(d0.esc))};var Mf={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const Yye=()=>{const e=oi();Array.from(document.body.children).forEach(r=>{r.contains(e)||(r.hasAttribute("aria-hidden")&&r.setAttribute("data-previous-aria-hidden",r.getAttribute("aria-hidden")||""),r.setAttribute("aria-hidden","true"))})},MO=()=>{Array.from(document.body.children).forEach(t=>{t.hasAttribute("data-previous-aria-hidden")?(t.setAttribute("aria-hidden",t.getAttribute("data-previous-aria-hidden")||""),t.removeAttribute("data-previous-aria-hidden")):t.removeAttribute("aria-hidden")})},HO=typeof window<"u"&&!!window.GestureEvent,Jye=()=>{if(HO&&!ac(document.body,st.iosfix)){const e=document.body.scrollTop;document.body.style.top=`${e*-1}px`,Lr(document.body,st.iosfix),Zye()}},Zye=()=>{const e=oi();if(!e)return;let t;e.ontouchstart=r=>{t=eve(r)},e.ontouchmove=r=>{t&&(r.preventDefault(),r.stopPropagation())}},eve=e=>{const t=e.target,r=oi(),n=Lj();return!r||!n||tve(e)||rve(e)?!1:t===r||!sT(r)&&t instanceof HTMLElement&&t.tagName!=="INPUT"&&t.tagName!=="TEXTAREA"&&!(sT(n)&&n.contains(t))},tve=e=>e.touches&&e.touches.length&&e.touches[0].touchType==="stylus",rve=e=>e.touches&&e.touches.length>1,nve=()=>{if(ac(document.body,st.iosfix)){const e=parseInt(document.body.style.top,10);xo(document.body,st.iosfix),document.body.style.top="",document.body.scrollTop=e*-1}},sve=()=>{const e=document.createElement("div");e.className=st["scrollbar-measure"],document.body.appendChild(e);const t=e.getBoundingClientRect().width-e.clientWidth;return document.body.removeChild(e),t};let Cf=null;const ave=e=>{Cf===null&&(document.body.scrollHeight>window.innerHeight||e==="scroll")&&(Cf=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${Cf+sve()}px`)},ive=()=>{Cf!==null&&(document.body.style.paddingRight=`${Cf}px`,Cf=null)};function VO(e,t,r,n){t2()?lT(e,n):($1e(r).then(()=>lT(e,n)),RO(nr)),HO?(t.setAttribute("style","display:none !important"),t.removeAttribute("class"),t.innerHTML=""):t.remove(),Oj()&&(ive(),nve(),MO()),ove()}function ove(){xo([document.documentElement,document.body],[st.shown,st["height-auto"],st["no-backdrop"],st["toast-shown"]])}function nA(e){e=cve(e);const t=Mf.swalPromiseResolve.get(this),r=lve(this);this.isAwaitingPromise?e.isDismissed||(wp(this),t(e)):r&&t(e)}const lve=e=>{const t=Vr();if(!t)return!1;const r=vn.innerParams.get(e);if(!r||ac(t,r.hideClass.popup))return!1;xo(t,r.showClass.popup),Lr(t,r.hideClass.popup);const n=oi();return xo(n,r.showClass.backdrop),Lr(n,r.hideClass.backdrop),Ave(e,t,r),!0};function $O(e){const t=Mf.swalPromiseReject.get(this);wp(this),t&&t(e)}const wp=e=>{e.isAwaitingPromise&&(delete e.isAwaitingPromise,vn.innerParams.get(e)||e._destroy())},cve=e=>typeof e>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},e),Ave=(e,t,r)=>{var n;const s=oi(),i=kO(t);typeof r.willClose=="function"&&r.willClose(t),(n=nr.eventEmitter)===null||n===void 0||n.emit("willClose",t),i?dve(e,t,s,r.returnFocus,r.didClose):VO(e,s,r.returnFocus,r.didClose)},dve=(e,t,r,n,s)=>{nr.swalCloseEventFinishedCallback=VO.bind(null,e,r,n,s);const i=function(o){if(o.target===t){var l;(l=nr.swalCloseEventFinishedCallback)===null||l===void 0||l.call(nr),delete nr.swalCloseEventFinishedCallback,t.removeEventListener("animationend",i),t.removeEventListener("transitionend",i)}};t.addEventListener("animationend",i),t.addEventListener("transitionend",i)},lT=(e,t)=>{setTimeout(()=>{var r;typeof t=="function"&&t.bind(e.params)(),(r=nr.eventEmitter)===null||r===void 0||r.emit("didClose"),e._destroy&&e._destroy()})},Hf=e=>{let t=Vr();if(t||new vi,t=Vr(),!t)return;const r=A0();t2()?wa(l0()):uve(t,e),Ps(r),t.setAttribute("data-loading","true"),t.setAttribute("aria-busy","true"),t.focus()},uve=(e,t)=>{const r=gp(),n=A0();!r||!n||(!t&&ei(vl())&&(t=vl()),Ps(r),t&&(wa(t),n.setAttribute("data-button-to-replace",t.className),r.insertBefore(n,t)),Lr([e,r],st.loading))},fve=(e,t)=>{t.input==="select"||t.input==="radio"?gve(e,t):["text","email","number","tel","textarea"].some(r=>r===t.input)&&(_j(t.inputValue)||Ij(t.inputValue))&&(Hf(vl()),yve(e,t))},hve=(e,t)=>{const r=e.getInput();if(!r)return null;switch(t.input){case"checkbox":return mve(r);case"radio":return pve(r);case"file":return xve(r);default:return t.inputAutoTrim?r.value.trim():r.value}},mve=e=>e.checked?1:0,pve=e=>e.checked?e.value:null,xve=e=>e.files&&e.files.length?e.getAttribute("multiple")!==null?e.files:e.files[0]:null,gve=(e,t)=>{const r=Vr();if(!r)return;const n=s=>{t.input==="select"?vve(r,by(s),t):t.input==="radio"&&wve(r,by(s),t)};_j(t.inputOptions)||Ij(t.inputOptions)?(Hf(vl()),pp(t.inputOptions).then(s=>{e.hideLoading(),n(s)})):typeof t.inputOptions=="object"?n(t.inputOptions):Zd(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof t.inputOptions}`)},yve=(e,t)=>{const r=e.getInput();r&&(wa(r),pp(t.inputValue).then(n=>{r.value=t.input==="number"?`${parseFloat(n)||0}`:`${n}`,Ps(r),r.focus(),e.hideLoading()}).catch(n=>{Zd(`Error in inputValue promise: ${n}`),r.value="",Ps(r),r.focus(),e.hideLoading()}))};function vve(e,t,r){const n=rA(e,st.select);if(!n)return;const s=(i,o,l)=>{const c=document.createElement("option");c.value=l,Di(c,o),c.selected=qO(l,r.inputValue),i.appendChild(c)};t.forEach(i=>{const o=i[0],l=i[1];if(Array.isArray(l)){const c=document.createElement("optgroup");c.label=o,c.disabled=!1,n.appendChild(c),l.forEach(A=>s(c,A[1],A[0]))}else s(n,l,o)}),n.focus()}function wve(e,t,r){const n=rA(e,st.radio);if(!n)return;t.forEach(i=>{const o=i[0],l=i[1],c=document.createElement("input"),A=document.createElement("label");c.type="radio",c.name=st.radio,c.value=o,qO(o,r.inputValue)&&(c.checked=!0);const d=document.createElement("span");Di(d,l),d.className=st.label,A.appendChild(c),A.appendChild(d),n.appendChild(A)});const s=n.querySelectorAll("input");s.length&&s[0].focus()}const by=e=>{const t=[];return e instanceof Map?e.forEach((r,n)=>{let s=r;typeof s=="object"&&(s=by(s)),t.push([n,s])}):Object.keys(e).forEach(r=>{let n=e[r];typeof n=="object"&&(n=by(n)),t.push([r,n])}),t},qO=(e,t)=>!!t&&t.toString()===e.toString(),bve=e=>{const t=vn.innerParams.get(e);e.disableButtons(),t.input?KO(e,"confirm"):qj(e,!0)},Nve=e=>{const t=vn.innerParams.get(e);e.disableButtons(),t.returnInputValueOnDeny?KO(e,"deny"):$j(e,!1)},Cve=(e,t)=>{e.disableButtons(),t(d0.cancel)},KO=(e,t)=>{const r=vn.innerParams.get(e);if(!r.input){Zd(`The "input" parameter is needed to be set when using returnInputValueOn${Tj(t)}`);return}const n=e.getInput(),s=hve(e,r);r.inputValidator?jve(e,s,t):n&&!n.checkValidity()?(e.enableButtons(),e.showValidationMessage(r.validationMessage||n.validationMessage)):t==="deny"?$j(e,s):qj(e,s)},jve=(e,t,r)=>{const n=vn.innerParams.get(e);e.disableInput(),Promise.resolve().then(()=>pp(n.inputValidator(t,n.validationMessage))).then(i=>{e.enableButtons(),e.enableInput(),i?e.showValidationMessage(i):r==="deny"?$j(e,t):qj(e,t)})},$j=(e,t)=>{const r=vn.innerParams.get(e||void 0);r.showLoaderOnDeny&&Hf(eu()),r.preDeny?(e.isAwaitingPromise=!0,Promise.resolve().then(()=>pp(r.preDeny(t,r.validationMessage))).then(s=>{s===!1?(e.hideLoading(),wp(e)):e.close({isDenied:!0,value:typeof s>"u"?t:s})}).catch(s=>zO(e||void 0,s))):e.close({isDenied:!0,value:t})},cT=(e,t)=>{e.close({isConfirmed:!0,value:t})},zO=(e,t)=>{e.rejectPromise(t)},qj=(e,t)=>{const r=vn.innerParams.get(e||void 0);r.showLoaderOnConfirm&&Hf(),r.preConfirm?(e.resetValidationMessage(),e.isAwaitingPromise=!0,Promise.resolve().then(()=>pp(r.preConfirm(t,r.validationMessage))).then(s=>{ei(Zv())||s===!1?(e.hideLoading(),wp(e)):cT(e,typeof s>"u"?t:s)}).catch(s=>zO(e||void 0,s))):cT(e,t)};function Ny(){const e=vn.innerParams.get(this);if(!e)return;const t=vn.domCache.get(this);wa(t.loader),t2()?e.icon&&Ps(l0()):Bve(t),xo([t.popup,t.actions],st.loading),t.popup.removeAttribute("aria-busy"),t.popup.removeAttribute("data-loading"),t.confirmButton.disabled=!1,t.denyButton.disabled=!1,t.cancelButton.disabled=!1}const Bve=e=>{const t=e.popup.getElementsByClassName(e.loader.getAttribute("data-button-to-replace"));t.length?Ps(t[0],"inline-block"):Z1e()&&wa(e.actions)};function GO(){const e=vn.innerParams.get(this),t=vn.domCache.get(this);return t?r2(t.popup,e.input):null}function WO(e,t,r){const n=vn.domCache.get(e);t.forEach(s=>{n[s].disabled=r})}function XO(e,t){const r=Vr();if(!(!r||!e))if(e.type==="radio"){const n=r.querySelectorAll(`[name="${st.radio}"]`);for(let s=0;s<n.length;s++)n[s].disabled=t}else e.disabled=t}function YO(){WO(this,["confirmButton","denyButton","cancelButton"],!1)}function JO(){WO(this,["confirmButton","denyButton","cancelButton"],!0)}function ZO(){XO(this.getInput(),!1)}function e7(){XO(this.getInput(),!0)}function t7(e){const t=vn.domCache.get(this),r=vn.innerParams.get(this);Di(t.validationMessage,e),t.validationMessage.className=st["validation-message"],r.customClass&&r.customClass.validationMessage&&Lr(t.validationMessage,r.customClass.validationMessage),Ps(t.validationMessage);const n=this.getInput();n&&(n.setAttribute("aria-invalid","true"),n.setAttribute("aria-describedby",st["validation-message"]),FO(n),Lr(n,st.inputerror))}function r7(){const e=vn.domCache.get(this);e.validationMessage&&wa(e.validationMessage);const t=this.getInput();t&&(t.removeAttribute("aria-invalid"),t.removeAttribute("aria-describedby"),xo(t,st.inputerror))}const jf={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0},Sve=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","willClose"],Fve={allowEnterKey:void 0},Eve=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],n7=e=>Object.prototype.hasOwnProperty.call(jf,e),s7=e=>Sve.indexOf(e)!==-1,a7=e=>Fve[e],kve=e=>{n7(e)||ii(`Unknown parameter "${e}"`)},Tve=e=>{Eve.includes(e)&&ii(`The parameter "${e}" is incompatible with toasts`)},_ve=e=>{const t=a7(e);t&&CO(e,t)},Ive=e=>{e.backdrop===!1&&e.allowOutsideClick&&ii('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`');for(const t in e)kve(t),e.toast&&Tve(t),_ve(t)};function i7(e){const t=Vr(),r=vn.innerParams.get(this);if(!t||ac(t,r.hideClass.popup)){ii("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const n=Lve(e),s=Object.assign({},r,n);PO(this,s),vn.innerParams.set(this,s),Object.defineProperties(this,{params:{value:Object.assign({},this.params,e),writable:!1,enumerable:!0}})}const Lve=e=>{const t={};return Object.keys(e).forEach(r=>{s7(r)?t[r]=e[r]:ii(`Invalid parameter to update: ${r}`)}),t};function o7(){const e=vn.domCache.get(this),t=vn.innerParams.get(this);if(!t){l7(this);return}e.popup&&nr.swalCloseEventFinishedCallback&&(nr.swalCloseEventFinishedCallback(),delete nr.swalCloseEventFinishedCallback),typeof t.didDestroy=="function"&&t.didDestroy(),nr.eventEmitter.emit("didDestroy"),Uve(this)}const Uve=e=>{l7(e),delete e.params,delete nr.keydownHandler,delete nr.keydownTarget,delete nr.currentInstance},l7=e=>{e.isAwaitingPromise?(bb(vn,e),e.isAwaitingPromise=!0):(bb(Mf,e),bb(vn,e),delete e.isAwaitingPromise,delete e.disableButtons,delete e.enableButtons,delete e.getInput,delete e.disableInput,delete e.enableInput,delete e.hideLoading,delete e.disableLoading,delete e.showValidationMessage,delete e.resetValidationMessage,delete e.close,delete e.closePopup,delete e.closeModal,delete e.closeToast,delete e.rejectPromise,delete e.update,delete e._destroy)},bb=(e,t)=>{for(const r in e)e[r].delete(t)};var Dve=Object.freeze({__proto__:null,_destroy:o7,close:nA,closeModal:nA,closePopup:nA,closeToast:nA,disableButtons:JO,disableInput:e7,disableLoading:Ny,enableButtons:YO,enableInput:ZO,getInput:GO,handleAwaitingPromise:wp,hideLoading:Ny,rejectPromise:$O,resetValidationMessage:r7,showValidationMessage:t7,update:i7});const Pve=(e,t,r)=>{e.toast?Ove(e,t,r):(Qve(t),Mve(t),Hve(e,t,r))},Ove=(e,t,r)=>{t.popup.onclick=()=>{e&&(Rve(e)||e.timer||e.input)||r(d0.close)}},Rve=e=>!!(e.showConfirmButton||e.showDenyButton||e.showCancelButton||e.showCloseButton);let Cy=!1;const Qve=e=>{e.popup.onmousedown=()=>{e.container.onmouseup=function(t){e.container.onmouseup=()=>{},t.target===e.container&&(Cy=!0)}}},Mve=e=>{e.container.onmousedown=t=>{t.target===e.container&&t.preventDefault(),e.popup.onmouseup=function(r){e.popup.onmouseup=()=>{},(r.target===e.popup||r.target instanceof HTMLElement&&e.popup.contains(r.target))&&(Cy=!0)}}},Hve=(e,t,r)=>{t.container.onclick=n=>{if(Cy){Cy=!1;return}n.target===t.container&&Jv(e.allowOutsideClick)&&r(d0.backdrop)}},Vve=e=>typeof e=="object"&&e.jquery,AT=e=>e instanceof Element||Vve(e),$ve=e=>{const t={};return typeof e[0]=="object"&&!AT(e[0])?Object.assign(t,e[0]):["title","html","icon"].forEach((r,n)=>{const s=e[n];typeof s=="string"||AT(s)?t[r]=s:s!==void 0&&Zd(`Unexpected type of ${r}! Expected "string" or "Element", got ${typeof s}`)}),t};function qve(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new this(...t)}function Kve(e){class t extends this{_main(n,s){return super._main(n,Object.assign({},e,s))}}return t}const zve=()=>nr.timeout&&nr.timeout.getTimerLeft(),c7=()=>{if(nr.timeout)return eye(),nr.timeout.stop()},A7=()=>{if(nr.timeout){const e=nr.timeout.start();return Qj(e),e}},Gve=()=>{const e=nr.timeout;return e&&(e.running?c7():A7())},Wve=e=>{if(nr.timeout){const t=nr.timeout.increase(e);return Qj(t,!0),t}},Xve=()=>!!(nr.timeout&&nr.timeout.isRunning());let dT=!1;const Q5={};function Yve(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"data-swal-template";Q5[e]=this,dT||(document.body.addEventListener("click",Jve),dT=!0)}const Jve=e=>{for(let t=e.target;t&&t!==document;t=t.parentNode)for(const r in Q5){const n=t.getAttribute(r);if(n){Q5[r].fire({template:n});return}}};class Zve{constructor(){this.events={}}_getHandlersByEventName(t){return typeof this.events[t]>"u"&&(this.events[t]=[]),this.events[t]}on(t,r){const n=this._getHandlersByEventName(t);n.includes(r)||n.push(r)}once(t,r){var n=this;const s=function(){n.removeListener(t,s);for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];r.apply(n,o)};this.on(t,s)}emit(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];this._getHandlersByEventName(t).forEach(i=>{try{i.apply(this,n)}catch(o){console.error(o)}})}removeListener(t,r){const n=this._getHandlersByEventName(t),s=n.indexOf(r);s>-1&&n.splice(s,1)}removeAllListeners(t){this.events[t]!==void 0&&(this.events[t].length=0)}reset(){this.events={}}}nr.eventEmitter=new Zve;const e2e=(e,t)=>{nr.eventEmitter.on(e,t)},t2e=(e,t)=>{nr.eventEmitter.once(e,t)},r2e=(e,t)=>{if(!e){nr.eventEmitter.reset();return}t?nr.eventEmitter.removeListener(e,t):nr.eventEmitter.removeAllListeners(e)};var n2e=Object.freeze({__proto__:null,argsToParams:$ve,bindClickHandler:Yve,clickCancel:Vye,clickConfirm:OO,clickDeny:Hye,enableLoading:Hf,fire:qve,getActions:gp,getCancelButton:c0,getCloseButton:Dj,getConfirmButton:vl,getContainer:oi,getDenyButton:eu,getFocusableElements:Pj,getFooter:SO,getHtmlContainer:Lj,getIcon:l0,getIconContent:G1e,getImage:BO,getInputLabel:W1e,getLoader:A0,getPopup:Vr,getProgressSteps:Uj,getTimerLeft:zve,getTimerProgressBar:e2,getTitle:jO,getValidationMessage:Zv,increaseTimer:Wve,isDeprecatedParameter:a7,isLoading:Y1e,isTimerRunning:Xve,isUpdatableParameter:s7,isValidParameter:n7,isVisible:Mye,mixin:Kve,off:r2e,on:e2e,once:t2e,resumeTimer:A7,showLoading:Hf,stopTimer:c7,toggleTimer:Gve});class s2e{constructor(t,r){this.callback=t,this.remaining=r,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(t){const r=this.running;return r&&this.stop(),this.remaining+=t,r&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const d7=["swal-title","swal-html","swal-footer"],a2e=e=>{const t=typeof e.template=="string"?document.querySelector(e.template):e.template;if(!t)return{};const r=t.content;return f2e(r),Object.assign(i2e(r),o2e(r),l2e(r),c2e(r),A2e(r),d2e(r),u2e(r,d7))},i2e=e=>{const t={};return Array.from(e.querySelectorAll("swal-param")).forEach(n=>{Pd(n,["name","value"]);const s=n.getAttribute("name"),i=n.getAttribute("value");!s||!i||(typeof jf[s]=="boolean"?t[s]=i!=="false":typeof jf[s]=="object"?t[s]=JSON.parse(i):t[s]=i)}),t},o2e=e=>{const t={};return Array.from(e.querySelectorAll("swal-function-param")).forEach(n=>{const s=n.getAttribute("name"),i=n.getAttribute("value");!s||!i||(t[s]=new Function(`return ${i}`)())}),t},l2e=e=>{const t={};return Array.from(e.querySelectorAll("swal-button")).forEach(n=>{Pd(n,["type","color","aria-label"]);const s=n.getAttribute("type");!s||!["confirm","cancel","deny"].includes(s)||(t[`${s}ButtonText`]=n.innerHTML,t[`show${Tj(s)}Button`]=!0,n.hasAttribute("color")&&(t[`${s}ButtonColor`]=n.getAttribute("color")),n.hasAttribute("aria-label")&&(t[`${s}ButtonAriaLabel`]=n.getAttribute("aria-label")))}),t},c2e=e=>{const t={},r=e.querySelector("swal-image");return r&&(Pd(r,["src","width","height","alt"]),r.hasAttribute("src")&&(t.imageUrl=r.getAttribute("src")||void 0),r.hasAttribute("width")&&(t.imageWidth=r.getAttribute("width")||void 0),r.hasAttribute("height")&&(t.imageHeight=r.getAttribute("height")||void 0),r.hasAttribute("alt")&&(t.imageAlt=r.getAttribute("alt")||void 0)),t},A2e=e=>{const t={},r=e.querySelector("swal-icon");return r&&(Pd(r,["type","color"]),r.hasAttribute("type")&&(t.icon=r.getAttribute("type")),r.hasAttribute("color")&&(t.iconColor=r.getAttribute("color")),t.iconHtml=r.innerHTML),t},d2e=e=>{const t={},r=e.querySelector("swal-input");r&&(Pd(r,["type","label","placeholder","value"]),t.input=r.getAttribute("type")||"text",r.hasAttribute("label")&&(t.inputLabel=r.getAttribute("label")),r.hasAttribute("placeholder")&&(t.inputPlaceholder=r.getAttribute("placeholder")),r.hasAttribute("value")&&(t.inputValue=r.getAttribute("value")));const n=Array.from(e.querySelectorAll("swal-input-option"));return n.length&&(t.inputOptions={},n.forEach(s=>{Pd(s,["value"]);const i=s.getAttribute("value");if(!i)return;const o=s.innerHTML;t.inputOptions[i]=o})),t},u2e=(e,t)=>{const r={};for(const n in t){const s=t[n],i=e.querySelector(s);i&&(Pd(i,[]),r[s.replace(/^swal-/,"")]=i.innerHTML.trim())}return r},f2e=e=>{const t=d7.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(e.children).forEach(r=>{const n=r.tagName.toLowerCase();t.includes(n)||ii(`Unrecognized element <${n}>`)})},Pd=(e,t)=>{Array.from(e.attributes).forEach(r=>{t.indexOf(r.name)===-1&&ii([`Unrecognized attribute "${r.name}" on <${e.tagName.toLowerCase()}>.`,`${t.length?`Allowed attributes are: ${t.join(", ")}`:"To set the value, use HTML within the element."}`])})},u7=10,h2e=e=>{const t=oi(),r=Vr();typeof e.willOpen=="function"&&e.willOpen(r),nr.eventEmitter.emit("willOpen",r);const s=window.getComputedStyle(document.body).overflowY;x2e(t,r,e),setTimeout(()=>{m2e(t,r)},u7),Oj()&&(p2e(t,e.scrollbarPadding,s),Yye()),!t2()&&!nr.previousActiveElement&&(nr.previousActiveElement=document.activeElement),typeof e.didOpen=="function"&&setTimeout(()=>e.didOpen(r)),nr.eventEmitter.emit("didOpen",r),xo(t,st["no-transition"])},jy=e=>{const t=Vr();if(e.target!==t)return;const r=oi();t.removeEventListener("animationend",jy),t.removeEventListener("transitionend",jy),r.style.overflowY="auto"},m2e=(e,t)=>{kO(t)?(e.style.overflowY="hidden",t.addEventListener("animationend",jy),t.addEventListener("transitionend",jy)):e.style.overflowY="auto"},p2e=(e,t,r)=>{Jye(),t&&r!=="hidden"&&ave(r),setTimeout(()=>{e.scrollTop=0})},x2e=(e,t,r)=>{Lr(e,r.showClass.backdrop),r.animation?(t.style.setProperty("opacity","0","important"),Ps(t,"grid"),setTimeout(()=>{Lr(t,r.showClass.popup),t.style.removeProperty("opacity")},u7)):Ps(t,"grid"),Lr([document.documentElement,document.body],st.shown),r.heightAuto&&r.backdrop&&!r.toast&&Lr([document.documentElement,document.body],st["height-auto"])};var uT={email:(e,t)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(e)?Promise.resolve():Promise.resolve(t||"Invalid email address"),url:(e,t)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(e)?Promise.resolve():Promise.resolve(t||"Invalid URL")};function g2e(e){e.inputValidator||(e.input==="email"&&(e.inputValidator=uT.email),e.input==="url"&&(e.inputValidator=uT.url))}function y2e(e){(!e.target||typeof e.target=="string"&&!document.querySelector(e.target)||typeof e.target!="string"&&!e.target.appendChild)&&(ii('Target parameter is not valid, defaulting to "body"'),e.target="body")}function v2e(e){g2e(e),e.showLoaderOnConfirm&&!e.preConfirm&&ii(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),y2e(e),typeof e.title=="string"&&(e.title=e.title.split(`
`).join("<br />")),lye(e)}let cl;var yg=new WeakMap;class ls{constructor(){if(Q1e(this,yg,void 0),typeof window>"u")return;cl=this;for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];const s=Object.freeze(this.constructor.argsToParams(r));this.params=s,this.isAwaitingPromise=!1,M1e(yg,this,this._main(cl.params))}_main(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Ive(Object.assign({},r,t)),nr.currentInstance){const i=Mf.swalPromiseResolve.get(nr.currentInstance),{isAwaitingPromise:o}=nr.currentInstance;nr.currentInstance._destroy(),o||i({isDismissed:!0}),Oj()&&MO()}nr.currentInstance=cl;const n=b2e(t,r);v2e(n),Object.freeze(n),nr.timeout&&(nr.timeout.stop(),delete nr.timeout),clearTimeout(nr.restoreFocusTimeout);const s=N2e(cl);return PO(cl,n),vn.innerParams.set(cl,n),w2e(cl,s,n)}then(t){return tT(yg,this).then(t)}finally(t){return tT(yg,this).finally(t)}}const w2e=(e,t,r)=>new Promise((n,s)=>{const i=o=>{e.close({isDismissed:!0,dismiss:o})};Mf.swalPromiseResolve.set(e,n),Mf.swalPromiseReject.set(e,s),t.confirmButton.onclick=()=>{bve(e)},t.denyButton.onclick=()=>{Nve(e)},t.cancelButton.onclick=()=>{Cve(e,i)},t.closeButton.onclick=()=>{i(d0.close)},Pve(r,t,i),$ye(nr,r,i),fve(e,r),h2e(r),C2e(nr,r,i),j2e(t,r),setTimeout(()=>{t.container.scrollTop=0})}),b2e=(e,t)=>{const r=a2e(e),n=Object.assign({},jf,t,r,e);return n.showClass=Object.assign({},jf.showClass,n.showClass),n.hideClass=Object.assign({},jf.hideClass,n.hideClass),n.animation===!1&&(n.showClass={backdrop:"swal2-noanimation"},n.hideClass={}),n},N2e=e=>{const t={popup:Vr(),container:oi(),actions:gp(),confirmButton:vl(),denyButton:eu(),cancelButton:c0(),loader:A0(),closeButton:Dj(),validationMessage:Zv(),progressSteps:Uj()};return vn.domCache.set(e,t),t},C2e=(e,t,r)=>{const n=e2();wa(n),t.timer&&(e.timeout=new s2e(()=>{r("timer"),delete e.timeout},t.timer),t.timerProgressBar&&(Ps(n),Ti(n,t,"timerProgressBar"),setTimeout(()=>{e.timeout&&e.timeout.running&&Qj(t.timer)})))},j2e=(e,t)=>{if(!t.toast){if(!Jv(t.allowEnterKey)){CO("allowEnterKey"),F2e();return}B2e(e)||S2e(e,t)||R5(-1,1)}},B2e=e=>{const t=Array.from(e.popup.querySelectorAll("[autofocus]"));for(const r of t)if(r instanceof HTMLElement&&ei(r))return r.focus(),!0;return!1},S2e=(e,t)=>t.focusDeny&&ei(e.denyButton)?(e.denyButton.focus(),!0):t.focusCancel&&ei(e.cancelButton)?(e.cancelButton.focus(),!0):t.focusConfirm&&ei(e.confirmButton)?(e.confirmButton.focus(),!0):!1,F2e=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){const e=new Date,t=localStorage.getItem("swal-initiation");t?(e.getTime()-Date.parse(t))/(1e3*60*60*24)>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const r=document.createElement("audio");r.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",r.loop=!0,document.body.appendChild(r),setTimeout(()=>{r.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${e}`)}ls.prototype.disableButtons=JO;ls.prototype.enableButtons=YO;ls.prototype.getInput=GO;ls.prototype.disableInput=e7;ls.prototype.enableInput=ZO;ls.prototype.hideLoading=Ny;ls.prototype.disableLoading=Ny;ls.prototype.showValidationMessage=t7;ls.prototype.resetValidationMessage=r7;ls.prototype.close=nA;ls.prototype.closePopup=nA;ls.prototype.closeModal=nA;ls.prototype.closeToast=nA;ls.prototype.rejectPromise=$O;ls.prototype.update=i7;ls.prototype._destroy=o7;Object.assign(ls,n2e);Object.keys(Dve).forEach(e=>{ls[e]=function(){return cl&&cl[e]?cl[e](...arguments):null}});ls.DismissReason=d0;ls.version="11.15.10";const vi=ls;vi.default=vi;typeof document<"u"&&function(e,t){var r=e.createElement("style");if(e.getElementsByTagName("head")[0].appendChild(r),r.styleSheet)r.styleSheet.disabled||(r.styleSheet.cssText=t);else try{r.innerHTML=t}catch{r.innerText=t}}(document,'body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px rgba(0,0,0,.4)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:.625em;overflow-x:hidden;transition:background-color .1s;-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:rgba(0,0,0,.4)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:32em;max-width:100%;padding:0 0 1.25em;border:none;border-radius:5px;background:#fff;color:#545454;font-family:inherit;font-size:1rem}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:.8em 1em 0;color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1))}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2))}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:box-shadow .1s;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border:0;border-radius:.25em;background:initial;background-color:#7066e0;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):focus-visible{box-shadow:0 0 0 3px rgba(112,102,224,.5)}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border:0;border-radius:.25em;background:initial;background-color:#dc3741;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):focus-visible{box-shadow:0 0 0 3px rgba(220,55,65,.5)}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border:0;border-radius:.25em;background:initial;background-color:#6e7881;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):focus-visible{box-shadow:0 0 0 3px rgba(110,120,129,.5)}div:where(.swal2-container) button:where(.swal2-styled).swal2-default-outline:focus-visible{box-shadow:0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid #eee;color:inherit;font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:5px;border-bottom-left-radius:5px}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:color .1s,box-shadow .1s;border:none;border-radius:5px;background:rgba(0,0,0,0);color:#ccc;font-family:monospace;font-size:2.5em;cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:none;background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:inset 0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:1em 1.6em .3em;overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:border-color .1s,box-shadow .1s;border:1px solid #d9d9d9;border-radius:.1875em;background:rgba(0,0,0,0);box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(0,0,0,0);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:#fff}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:rgba(0,0,0,0);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:rgba(0,0,0,0);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:#fff;color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:#f0f0f0;color:#666;font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:#add8e6;color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:#add8e6}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:swal2-show .3s}.swal2-hide{animation:swal2-hide .15s forwards}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;background:#fff;box-shadow:0 0 1px rgba(0,0,0,.075),0 1px 2px rgba(0,0,0,.075),1px 2px 4px rgba(0,0,0,.075),1px 3px 8px rgba(0,0,0,.075),2px 4px 16px rgba(0,0,0,.075);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}.swal2-toast.swal2-show{animation:swal2-toast-show .5s}.swal2-toast.swal2-hide{animation:swal2-toast-hide .1s forwards}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}');const E2e=({isOpen:e,onClose:t,title:r,description:n})=>e?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg mx-4 relative",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b border-gray-200",children:[a.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-gray-800 line-clamp-1",children:r}),a.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 transition-colors",children:a.jsx(_r,{size:24})})]}),a.jsx("div",{className:"p-4 sm:p-6",children:a.jsx("p",{className:"text-gray-700 text-sm sm:text-base leading-relaxed whitespace-pre-wrap",children:n})}),a.jsx("div",{className:"flex justify-end p-4 sm:p-6 bg-gray-50 border-t",children:a.jsx("button",{onClick:t,className:"px-3 py-1.5 sm:px-4 sm:py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors text-sm sm:text-base",children:"Close"})})]})}):null,k2e=({isOpen:e,onClose:t,onSubmit:r})=>{const[n,s]=C.useState({question:"",description:"",expectedAnswer:!0}),i=()=>{n.question.trim()&&(r({question:n.question,status:!1,description:n.description,expectedAnswer:n.expectedAnswer}),s({question:"",description:"",expectedAnswer:!0})),t()};return e?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl",children:[a.jsx("div",{className:"p-4 sm:p-6 border-b border-gray-200",children:a.jsxs("h2",{className:"text-lg sm:text-xl font-bold text-gray-800 flex items-center",children:[a.jsx(yn,{className:"mr-2 sm:mr-3 text-primary",size:18}),"Add Legal Question"]})}),a.jsxs("div",{className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-base sm:text-lg font-medium text-gray-700 mb-1 sm:mb-2",children:["Question ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",value:n.question,onChange:o=>s(l=>({...l,question:o.target.value})),placeholder:"Enter your legal question",className:"w-full px-3 py-2 sm:px-4 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-base sm:text-lg font-medium text-gray-700 mb-1 sm:mb-2",children:"Description"}),a.jsx("textarea",{value:n.description,onChange:o=>s(l=>({...l,description:o.target.value})),placeholder:"Provide additional context or explanation",rows:4,className:"w-full px-3 py-2 sm:px-4 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-base sm:text-lg font-medium text-gray-700 mb-1 sm:mb-2",children:"Expected Answer"}),a.jsxs("div",{className:"flex items-center cursor-pointer",onClick:()=>s(o=>({...o,expectedAnswer:!o.expectedAnswer})),children:[n.expectedAnswer?a.jsx(G_,{className:"text-primary w-10 h-6 sm:w-14 sm:h-8"}):a.jsx(z_,{className:"text-gray-400 w-10 h-6 sm:w-14 sm:h-8"}),a.jsx("span",{className:"ml-2 sm:ml-3 text-sm sm:text-lg",children:n.expectedAnswer?"Yes":"No"})]})]})]}),a.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:py-4 flex justify-end space-x-3 sm:space-x-4 border-t",children:[a.jsx("button",{onClick:t,className:"px-4 py-2 sm:px-6 sm:py-3 text-sm sm:text-base font-medium text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),a.jsx("button",{onClick:i,className:"px-4 py-2 sm:px-6 sm:py-3 text-sm sm:text-base font-medium text-white bg-primary rounded-lg hover:bg-primary/90",children:"Submit"})]})]})}):null},T2e=()=>{const e=localStorage.getItem("userId"),t=localStorage.getItem("role"),[r,n]=C.useState([]),[s,i]=C.useState(!1),[o,l]=C.useState({isOpen:!1,title:"",description:""}),[c,A]=C.useState(!0),[d,u]=C.useState(!1);C.useEffect(()=>{const w=()=>{u(window.innerWidth<768)};return w(),window.addEventListener("resize",w),()=>window.removeEventListener("resize",w)},[]);const f=async()=>{var w;try{A(!0);let B;t==="Admin"?B=await F$():B=await B$(e,t),(B==null?void 0:B.status)===200&&((w=B==null?void 0:B.data)!=null&&w.data)?n(B.data.data):n([])}catch(B){console.error("Error fetching questions:",B),Ie.error("Failed to fetch questions"),n([])}finally{A(!1)}};C.useEffect(()=>{f()},[e]);const h=async w=>{try{n(T=>[...T,w]);const B=await j$(e,w,t);(B==null?void 0:B.status)===200&&Ie.success("Question added successfully")}catch(B){console.error("Error adding question:",B),Ie.error(`Error: ${B.message||"Something went wrong!"}`),f()}},x=async w=>{if((await vi.fire({title:"Are you sure?",text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc2626",cancelButtonColor:"#6b7280",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel"})).isConfirmed)try{const T=await S$(w);(T==null?void 0:T.status)===200&&(n(r.filter(_=>_._id!==w)),Ie.success("Question deleted successfully"))}catch(T){console.error("Error deleting question:",T),Ie.error("Failed to delete question")}},m=async w=>{const T=r.find(j=>j._id===w).status?"disable":"enable";(await vi.fire({title:"Are you sure?",text:`Do you want to ${T} this question?`,icon:"warning",showCancelButton:!0,confirmButtonText:`Yes, ${T} it!`,cancelButtonText:"No, cancel!"})).isConfirmed?(n(r.map(E=>E._id===w?{...E,status:!E.status}:E)),(await E$(w)).status===200?vi.fire("Updated!",`The question has been ${T}d.`,"success"):(vi.fire("Error!",`Failed to ${T} the question.`,"error"),f())):vi.fire("Cancelled","The status update was cancelled.","info")},g=(w,B)=>{l({isOpen:!0,title:w,description:B})},p=w=>a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow mb-4",children:[a.jsx("div",{className:"flex justify-between items-start mb-3",children:a.jsxs("div",{className:"flex-1 pr-2",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:w.question}),w.description&&a.jsx("button",{onClick:()=>g(w.question,w.description),className:"text-gray-400 hover:text-primary transition-colors",children:a.jsx(Fi,{size:16})})]})}),a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-xs font-medium text-gray-500 mr-2",children:"Expected:"}),a.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${w.expectedAnswer?"bg-blue-50 text-blue-700":"bg-orange-50 text-orange-700"}`,children:w.expectedAnswer?"Yes":"No"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-xs font-medium text-gray-500 mr-2",children:"Status:"}),a.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${w.status?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:w.status?"Enabled":"Disabled"})]})]}),a.jsxs("div",{className:"flex justify-end space-x-2",children:[a.jsx("button",{onClick:()=>m(w._id),className:`inline-flex items-center px-2 py-1 rounded-lg text-xs font-medium ${w.status?"bg-red-500 hover:bg-red-600 text-white":"bg-green-500 hover:bg-green-600 text-white"} transition-colors`,children:w.status?"Disable":"Enable"}),t==="Admin"&&a.jsxs("button",{onClick:()=>x(w._id),className:"inline-flex items-center px-2 py-1 rounded-lg text-xs font-medium bg-red-100 text-red-700 hover:bg-red-200 transition-colors",children:[a.jsx($r,{size:12,className:"mr-1"}),"Delete"]})]})]},w._id),v=()=>c?a.jsx("div",{className:"flex items-center justify-center p-6 sm:p-8",children:a.jsx("div",{className:"animate-spin rounded-full h-10 w-10 sm:h-12 sm:w-12 border-b-2 border-primary"})}):!r||r.length===0?a.jsxs("div",{className:"p-6 sm:p-12 text-center",children:[a.jsx("div",{className:"text-gray-400 text-base sm:text-xl mb-4",children:"No questions found"}),a.jsxs("button",{onClick:()=>i(!0),className:"inline-flex items-center px-3 py-1.5 sm:px-4 sm:py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors text-sm sm:text-base",children:[a.jsx(yn,{className:"mr-1 sm:mr-2",size:15}),"Add Your First Question"]})]}):d?a.jsx("div",{className:"p-4",children:r.map(w=>p(w))}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-50 border-y border-gray-200",children:[a.jsx("th",{className:"px-4 sm:px-6 py-3 sm:py-4 text-left text-xs sm:text-sm font-semibold text-gray-900",children:"Question"}),a.jsx("th",{className:"px-4 sm:px-6 py-3 sm:py-4 text-center text-xs sm:text-sm font-semibold text-gray-900",children:"Expected"}),a.jsx("th",{className:"px-4 sm:px-6 py-3 sm:py-4 text-center text-xs sm:text-sm font-semibold text-gray-900",children:"Status"}),a.jsx("th",{className:"px-4 sm:px-6 py-3 sm:py-4 text-center text-xs sm:text-sm font-semibold text-gray-900",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(w=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[a.jsx("td",{className:"px-4 sm:px-6 py-3 sm:py-4",children:a.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 max-w-xs sm:max-w-xl",children:[a.jsx("span",{className:"text-xs sm:text-sm text-gray-900 line-clamp-2",children:w.question}),w.description&&a.jsx("button",{onClick:()=>g(w.question,w.description),className:"flex-shrink-0 text-gray-400 hover:text-primary transition-colors",children:a.jsx(Fi,{size:16})})]})}),a.jsx("td",{className:"px-4 sm:px-6 py-3 sm:py-4",children:a.jsx("div",{className:"flex justify-center",children:a.jsx("span",{className:`inline-flex items-center px-2 sm:px-3 py-0.5 sm:py-1 rounded-full text-xs font-medium ${w.expectedAnswer?"bg-blue-50 text-blue-700":"bg-orange-50 text-orange-700"}`,children:w.expectedAnswer?"Yes":"No"})})}),a.jsx("td",{className:"px-4 sm:px-6 py-3 sm:py-4",children:a.jsx("div",{className:"flex justify-center",children:a.jsx("span",{className:`inline-flex items-center px-2 sm:px-3 py-0.5 sm:py-1 rounded-full text-xs font-medium ${w.status?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:w.status?"Enabled":"Disabled"})})}),a.jsx("td",{className:"px-4 sm:px-6 py-3 sm:py-4",children:a.jsxs("div",{className:"flex justify-center space-x-1 sm:space-x-2",children:[a.jsx("button",{onClick:()=>m(w._id),className:`inline-flex items-center px-2 sm:px-3 py-0.5 sm:py-1 rounded-lg text-xs font-medium ${w.status?"bg-red-500 hover:bg-red-600 text-white":"bg-green-500 hover:bg-green-600 text-white"} transition-colors`,children:w.status?"Disable":"Enable"}),t==="Admin"&&a.jsxs("button",{onClick:()=>x(w._id),className:"inline-flex items-center px-2 py-1 rounded-lg text-xs font-medium bg-red-100 text-red-700 hover:bg-red-200 transition-colors",children:[a.jsx($r,{size:12,className:"mr-1"}),"Delete"]})]})})]},w._id))})]})});return a.jsxs("div",{className:"p-4 sm:p-8 space-y-6 sm:space-y-8",children:[a.jsxs("div",{className:"flex justify-between items-center border-b pb-4 sm:pb-6",children:[a.jsx("h2",{className:"text-xl sm:text-3xl font-bold text-primary",children:"Legal Questions"}),a.jsxs("button",{onClick:()=>i(!0),className:"flex items-center bg-primary text-white px-2 py-1 text-sm sm:text-lg rounded-lg hover:bg-primary/90 transition-colors",children:[a.jsx(yn,{className:"mr-1 sm:mr-2",size:14}),a.jsx("span",{className:"hidden sm:inline",children:"Add New Question"}),a.jsx("span",{className:"sm:hidden",children:"Add"})]})]}),a.jsx("div",{className:"bg-white shadow-lg rounded-xl overflow-hidden",children:v()}),a.jsx(k2e,{isOpen:s,onClose:()=>i(!1),onSubmit:h}),a.jsx(E2e,{isOpen:o.isOpen,onClose:()=>l(w=>({...w,isOpen:!1})),title:o.title,description:o.description}),a.jsx(In,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,pauseOnFocusLoss:!0})]})},ah=({icon:e,title:t,className:r=""})=>a.jsxs("div",{className:`flex items-center gap-2 mb-4 ${r}`,children:[a.jsx(e,{className:"h-5 w-5 text-primary"}),a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:t})]}),fT=({title:e,value:t})=>a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 border border-gray-100 hover:border-primary/20 hover:shadow-md transition-all",children:[a.jsx("div",{className:"text-sm font-medium text-gray-500 mb-1",children:e}),a.jsx("div",{className:"text-base font-medium text-gray-900 break-words",children:t})]}),ih=({fileUrl:e})=>{const r=(i=>{if(!i)return"agreement-file.pdf";try{const o=i.split("/"),c=o[o.length-1].split("?")[0],A=c.split("_");return A.length>1?decodeURIComponent(A.slice(1).join("_")):decodeURIComponent(c)}catch{return"agreement-file.pdf"}})(e),n=()=>{if(!e)return;const i=document.createElement("a");i.href=e,i.download=r,i.target="_blank",i.rel="noopener noreferrer",document.body.appendChild(i),i.click(),document.body.removeChild(i)},s=()=>{e&&window.open(e,"_blank","noopener,noreferrer")};return e?a.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg shadow-sm p-4 border border-blue-200 hover:border-blue-300 hover:shadow-md transition-all",children:a.jsx("div",{className:"flex items-start justify-between",children:a.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[a.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:a.jsx(jr,{className:"h-6 w-6 text-blue-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-medium text-gray-500 mb-1",children:"Agreement File"}),a.jsx("div",{className:"text-base font-semibold text-gray-900 break-words",children:r}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Stored in S3"}),a.jsxs("div",{className:"mt-3 flex gap-2",children:[a.jsxs("button",{onClick:s,className:"flex items-center gap-1 px-3 py-1.5 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 transition-colors",children:[a.jsx(Xf,{className:"h-4 w-4"}),"View"]}),a.jsxs("button",{onClick:n,className:"flex items-center gap-1 px-3 py-1.5 bg-white border border-blue-200 text-blue-600 text-sm rounded-md hover:bg-blue-50 transition-colors",children:[a.jsx(_n,{className:"h-4 w-4"}),"Download"]})]})]})]})})}):a.jsx("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-lg",children:a.jsx("p",{className:"text-sm text-gray-500",children:"No agreement file available"})})},_2e=({questionnaireData:e})=>{const t={counterpartyRequired:"Is the agreement required by the counterparty?",agreementType:"Does the agreement have an auto-renewal clause or a fixed tenure?",serviceType:"Is this a one-time or recurring service?",paymentType:"Is the payment a one-time transaction or a recurring payment?"};return!e||typeof e!="object"?a.jsx("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-lg",children:a.jsx("p",{className:"text-sm text-gray-500",children:"No questionnaire data available"})}):a.jsx("div",{className:"space-y-4",children:Object.entries(e).map(([r,n],s)=>a.jsx("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg p-4 border border-green-200 hover:border-green-300 transition-all",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex-shrink-0 mt-1",children:a.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-sm font-semibold text-green-700",children:s+1})})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:t[r]||r}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx($a,{className:"h-4 w-4 text-green-600"}),a.jsx("span",{className:"text-base font-semibold text-gray-900",children:n})]})]})]})},r))})},I2e=()=>{var K,ae,Z,oe;const{vendorId:e}=yo(),t=Sr(),r=localStorage.getItem("role"),[n,s]=C.useState(null),[i,o]=C.useState(!0),[l,c]=C.useState(!1),[A,d]=C.useState(!1),[u,f]=C.useState(!1),[h,x]=C.useState(!1),[m,g]=C.useState(""),[p,v]=C.useState(!1),w=["_id","uploadedAt","lastModified","updatedAt","createdAt","agreementFile","agreementFileName","agreementFileUrl","hasAgreement","questionnaireAnswer","questionnaireData","panTaxFile","panTaxFileName","panTaxFileUrl","gstFile","gstFileName","gstFileUrl","msmeFile","msmeFileName","msmeFileUrl","bankProofFile","bankProofFileName","bankProofFileUrl","__v","empId","isLegalTeamVerifiedLogs","isVendorTeamVerifiedLogs"],B={basic:{icon:Fa,title:"Company Information",fields:[{key:"vendorId",label:"Vendor ID"},{key:"vendorName",label:"Company Name"},{key:"entity",label:"Entity"},{key:"category",label:"Category"},{key:"primarySubsidiary",label:"Primary Subsidiary"},{key:"natureOfService",label:"Nature of Service"},{key:"status",label:"Status"}]},contact:{icon:$_,title:"Contact Details",fields:[{key:"email",label:"Email Address"},{key:"phone",label:"Phone Number"}]},address:{icon:wH,title:"Address Information",fields:[{key:"billingAddress",label:"Address"},{key:"shippingAddress",label:"Shipping Address"}]},financial:{icon:q4,title:"Tax & Financial Information",fields:[{key:"taxNumber",label:"PAN/Tax Registration/W9"},{key:"gstin",label:"GST"},{key:"msme",label:"MSME"}]},banking:{icon:Fa,title:"Bank Details",fields:[{key:"bankAccountNumber",label:"Bank Account Number"},{key:"ifscSwiftCode",label:"IFSC/SWIFT CODE"},{key:"bankName",label:"Bank Name"}]}};C.useEffect(()=>{(async()=>{try{const R=await f$(e);console.log("Vendor data:",R.data),s(R.data),r==="Vendor Management"&&(!R.data.vendorId||R.data.vendorId.trim()==="")&&v(!0)}catch(R){console.error("Error fetching vendor details:",R)}finally{o(!1)}})()},[e]);const T=Y=>Y===""||Y===null||Y===void 0?"N/A":typeof Y=="boolean"?Y?"Yes":"No":typeof Y=="object"&&!Array.isArray(Y)?Y.status!==void 0&&Y.verifiedBy!==void 0&&Y.verifiedAt!==void 0?`${Y.status?"Verified":"Not Verified"} by ${Y.verifiedBy||"Unknown"} on ${new Date(Y.verifiedAt).toLocaleDateString()}`:Y.status!==void 0&&Y.comments!==void 0?`${Y.status?"Verified":"Not Verified"}${Y.comments&&Y.comments.length>0?` (${Y.comments.length} comment${Y.comments.length>1?"s":""})`:""}`:"N/A":typeof Y=="number"?Y===0?"0":Number.isInteger(Y)?Y.toLocaleString():Y.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):typeof Y=="string"&&Y.includes("T")&&!isNaN(Date.parse(Y))?new Date(Y).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):Y,_=Y=>Y?Y.split(/\r?\n/).map((R,z)=>a.jsx("span",{className:"block",children:R},z)):"N/A",j=()=>{if(!n)return[];const Y=Object.values(B).flatMap(R=>R.fields.map(z=>z.key));return Object.keys(n).filter(R=>!w.includes(R)&&!Y.includes(R)).map(R=>({key:R,label:R.replace(/([A-Z])/g," $1").replace(/^./,z=>z.toUpperCase())}))},E=()=>{f(!0)},L=()=>{x(!0)},M=async()=>{try{const Y=localStorage.getItem("capEmpId"),R=localStorage.getItem("role");let z;R==="Legal Team"?z=await bI(e,Y):z=await II(e,Y,"Approved by Vendor Management"),z.status===200?(s(R==="Legal Team"?{...n,status:"approved",isLegalTeamVerified:!0}:{...n,isVendorTeamVerified:!0}),Ie.success(z.data.message||"Vendor approved successfully"),f(!1)):Ie.error("Failed to approve vendor")}catch{Ie.error("Error approving vendor")}},F=async()=>{if(!m.trim()){Ie.error("Please provide a reason for rejection");return}try{const Y=localStorage.getItem("capEmpId"),R=localStorage.getItem("role");let z;R==="Legal Team"?z=await NI(e,Y,m):z=await LI(e,Y,m),z.status===200?(s(R==="Legal Team"?{...n,status:"rejected",isLegalTeamVerified:!1}:{...n,isVendorTeamVerified:!1}),Ie.success(z.data.message||"Vendor rejected successfully"),x(!1),g("")):Ie.error("Failed to reject vendor")}catch{Ie.error("Error rejecting vendor")}},D=()=>{f(!1)},G=()=>{x(!1),g("")};return i?a.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsx("div",{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin"}),a.jsx("div",{className:"text-lg font-medium text-gray-600",children:"Loading vendor details..."})]})}):n?a.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[p&&r==="Vendor Management"&&a.jsx("div",{className:"fixed top-15 right-4 z-50 bg-white rounded-lg shadow-lg border-l-4 border-yellow-500 p-4 max-w-sm",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center",children:a.jsx(Ea,{className:"h-5 w-5 text-yellow-600"})})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-1",children:"Vendor ID Required"}),a.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Vendor ID is mandatory for Vendor Management users. Please edit the vendor to add a Vendor ID."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>t(`/vendor-list-table/edit-vendor/${e}`),className:"px-3 py-1.5 bg-green-600 text-white text-sm font-medium rounded hover:bg-blue-700 transition-colors",children:"Edit Vendor"}),a.jsx("button",{onClick:()=>v(!1),className:"px-3 py-1.5 bg-gray-200 text-gray-700 text-sm font-medium rounded hover:bg-gray-300 transition-colors",children:"Dismiss"})]})]})]})}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("button",{onClick:()=>t(-1),className:"flex items-center text-gray-600 hover:text-primary transition-colors",children:[a.jsx(qy,{className:"h-5 w-5 mr-2"}),a.jsx("span",{className:"font-medium",children:"Back to Vendors"})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("span",{className:"px-3 py-1 bg-primary/10 text-primary rounded-full text-sm font-medium",children:n.vendorId||"N/A"}),n.status==="Active"&&a.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm font-medium",children:"Active"}),n.status==="Pending"&&a.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-700 rounded-full text-sm font-medium",children:"Pending"}),n.status==="Inactive"&&a.jsx("span",{className:"px-3 py-1 bg-red-100 text-red-700 rounded-full text-sm font-medium",children:"Inactive"})]})]}),a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:n.vendorName||"Vendor Details"}),a.jsx("p",{className:"text-gray-500",children:n.primarySubsidiary||""})]}),a.jsxs("div",{className:"space-y-8",children:[Object.entries(B).map(([Y,{icon:R,title:z,fields:ee}])=>{const b=ee.filter(O=>n&&n.hasOwnProperty(O.key)&&n[O.key]!==null&&n[O.key]!==void 0&&n[O.key]!=="");return b.length===0?null:a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsx(ah,{icon:R,title:z}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:b.map(O=>a.jsx(fT,{title:O.label,value:O.key.toLowerCase().includes("address")?_(n[O.key]):T(n[O.key])},O.key))})]},Y)}),(n.panTaxFileUrl||n.gstFileUrl||n.msmeFileUrl||n.bankProofFileUrl)&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsx(ah,{icon:jr,title:"Document Uploads"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.panTaxFileUrl&&a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-500 mb-2",children:"PAN / TAX / W9 File"}),a.jsx(ih,{fileUrl:n.panTaxFileUrl})]}),n.gstFileUrl&&a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-500 mb-2",children:"GST File"}),a.jsx(ih,{fileUrl:n.gstFileUrl})]}),n.msmeFileUrl&&a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-500 mb-2",children:"MSME File"}),a.jsx(ih,{fileUrl:n.msmeFileUrl})]}),n.bankProofFileUrl&&a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-500 mb-2",children:"Bank Account Proof"}),a.jsx(ih,{fileUrl:n.bankProofFileUrl})]})]})]}),n.hasAgreement&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsx(ah,{icon:jr,title:"Agreement/EL"}),n.hasAgreement==="yes"&&a.jsx("div",{className:"space-y-4",children:n.agreementFileUrl?a.jsx(ih,{fileUrl:n.agreementFileUrl}):a.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:a.jsx("p",{className:"text-sm text-yellow-800",children:"Agreement file URL not available"})})}),n.hasAgreement==="no"&&a.jsxs("div",{children:[a.jsx("div",{className:"mb-3",children:a.jsxs("div",{className:"inline-flex items-center px-3 py-1.5 bg-blue-100 text-blue-700 rounded-full text-sm font-medium",children:[a.jsx(Fi,{className:"h-4 w-4 mr-1.5"}),"Questionnaire Responses"]})}),n.questionnaireData?a.jsx(_2e,{questionnaireData:n.questionnaireData}):a.jsx("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-lg",children:a.jsx("p",{className:"text-sm text-gray-500",children:"No questionnaire data available"})})]})]}),j().length>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsx(ah,{icon:Fi,title:"Additional Information"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:j().map(Y=>a.jsx(fT,{title:Y.label,value:T(n[Y.key])},Y.key))})]}),(((K=n.isLegalTeamVerifiedLogs)==null?void 0:K.length)>0||((ae=n.isVendorTeamVerifiedLogs)==null?void 0:ae.length)>0)&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsx(ah,{icon:ql,title:"Verification Logs"}),a.jsxs("div",{className:"space-y-4",children:[((Z=n.isLegalTeamVerifiedLogs)==null?void 0:Z.length)>0&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Legal Team Verification"}),a.jsxs("button",{onClick:()=>c(!l),className:"flex items-center gap-2 px-3 py-1 bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors text-sm",children:[a.jsx(Po,{className:"h-4 w-4"}),l?"Hide Logs":"Show Logs"]})]}),l&&a.jsx("div",{className:"space-y-2",children:n.isLegalTeamVerifiedLogs.map((Y,R)=>a.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:`w-2 h-2 rounded-full ${Y.status?"bg-green-500":"bg-red-500"}`}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:Y.status?"Verified":"Not Verified"})]}),a.jsx("span",{className:"text-xs text-gray-500",children:new Date(Y.verifiedAt).toLocaleString()})]}),a.jsxs("div",{className:"mt-1 text-sm text-gray-600",children:["By: ",Y.verifiedBy||Y.verifiedUserId||"Unknown"]}),Y.comments&&Y.comments.length>0&&a.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[a.jsx("span",{className:"font-medium",children:"Comments: "}),Y.comments.join(", ")]})]},Y._id||R))})]}),((oe=n.isVendorTeamVerifiedLogs)==null?void 0:oe.length)>0&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Vendor Team Verification"}),a.jsxs("button",{onClick:()=>d(!A),className:"flex items-center gap-2 px-3 py-1 bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors text-sm",children:[a.jsx(Po,{className:"h-4 w-4"}),A?"Hide Logs":"Show Logs"]})]}),A&&a.jsx("div",{className:"space-y-2",children:n.isVendorTeamVerifiedLogs.map((Y,R)=>a.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:`w-2 h-2 rounded-full ${Y.status?"bg-green-500":"bg-red-500"}`}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:Y.status?"Verified":"Not Verified"})]}),a.jsx("span",{className:"text-xs text-gray-500",children:new Date(Y.verifiedAt).toLocaleString()})]}),a.jsxs("div",{className:"mt-1 text-sm text-gray-600",children:["By: ",`${Y.verifiedUserId} - ${Y.verifiedBy} `||"Unknown"]}),Y.comments&&Y.comments.length>0&&a.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[a.jsx("span",{className:"font-medium",children:"Comments: "}),Y.comments.join(", ")]})]},Y._id||R))})]})]})]}),(()=>{const Y=localStorage.getItem("role");return Y==="Legal Team"?n.status==="Pending"&&n.isLegalTeamVerified===!1:Y==="Vendor Management"?n.status==="Pending"&&n.isVendorTeamVerified===!1:!1})()&&a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[a.jsxs("button",{onClick:E,disabled:localStorage.getItem("role")==="Vendor Management"&&(!n.vendorId||n.vendorId.trim()===""),className:`px-6 py-3 font-medium rounded-lg transition-colors flex items-center justify-center gap-2 ${localStorage.getItem("role")==="Vendor Management"&&(!n.vendorId||n.vendorId.trim()==="")?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"}`,children:[a.jsx($a,{className:"h-5 w-5"}),"Approve Vendor"]}),a.jsxs("button",{onClick:L,disabled:localStorage.getItem("role")==="Vendor Management"&&(!n.vendorId||n.vendorId.trim()===""),className:`px-6 py-3 font-medium rounded-lg transition-colors flex items-center justify-center gap-2 ${localStorage.getItem("role")==="Vendor Management"&&(!n.vendorId||n.vendorId.trim()==="")?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-red-600 text-white hover:bg-red-700"}`,children:[a.jsx(Ea,{className:"h-5 w-5"}),"Reject Vendor"]})]})}),u&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Approve Vendor"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to approve this vendor? This action cannot be undone."}),a.jsxs("div",{className:"flex gap-4 justify-end",children:[a.jsx("button",{onClick:D,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition-colors",children:"Cancel"}),a.jsx("button",{onClick:M,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:"Approve"})]})]})}),h&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Reject Vendor"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Are you sure you want to reject this vendor? This action cannot be undone."}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Reason for rejection ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{value:m,onChange:Y=>g(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent",rows:"3",placeholder:"Please provide a reason for rejection..."})]}),a.jsxs("div",{className:"flex gap-4 justify-end",children:[a.jsx("button",{onClick:G,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition-colors",children:"Cancel"}),a.jsx("button",{onClick:F,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:"Reject"})]})]})})]}),a.jsxs("div",{className:"mt-8 text-center text-sm text-gray-500",children:[n.createdAt&&a.jsxs(a.Fragment,{children:["Created: ",T(n.createdAt),n.updatedAt&&"  "]}),n.updatedAt&&a.jsxs(a.Fragment,{children:["Last Updated: ",T(n.updatedAt)]})]})]})}):a.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-lg font-medium text-gray-600",children:"Vendor not found"}),a.jsx("button",{onClick:()=>t(-1),className:"mt-4 text-primary hover:underline",children:"Go back"})]})})},L2e=()=>a.jsx("div",{className:"min-h-screen bg-primary/5 flex flex-col items-center justify-center px-6 animate-fade-in",children:a.jsxs("div",{className:"text-center max-w-xl",children:[a.jsxs("div",{className:"relative",children:[a.jsx("h1",{className:"text-9xl font-bold text-primary animate-slide-up hover:scale-105 transition-transform duration-300 cursor-default",children:"404"}),a.jsx("div",{className:"absolute -top-8 -right-8 w-24 h-24 bg-primary/10 rounded-full animate-pulse"}),a.jsx("div",{className:"absolute -bottom-4 -left-8 w-16 h-16 bg-primary/20 rounded-full animate-bounce delay-300"})]}),a.jsx("h2",{className:"mt-4 text-3xl font-semibold text-gray-800 animate-slide-up delay-150",children:"Page not found"}),a.jsx("p",{className:"mt-4 text-lg text-gray-600 animate-slide-up delay-300",children:"Sorry, we couldn't find the page you're looking for. Please check the URL or return home."}),a.jsx("div",{className:"mt-8 space-y-4 animate-slide-up delay-450",children:a.jsxs("a",{href:"/",className:`inline-flex items-center gap-2 px-6 py-3 bg-primary text-white rounded-lg \r
                     hover:bg-primary/90 hover:scale-105 hover:gap-3 active:scale-95\r
                     transition-all duration-300 ease-in-out group`,children:[a.jsx(H_,{className:"w-5 h-5 group-hover:rotate-12 transition-transform duration-300"}),"Back to Home",a.jsx(qy,{className:"w-0 h-5 opacity-0 group-hover:w-5 group-hover:opacity-100 transition-all duration-300"})]})}),a.jsx("p",{className:"mt-8 text-sm text-black hover:text-primary transition-colors duration-300 cursor-help animate-slide-up delay-600",children:"If you believe this is a mistake, please contact our support team."})]})}),f7=document.createElement("style");f7.textContent=`
  @keyframes fade-in {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  
  @keyframes slide-up {
    from { 
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  .animate-fade-in {
    animation: fade-in 0.5s ease-out forwards;
  }
  
  .animate-slide-up {
    animation: slide-up 0.5s ease-out forwards;
  }
  
  .delay-150 {
    animation-delay: 150ms;
  }
  
  .delay-300 {
    animation-delay: 300ms;
  }
  
  .delay-450 {
    animation-delay: 450ms;
  }
  
  .delay-600 {
    animation-delay: 600ms;
  }
`;document.head.appendChild(f7);const U2e=({showBulkApproval:e,handleSelectAll:t,selectAll:r,currentUsers:n,navigate:s,handleRequestSelect:i,handleCopyReqId:o,handleOpenInNewTab:l,formatCurrency:c,renderActionColumn:A,Pagination:d,currentPage:u,totalPages:f,handlePageChange:h,itemsPerPage:x,filteredUsers:m,selectedRequests:g})=>a.jsx("div",{className:"border border-gray-200 rounded-lg w-full",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsx("div",{className:"inline-block min-w-full align-middle",children:a.jsxs("div",{className:"overflow-hidden",children:[a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-primary",children:a.jsxs("tr",{children:[e&&a.jsx("th",{scope:"col",className:"sticky top-0 px-2 py-2 md:px-6 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[5%]",children:a.jsx("input",{type:"checkbox",checked:r,onChange:p=>t(p.target.checked),className:"rounded border-gray-300 text-primary focus:ring-primary focus:ring-offset-0"})}),a.jsx("th",{scope:"col",className:"sticky top-0 px-2 py-2 md:px-6 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[5%]",children:"SNo"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-2 py-2 md:px-6 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[15%]",children:"ReqId"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-2 py-2 md:px-6 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[15%] hidden md:table-cell",children:"Entity"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-2 py-2 md:px-6 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[15%] hidden md:table-cell",children:"Vendor"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-2 py-2 md:px-6 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[9%]",children:"Amount"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-2 py-2 md:px-6 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[13%]",children:"Status"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-2 py-2 md:px-6 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[10%]",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.length>0?n.map((p,v)=>{var w,B,T,_,j,E,L,M;return a.jsxs("tr",{className:"hover:bg-gray-100 cursor-pointer",onClick:()=>s(`/req-list-table/preview-one-req/${p._id}`),children:[e&&a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4",children:a.jsx("div",{onClick:F=>{F.preventDefault(),F.stopPropagation(),(F.target.querySelector('input[type="checkbox"]')||F.target).type==="checkbox"&&i(p._id,!(g!=null&&g.includes(p._id)))},className:"flex items-center justify-center cursor-pointer",children:a.jsx("input",{type:"checkbox",checked:g==null?void 0:g.includes(p._id),onChange:()=>{},className:"rounded border-gray-300 text-primary focus:ring-primary focus:ring-offset-0 pointer-events-none"})})}),a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-xs md:text-sm font-medium text-gray-900",children:(u-1)*x+v+1}),a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-xs md:text-sm text-gray-500",children:a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"block font-medium",children:p.reqid}),a.jsxs("div",{className:"flex space-x-1",children:[a.jsx("button",{onClick:F=>o(p.reqid,F),className:"text-gray-400 hover:text-blue-500 transition-colors",title:"Copy Request ID",children:a.jsx(Gl,{className:"h-3 w-3 md:h-4 md:w-4"})}),a.jsx("button",{onClick:F=>l(p._id,F),className:"text-gray-400 hover:text-green-500 transition-colors",title:"Open in new tab",children:a.jsx(Xf,{className:"h-3 w-3 md:h-4 md:w-4"})})]})]}),a.jsx("span",{className:"block font-medium",children:p.userName||"Employee"}),a.jsx("span",{className:"block text-xs md:text-sm",children:(w=p.commercials)==null?void 0:w.department})]})}),a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-xs md:text-sm text-gray-500 hidden md:table-cell",children:a.jsxs("div",{children:[a.jsx("span",{className:"block",children:((B=p.commercials)==null?void 0:B.businessUnit)||"NA"}),a.jsx("span",{className:"block font-medium",children:((T=p.commercials)==null?void 0:T.entity)||"NA"}),a.jsx("span",{className:"block",children:((_=p.commercials)==null?void 0:_.site)||"NA"})]})}),a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-xs md:text-sm text-gray-500 hidden md:table-cell",children:a.jsxs("div",{children:[a.jsx("span",{className:"block font-medium",children:(j=p.procurements)==null?void 0:j.vendor}),a.jsx("span",{className:"block",children:(E=p.procurements)==null?void 0:E.vendorName})]})}),a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-xs md:text-sm text-gray-500",children:c((L=p.supplies)==null?void 0:L.totalValue,(M=p.supplies)==null?void 0:M.selectedCurrency)}),a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-xs md:text-sm text-gray-500",children:p.isCompleted?a.jsxs(a.Fragment,{children:[p.status!=="Approved"&&a.jsxs(a.Fragment,{children:[p.nextDepartment||p.cDepartment," ",a.jsx("br",{})]}),p.status||"Pending"]}):a.jsx("span",{className:"text-red-500",children:"Draft"})}),A(p)]},p._id)}):a.jsx("tr",{children:a.jsx("td",{colSpan:e?"14":"13",className:"px-2 py-2 md:px-6 md:py-4 text-center text-xs md:text-sm text-gray-500",children:"No matching results found."})})})]}),a.jsx("div",{className:"mt-4 px-2 md:px-0",children:a.jsx(d,{currentPage:u,totalPages:f,handlePageChange:h,itemsPerPage:x,totalItems:m.length})})]})})})}),D2e=({selectedRequests:e,handleBulkApproval:t,currentUsers:r,isBulkApproving:n})=>a.jsx("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Bulk Actions:"}),a.jsxs("span",{className:"text-sm text-blue-700",children:[e==null?void 0:e.length," of ",r==null?void 0:r.length," ","selected"]})]}),a.jsx("button",{onClick:t,disabled:(e==null?void 0:e.length)===0||n,className:`px-4 py-2 rounded-lg text-sm font-medium ${(e==null?void 0:e.length)>0&&!n?"bg-green-600 text-white hover:bg-green-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:n?"Approving...":"Bulk Approve"})]})}),P2e=()=>{let{action:e,fromDate:t,toDate:r}=yo();const n=localStorage.getItem("capEmpId"),s=localStorage.getItem("role"),i=localStorage.getItem("department"),o=localStorage.getItem("email"),l=localStorage.getItem("multiRole"),[c,A]=C.useState(null),[d,u]=C.useState([]),[f,h]=C.useState(""),[x,m]=C.useState(!1),[g,p]=C.useState(""),[v,w]=C.useState(""),[B,T]=C.useState([]),[_,j]=C.useState(!1),[E,L]=C.useState([]),[M,F]=C.useState(!1),[D,G]=C.useState(!1),K=Sr(),[ae,Z]=C.useState([]),[oe,Y]=C.useState([]),[R,z]=C.useState(!0),[ee,b]=C.useState(!1),[O,S]=C.useState(""),[I,U]=C.useState(!1),[Q,H]=C.useState([]),[X,V]=C.useState(1),[Ae,W]=C.useState(!1),[J,ve]=C.useState({fromDate:"",toDate:""}),[de,te]=C.useState([]),[je,qe]=C.useState(null),He=20,Ze=["Pending","Rejected","Hold"],xe=s==="Business Finance"&&e==="Pending-Approvals",ue=(lt,Et)=>Ze.includes(lt)?Et.filter(Oe=>Oe.status===lt).map(Oe=>Oe.nextDepartment).filter(Oe=>Oe&&Oe.trim()!=="").filter((Oe,Re,Ye)=>Ye.indexOf(Oe)===Re).sort():[];C.useEffect(()=>{if(g&&Ze.includes(g)){const lt=ue(g,ae);T(lt),v&&!lt.includes(v)&&w("")}else T([])},[g,ae,v]),C.useEffect(()=>{(async()=>{const Et=await mo();Et.status===200&&te(Et.data.data)})()},[]),C.useEffect(()=>{e==="Pending-Request"?u(["Pending","PO-Pending","Invoice-Pending"]):e==="Approved-Request"||e==="Completed-Request"?u("Approved"):e==="Pending-Approvals"?u("Pending"):e==="Approved-Approvals"?(h("Approved-Approvals"),u("Approved")):e==="OnHold-Approvals"?u("Hold"):e==="Rejected-Approvals"&&u("Rejected")},[e]);const Fe=(lt,Et)=>{L(Et?It=>[...It,lt]:It=>It.filter(Ee=>Ee!==lt))},ke=lt=>{if(F(lt),lt){const Et=$t.map(It=>It._id);L(Et)}else L([])},Te=async()=>{if(E.length===0){alert("Please select at least one request to approve.");return}try{G(!0),(await bq(n,E,s)).status===200?(alert(`${E.length} requests approved successfully!`),await Se(x),L([]),F(!1)):alert("Failed to approve requests. Please try again.")}catch(lt){console.error("Error in bulk approval:",lt),alert("An error occurred while approving requests.")}finally{G(!1)}};C.useEffect(()=>{L([]),F(!1)},[ae,Q,X]);const Ne=lt=>{const Et=lt.target.value;p(Et),w(""),j(Ze.includes(Et))},et=lt=>{w(lt.target.value)},Se=async(lt=!1)=>{z(!0);try{let Et;if(s==="Admin"&&i==="Admin")if(Et=await rf(),console.log("1",Et),Y(Et.data.data),lt||e==="Total-Request")Z(Et.data.data);else{const It=Et.data.data.filter(Ee=>d.includes(Ee.status));Z(It)}else if(s==="Employee"){if(Et=await tf(n),Et.status===200)if(Y(Et.data.data),lt)Z(Et.data.data);else{const It=Et.data.data.filter(Ee=>Ee.status===d);Z(It)}}else if(Et=await E1(n),console.log("response hod",Et),Et.status===200)if(Y(Et.data.reqData),lt)Z(Et.data.reqData);else if(e==="Total-Approvals"){console.log("Total-Approvals filtering");const It=Et.data.reqData.filter(Ee=>{const Oe=Ee.nextDepartment===s||Ee.nextDepartment===i;return console.log(`ReqID: ${Ee.reqid}, NextDept: ${Ee.nextDepartment}, UserRole: ${s}, UserDept: ${i}, Matches: ${Oe}`),Oe});console.log("Total-Approvals filtered data:",It.length),Z(It)}else if(e==="Pending-Approvals")if(console.log("Pending-Approvals filtering"),s==="HOD Department"||s==="Admin"){const It=Et.data.reqData.filter(Ee=>{const Oe=["Pending","PO-Pending","Invoice-Pending"].includes(Ee.firstLevelApproval.status),Re=Ee.nextDepartment===s||Ee.nextDepartment===i;return Oe&&Re});Z(It)}else{let It=Et.data.reqData.filter(Re=>Re.nextDepartment===s||Re.nextDepartment===i?Re.approvals&&Re.approvals.some((mt,qt,Nt)=>{const se=mt.nextDepartment===s&&mt.approvalId!==n&&mt.status==="Approved",pe=qt===Nt.length-1;return se&&pe}):!1);const Ee=Et.data.reqData.filter(Re=>{const Ye=Re.nextDepartment===s||Re.nextDepartment===i,ft=Re.firstLevelApproval&&Re.firstLevelApproval.hodEmail===o&&!["Approved","Hold","Rejected"].includes(Re.firstLevelApproval.status);return Ye&&ft}),Oe=[...It,...Ee].filter((Re,Ye,ft)=>Ye===ft.findIndex(mt=>mt._id===Re._id));console.log("Pending approvals combined data:",Oe.length),Z(Oe)}else if(e==="OnHold-Approvals")if(console.log("OnHold-Approvals filtering"),s==="HOD Department"||s==="Admin"){const It=Et.data.reqData.filter(Ee=>{const Oe=Ee.firstLevelApproval.status==="Hold",Re=Ee.nextDepartment===s||Ee.nextDepartment===i||Ee.cDepartment===i,Ye=Ee.firstLevelApproval.hodEmail===o&&Ee.firstLevelApproval.status==="Hold";return Oe&&Re&&Ye});Z(It)}else{const It=Et.data.reqData.filter(Ee=>Ee.nextDepartment===s||Ee.nextDepartment===i||Ee.cDepartment===i?Ee.approvals&&Ee.approvals.some((Re,Ye,ft)=>{const mt=Re.approvalId===n&&Re.status==="Hold",qt=Ye===ft.length-1;return mt&&qt}):!1);Z(It)}else if(e==="Rejected-Approvals")if(console.log("Rejected-Approvals filtering"),s==="HOD Department"||s==="Admin"){const It=Et.data.reqData.filter(Ee=>{var Ye;const Oe=((Ye=Ee.firstLevelApproval)==null?void 0:Ye.status)==="Rejected"||Ee.status==="Rejected",Re=Ee.nextDepartment===s||Ee.nextDepartment===i||Ee.cDepartment===i;return Oe&&Re});Z(It)}else{const It=Et.data.reqData.filter(Ee=>Ee.nextDepartment===s||Ee.nextDepartment===i?Ee.approvals&&Ee.approvals.some((Re,Ye,ft)=>{const mt=Re.approvalId===n&&Re.status==="Rejected",qt=Ye===ft.length-1;return mt&&qt}):!1);Z(It)}else if(e==="Approved-Approvals"){console.log("Approved-Approvals filtering");const It=Et.data.reqData.filter(Ee=>Ee.approvals.some(Oe=>{const Re=Oe.approvalId===n&&Oe.status==="Approved",Ye=Ee.nextDepartment===s||Ee.nextDepartment===i;return Re||Ye}));Z(It)}else if(e==="My-Approvals"){const It=Et.data.reqData.filter(Ee=>Ee.approvals.some(Oe=>Oe.approvalId===n&&Oe.status==="Approved"));Z(It)}else{console.log("Default case - showing approved");const It=Et.data.reqData.filter(Ee=>Ee.status==="Approved");Z(It)}}catch(Et){console.error("Error fetching data:",Et)}finally{setTimeout(()=>{z(!1)},500)}};C.useEffect(()=>{Se(x)},[n,s,e,d,o,i,x]),C.useEffect(()=>{let lt=[...ae];const Et=t&&t!=="null"?new Date(t):null,It=r&&r!=="null"?new Date(r):null,Ee=Et||(J.fromDate?new Date(J.fromDate):null),Oe=It||(J.toDate?new Date(J.toDate):null);if(console.log("Route fromDate:",Et,"Route toDate:",It),console.log("Local fromDate:",J.fromDate,"Local toDate:",J.toDate),console.log("Final fromDate:",Ee,"Final toDate:",Oe),(Ee||Oe)&&(lt=lt.filter(Re=>{const Ye=Re.createdAt?new Date(Re.createdAt):null;if(!Ye)return!1;if(Ee&&Oe){const ft=new Date(Oe);return ft.setHours(23,59,59,999),Ye>=Ee&&Ye<=ft}else{if(Ee)return Ye>=Ee;if(Oe){const ft=new Date(Oe);return ft.setHours(23,59,59,999),Ye<=ft}}return!0})),g&&(lt=lt.filter(Re=>Re.status===g?!0:Re.approvals?Re.approvals.some(Ye=>Ye.status===g):!!(Re.firstLevelApproval&&Re.firstLevelApproval.status===g))),v&&Ze.includes(g)&&(lt=lt.filter(Re=>{const Ye=Re.nextDepartment===v;return console.log(`Request ${Re.reqid}: nextDepartment="${Re.nextDepartment}", matches departmentFilter="${v}": ${Ye}`),Ye}),console.log(`After department filter (${v}):`,lt.length,"records")),O.trim()!==""){const Re=O.toLowerCase();lt=lt.filter(Ye=>{const ft=(mt,qt)=>{if(!mt)return!1;if(typeof mt=="string")return mt.toLowerCase().includes(Re);if(Array.isArray(mt))return mt.some(Nt=>ft(Nt,""));if(qt){const Nt=qt.split(".");let se=mt;for(const pe of Nt){if(se[pe]===void 0)return!1;se=se[pe]}return typeof se=="string"?se.toLowerCase().includes(Re):!1}return Object.values(mt).some(Nt=>typeof Nt=="string"?Nt.toLowerCase().includes(Re):typeof Nt=="object"&&Nt!==null?ft(Nt,""):!1)};return Ye.reqid&&Ye.reqid.toLowerCase().includes(Re)||Ye.userName&&Ye.userName.toLowerCase().includes(Re)||Ye.status&&Ye.status.toLowerCase().includes(Re)||Ye.nextDepartment&&Ye.nextDepartment.toLowerCase().includes(Re)||ft(Ye.commercials,"")||ft(Ye.procurements,"")||ft(Ye.supplies,"")||ft(Ye.firstLevelApproval,"")||ft(Ye.approvals,"")?!0:ft(Ye.commercials,"department")||ft(Ye.commercials,"businessUnit")||ft(Ye.commercials,"entity")||ft(Ye.commercials,"site")||ft(Ye.procurements,"vendor")||ft(Ye.procurements,"vendorName")})}console.log(`Final filtered results: ${lt.length} records`),H(lt),V(1)},[ae,O,J,g,v,t,r]);const Ce=async(lt,Et)=>{Et.stopPropagation();try{await navigator.clipboard.writeText(lt),qe(lt),setTimeout(()=>{qe(null)},2e3)}catch(It){console.error("Failed to copy: ",It);const Ee=document.createElement("textarea");Ee.value=lt,document.body.appendChild(Ee),Ee.focus(),Ee.select();try{document.execCommand("copy"),qe(lt),setTimeout(()=>{qe(null)},2e3)}catch(Oe){console.error("Fallback copy failed: ",Oe)}document.body.removeChild(Ee)}},Be=(lt,Et)=>{Et.stopPropagation();const It=`/req-list-table/preview-one-req/${lt}`;window.open(It,"_blank")},Pe=lt=>{t="",r="",m(lt)},Bt=lt=>{lt>=1&&lt<=vt&&V(lt)},tt=async()=>{try{console.log("Sending...");const lt=await wI(n,c);console.log(lt)}catch(lt){console.error("Error sending mail",lt)}},Ot=lt=>{S(lt.target.value)},vt=Math.ceil(Q.length/He),Vt=(X-1)*He,pr=Vt+He,$t=Q.slice(Vt,pr),Qr=(lt,Et)=>{if(!lt)return"N/A";const It=de.find(Ee=>Ee.code===Et);if(!It)return lt;try{return new Intl.NumberFormat(It.locale,{style:"currency",currency:It.code,minimumFractionDigits:2,maximumFractionDigits:2}).format(lt)}catch(Ee){return console.error("Currency formatting error:",Ee),lt}},ir=()=>{ve({fromDate:"",toDate:""}),S(""),p(""),w(""),T([]),j(!1),U(!1)},Gr=async(lt,Et)=>{lt.stopPropagation(),K(`/req-list-table/edit-req/${Et}`)},un=lt=>{const{name:Et,value:It}=lt.target;ve(Ee=>({...Ee,[Et]:It}))},Nr=async lt=>{try{(await Zm(lt)).status===200&&(Z(ae.filter(It=>It._id!==lt)),W(!1))}catch(Et){console.error("Error deleting request:",Et)}},Wt=lt=>lt.status==="Approved"?a.jsx("td",{className:"text-sm text-gray-500 text-center md:px-6 md:py-4 px-2 py-2",children:a.jsx("span",{className:"text-xs text-gray-400",children:"No actions"})}):lt.isCompleted?s==="Admin"||s==="Head of Finance"||s==="HOD Department"||l==1?a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-sm text-gray-500",children:a.jsxs("div",{className:"flex justify-center items-center space-x-2",children:[a.jsx("button",{className:"text-blue-500 hover:text-blue-700",onClick:Et=>Gr(Et,lt._id),children:a.jsx(Us,{className:"h-4 w-4 md:h-5 md:w-5"})}),s==="Admin"&&a.jsx("button",{className:"text-red-500 hover:text-red-700",onClick:Et=>{Et.stopPropagation(),A(lt._id),W(!0)},children:a.jsx($r,{className:"h-4 w-4 md:h-5 md:w-5"})})]})}):a.jsx("td",{className:"text-sm text-gray-500 text-center md:px-6 md:py-4 px-2 py-2",children:a.jsx("button",{className:"px-2 py-1 bg-primary text-white rounded-md hover:bg-primary text-xs md:text-sm",onClick:Et=>{Et.stopPropagation(),b(!0),A(lt._id)},children:"Request Edit"})}):a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-sm text-gray-500",children:a.jsxs("div",{className:"flex justify-center items-center space-x-2",children:[a.jsx("button",{className:"text-blue-500 hover:text-blue-700",onClick:Et=>Gr(Et,lt._id),children:a.jsx(Us,{className:"h-4 w-4 md:h-5 md:w-5"})}),a.jsx("button",{className:"text-red-500 hover:text-red-700",onClick:Et=>{Et.stopPropagation(),A(lt._id),W(!0)},children:a.jsx($r,{className:"h-4 w-4 md:h-5 md:w-5"})})]})});return a.jsxs(a.Fragment,{children:[R&&a.jsx(Fd,{}),a.jsxs("div",{className:"p-3 md:p-8 bg-white rounded-lg shadow-sm h-full",children:[je&&a.jsx("div",{className:"fixed top-4 right-4 z-50",children:a.jsxs("div",{className:"bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg flex items-center space-x-2",children:[a.jsx(ho,{className:"h-4 w-4"}),a.jsxs("span",{className:"text-sm font-medium",children:['ReqID "',je,'" copied successfully!']})]})}),a.jsxs("div",{className:"mb-4 md:mb-8",children:[a.jsx("h2",{className:"text-xl md:text-2xl font-bold text-gray-900 mb-4 md:mb-6",children:`${e.replace(/-/g," ")}`}),xe&&a.jsx(D2e,{selectedRequests:E,handleBulkApproval:Te,currentUsers:$t,isBulkApproving:D}),a.jsxs("div",{className:"block lg:hidden mb-4",children:[a.jsxs("button",{className:"w-full flex justify-center items-center px-3 py-2 bg-primary text-white rounded-lg text-sm font-medium hover:bg-primary/90 mb-2",onClick:()=>K("/req-list-table/create-request"),children:[a.jsx(yn,{className:"h-4 w-4 mr-1"}),"Add Request"]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("button",{className:`px-4 py-2 mr-2 rounded-lg text-sm font-medium ${x?"bg-gray-100 text-gray-700":"bg-primary text-white"}`,onClick:()=>Pe(!1),children:e.replace(/-/g," ")}),a.jsx("button",{className:`px-4 py-2 rounded-lg text-sm font-medium ${x?"bg-primary text-white":"bg-gray-100 text-gray-700"}`,onClick:()=>Pe(!0),children:"All"}),a.jsxs("button",{className:"flex-1 mr-2 flex justify-center items-center px-2 py-2 border border-gray-300 rounded-lg text-xs font-medium text-gray-700 bg-white hover:bg-gray-50",onClick:()=>U(!I),children:[a.jsx(ti,{className:"h-3 w-3 mr-1"}),"Filter"]}),a.jsxs("button",{className:"flex-1 flex justify-center items-center px-2 py-2 border border-gray-300 rounded-lg text-xs font-medium text-gray-700 bg-white hover:bg-gray-50",onClick:()=>Ud(ae),children:[a.jsx(_n,{className:"h-3 w-3 mr-1"}),"Export"]})]})]}),a.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-3 lg:gap-6",children:[a.jsxs("div",{className:"relative w-full lg:flex-1 lg:min-w-[300px] lg:max-w-md",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:a.jsx(rn,{className:"h-4 w-4 md:h-5 md:w-5 text-gray-400"})}),a.jsx("input",{type:"text",value:O,onChange:Ot,placeholder:"Search by ID, name, department, or next department...",className:"w-full pl-10 pr-4 py-2 md:py-2.5 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),a.jsxs("div",{className:"hidden lg:flex items-center gap-4",children:[a.jsx("button",{className:`px-4 py-2  rounded-lg text-sm font-medium ${x?"bg-gray-100 text-gray-700":"bg-primary text-white"}`,onClick:()=>Pe(!1),children:e.replace(/-/g," ")}),a.jsx("button",{className:`px-4 py-2 rounded-lg text-sm font-medium ${x?"bg-primary text-white":"bg-gray-100 text-gray-700"}`,onClick:()=>Pe(!0),children:"All"}),a.jsxs("button",{className:"inline-flex items-center px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",onClick:()=>U(!I),children:[a.jsx(ti,{className:"h-4 w-4 mr-2"}),"Filter",I?a.jsx(bl,{className:"h-4 w-4 ml-1"}):a.jsx(vo,{className:"h-4 w-4 ml-1"})]}),a.jsxs("button",{className:"inline-flex items-center px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",onClick:()=>Ud(ae),children:[a.jsx(_n,{className:"h-4 w-4 mr-2"}),"Export"]}),a.jsxs("button",{className:"inline-flex items-center px-4 py-2.5 bg-primary text-white rounded-lg text-sm font-medium hover:bg-primary/90",onClick:()=>K("/req-list-table/create-request"),children:[a.jsx(yn,{className:"h-4 w-4 mr-2"}),"Add Request"]}),a.jsxs("button",{className:"inline-flex items-center px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",onClick:async()=>{try{const lt=await ev();if(lt.status===200)window.open(lt.data.policyUrl,"_blank","noopener,noreferrer");else throw new Error("No policy URL found")}catch(lt){console.error("Error fetching PO policy:",lt),toast.error("Failed to open PO policy. Please try again later.")}},children:[a.jsx(jr,{className:"h-4 w-4 mr-2"}),"View PO Policy"]})]})]}),I&&a.jsxs("div",{className:"mt-4 w-full md:w-80 p-4 bg-white rounded-lg shadow-lg border border-gray-200 absolute right-0 md:right-8 z-20",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:"Filters"}),a.jsx("button",{onClick:()=>U(!1),className:"text-gray-500 hover:text-gray-700",children:a.jsx(_r,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Status"}),a.jsxs("select",{value:g,onChange:Ne,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary",children:[a.jsx("option",{value:"",children:"All Statuses"}),a.jsx("option",{value:"Pending",children:"Pending"}),a.jsx("option",{value:"Hold",children:"Hold"}),a.jsx("option",{value:"Rejected",children:"Rejected"}),a.jsx("option",{value:"PO-Pending",children:"PO-Pending"}),a.jsx("option",{value:"Invoice-Pending",children:"Invoice-Pending"}),a.jsx("option",{value:"Approved",children:"Approved"})]})]}),Ze.includes(g)&&B.length>0&&a.jsxs("div",{className:"mb-4",children:[a.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:["Next Department (",g,")"]}),a.jsxs("select",{value:v,onChange:et,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary",children:[a.jsx("option",{value:"",children:"All Departments"}),B.map(lt=>a.jsx("option",{value:lt,children:lt},lt))]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Showing"," ",B.length," ","departments for ",g," ","status"]})]}),Ze.includes(g)&&B.length===0&&a.jsxs("div",{className:"mb-4",children:[a.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:["Next Department (",g,")"]}),a.jsxs("div",{className:"px-3 py-2 text-sm text-gray-500 bg-gray-50 rounded-md border",children:["No departments available for"," ",g," status"]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Date Range"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:"From"}),a.jsx("input",{type:"date",name:"fromDate",value:J.fromDate,onChange:un,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:"To"}),a.jsx("input",{type:"date",name:"toDate",value:J.toDate,onChange:un,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary"})]})]})]}),a.jsxs("div",{className:"flex justify-between pt-3 border-t border-gray-200",children:[a.jsx("button",{onClick:()=>U(!1),className:"px-3 py-1.5 text-sm text-gray-600 hover:text-gray-800 font-medium",children:"Close"}),a.jsx("button",{onClick:ir,className:"px-4 py-1.5 bg-gray-100 text-gray-700 text-sm font-medium rounded-md hover:bg-gray-200",children:"Clear Filters"})]})]})]}),a.jsx(U2e,{showBulkApproval:xe,handleSelectAll:ke,selectAll:M,currentUsers:$t,navigate:K,handleRequestSelect:Fe,handleCopyReqId:Ce,handleOpenInNewTab:Be,formatCurrency:Qr,renderActionColumn:Wt,Pagination:tp,currentPage:X,totalPages:vt,handlePageChange:Bt,itemsPerPage:He,filteredUsers:Q,selectedRequests:E}),ee&&a.jsx(EditReqModal,{setIsShowModal:b,sendEditMail:tt}),Ae&&a.jsx(DeleteReqModal,{setIsDelete:W,handleDelete:Nr,reqId:c})]})]})},O2e=()=>{const e=Sr(),[t,r]=C.useState([]),[n,s]=C.useState([]),[i,o]=C.useState(null),[l,c]=C.useState(""),[A,d]=C.useState({employeeId:"",empName:"",email:"",role:"",department:""});C.useEffect(()=>{(async()=>{try{const g=await jI();r(g.data||[])}catch(g){Ie.error("Error fetching employees"),console.error("Error fetching employees:",g)}})()},[]);const u=m=>{const g=m.target.value;if(c(g),!g){o(null),s([]);return}const p=t.filter(v=>v.employee_id.toLowerCase().includes(g.toLowerCase())||v.full_name.toLowerCase().includes(g.toLowerCase()));s(p)},f=m=>{o(m),d(g=>({...g,employeeId:m.employee_id,empName:m.full_name,email:m.company_email_id,department:m.department,role:""})),c(m.employee_id),s([])},h=m=>{const{name:g,value:p}=m.target;d(v=>({...v,[g]:p}))},x=async m=>{console.log("Selected employee",A),m.preventDefault();try{(await EI(A)).status===201&&(Ie.success("Employee added successfully"),setTimeout(()=>{e("/panel-members-table")},1500))}catch{Ie.error("Error adding employee")}};return a.jsxs("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[a.jsx("div",{children:a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Add User"})}),a.jsxs("form",{onSubmit:x,children:[a.jsxs("div",{className:"p-4 border rounded-lg border-primary space-y-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Employee"}),a.jsx("input",{name:"searchInput",value:l,type:"text",placeholder:"Search by Employee ID or Name",onChange:u,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),n.length>0&&a.jsx("div",{className:"absolute z-10 w-full bg-white border rounded shadow-lg",children:n.map(m=>a.jsxs("div",{onClick:()=>f(m),className:"p-2 hover:bg-gray-100 cursor-pointer",children:[m.employee_id," - ",m.full_name]},m._id))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee Name"}),a.jsx("input",{name:"empName",type:"text",placeholder:"Employee Name",value:A.empName,onChange:h,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary",readOnly:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),a.jsx("input",{name:"email",type:"email",placeholder:"Email",value:A.email,onChange:h,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary",readOnly:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),a.jsx("input",{name:"department",type:"text",placeholder:"Department",value:A.department,onChange:h,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary",readOnly:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),a.jsxs("select",{name:"role",value:A.role,onChange:h,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary",children:[a.jsx("option",{value:"",children:"Select role"}),a.jsx("option",{value:"Admin",children:"Admin"}),a.jsx("option",{value:"Business Finance",children:"Business Finance"}),a.jsx("option",{value:"Vendor Management",children:"Vendor Management"}),a.jsx("option",{value:"Legal Team",children:"Legal Team"}),a.jsx("option",{value:"Info Security",children:"Info Security"}),a.jsx("option",{value:"Head of Finance",children:"Head of Finance"})]})]})]}),a.jsx("div",{className:"flex justify-end mt-6",children:a.jsx("button",{type:"submit",className:"px-6 py-2 bg-primary text-white rounded hover:bg-primary focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",children:"SUBMIT"})})]}),a.jsx(In,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,pauseOnFocusLoss:!0})]})},R2e=({currentPage:e,totalPages:t,handlePageChange:r,itemsPerPage:n,totalItems:s})=>{const i=()=>{const h=[],x=[];let m;for(let g=1;g<=t;g++)(g===1||g===t||g>=e-2&&g<=e+2)&&h.push(g);return h.forEach(g=>{m&&(g-m===2?x.push(m+1):g-m!==1&&x.push("...")),x.push(g),m=g}),x},o=(e-1)*n,l=Math.min(o+n,s),c="flex items-center justify-center px-3 py-2 text-sm font-medium transition-colors duration-200",A="bg-primary text-white hover:bg-primary/90",d="text-gray-500 hover:bg-gray-100",u="text-gray-300 cursor-not-allowed hover:bg-transparent";return a.jsxs("div",{className:"flex items-center justify-between px-6 py-4 bg-gray-50 border-t border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[a.jsx("span",{children:"Showing"}),a.jsx("span",{className:"font-medium",children:o+1}),a.jsx("span",{children:"to"}),a.jsx("span",{className:"font-medium",children:l}),a.jsx("span",{children:"of"}),a.jsx("span",{className:"font-medium",children:s}),a.jsx("span",{children:"entries"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>r(1),disabled:e===1,className:`${c} rounded-l-lg ${e===1?u:d}`,children:a.jsx(Gm,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>r(e-1),disabled:e===1,className:`${c} ${e===1?u:d}`,children:a.jsx(zm,{className:"h-4 w-4"})}),a.jsx("div",{className:"flex items-center",children:i().map((f,h)=>a.jsx("button",{onClick:()=>typeof f=="number"&&r(f),className:`${c} ${f===e?A:typeof f=="number"?d:u}`,disabled:typeof f!="number",children:f},h))}),a.jsx("button",{onClick:()=>r(e+1),disabled:e===t,className:`${c} ${e===t?u:d}`,children:a.jsx(Wf,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>r(t),disabled:e===t,className:`${c} rounded-r-lg ${e===t?u:d}`,children:a.jsx(Wm,{className:"h-4 w-4"})})]})]})},Q2e=({isOpen:e,onClose:t,departments:r,hods:n,onFilter:s})=>{const[i,o]=C.useState(""),[l,c]=C.useState(""),A=()=>{s({department:i,hod:l}),t()};return e?a.jsx("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-medium",children:"Filters"}),a.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700",children:a.jsx(_r,{className:"h-5 w-5"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),a.jsxs("select",{value:i,onChange:d=>o(d.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[a.jsx("option",{value:"",children:"All Departments"}),r.map(d=>a.jsx("option",{value:d,children:d},d))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"HOD"}),a.jsxs("select",{value:l,onChange:d=>c(d.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[a.jsx("option",{value:"",children:"All HODs"}),n.map(d=>a.jsx("option",{value:d,children:d},d))]})]}),a.jsx("button",{onClick:A,className:"w-full bg-primary text-white rounded-md py-2 text-sm font-medium hover:bg-primary/90",children:"Apply Filters"})]})]})}):null},M2e=()=>{const e=Sr(),[t,r]=C.useState([]),[n,s]=C.useState([]),[i,o]=C.useState([]),[l,c]=C.useState(!1),[A,d]=C.useState(1),[u,f]=C.useState(""),[h,x]=C.useState(!1);C.useState(!1);const[m,g]=C.useState({});C.useState([]);const[p,v]=C.useState({department:"",hod:""}),w=20,B=async()=>{c(!0);try{const K=await g$();s(K.data),o(K.data);const ae=K.data.reduce((Z,oe)=>(Z[oe.employee_id]=!0,Z),{});g(ae)}catch(K){Ie.error("Error fetching employees"),console.error("Error fetching employees:",K)}c(!1)};C.useEffect(()=>{B()},[]),C.useEffect(()=>{let K=[...n];u&&(K=K.filter(ae=>["full_name","employee._id","department"].some(Z=>String(ae[Z]||"").toLowerCase().includes(u.toLowerCase())))),p.department&&(K=K.filter(ae=>ae.department===p.department)),p.hod&&(K=K.filter(ae=>ae.hod===p.hod)),o(K),d(1)},[u,p,n]);const T=async K=>{const ae=await x$(K);ae.status===200?(s(n==null?void 0:n.filter(Z=>(Z==null?void 0:Z._id)!==K)),Ie.success(ae.data.message)):Ie.error(ae.data.message)},_=[...new Set(n.map(K=>K.department))],j=[...new Set(n.map(K=>K.hod))],E=Math.ceil(i.length/w),L=(A-1)*w,M=L+w,F=i.slice(L,M),D=K=>{K>=1&&K<=E&&(d(K),r([]))},G=K=>{v(K)};return a.jsxs("div",{className:"p-4 md:p-8 bg-white rounded-lg shadow-sm h-full",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Employee List"}),a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:space-x-4 mb-4 space-y-3 md:space-y-0",children:[a.jsxs("div",{className:"relative flex-1 w-full md:min-w-[300px] md:max-w-md",children:[a.jsx(rn,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),a.jsx("input",{type:"text",value:u,onChange:K=>f(K.target.value),placeholder:"Search employees...",className:"w-full pl-11 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),a.jsxs("div",{className:"relative",children:[a.jsxs("button",{className:"w-full md:w-auto inline-flex items-center justify-center px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",onClick:()=>x(!h),children:[a.jsx(ti,{className:"h-4 w-4 mr-2"}),"Filter"]}),a.jsx(Q2e,{isOpen:h,onClose:()=>x(!1),departments:_,hods:j,onFilter:G})]}),a.jsxs("button",{className:"w-full md:w-auto inline-flex items-center justify-center px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[a.jsx(_n,{className:"h-4 w-4 mr-2"}),"Export"]}),a.jsxs("button",{className:"w-full md:w-auto inline-flex items-center justify-center px-4 py-2.5 bg-primary text-white rounded-lg text-sm font-medium hover:bg-primary/90",onClick:()=>e("/panel-members-table/add-panel-members"),children:[a.jsx(yn,{className:"h-4 w-4 mr-2"}),"Add User"]})]})]}),a.jsxs("div",{className:"bg-white shadow-lg rounded-lg border border-gray-200 overflow-hidden",children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-primary",children:a.jsx("tr",{children:["SL NO","User Name","Department","Role","Actions"].map(K=>a.jsx("th",{className:"sticky top-0 px-6 py-4 text-left text-xs font-bold text-white uppercase tracking-wider",children:K},K))})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:F==null?void 0:F.map((K,ae)=>a.jsxs("tr",{className:"hover:bg-blue-50 transition duration-200 ease-in-out",children:[a.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:ae+1}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"block font-semibold text-gray-900",children:K.employee_id||"NA"}),a.jsx("span",{className:"block font-medium text-gray-800",children:K.full_name||"NA"}),a.jsx("span",{className:"block text-sm text-gray-500",children:K.company_email_id||"NA"})]})}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:K.department}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:K.role}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex space-x-4",children:[a.jsx("button",{className:"text-primary hover:text-blue-800 transition",onClick:()=>e(`/panel-members-table/edit-panel-members/${K._id}`),children:a.jsx(Us,{className:"h-5 w-5"})}),a.jsx("button",{onClick:()=>T(K._id),className:"text-red-600 hover:text-red-800 transition",children:a.jsx($r,{className:"h-5 w-5"})})]})})]},K._id))})]})}),a.jsx(R2e,{currentPage:A,totalPages:E,handlePageChange:D,itemsPerPage:w,totalItems:i.length})]}),a.jsx(In,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,pauseOnFocusLoss:!0})]})},H2e=()=>{const{id:e}=yo(),t=Sr(),[r,n]=C.useState({employeeId:"",empName:"",email:"",role:"",department:""});C.useEffect(()=>{(async()=>{try{const c=(await w$(e)).data;n({employeeId:c.employee_id,empName:c.full_name,email:c.company_email_id,department:c.department,role:c.role||"Admin"})}catch(l){Ie.error("Error fetching employee details"),console.error("Error fetching employee details:",l)}})()},[e]);const s=o=>{const{name:l,value:c}=o.target;n(A=>({...A,[l]:c}))},i=async o=>{o.preventDefault();try{const l=await EI(r);l.status===200&&(Ie.success(l.data.message),setTimeout(()=>{t("/panel-members-table")},1500))}catch{Ie.error("Error adding employee")}};return a.jsxs("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[a.jsx("div",{children:a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Add User"})}),a.jsxs("form",{onSubmit:i,children:[a.jsxs("div",{className:"p-4 border rounded-lg border-primary space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee ID"}),a.jsx("input",{name:"employeeId",type:"text",value:r.employeeId,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee Name"}),a.jsx("input",{name:"empName",type:"text",value:r.empName,onChange:s,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),a.jsx("input",{name:"email",type:"email",value:r.email,onChange:s,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),a.jsx("input",{name:"department",type:"text",value:r.department,onChange:s,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),a.jsxs("select",{name:"role",value:r.role,onChange:s,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary",children:[a.jsx("option",{value:"",children:"Select role"}),a.jsx("option",{value:"Admin",children:"Admin"}),a.jsx("option",{value:"Vendor Management",children:"Vendor Management"}),a.jsx("option",{value:"Business Finance",children:"Business Finance"}),a.jsx("option",{value:"Legal Team",children:"Legal Team"}),a.jsx("option",{value:"Info Security",children:"Info Security"}),a.jsx("option",{value:"Head of Finance",children:"Head Of Finance"})]})]})]}),a.jsx("div",{className:"flex justify-end mt-6",children:a.jsx("button",{type:"submit",className:"px-6 py-2 bg-primary text-white rounded hover:bg-primary focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",children:"SUBMIT"})})]}),a.jsx(In,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,pauseOnFocusLoss:!0})]})},V2e=()=>{const e=Sr(),t=60*60*1e3,r=1*60*1e3,n=0,s=0,i=5*60*1e3,o=()=>{localStorage.setItem("lastActivityTime",Date.now().toString())},l=(m=!1,g="")=>{localStorage.clear(),sessionStorage.clear(),m?vi.fire({title:"Session Expired",text:g||"Your session has expired. Please log in again.",icon:"warning",confirmButtonText:"OK",confirmButtonColor:"#3085d6"}).then(()=>{e("/")}):e("/")},c=(m=!1)=>{let g=m?i/1e3:r/1e3;const p=m?"Daily Session Ending Soon":"Session Expiring Soon",v=m?`Your daily session will end in <b>${g}</b> seconds.<br/>Do you want to stay logged in?`:`Your session will expire in <b>${g}</b> seconds.<br/>Do you want to stay logged in?`;let w;vi.fire({title:p,html:v,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, keep me logged in",cancelButtonText:"Logout now",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",timer:g*1e3,timerProgressBar:!0,didOpen:()=>{w=setInterval(()=>{g-=1;const B=vi.getHtmlContainer();if(B){const T=B.querySelector("b");T&&(T.textContent=g)}},1e3)},willClose:()=>clearInterval(w)}).then(B=>{B.isConfirmed?(o(),u()):(B.dismiss===vi.DismissReason.cancel||B.dismiss===vi.DismissReason.timer)&&l(!0,m?"Daily session has ended. Please log in again.":"Your session has expired. Please log in again.")})};let A,d;const u=()=>{clearTimeout(A),clearTimeout(d),d=setTimeout(()=>c(!1),t-r),A=setTimeout(()=>l(!0),t)};let f,h;const x=()=>{const m=new Date,g=new Date;g.setHours(n,s,0,0),m>=g&&g.setDate(g.getDate()+1);const p=g-m,v=Math.max(p-i,0);f=setTimeout(()=>c(!0),v),h=setTimeout(()=>{l(!0,"Daily session has ended. Please log in again."),x()},p)};return C.useEffect(()=>{if(!localStorage.getItem("capEmpId")){e("/");return}o(),u(),x();const g=["mousemove","mousedown","keypress","scroll","touchstart","click"],p=()=>{localStorage.getItem("capEmpId")&&(o(),u())};g.forEach(w=>window.addEventListener(w,p));const v=()=>{!document.hidden&&localStorage.getItem("capEmpId")&&(o(),u())};return document.addEventListener("visibilitychange",v),()=>{g.forEach(w=>window.removeEventListener(w,p)),document.removeEventListener("visibilitychange",v),clearTimeout(A),clearTimeout(d),clearTimeout(f),clearTimeout(h)}},[e]),null},$2e=({tableData:e,formatCurrencyValue:t})=>{const r=e.reduce((s,i)=>(s.totalRequests+=i.totalRequests||0,s.approvedRequests+=i.approvedRequests||0,s.rejectedRequests+=i.rejectedRequests||0,s.pendingRequests+=i.pendingRequests||0,s.holdRequests+=i.holdRequests||0,s),{totalRequests:0,approvedRequests:0,rejectedRequests:0,pendingRequests:0,holdRequests:0}),n=[{title:"Total Requests",count:r.totalRequests,bgColor:"bg-blue-50",textColor:"text-blue-600",borderColor:"border-blue-200",iconColor:"text-blue-500"},{title:"Approved Requests",count:r.approvedRequests,bgColor:"bg-green-50",textColor:"text-green-600",borderColor:"border-green-200",iconColor:"text-green-500"},{title:"Pending Requests",count:r.pendingRequests,bgColor:"bg-yellow-50",textColor:"text-yellow-600",borderColor:"border-yellow-200",iconColor:"text-yellow-500"},{title:"Hold Requests",count:r.holdRequests,bgColor:"bg-orange-50",textColor:"text-orange-600",borderColor:"border-orange-200",iconColor:"text-orange-500"},{title:"Rejected Requests",count:r.rejectedRequests,bgColor:"bg-red-50",textColor:"text-red-600",borderColor:"border-red-200",iconColor:"text-red-500"}];return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:n.map((s,i)=>a.jsx("div",{className:`${s.bgColor} ${s.borderColor} border rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow duration-200`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:`text-sm font-medium ${s.textColor} mb-1`,children:s.title}),a.jsx("p",{className:`text-2xl font-bold ${s.textColor}`,children:s.count.toLocaleString()})]}),a.jsxs("div",{className:`${s.iconColor}`,children:[s.title==="Total Requests"&&a.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),s.title==="Approved Requests"&&a.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.title==="Pending Requests"&&a.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.title==="Hold Requests"&&a.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.title==="Rejected Requests"&&a.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})})]})]})},i))}),a.jsx("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-max",children:[" ",a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"SL"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Entity"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Requests"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Approved"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rejected"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pending"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hold"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Currency"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Funds"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rejected Funds"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hold Funds"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pending Funds"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Approved Funds"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Approved Flows"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hold Flows"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rejected Flows"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Success Rate"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Next Department"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:e.map((s,i)=>{var o,l,c,A,d,u,f,h;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3",children:i+1}),a.jsx("td",{className:"px-4 py-3",children:((o=s._id)==null?void 0:o.entity)||"N/A"}),a.jsx("td",{className:"px-4 py-3",children:((l=s._id)==null?void 0:l.department)||"N/A"}),a.jsx("td",{className:"px-4 py-3",children:s.totalRequests||0}),a.jsx("td",{className:"px-4 py-3",children:s.approvedRequests||0}),a.jsx("td",{className:"px-4 py-3",children:s.rejectedRequests||0}),a.jsx("td",{className:"px-4 py-3",children:s.pendingRequests||0}),a.jsx("td",{className:"px-4 py-3",children:s.holdRequests||0}),a.jsx("td",{className:"px-4 py-3",children:((c=s._id)==null?void 0:c.currency)||"N/A"}),a.jsx("td",{className:"px-4 py-3",children:t(s.totalFund,(A=s._id)==null?void 0:A.currency)}),a.jsx("td",{className:"px-4 py-3",children:t(s.rejectedFund,(d=s._id)==null?void 0:d.currency)}),a.jsx("td",{className:"px-4 py-3",children:t(s.holdFund,(u=s._id)==null?void 0:u.currency)}),a.jsx("td",{className:"px-4 py-3",children:t(s.pendingFund,(f=s._id)==null?void 0:f.currency)}),a.jsx("td",{className:"px-4 py-3",children:t(s.approvedFund,(h=s._id)==null?void 0:h.currency)}),a.jsx("td",{className:"px-4 py-3",children:s.approvedToApprovedFlows!==void 0?s.approvedToApprovedFlows:"-"}),a.jsx("td",{className:"px-4 py-3",children:s.approvedToHoldFlows!==void 0?s.approvedToHoldFlows:"-"}),a.jsx("td",{className:"px-4 py-3",children:s.approvedToRejectedFlows!==void 0?s.approvedToRejectedFlows:"-"}),a.jsx("td",{className:"px-4 py-3",children:s.successRate!==void 0?`${s.successRate.toFixed(1)}%`:"-"}),a.jsx("td",{className:"px-4 py-3",children:s.nextDepartment||"-"})]},i)})})]})})})]})},q2e=[{code:"USD",symbol:"$",locale:"en-US"},{code:"EUR",symbol:"",locale:"de-DE"},{code:"GBP",symbol:"",locale:"en-GB"},{code:"INR",symbol:"",locale:"en-IN"},{code:"AED",symbol:".",locale:"ar-AE"},{code:"IDR",symbol:"Rp",locale:"id-ID"},{code:"MYR",symbol:"RM",locale:"ms-MY"},{code:"SGD",symbol:"S$",locale:"en-SG"},{code:"PHP",symbol:"",locale:"fil-PH"}],K2e=["Business Finance","Vendor Management","Legal Team","Info Security","Head of Finance"],z2e=()=>{const[e,t]=C.useState({totalRequests:0,pendingRequests:0,rejectedRequests:0,invoicePending:0,approvedRequests:0,poPendingRequest:0,holdRequests:0,departmentBudgetByCurrency:{}}),[r,n]=C.useState("department"),[s,i]=C.useState("general"),[o,l]=C.useState({entity:"",department:"",role:"",status:"",nextDepartment:"",fromDate:"",toDate:""}),[c,A]=C.useState([]),[d,u]=C.useState([]),[f,h]=C.useState([]),[x,m]=C.useState(""),[g,p]=C.useState(!1),[v,w]=C.useState([]),[B,T]=C.useState([]),[_,j]=C.useState(!1),E=["Pending","Rejected","Hold"];C.useEffect(()=>{(async()=>{try{const b=await $$();b.status===200&&t(b.data);const O=await uq();if(console.log(O),O.status===200){A(O.data.entities);const S=(O.data.departments||[]).sort();u(S),w(S)}}catch(b){console.error("Error fetching initial data:",b)}})()},[]),C.useEffect(()=>{if(x){const ee=d.filter(b=>b.toLowerCase().includes(x.toLowerCase()));w(ee)}else w(d)},[x,d]);const L=ee=>{n(ee),l(b=>({...b,department:ee==="role"?"":b.department,role:ee==="department"?"":b.role})),ee==="role"&&(m(""),p(!1))},M=ee=>{i(ee),l(b=>({...b,fromDate:"",toDate:""}))},F=ee=>{m(ee.target.value),p(!0)},D=ee=>{l(b=>({...b,department:ee})),m(ee),p(!1)},G=()=>{l(ee=>({...ee,department:""})),m(""),p(!1)},K=ee=>{const{name:b,value:O}=ee.target;l(S=>({...S,[b]:O})),b==="status"&&(l(S=>({...S,[b]:O,nextDepartment:""})),E.includes(O)?ae(O):h([]))},ae=async ee=>{try{j(!0);const b={...o,status:ee,nextDepartment:""},O=await sS(b);if(O.status===200&&O.data.data){const S=[...new Set(O.data.data.map(I=>I.nextDepartment).filter(I=>I&&I.trim()!==""))].sort();h(S),console.log(`Available departments for ${ee}:`,S)}}catch(b){console.error("Error fetching available departments:",b),h([])}finally{j(!1)}},Z=async()=>{try{j(!0);const ee={...o,department:r==="department"?o.department:"",role:r==="role"?o.role:""},b=await sS(ee);b.status===200&&(T(b.data.data),console.log("Search results:",b.data.data))}catch(ee){console.error("Error searching reports:",ee)}finally{j(!1)}},oe=()=>{l({entity:"",department:"",role:"",status:"",nextDepartment:"",fromDate:"",toDate:""}),m(""),h([]),T([]),p(!1),n("department"),i("general")},Y=(ee,b)=>{if(!ee)return 0;const O=q2e.find(S=>S.code===b);if(!O)return ee;try{return new Intl.NumberFormat(O.locale,{style:"currency",currency:O.code,minimumFractionDigits:2,maximumFractionDigits:2}).format(ee)}catch(S){return console.error("Currency formatting error:",S),ee}},R=ee=>ee&&Object.entries(ee).filter(([b,O])=>O!=null).map(([b,O])=>Y(O,b)).join(" + ")||"0",z=()=>{switch(s){case"general":return{from:"From Date",to:"To Date"};case"poRequested":return{from:"PO Requested From",to:"PO Requested To"};case"poExpiry":return{from:"PO Expiry From",to:"PO Expiry To"};default:return{from:"From Date",to:"To Date"}}};return a.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[a.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:a.jsx(Th,{className:"w-6 h-6 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Total Requests"}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:e.totalRequests})]})]})}),a.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:a.jsx(O3,{className:"w-6 h-6 text-green-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Total Budget"}),a.jsx("p",{className:"text-lg font-bold text-gray-800",children:R(e.departmentBudgetByCurrency)})]})]})}),a.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:a.jsx(ql,{className:"w-6 h-6 text-yellow-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Pending Requests"}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:e.pendingRequests})]})]})}),a.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:a.jsx(Ea,{className:"w-6 h-6 text-red-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Rejected Requests"}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:e.rejectedRequests})]})]})}),a.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-3 bg-orange-100 rounded-lg",children:a.jsx(Yi,{className:"w-6 h-6 text-orange-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Hold Requests"}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:e.holdRequests})]})]})}),a.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:a.jsx(O3,{className:"w-6 h-6 text-green-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Approved Requests"}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:e.approvedRequests})]})]})}),a.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:a.jsx(jr,{className:"w-6 h-6 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"PO Pending Requests"}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:e.poPendingRequest})]})]})}),a.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:a.jsx($4,{className:"w-6 h-6 text-purple-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Invoice Pending"}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:e.invoicePending})]})]})})]}),a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-6",children:"Search Filters"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Entity"}),a.jsxs("select",{name:"entity",value:o.entity,onChange:K,className:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 focus:ring-opacity-50 h-11",children:[a.jsx("option",{value:"",children:"Select Entity"}),c.map((ee,b)=>a.jsx("option",{value:ee,children:ee},b))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),a.jsxs("select",{name:"status",value:o.status,onChange:K,className:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 focus:ring-opacity-50 h-11",children:[a.jsx("option",{value:"",children:"Select Status"}),a.jsx("option",{value:"Approved",children:"Approved"}),a.jsx("option",{value:"Pending",children:"Pending"}),a.jsx("option",{value:"Rejected",children:"Rejected"}),a.jsx("option",{value:"Hold",children:"Hold"}),a.jsx("option",{value:"PO-Pending",children:"PO Pending"}),a.jsx("option",{value:"Invoice-Pending",children:"Invoice Pending"})]})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:"Filter By"}),a.jsxs("div",{className:"flex gap-6 mb-4",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"filterType",value:"department",checked:r==="department",onChange:ee=>L(ee.target.value),className:"w-4 h-4 text-indigo-600 bg-gray-100 border-gray-300 focus:ring-indigo-500 focus:ring-2"}),a.jsx("span",{className:"ml-2 text-sm font-medium text-gray-700",children:"Department"})]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"filterType",value:"role",checked:r==="role",onChange:ee=>L(ee.target.value),className:"w-4 h-4 text-indigo-600 bg-gray-100 border-gray-300 focus:ring-indigo-500 focus:ring-2"}),a.jsx("span",{className:"ml-2 text-sm font-medium text-gray-700",children:"Role"})]})]}),r==="department"&&a.jsxs("div",{className:"relative max-w-md",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Search departments...",value:x,onChange:F,onFocus:()=>p(!0),className:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 focus:ring-opacity-50 pr-10 h-11"}),a.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:a.jsx(vo,{className:"w-5 h-5 text-gray-400"})}),g&&a.jsxs("div",{className:"absolute z-20 mt-1 w-full bg-white shadow-lg max-h-60 rounded-lg border border-gray-200 overflow-auto",children:[o.department&&a.jsx("div",{className:"p-3 border-b border-gray-200",children:a.jsx("button",{onClick:G,className:"text-sm text-red-600 hover:text-red-800 font-medium",children:" Clear Selection"})}),v.length>0?v.map((ee,b)=>a.jsx("button",{onClick:()=>D(ee),className:`w-full text-left px-4 py-3 hover:bg-gray-50 transition-colors ${o.department===ee?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-900"}`,children:ee},b)):a.jsx("div",{className:"px-4 py-3 text-gray-500 text-sm",children:"No departments found"})]})]}),g&&a.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>p(!1)})]}),r==="role"&&a.jsxs("div",{className:"max-w-md",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role"}),a.jsxs("select",{name:"role",value:o.role,onChange:K,className:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 focus:ring-opacity-50 h-11",children:[a.jsx("option",{value:"",children:"Select Role"}),K2e.map((ee,b)=>a.jsx("option",{value:ee,children:ee},b))]})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:"Date Filter Type"}),a.jsxs("div",{className:"flex gap-6 mb-4",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"dateFilterType",value:"general",checked:s==="general",onChange:ee=>M(ee.target.value),className:"w-4 h-4 text-indigo-600 bg-gray-100 border-gray-300 focus:ring-indigo-500 focus:ring-2"}),a.jsx("span",{className:"ml-2 text-sm font-medium text-gray-700",children:"General Dates"})]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"dateFilterType",value:"poRequested",checked:s==="poRequested",onChange:ee=>M(ee.target.value),className:"w-4 h-4 text-indigo-600 bg-gray-100 border-gray-300 focus:ring-indigo-500 focus:ring-2"}),a.jsx("span",{className:"ml-2 text-sm font-medium text-gray-700",children:"PO Requested Date"})]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"dateFilterType",value:"poExpiry",checked:s==="poExpiry",onChange:ee=>M(ee.target.value),className:"w-4 h-4 text-indigo-600 bg-gray-100 border-gray-300 focus:ring-indigo-500 focus:ring-2"}),a.jsx("span",{className:"ml-2 text-sm font-medium text-gray-700",children:"PO Expiry Date"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-2xl",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:z().from}),a.jsx("input",{type:"date",name:"fromDate",value:o.fromDate,onChange:K,className:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 focus:ring-opacity-50 h-11"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:z().to}),a.jsx("input",{type:"date",name:"toDate",value:o.toDate,onChange:K,className:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 focus:ring-opacity-50 h-11"})]})]})]}),E.includes(o.status)&&a.jsx("div",{className:"mb-6",children:a.jsxs("div",{className:"max-w-md",children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Next Department (",o.status,")"]}),a.jsxs("select",{name:"nextDepartment",value:o.nextDepartment,onChange:K,disabled:_,className:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 focus:ring-opacity-50 disabled:bg-gray-100 h-11",children:[a.jsx("option",{value:"",children:_?"Loading...":"All Departments"}),f.map((ee,b)=>a.jsx("option",{value:ee,children:ee},b))]}),f.length>0&&a.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[f.length," departments available"]}),E.includes(o.status)&&f.length===0&&!_&&a.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["No departments found for ",o.status," status"]})]})}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:justify-end",children:[a.jsx("button",{onClick:oe,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors text-sm font-medium",children:"Clear Filters"}),a.jsxs("button",{onClick:Z,disabled:_,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm font-medium",children:[a.jsx(rn,{className:"mr-2 w-4 h-4"}),_?"Searching...":"Search"]})]})]}),B.length>0&&a.jsx($2e,{tableData:B,formatCurrencyValue:Y}),B.length===0&&o.status&&!_&&a.jsx("div",{className:"bg-white p-8 rounded-xl shadow-sm border text-center",children:a.jsx("p",{className:"text-gray-500",children:"No results found for the selected criteria."})})]})},G2e=({action:e})=>{const t=Sr(),n=(()=>{switch(e){case"Pending-Request":return{title:"No Pending Requests",description:"There are currently no requests waiting for approval."};case"Approved-Request":return{title:"No Approved Requests",description:"There are no requests that have been approved yet."};case"Completed-Request":return{title:"No Completed Requests",description:"There are no requests that have been completed yet."};case"Total-Request":return{title:"No Requests Found",description:"There are no requests in the system at the moment."};default:return{title:"No Data Available",description:"No requests match the current criteria."}}})();return a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"flex justify-center",children:a.jsx("div",{className:"bg-gray-100 rounded-full p-4",children:a.jsx(V_,{className:"h-12 w-12 text-gray-400"})})}),a.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:n.title}),a.jsx("p",{className:"mt-2 text-sm text-gray-500",children:n.description}),a.jsx("div",{className:"mt-6",children:a.jsxs("button",{onClick:()=>t("/req-list-table/create-request"),className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:[a.jsx(yn,{className:"h-4 w-4 mr-2"}),"Create New Request"]})})]})},W2e=()=>{const{action:e}=yo(),t=localStorage.getItem("capEmpId"),r=localStorage.getItem("department"),n=localStorage.getItem("multiRole"),s=localStorage.getItem("role"),i=Sr(),[o,l]=C.useState([]),[c,A]=C.useState([]),[d,u]=C.useState([]),[f,h]=C.useState(!0),[x,m]=C.useState(1),[g,p]=C.useState(""),[v,w]=C.useState(!1),[B,T]=C.useState(!1),[_,j]=C.useState(!1),[E,L]=C.useState("action"),[M,F]=C.useState(""),[D,G]=C.useState([]),[K,ae]=C.useState(null),[Z,oe]=C.useState(null),[Y,R]=C.useState({fromDate:"",toDate:""}),[z,ee]=C.useState([]),b=20;C.useEffect(()=>{(async()=>{const ue=await mo();ue.status===200&&G(ue.data.data)})()},[]),C.useEffect(()=>{const ue=(E==="action"?o:c).filter(Fe=>{var Ne,et,Se,Ce;const ke=((Ne=Fe.reqid)==null?void 0:Ne.toLowerCase().includes(g.toLowerCase()))||((et=Fe.userName)==null?void 0:et.toLowerCase().includes(g.toLowerCase()))||((Ce=(Se=Fe.commercials)==null?void 0:Se.businessUnit)==null?void 0:Ce.toLowerCase().includes(g.toLowerCase())),Te=!M||Fe.status===M;return ke&&Te});ee(ue),m(1)},[g,o,c,E,M]);const O=xe=>{F(xe.target.value)},S=Math.ceil(z.length/b),I=(x-1)*b,U=I+b;z.slice(I,U);const Q=xe=>{xe>=1&&xe<=S&&(m(xe),u([]))};let H;e==="Pending-Request"?H=["Pending","PO-Pending","Invoice-Pending"]:e==="Approved-Request"||e==="Completed-Request"?H=["Approved"]:e==="OnHold-Request"?H=["Hold"]:e==="Rejected-Request"&&(H=["Rejected"]);const X=xe=>{const{name:ue,value:Fe}=xe.target;R(ke=>({...ke,[ue]:Fe}))},V=xe=>{L(xe),m(1),u([])};C.useEffect(()=>{(async()=>{h(!0);try{let ue;if(s==="Admin"&&r==="Admin")if(ue=await rf(),A(ue.data.data),e==="Total-Request")l(ue.data.data);else{const Fe=ue.data.data.filter(ke=>H.includes(ke.status));l(Fe)}else if(ue=await tf(t),ue.status===200){A(ue.data.data);const Fe=ue.data.data.filter(ke=>H.includes(ke.status));l(Fe)}}catch(ue){console.error("Error fetching data:",ue)}finally{setTimeout(()=>{h(!1)},500)}})()},[t,s,e]);const Ae=xe=>{p(xe.target.value)},W=(xe,ue)=>{if(!xe)return"N/A";const Fe=D.find(ke=>ke.code===ue);if(!Fe)return xe;try{return new Intl.NumberFormat(Fe.locale,{style:"currency",currency:Fe.code,minimumFractionDigits:2,maximumFractionDigits:2}).format(xe)}catch(ke){return console.error("Currency formatting error:",ke),xe}},J=async(xe,ue)=>{xe.stopPropagation(),i(`/req-list-table/edit-req/${ue}`)},ve=()=>{R({fromDate:"",toDate:""}),p(""),T(!1)},de=async(xe,ue)=>{ue.stopPropagation();try{await navigator.clipboard.writeText(xe),ae(xe),setTimeout(()=>{ae(null)},2e3)}catch(Fe){console.error("Failed to copy: ",Fe);const ke=document.createElement("textarea");ke.value=xe,document.body.appendChild(ke),ke.focus(),ke.select();try{document.execCommand("copy"),ae(xe),setTimeout(()=>{ae(null)},2e3)}catch(Te){console.error("Fallback copy failed: ",Te)}document.body.removeChild(ke)}},te=(xe,ue)=>{ue.stopPropagation();const Fe=`/req-list-table/preview-one-req/${xe}`;window.open(Fe,"_blank")},je=async xe=>{try{(await Zm(xe)).status===200&&(l(o.filter(Fe=>Fe._id!==xe)),A(c.filter(Fe=>Fe._id!==xe)),w(!1))}catch(ue){console.error("Error deleting request:",ue)}},qe=()=>{console.log("Sending edit mail for request:",Z)};if(f)return a.jsx(Fd,{});if(o.length===0&&c.length===0)return a.jsx(G2e,{action:e});const He=xe=>xe.replace("-"," "),Ze=xe=>xe.status==="Approved"?a.jsx("td",{className:"text-sm text-gray-500 text-center md:px-6 md:py-4 px-2 py-2",children:a.jsx("span",{className:"text-xs text-gray-400",children:"No actions"})}):xe.isCompleted?s==="Admin"||s==="Head of Finance"||s==="HOD Department"||n==1?a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-sm text-gray-500",children:a.jsxs("div",{className:"flex justify-center items-center space-x-2",children:[a.jsx("button",{className:"text-blue-500 hover:text-blue-700",onClick:ue=>J(ue,xe._id),children:a.jsx(Us,{className:"h-4 w-4 md:h-5 md:w-5"})}),s==="Admin"&&a.jsx("button",{className:"text-red-500 hover:text-red-700",onClick:ue=>{ue.stopPropagation(),oe(xe._id),w(!0)},children:a.jsx($r,{className:"h-4 w-4 md:h-5 md:w-5"})})]})}):a.jsx("td",{className:"text-sm text-gray-500 text-center md:px-6 md:py-4 px-2 py-2",children:a.jsx("button",{className:"px-2 py-1 bg-primary text-white rounded-md hover:bg-primary text-xs md:text-sm",onClick:ue=>{ue.stopPropagation(),j(!0),oe(xe._id)},children:"Request Edit"})}):a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-sm text-gray-500",children:a.jsxs("div",{className:"flex justify-center items-center space-x-2",children:[a.jsx("button",{className:"text-blue-500 hover:text-blue-700",onClick:ue=>J(ue,xe._id),children:a.jsx(Us,{className:"h-4 w-4 md:h-5 md:w-5"})}),a.jsx("button",{className:"text-red-500 hover:text-red-700",onClick:ue=>{ue.stopPropagation(),oe(xe._id),w(!0)},children:a.jsx($r,{className:"h-4 w-4 md:h-5 md:w-5"})})]})});return a.jsxs(a.Fragment,{children:[f&&a.jsx(Fd,{}),a.jsxs("div",{className:"p-3 md:p-4 bg-white rounded-lg shadow-sm h-full",children:[K&&a.jsx("div",{className:"fixed top-4 right-4 z-50",children:a.jsxs("div",{className:"bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg flex items-center space-x-2",children:[a.jsx(ho,{className:"h-4 w-4"}),a.jsxs("span",{className:"text-sm font-medium",children:['ReqID "',K,'" copied successfully!']})]})}),a.jsxs("div",{className:"mb-4",children:[a.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-4",children:a.jsx("h2",{className:"text-xl md:text-2xl font-bold text-gray-900 mb-2 md:mb-0",children:`${He(e)} List`})}),a.jsxs("div",{className:"block lg:hidden mb-4",children:[a.jsxs("button",{className:"w-full flex justify-center items-center px-3 py-2 bg-primary text-white rounded-lg text-sm font-medium hover:bg-primary/90 mb-2",onClick:()=>i("/req-list-table/create-request"),children:[a.jsx(yn,{className:"h-4 w-4 mr-1"}),"Add Request"]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("button",{className:`px-3 py-1.5 md:px-4 md:py-2 rounded-lg text-sm font-medium transition-colors ${E==="action"?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,onClick:()=>V("action"),children:He(e)}),a.jsx("button",{className:`px-3 py-1.5 md:px-4 md:py-2 rounded-lg text-sm font-medium transition-colors ${E==="all"?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,onClick:()=>V("all"),children:"All"}),a.jsxs("button",{className:"flex-1 mr-2 flex justify-center items-center px-2 py-2 border border-gray-300 rounded-lg text-xs font-medium text-gray-700 bg-white hover:bg-gray-50",onClick:()=>T(!B),children:[a.jsx(ti,{className:"h-3 w-3 mr-1"}),"Filter"]}),a.jsxs("button",{className:"flex-1 flex justify-center items-center px-2 py-2 border border-gray-300 rounded-lg text-xs font-medium text-gray-700 bg-white hover:bg-gray-50",onClick:()=>Ud(o),children:[a.jsx(_n,{className:"h-3 w-3 mr-1"}),"Export"]})]})]}),a.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-3 lg:gap-6",children:[a.jsxs("div",{className:"relative w-full lg:flex-1 lg:min-w-[300px] lg:max-w-md",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:a.jsx(rn,{className:"h-4 w-4 md:h-5 md:w-5 text-gray-400"})}),a.jsx("input",{type:"text",value:g,onChange:Ae,placeholder:"Search by ID, name, or employee...",className:"w-full pl-10 pr-4 py-2 md:py-2.5 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),a.jsxs("div",{className:"hidden lg:flex items-center gap-4",children:[a.jsx("button",{className:`px-3 py-1.5 md:px-4 md:py-2 rounded-lg text-sm font-medium transition-colors ${E==="action"?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,onClick:()=>V("action"),children:He(e)}),a.jsx("button",{className:`px-3 py-1.5 md:px-4 md:py-2 rounded-lg text-sm font-medium transition-colors ${E==="all"?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,onClick:()=>V("all"),children:"All"}),a.jsxs("button",{className:"inline-flex items-center px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",onClick:()=>T(!B),children:[a.jsx(ti,{className:"h-4 w-4 mr-2"}),"Filter"]}),a.jsxs("button",{className:"inline-flex items-center px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",onClick:()=>Ud(o),children:[a.jsx(_n,{className:"h-4 w-4 mr-2"}),"Export"]}),a.jsxs("button",{className:"inline-flex items-center px-4 py-2.5 bg-primary text-white rounded-lg text-sm font-medium hover:bg-primary/90",onClick:()=>i("/req-list-table/create-request"),children:[a.jsx(yn,{className:"h-4 w-4 mr-2"}),"Add Request"]})]})]}),B&&a.jsxs("div",{className:"mt-4 w-full md:w-80 p-3 bg-white rounded-lg shadow-sm border border-gray-200 absolute right-0 md:right-8 z-10",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h3",{className:"text-xs font-medium text-gray-700",children:"Filters"}),a.jsx("button",{onClick:ve,className:"text-xs text-gray-500 hover:text-gray-700 flex items-center",children:a.jsx(_r,{className:"h-3 w-3"})})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("h4",{className:"text-xs font-medium text-gray-700 mb-2",children:"Date Range"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:"From"}),a.jsx("input",{type:"date",name:"fromDate",value:Y.fromDate,onChange:X,className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-primary focus:border-primary"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:"To"}),a.jsx("input",{type:"date",name:"toDate",value:Y.toDate,onChange:X,className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-primary focus:border-primary"})]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-xs font-medium text-gray-700 mb-2",children:"Status"}),a.jsxs("select",{value:M,onChange:O,className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-primary focus:border-primary",children:[a.jsx("option",{value:"",children:"All Statuses"}),a.jsx("option",{value:"Pending",children:"Pending"}),a.jsx("option",{value:"Hold",children:"Hold"}),a.jsx("option",{value:"Rejected",children:"Rejected"}),a.jsx("option",{value:"PO-Pending",children:"PO-Pending"}),a.jsx("option",{value:"Invoice-Pending",children:"Invoice-Pending"}),a.jsx("option",{value:"Approved",children:"Approved"})]})]})]})]}),a.jsx("div",{className:"border border-gray-200 rounded-lg w-full",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsx("div",{className:"inline-block min-w-full align-middle",children:a.jsxs("div",{className:"overflow-hidden",children:[a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-primary",children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",className:"sticky top-0 px-2 py-2 md:px-6 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[5%]",children:"SNo"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-2 py-2 md:px-6 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[15%]",children:"ReqId"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-2 py-2 md:px-6 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[15%] hidden md:table-cell",children:"Entity"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-2 py-2 md:px-6 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[15%] hidden md:table-cell",children:"Vendor"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-2 py-2 md:px-6 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[9%]",children:"Amount"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-2 py-2 md:px-6 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[13%]",children:"Status"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-2 py-2 md:px-6 md:py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[9%]",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:z.length>0?z.map((xe,ue)=>{var Fe,ke,Te,Ne,et,Se,Ce,Be;return a.jsxs("tr",{className:"hover:bg-gray-100 cursor-pointer",onClick:()=>i(`/req-list-table/preview-one-req/${xe._id}`),children:[a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-xs md:text-sm font-medium text-gray-900",children:(x-1)*b+ue+1}),a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-xs md:text-sm text-gray-500",children:a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"block font-medium",children:xe.reqid}),a.jsxs("div",{className:"flex space-x-1",children:[a.jsx("button",{onClick:Pe=>de(xe.reqid,Pe),className:"text-gray-400 hover:text-blue-500 transition-colors",title:"Copy Request ID",children:a.jsx(Gl,{className:"h-3 w-3 md:h-4 md:w-4"})}),a.jsx("button",{onClick:Pe=>te(xe._id,Pe),className:"text-gray-400 hover:text-green-500 transition-colors",title:"Open in new tab",children:a.jsx(Xf,{className:"h-3 w-3 md:h-4 md:w-4"})})]})]}),a.jsx("span",{className:"block font-medium",children:xe.userName||"Employee"}),a.jsx("span",{className:"block text-xs md:text-sm",children:(Fe=xe.commercials)==null?void 0:Fe.department})]})}),a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-xs md:text-sm text-gray-500 hidden md:table-cell",children:a.jsxs("div",{children:[a.jsx("span",{className:"block",children:((ke=xe.commercials)==null?void 0:ke.businessUnit)||"NA"}),a.jsx("span",{className:"block font-medium",children:((Te=xe.commercials)==null?void 0:Te.entity)||"NA"}),a.jsx("span",{className:"block",children:((Ne=xe.commercials)==null?void 0:Ne.site)||"NA"})]})}),a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-xs md:text-sm text-gray-500 hidden md:table-cell",children:a.jsxs("div",{children:[a.jsx("span",{className:"block font-medium",children:(et=xe.procurements)==null?void 0:et.vendor}),a.jsx("span",{className:"block",children:(Se=xe.procurements)==null?void 0:Se.vendorName})]})}),a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-xs md:text-sm text-gray-500",children:W((Ce=xe.supplies)==null?void 0:Ce.totalValue,(Be=xe.supplies)==null?void 0:Be.selectedCurrency)}),a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-xs md:text-sm text-gray-500",children:xe.isCompleted?a.jsxs(a.Fragment,{children:[xe.status!=="Approved"&&a.jsxs(a.Fragment,{children:[xe.nextDepartment," ",a.jsx("br",{})]}),xe.status||"Pending"]}):a.jsx("span",{className:"text-red-500",children:"Draft"})}),Ze(xe)]},xe._id)}):a.jsx("tr",{children:a.jsx("td",{colSpan:"13",className:"px-2 py-2 md:px-6 md:py-4 text-center text-xs md:text-sm text-gray-500",children:"No matching results found."})})})]}),a.jsx("div",{className:"mt-4 px-2 md:px-0",children:a.jsx(tp,{currentPage:x,totalPages:S,handlePageChange:Q,itemsPerPage:b,totalItems:z.length})})]})})})}),z.length===0&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"flex justify-center",children:a.jsx("div",{className:"bg-gray-100 rounded-full p-4",children:a.jsx(V_,{className:"h-10 w-10 text-gray-400"})})}),a.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"No matching results"}),a.jsx("p",{className:"mt-2 text-sm text-gray-500",children:E==="action"?`No ${He(e).toLowerCase()} requests match your search criteria.`:"No requests match your search criteria."}),E==="action"&&c.length>0&&a.jsx("div",{className:"mt-4",children:a.jsx("button",{onClick:()=>V("all"),className:"text-primary hover:text-primary/80 text-sm font-medium",children:"View all requests instead"})})]}),_&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-lg shadow-lg w-full max-w-sm md:max-w-md",children:[a.jsx("h3",{className:"text-lg md:text-xl font-semibold mb-4",children:"Send Edit Request"}),a.jsx("p",{className:"mb-6 text-sm md:text-base",children:"Do you want to send a edit request email to the Head of Department?"}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx("button",{onClick:()=>j(!1),className:"px-3 py-1.5 md:px-4 md:py-2 border rounded-lg text-sm hover:bg-gray-100",children:"Cancel"}),a.jsx("button",{onClick:()=>{j(!1),qe()},className:"bg-primary text-white px-3 py-1.5 md:px-4 md:py-2 rounded-lg text-sm hover:bg-primary/90",children:"Send Request"})]})]})}),v&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-lg shadow-lg w-full max-w-sm md:max-w-md",children:[a.jsx("h3",{className:"text-lg md:text-xl font-semibold mb-4",children:"Do you really want to delete this request?"}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx("button",{onClick:()=>w(!1),className:"px-3 py-1.5 md:px-4 md:py-2 border rounded-lg text-sm hover:bg-gray-100",children:"Cancel"}),a.jsx("button",{onClick:()=>je(Z),className:"bg-primary text-white px-3 py-1.5 md:px-4 md:py-2 rounded-lg text-sm hover:bg-primary/90",children:"Yes, Delete"})]})]})})]})]})},X2e=()=>{const e=Sr(),t=[{title:"Integrations",description:"Configure third-party service connections",items:[{title:"REST API",icon:Fa,bgColor:"bg-indigo-50",textColor:"text-indigo-600",description:"Create Api keys",path:"/settings/create-rest-api"},{title:"Email Notification",icon:hH,bgColor:"bg-cyan-50",textColor:"text-cyan-600",description:"Enable disable Email notification",path:"/settings/email-notification"},{title:"Approver Type",icon:xH,bgColor:"bg-green-50",textColor:"text-green-600",description:"Configure approval workflows",path:"/settings/approver-type"},{title:"Currency",icon:fH,bgColor:"bg-amber-50",textColor:"text-amber-600",description:"Manage currency settings",path:"/settings/all-listed-currency"},{title:"Upload Vendor Policy",icon:M3,bgColor:"bg-fuchsia-50",textColor:"text-fuchsia-600",description:"Manage the vendor policy document",path:"/settings/upload-vendor-policy"},{title:"Upload PO Policy",icon:M3,bgColor:"bg-pink-50",textColor:"text-pink-600",description:"Manage the purchase order policy",path:"/settings/upload-po-policy"}]}],r=({title:n,icon:s,bgColor:i,textColor:o,description:l,path:c,onClick:A})=>a.jsx("div",{onClick:()=>e(c),className:`${i} rounded-xl p-6 cursor-pointer transform transition-all duration-300 hover:scale-105 hover:shadow-xl border border-transparent hover:border-gray-200`,children:a.jsxs("div",{className:"flex items-start space-x-4",children:[a.jsx("div",{className:`${o} bg-white p-3 rounded-lg shadow-sm flex-shrink-0`,children:a.jsx(s,{className:"w-6 h-6"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:n}),a.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:l})]})]})});return a.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-gray-50 min-h-screen",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-8 mb-8",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[a.jsx("div",{className:"bg-blue-100 p-2 rounded-lg",children:a.jsx(K_,{className:"w-8 h-8 text-blue-600"})}),a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Settings"})]}),a.jsx("p",{className:"text-gray-600",children:"Manage your application settings and configurations"})]}),a.jsx("div",{className:"space-y-12",children:t.map((n,s)=>a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-8",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:n.title}),a.jsx("p",{className:"text-gray-600",children:n.description})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.items.map((i,o)=>a.jsx(r,{...i},o))})]},s))})]})},Y2e=()=>{const[e,t]=C.useState(""),[r,n]=C.useState(null),[s,i]=C.useState(!1),[o,l]=C.useState(null),[c,A]=C.useState(""),d="#80c242",u="#80c242",f="#80c242";C.useEffect(()=>{(async()=>{try{i(!0);const g=await xq();console.log("response",g.data.googleSSOKey),g.data&&g.data.googleSSOKey&&n({key:g.data.googleSSOKey})}catch(g){console.error("Error fetching key:",g),l("Failed to fetch existing key")}finally{i(!1)}})()},[]);const h=async m=>{if(m.preventDefault(),!e.trim()){l("Please enter an authentication key");return}i(!0),l(null),A("");try{const g=await pq(e);console.log(g),n({key:e}),A("Authentication key saved successfully!"),t("")}catch(g){l(g.message||"An error occurred during authentication")}finally{i(!1)}},x=async()=>{i(!0),l(null),A("");try{const m=await gq();if(console.log(m),m&&m.status===200)n(null),t(""),A("Authentication key deleted successfully!");else throw new Error("Failed to delete entry")}catch(m){l(m.message||"An error occurred while deleting")}finally{i(!1)}};return a.jsxs("div",{className:"p-6 w-full",children:[a.jsx("h1",{className:"text-2xl font-bold mb-6",style:{color:d},children:"Google SSO Authentication"}),c&&a.jsx("p",{className:"text-green-600 mb-4 font-medium",children:c}),o&&a.jsx("p",{className:"text-red-500 mb-4 font-medium",children:o}),a.jsx("form",{onSubmit:h,className:"mb-8 w-full",children:a.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[a.jsx("input",{type:"text",value:e,onChange:m=>t(m.target.value),placeholder:"Enter authentication key",className:"px-4 py-2 border rounded flex-grow",style:{borderColor:d}}),a.jsx("button",{type:"submit",className:"px-6 py-2 rounded text-white font-medium",style:{backgroundColor:d,boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},disabled:s,children:s?"Processing...":"Submit"})]})}),r&&a.jsxs("div",{className:"w-full mb-8",children:[a.jsx("h2",{className:"text-xl font-semibold mb-3",style:{color:d},children:"Current Authentication Key"}),a.jsxs("table",{className:"w-full border-collapse table-fixed",children:[a.jsx("thead",{children:a.jsxs("tr",{style:{backgroundColor:u,color:"white"},children:[a.jsx("th",{className:"border p-2 text-left w-16",children:"SL No."}),a.jsx("th",{className:"border p-2 text-left",children:"Auth Key"}),a.jsx("th",{className:"border p-2 text-center w-24",children:"Action"})]})}),a.jsx("tbody",{children:a.jsxs("tr",{children:[a.jsx("td",{className:"border p-2",children:"1"}),a.jsx("td",{className:"border p-2 break-words",children:r.key}),a.jsx("td",{className:"border p-2 text-center",children:a.jsx("button",{onClick:x,className:"px-3 py-1 rounded text-white",style:{backgroundColor:f},disabled:s,children:"Delete"})})]})})]})]}),a.jsxs("ul",{className:"mt-8 list-disc pl-5",style:{color:d},children:[a.jsx("li",{className:"mb-2",children:"Enter your Google SSO authentication key in the field above"}),a.jsx("li",{className:"mb-2",children:"The system will store only one key at a time"}),!r&&a.jsx("li",{className:"mb-2",children:"No authentication key is currently stored"})]}),s&&a.jsx("div",{className:"text-center mt-4",children:a.jsx("p",{children:"Loading..."})})]})},J2e=()=>{const e=localStorage.getItem("capEmpId"),[t,r]=C.useState({email:"",port:"",password:""}),[n,s]=C.useState(null),[i,o]=C.useState(!1),[l,c]=C.useState(null),[A,d]=C.useState(""),u="#80c242",f=async()=>{try{o(!0);const m=await Cq()}catch{c("Failed to fetch SMTP configuration"),o(!1)}};C.useEffect(()=>{f()},[]);const h=async m=>{if(m.preventDefault(),!t.email||!t.port||!t.password){c("Please fill all required fields");return}o(!0),c(null),d("");try{const g=await Nq(t,e)}catch{c("Failed to save SMTP configuration"),o(!1)}},x=async m=>{if(n){o(!0),c(null),d("");try{const g=await jq(m,e)}catch{c("Failed to delete SMTP configuration"),o(!1)}}};return a.jsxs("div",{className:"p-6 w-full",children:[a.jsx("h1",{className:"text-2xl font-bold mb-6",style:{color:u},children:"SMTP Configuration"}),A&&a.jsx("p",{className:"text-green-600 mb-4 font-medium",children:A}),l&&a.jsx("p",{className:"text-red-500 mb-4 font-medium",children:l}),a.jsxs("form",{onSubmit:h,className:"mb-8 w-full",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"mb-1 font-medium",style:{color:u},children:"SMTP Email"}),a.jsx("input",{type:"email",value:t.email,onChange:m=>r({...t,email:m.target.value}),placeholder:"smtp@example.com",className:"px-4 py-2 border rounded",style:{borderColor:u}})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"mb-1 font-medium",style:{color:u},children:"SMTP Port"}),a.jsx("input",{type:"text",value:t.port,onChange:m=>r({...t,port:m.target.value}),placeholder:"587 or 465",className:"px-4 py-2 border rounded",style:{borderColor:u}})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"mb-1 font-medium",style:{color:u},children:"SMTP Password"}),a.jsx("input",{type:"password",value:t.password,onChange:m=>r({...t,password:m.target.value}),placeholder:"Enter password",className:"px-4 py-2 border rounded",style:{borderColor:u}})]})]}),a.jsx("button",{type:"submit",className:"px-6 py-2 rounded text-white font-medium",style:{backgroundColor:u,boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},disabled:i,children:i?"Processing...":"Save Configuration"})]}),n&&a.jsxs("div",{className:"w-full mb-8",children:[a.jsx("h2",{className:"text-xl font-semibold mb-3",style:{color:u},children:"Current SMTP Configuration"}),a.jsxs("table",{className:"w-full border-collapse table-fixed",children:[a.jsx("thead",{children:a.jsxs("tr",{style:{backgroundColor:u,color:"white"},children:[a.jsx("th",{className:"border p-2 text-left w-16",children:"SL No."}),a.jsx("th",{className:"border p-2 text-left",children:"Email"}),a.jsx("th",{className:"border p-2 text-left w-24",children:"Port"}),a.jsx("th",{className:"border p-2 text-left",children:"Password"}),a.jsx("th",{className:"border p-2 text-center w-24",children:"Action"})]})}),a.jsx("tbody",{children:a.jsxs("tr",{children:[a.jsx("td",{className:"border p-2",children:"1"}),a.jsx("td",{className:"border p-2 break-words",children:n.email}),a.jsx("td",{className:"border p-2",children:n.port}),a.jsx("td",{className:"border p-2",children:""}),a.jsx("td",{className:"border p-2 text-center",children:a.jsx("button",{onClick:()=>x(n._id),className:"px-3 py-1 rounded text-white",style:{backgroundColor:u},disabled:i,children:"Delete"})})]})})]})]}),a.jsxs("ul",{className:"mt-8 list-disc pl-5",style:{color:u},children:[a.jsx("li",{className:"mb-2",children:"Configure your SMTP server details for email notifications"}),a.jsx("li",{className:"mb-2",children:"All fields are required for proper email functionality"}),a.jsx("li",{className:"mb-2",children:"Common SMTP ports are 587 (TLS) and 465 (SSL)"}),!n&&a.jsx("li",{className:"mb-2",children:"No SMTP configuration is currently stored"})]}),i&&a.jsx("div",{className:"text-center mt-4",children:a.jsx("p",{children:"Loading..."})})]})},Z2e=({message:e,type:t,onClose:r})=>a.jsx("div",{className:"fixed top-20 right-4 py-2 px-4 rounded-md shadow-lg z-50 text-white",style:{backgroundColor:t==="success"?"#10b981":"#ef4444",animation:"slideIn 0.5s ease-out"},children:a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-sm",children:e}),a.jsx("button",{onClick:r,className:"ml-2 text-white hover:text-gray-200 focus:outline-none",children:""})]})}),ewe=()=>{const[e,t]=C.useState([]),[r,n]=C.useState([]),[s,i]=C.useState(""),[o,l]=C.useState(null),[c,A]=C.useState(""),[d,u]=C.useState(!1),[f,h]=C.useState(null),[x,m]=C.useState([]),[g,p]=C.useState(null),[v,w]=C.useState(!1),[B,T]=C.useState(""),[_,j]=C.useState(""),[E,L]=C.useState(1),[M]=C.useState(5),[F,D]=C.useState(!0),[G,K]=C.useState({}),ae=C.useRef(null);C.useEffect(()=>{function H(X){ae.current&&!ae.current.contains(X.target)&&w(!1)}return document.addEventListener("mousedown",H),()=>{document.removeEventListener("mousedown",H)}},[]),C.useEffect(()=>{if(g){const H=setTimeout(()=>{p(null)},3e4);return()=>clearTimeout(H)}},[g]),C.useEffect(()=>{(async()=>{D(!0);try{const X=await cq();if(X.status===200){const Ae=X.data.empData||[];t(Ae),n(Ae)}else Y("Failed to fetch employees","error");const V=await Aq();if(V.status===200){const W=(V.data.formattedData||[]).map(J=>({id:J._id,apiKey:J.apiKey,secretKey:J.secretKey,purpose:J.purpose,valid:J.valid,employeeDetails:{employeeId:J.employeeId,full_name:J.full_name,company_email_id:J.email},createdAt:new Date(J.createdAt).toLocaleString()}));m(W)}else Y("Failed to fetch API credentials","error")}catch(X){Y("Failed to fetch data","error"),console.error(X)}finally{D(!1)}})()},[]);const Z=H=>{if(T(H),H.trim()==="")n(e);else{const X=e.filter(V=>{var Ae,W,J;return((Ae=V.employeeId)==null?void 0:Ae.toLowerCase().includes(H.toLowerCase()))||((W=V.full_name)==null?void 0:W.toLowerCase().includes(H.toLowerCase()))||((J=V.company_email_id)==null?void 0:J.toLowerCase().includes(H.toLowerCase()))});n(X)}},oe=H=>{console.log("Employee selected:",H),i(H.employee_id),l(H),T(`${H.full_name} (${H.company_email_id})`),w(!1)},Y=(H,X="success")=>{h(null),setTimeout(()=>{h({message:H,type:X})},100),setTimeout(()=>{h(null)},3e3)},R=async H=>{try{await navigator.clipboard.writeText(H),Y("Copied to clipboard!")}catch{Y("Failed to copy to clipboard","error")}},z=async H=>{if(H.preventDefault(),console.log("Form submitted - Employee:",s,"Purpose:",c),!s){Y("Please select an employee","error");return}if(!c.trim()){Y("Please enter a purpose","error");return}u(!0);try{const X=o||e.find(Ae=>Ae.employee_id===s);if(!X){Y("Employee details not found","error"),u(!1);return}const V=await rq({employeeId:s,purpose:c,employeeDetails:X});if(V.status===201){const Ae={id:V.data.id,employeeId:s,apiKey:V.data.password,secretKey:V.data.secretKey,purpose:c,valid:V.data.valid,employeeDetails:X,createdAt:new Date().toLocaleString()};p(Ae),m(W=>[Ae,...W]),i(""),l(null),T(""),A(""),Y("API Credentials generated successfully!")}else Y(V.data.message||"Failed to generate credentials","error")}catch(X){Y(X.message||"Failed to generate credentials","error"),console.error("Error generating credentials:",X)}finally{u(!1)}},ee=async H=>{try{const X=x.find(W=>W.id===H),V=!X.valid;if((await dq(H,V)).status===200){const W=x.map(J=>J.id===H?{...J,valid:!J.valid}:J);m(W),Y(`Credential ${X.valid?"disabled":"enabled"} successfully`)}else Y("Failed to update credential status","error")}catch(X){Y("Error updating credential status","error"),console.error(X)}},b=H=>{K(X=>({...X,[H]:!X[H]}))},O=x.filter(H=>{var V,Ae,W,J,ve,de,te;if(!_.trim())return!0;const X=_.toLowerCase();return((Ae=(V=H.employeeDetails)==null?void 0:V.full_name)==null?void 0:Ae.toLowerCase().includes(X))||((J=(W=H.employeeDetails)==null?void 0:W.company_email_id)==null?void 0:J.toLowerCase().includes(X))||((ve=H.purpose)==null?void 0:ve.toLowerCase().includes(X))||((de=H.apiKey)==null?void 0:de.toLowerCase().includes(X))||((te=H.secretKey)==null?void 0:te.toLowerCase().includes(X))}),S=E*M,I=S-M,U=O.slice(I,S),Q=H=>L(H);return a.jsxs("div",{className:"min-h-screen bg-gray-100 p-4 md:p-8",children:[a.jsx("div",{className:"fixed top-16 right-0 p-4 z-50",children:f&&a.jsx(Z2e,{message:f.message,type:f.type,onClose:()=>h(null)})}),a.jsxs("div",{className:"container mx-auto",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 mb-6",children:[a.jsx("h1",{className:"text-xl md:text-2xl font-bold mb-4 md:mb-6 text-primary",children:"Generate API Credentials"}),a.jsxs("form",{onSubmit:z,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"relative",ref:ae,children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Select Employee"}),a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Search Employees",value:B,onChange:H=>{Z(H.target.value),w(!0)},onClick:()=>w(!0),className:"w-full pl-10 pr-10 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"}),a.jsx(rn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),a.jsx("button",{type:"button",onClick:()=>w(!v),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:a.jsx(vo,{size:20})})]}),v&&a.jsx("ul",{className:"absolute z-10 w-full max-h-60 overflow-y-auto bg-white border rounded-lg shadow-lg mt-1",children:r.length>0?r.map(H=>a.jsxs("li",{onClick:()=>oe(H),className:"px-4 py-2 hover:bg-gray-100 cursor-pointer",children:[a.jsx("div",{className:"font-medium",children:H.full_name}),a.jsxs("div",{className:"text-sm text-gray-500",children:[H.employeeId," - ",H.company_email_id]})]},H.employeeId)):a.jsx("li",{className:"px-4 py-2 text-gray-500",children:"No employees found"})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Purpose of API"}),a.jsx("input",{type:"text",value:c,onChange:H=>A(H.target.value),placeholder:"Enter purpose of API",className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]})]}),g&&a.jsxs("div",{className:"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg animate-pulse",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Generated Token"}),a.jsx("div",{className:"text-sm text-gray-500",children:"Will disappear in 30 seconds"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"API Key"}),a.jsxs("div",{className:"flex items-center bg-white border rounded-lg",children:[a.jsx("input",{type:G.newApi?"text":"password",value:g.apiKey,readOnly:!0,className:"flex-grow px-3 py-2 bg-transparent"}),a.jsx("button",{type:"button",onClick:()=>b("newApi"),className:"p-2 text-gray-600 hover:bg-gray-100",children:G.newApi?a.jsx(bx,{size:18}):a.jsx(Po,{size:18})}),a.jsx("button",{type:"button",onClick:()=>R(g.apiKey),className:"p-2 text-primary hover:bg-gray-100",children:a.jsx(Gl,{size:18})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Secret Key"}),a.jsxs("div",{className:"flex items-center bg-white border rounded-lg",children:[a.jsx("input",{type:G.newSecret?"text":"password",value:g.secretKey,readOnly:!0,className:"flex-grow px-3 py-2 bg-transparent"}),a.jsx("button",{type:"button",onClick:()=>b("newSecret"),className:"p-2 text-gray-600 hover:bg-gray-100",children:G.newSecret?a.jsx(bx,{size:18}):a.jsx(Po,{size:18})}),a.jsx("button",{type:"button",onClick:()=>R(g.secretKey),className:"p-2 text-primary hover:bg-gray-100",children:a.jsx(Gl,{size:18})})]})]})]})]}),a.jsx("button",{type:"submit",disabled:d,className:"w-auto bg-primary text-white py-2 px-4 rounded-lg hover:bg-primary/90 disabled:opacity-50 mt-4 text-sm flex items-center",children:d?"Generating...":"Generate Credentials"})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[a.jsx("div",{className:"mb-4 flex flex-col md:flex-row md:items-center",children:a.jsxs("div",{className:"relative flex-grow mr-0 md:mr-2 mb-2 md:mb-0",children:[a.jsx("input",{type:"text",placeholder:"Search API Credentials",value:_,onChange:H=>{j(H.target.value),L(1)},className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"}),a.jsx(rn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20})]})}),F?a.jsx("div",{className:"flex justify-center py-8",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-full overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-3 text-left",children:"SL"}),a.jsx("th",{className:"p-3 text-left",children:"Employee"}),a.jsx("th",{className:"p-3 text-left",children:"Purpose"}),a.jsx("th",{className:"p-3 text-left",children:"API Key"}),a.jsx("th",{className:"p-3 text-left",children:"Secret Key"}),a.jsx("th",{className:"p-3 text-left",children:"Created At"}),a.jsx("th",{className:"p-3 text-left",children:"Status"}),a.jsx("th",{className:"p-3 text-left",children:"Actions"})]})}),a.jsx("tbody",{children:U.length>0?U.map((H,X)=>{var V,Ae;return a.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[a.jsx("td",{className:"p-3",children:(E-1)*M+X+1}),a.jsxs("td",{className:"p-3",children:[a.jsx("div",{className:"font-medium",children:((V=H.employeeDetails)==null?void 0:V.full_name)||"N/A"}),a.jsx("div",{className:"text-sm text-gray-500",children:((Ae=H.employeeDetails)==null?void 0:Ae.company_email_id)||"N/A"})]}),a.jsx("td",{className:"p-3",children:H.purpose||"N/A"}),a.jsx("td",{className:"p-3",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:"mr-2 truncate max-w-[100px] md:max-w-[150px]",children:G[`api-${H.id}`]?H.apiKey:""}),a.jsx("button",{onClick:()=>b(`api-${H.id}`),className:"text-gray-600 hover:text-gray-800 mr-1",children:G[`api-${H.id}`]?a.jsx(bx,{size:16}):a.jsx(Po,{size:16})}),a.jsx("button",{onClick:()=>R(H.apiKey),className:"text-primary hover:text-primary/80",children:a.jsx(Gl,{size:16})})]})}),a.jsx("td",{className:"p-3",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:"mr-2 truncate max-w-[100px] md:max-w-[150px]",children:G[`secret-${H.id}`]?H.secretKey:""}),a.jsx("button",{onClick:()=>b(`secret-${H.id}`),className:"text-gray-600 hover:text-gray-800 mr-1",children:G[`secret-${H.id}`]?a.jsx(bx,{size:16}):a.jsx(Po,{size:16})}),a.jsx("button",{onClick:()=>R(H.secretKey),className:"text-primary hover:text-primary/80",children:a.jsx(Gl,{size:16})})]})}),a.jsx("td",{className:"p-3",children:H.createdAt}),a.jsx("td",{className:"p-3",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${H.valid?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:H.valid?"Active":"Disabled"})}),a.jsx("td",{className:"p-3",children:a.jsx("button",{onClick:()=>ee(H.id),className:`py-1 px-2 rounded text-xs ${H.valid?"bg-red-500 text-white hover:bg-red-600":"bg-green-500 text-white hover:bg-green-600"}`,children:H.valid?"Disable":"Enable"})})]},H.id)}):a.jsx("tr",{children:a.jsx("td",{colSpan:"8",className:"p-4 text-center text-gray-500",children:_?"No matching credentials found":"No credentials available"})})})]})}),O.length>M&&a.jsx("div",{className:"flex justify-center mt-4",children:a.jsx("nav",{children:a.jsx("ul",{className:"flex flex-wrap space-x-1",children:Array.from({length:Math.ceil(O.length/M)}).map((H,X)=>a.jsx("li",{children:a.jsx("button",{onClick:()=>Q(X+1),className:`px-3 py-1 rounded ${E===X+1?"bg-primary text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:X+1})},X))})})})]})]})]})]})},twe=()=>a.jsx("div",{children:"ApprovalFlowPage"}),rwe=({toast:e,onClose:t})=>{const r={success:a.jsx($a,{className:"w-5 h-5"}),error:a.jsx(Ea,{className:"w-5 h-5"}),warning:a.jsx(xA,{className:"w-5 h-5"}),info:a.jsx(Fi,{className:"w-5 h-5"})},n={success:"bg-green-50 border-green-200 text-green-800",error:"bg-red-50 border-red-200 text-red-800",warning:"bg-yellow-50 border-yellow-200 text-yellow-800",info:"bg-blue-50 border-blue-200 text-blue-800"},s={success:"text-green-400",error:"text-red-400",warning:"text-yellow-400",info:"text-blue-400"};return C.useEffect(()=>{const i=setTimeout(()=>{t(e.id)},e.duration||2e3);return()=>clearTimeout(i)},[e.id,e.duration,t]),a.jsxs("div",{className:`flex items-center p-4 mb-3 border rounded-lg shadow-sm ${n[e.type]} transform transition-all duration-300 ease-in-out`,children:[a.jsx("div",{className:`flex-shrink-0 ${s[e.type]}`,children:r[e.type]}),a.jsx("div",{className:"ml-3 flex-1",children:a.jsx("p",{className:"text-sm font-medium",children:e.message})}),a.jsx("button",{onClick:()=>t(e.id),className:"ml-4 text-gray-400 hover:text-gray-600",children:a.jsx(_r,{className:"w-4 h-4"})})]})},nwe=({toasts:e,removeToast:t})=>e.length===0?null:a.jsx("div",{className:"fixed top-4 right-4 z-50 w-96",children:e.map(r=>a.jsx(rwe,{toast:r,onClose:t},r.id))}),swe=({isOpen:e,onClose:t,onConfirm:r,title:n,message:s,confirmText:i="Confirm",cancelText:o="Cancel",type:l="danger"})=>{if(!e)return null;const c={danger:"bg-red-600 hover:bg-red-700 text-white",warning:"bg-yellow-600 hover:bg-yellow-700 text-white",primary:"bg-blue-600 hover:bg-blue-700 text-white"};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:a.jsxs("div",{className:"p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:n}),a.jsx("p",{className:"text-sm text-gray-500 mb-6",children:s}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:o}),a.jsx("button",{onClick:r,className:`px-4 py-2 rounded-lg transition-colors ${c[l]}`,children:i})]})]})})})},awe=()=>{const[e,t]=C.useState([]),r=(s,i="info",o=4e3)=>{const c={id:Date.now()+Math.random(),message:s,type:i,duration:o};t(A=>[...A,c])};return{toasts:e,showToast:r,removeToast:s=>{t(i=>i.filter(o=>o.id!==s))},showSuccess:(s,i)=>r(s,"success",i),showError:(s,i)=>r(s,"error",i),showWarning:(s,i)=>r(s,"warning",i),showInfo:(s,i)=>r(s,"info",i)}},iwe=()=>{var ae;const[e,t]=C.useState([]),[r,n]=C.useState({}),[s,i]=C.useState(!1),[o,l]=C.useState(""),[c,A]=C.useState(!1),[d,u]=C.useState(new Set),[f,h]=C.useState(!1),[x,m]=C.useState({isOpen:!1,data:null}),{toasts:g,removeToast:p,showSuccess:v,showError:w}=awe(),B={USD:"$",EUR:"",GBP:"",JPY:"",CNY:"",INR:"",AUD:"A$",CAD:"C$",CHF:"Fr",NZD:"NZ$",SGD:"S$",HKD:"HK$",SEK:"kr",NOK:"kr",DKK:"kr",PLN:"z",CZK:"K",HUF:"Ft",RUB:"",BRL:"R$",MXN:"$",ZAR:"R",KRW:"",THB:"",MYR:"RM",IDR:"Rp",PHP:"",VND:"",AED:".",SAR:"",EGP:"",TRY:"",ILS:"",CLP:"$",COP:"$",PEN:"S/",ARS:"$",UYU:"$",BOB:"Bs",PYG:"",TWD:"NT$"};C.useEffect(()=>{(async()=>{try{const oe=await mo();oe.status===200&&t(oe.data.data)}catch(oe){console.error("Error loading currencies:",oe)}})()},[]);const T=async()=>{A(!0);try{const oe=await(await fetch("https://openexchangerates.org/api/currencies.json")).json();n(oe)}catch(Z){console.error("Failed to fetch currencies:",Z),n({USD:"United States Dollar",EUR:"Euro",GBP:"British Pound Sterling",JPY:"Japanese Yen",CNY:"Chinese Yuan",INR:"Indian Rupee",AUD:"Australian Dollar",CAD:"Canadian Dollar",CHF:"Swiss Franc",NZD:"New Zealand Dollar"})}A(!1)};C.useEffect(()=>{T()},[]);const _=Object.entries(r).filter(([Z,oe])=>Z.toLowerCase().includes(o.toLowerCase())||oe.toLowerCase().includes(o.toLowerCase())),j=async()=>{h(!0);const Z=d.size;try{const oe=Array.from(d).map(R=>({code:R,symbol:B[R]||R,locale:L(R),enabled:!0}));if((await yq(oe)).status===200){const R=await mo();R.status===200&&t(R.data.data),u(new Set),i(!1),l(""),v(`Successfully added ${Z} ${Z===1?"currency":"currencies"}!`)}else w("Failed to add currencies. Please try again.")}catch(oe){console.error("Failed to add currencies:",oe),w("Failed to add currencies. Please try again.")}finally{h(!1)}},E=async Z=>{const oe=e.find(z=>z._id===Z);if(!oe)return;const Y=!oe.enabled,R=Y?"enabled":"disabled";try{(await vq(Z,Y)).status===200?(t(ee=>ee.map(b=>b._id===Z?{...b,enabled:Y}:b)),v(`${oe.code} ${R} successfully!`)):w(`Failed to ${Y?"enable":"disable"} ${oe.code}`)}catch(z){console.error("Failed to toggle currency status:",z),w(`Failed to ${Y?"enable":"disable"} ${oe.code}`)}},L=Z=>({USD:"en-US",EUR:"de-DE",GBP:"en-GB",JPY:"ja-JP",CNY:"zh-CN",INR:"en-IN",AUD:"en-AU",CAD:"en-CA",CHF:"de-CH",NZD:"en-NZ",SGD:"en-SG",HKD:"zh-HK",SEK:"sv-SE",NOK:"nb-NO",DKK:"da-DK",PLN:"pl-PL",CZK:"cs-CZ",HUF:"hu-HU",RUB:"ru-RU",BRL:"pt-BR",MXN:"es-MX",ZAR:"en-ZA",KRW:"ko-KR",THB:"th-TH",MYR:"ms-MY",IDR:"id-ID",PHP:"fil-PH",VND:"vi-VN",AED:"ar-AE",SAR:"ar-SA",EGP:"ar-EG",TRY:"tr-TR",ILS:"he-IL",CLP:"es-CL",COP:"es-CO",PEN:"es-PE",ARS:"es-AR",UYU:"es-UY",BOB:"es-BO",PYG:"es-PY",TWD:"zh-TW"})[Z]||"en-US",M=Z=>{const oe=new Set(d);oe.has(Z)?oe.delete(Z):oe.add(Z),u(oe)},F=Z=>{m({isOpen:!0,data:Z})},D=async()=>{const Z=x.data;if(Z)try{(await wq(Z._id)).status===200?(t(Y=>Y.filter(R=>R._id!==Z._id)),v(`${Z.code} removed successfully!`)):w(`Failed to remove ${Z.code}`)}catch(oe){console.error("Failed to remove currency:",oe),w(`Failed to remove ${Z.code}`)}finally{m({isOpen:!1,data:null})}},G=e.filter(Z=>Z.enabled).length,K=e.length-G;return a.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[a.jsx(nwe,{toasts:g,removeToast:p}),a.jsx(swe,{isOpen:x.isOpen,onClose:()=>m({isOpen:!1,data:null}),onConfirm:D,title:"Remove Currency",message:`Are you sure you want to remove ${(ae=x.data)==null?void 0:ae.code}? This action cannot be undone.`,confirmText:"Remove",cancelText:"Cancel",type:"danger"}),a.jsxs("div",{className:"bg-white rounded-lg shadow-lg",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Currency Management"}),a.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Manage currencies for your project (",e.length," ","currencies: ",G," enabled, ",K," disabled)"]})]}),a.jsxs("button",{onClick:()=>i(!0),className:"inline-flex items-center px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary transition-colors",children:[a.jsx(yn,{className:"w-4 h-4 mr-2"}),"Add Currency"]})]})}),a.jsxs("div",{className:"overflow-x-auto",children:[a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"SL No"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Code"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Symbol"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Locale"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map((Z,oe)=>a.jsxs("tr",{className:`hover:bg-gray-50 ${Z.enabled?"":"opacity-60"}`,children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a.jsx("span",{className:"inline-flex items-center justify-center w-8 h-8 rounded-full bg-gray-100 text-gray-800 font-medium text-sm",children:oe+1})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:a.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:Z.code})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a.jsx("span",{className:"text-xl font-semibold",children:Z.symbol})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Z.locale}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Z.enabled?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:Z.enabled?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full mr-2"}),"Enabled"]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-2 h-2 bg-red-400 rounded-full mr-2"}),"Disabled"]})})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("button",{onClick:()=>E(Z._id),className:`inline-flex items-center px-3 py-1 rounded-md text-xs font-medium transition-colors ${Z.enabled?"bg-orange-100 text-orange-800 hover:bg-orange-200":"bg-green-100 text-green-800 hover:bg-green-200"}`,title:Z.enabled?"Click to disable":"Click to enable",children:Z.enabled?a.jsxs(a.Fragment,{children:[a.jsx(SH,{className:"w-3 h-3 mr-1"}),"Disable"]}):a.jsxs(a.Fragment,{children:[a.jsx(FH,{className:"w-3 h-3 mr-1"}),"Enable"]})}),a.jsxs("button",{onClick:()=>F(Z),className:"inline-flex items-center px-3 py-1 bg-red-100 text-red-800 hover:bg-red-200 rounded-md text-xs font-medium transition-colors",title:"Remove Currency",children:[a.jsx($r,{className:"w-3 h-3 mr-1"}),"Remove"]})]})})]},Z._id))})]}),e.length===0&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"text-gray-400 mb-4",children:a.jsx("svg",{className:"mx-auto h-12 w-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),a.jsx("p",{className:"text-gray-500 text-lg",children:"No currencies added yet"}),a.jsx("p",{className:"text-gray-400 text-sm mt-1",children:'Click "Add Currency" to get started'})]})]})]}),s&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[80vh] overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Add Currency"}),a.jsx("button",{onClick:()=>{i(!1),u(new Set),l("")},className:"text-gray-400 hover:text-gray-600",children:a.jsx(_r,{className:"w-6 h-6"})})]})}),a.jsx("div",{className:"p-4 border-b border-gray-200",children:a.jsxs("div",{className:"relative",children:[a.jsx(rn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx("input",{type:"text",placeholder:"Search currencies...",value:o,onChange:Z=>l(Z.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto max-h-96",children:c?a.jsxs("div",{className:"p-8 text-center text-gray-500",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),"Loading currencies..."]}):a.jsx("div",{className:"p-4",children:_.length===0?a.jsx("div",{className:"text-center text-gray-500 py-8",children:"No currencies found matching your search."}):a.jsx("div",{className:"grid grid-cols-1 gap-2",children:_.map(([Z,oe])=>{const Y=e.some(z=>z.code===Z),R=d.has(Z);return a.jsx("div",{className:`p-3 border rounded-lg cursor-pointer transition-colors ${Y?"bg-gray-100 border-gray-300 cursor-not-allowed":R?"bg-blue-50 border-blue-300":"bg-white border-gray-200 hover:bg-gray-50"}`,onClick:()=>!Y&&M(Z),children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-800 mr-3",children:Z}),a.jsx("span",{className:"text-lg mr-3",children:B[Z]||Z}),a.jsx("span",{className:"text-sm text-gray-900",children:oe})]}),a.jsxs("div",{className:"flex items-center",children:[Y&&a.jsx("span",{className:"text-xs text-green-600 font-medium mr-2",children:" Already added"}),R&&!Y&&a.jsx(ho,{className:"w-5 h-5 text-blue-600"})]})]})},Z)})})})}),a.jsx("div",{className:"p-4 border-t border-gray-200",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("span",{className:"text-sm text-gray-500",children:[d.size," currencies selected"]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>{i(!1),u(new Set),l("")},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),a.jsx("button",{onClick:j,disabled:d.size===0||f,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center",children:f?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Adding..."]}):`Add Selected (${d.size})`})]})]})})]})})]})},owe=()=>a.jsx("div",{children:"PaymentTermsPage"}),lwe=()=>a.jsx("div",{children:"PaymentType"}),cwe=()=>{const[e,t]=C.useState(!1),[r,n]=C.useState([]),[s,i]=C.useState(1),[o,l]=C.useState(!1),[c,A]=C.useState(""),[d,u]=C.useState(null),[f,h]=C.useState({businessUnit:"",department:"",approverName:"",approverId:"",approverEmail:"",role:"Approver"}),[x,m]=C.useState(null),[g,p]=C.useState(!1),[v,w]=C.useState(!1),[B,T]=C.useState(null),[_,j]=C.useState(!1),[E,L]=C.useState(null),M=50,D=r.filter(U=>U.approvers.some(Q=>{const H=c.toLowerCase();return Q.approverName.toLowerCase().includes(H)||Q.approverId.toLowerCase().includes(H)||U.departmentName.toLowerCase().includes(H)})).flatMap(U=>U.approvers.map(Q=>({businessUnit:U.businessUnit,departmentName:U.departmentName,...Q}))),G=Math.ceil(D.length/M),K=(s-1)*M,ae=K+M,Z=D.slice(K,ae);C.useEffect(()=>{(async()=>{try{const Q=await eq();Q.status===200&&t(Q.data.status);const X=(await nS()).data.approvalData.flatMap(V=>V.departments.map(Ae=>({businessUnit:V.businessUnit,departmentName:Ae.name,approvers:Ae.approvers.map(W=>({...W,role:W.role||"Approver"}))})));n(X)}catch(Q){console.error("Error fetching initial data:",Q)}})()},[]),C.useEffect(()=>{i(1)},[c]);const oe=async()=>{try{const U=await tq();t(U.data.enabled)}catch(U){console.error("Error toggling Darwin status:",U)}},Y=U=>{const Q=U.target.files[0];Q&&(m(Q),l(!0))},R=async()=>{if(x){p(!0);try{const U=new FormData;if(U.append("file",x),(await Z$(U)).status===200){const X=(await nS()).data.approvalData.flatMap(V=>V.departments.map(Ae=>({businessUnit:V.businessUnit,departmentName:Ae.name,approvers:Ae.approvers})));n(X),l(!1),m(null)}else throw new Error("Upload failed")}catch(U){console.error("Error uploading file:",U)}finally{p(!1)}}},z=()=>{const U=D.map((W,J)=>({"S.No":J+1,"Business Unit":W.businessUnit,Department:W.departmentName,"Approver Name":W.approverName,"Approver ID":W.approverId,"Approver Email":W.approverEmail,Role:W.role||"Approver"})),Q=as.json_to_sheet(U),H=as.book_new();as.book_append_sheet(H,Q,"Approvers");const X=[{wch:8},{wch:15},{wch:20},{wch:25},{wch:15},{wch:30},{wch:12}];Q["!cols"]=X;const Ae=`Approver_Management_${new Date().toISOString().split("T")[0]}.xlsx`;s0(H,Ae)},ee=async U=>{U.preventDefault();const Q={...f,businessUnit:f.businessUnit.toUpperCase()};if(_&&E){console.log("Editing approver - Full data:",{originalData:E,newData:Q}),n(H=>H.map(X=>X.businessUnit===E.originalBusinessUnit&&X.departmentName===E.originalDepartmentName?{...X,businessUnit:Q.businessUnit,departmentName:Q.department,approvers:X.approvers.map(V=>V.approverId===E.originalApproverId?{approverId:Q.approverId,approverName:Q.approverName,approverEmail:Q.approverEmail,role:Q.role||"Approver"}:V)}:X));try{await hq({originalData:{businessUnit:E.originalBusinessUnit,departmentName:E.originalDepartmentName,approverId:E.originalApproverId},newData:{businessUnit:Q.businessUnit,departmentName:Q.department,approverName:Q.approverName,approverId:Q.approverId,approverEmail:Q.approverEmail,role:Q.role}})}catch(H){console.error("Error updating approver:",H)}j(!1),L(null)}else{console.log("Adding new approver:",Q);const H={businessUnit:Q.businessUnit,departmentName:Q.department,approvers:[{approverId:Q.approverId,approverName:Q.approverName,approverEmail:Q.approverEmail,role:Q.role||"Approver"}]};n(X=>[H,...X]);try{const X=await fq(H);console.log("Add approver response:",X)}catch(X){console.error("Error adding approver:",X)}}h({businessUnit:"",department:"",approverName:"",approverId:"",approverEmail:"",role:"Approver"})},b=U=>{console.log("Editing approver - Current data:",U),j(!0),L({originalBusinessUnit:U.businessUnit,originalDepartmentName:U.departmentName,originalApproverId:U.approverId}),h({businessUnit:U.businessUnit,department:U.departmentName,approverName:U.approverName,approverId:U.approverId,approverEmail:U.approverEmail,role:U.role||"Approver"})},O=async(U,Q,H)=>{const X=D.find(V=>V.businessUnit===U&&V.departmentName===Q&&V.approverId===H);console.log("Deleting approver - Full data:",X),u(X),T({businessUnit:U,departmentName:Q,approverId:H}),w(!0)},S=async()=>{if(!B)return;const{businessUnit:U,departmentName:Q,approverId:H}=B;await mq(d),console.log("Confirming deletion of approver:",{businessUnit:U,departmentName:Q,approverId:H,fullData:D.find(X=>X.businessUnit===U&&X.departmentName===Q&&X.approverId===H)}),n(X=>X.map(V=>V.businessUnit===U&&V.departmentName===Q?{...V,approvers:V.approvers.filter(Ae=>Ae.approverId!==H)}:V).filter(V=>V.approvers.length>0));try{console.log("Approver successfully deleted from UI state")}catch(X){console.error("Error deleting approver:",X)}w(!1),T(null)},I=()=>{console.log("Edit canceled"),j(!1),L(null),h({businessUnit:"",department:"",approverName:"",approverId:"",approverEmail:"",role:"Approver"})};return a.jsxs("div",{className:"p-6 max-w-6xl mx-auto bg-white rounded-lg shadow-sm",children:[a.jsx("div",{className:"flex items-center justify-between mb-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:"mr-4",children:"Darwin"}),a.jsxs("label",{className:"inline-flex relative items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",className:"sr-only peer",checked:e,onChange:oe}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]}),a.jsx("span",{className:"ml-4",children:"Custom"})]})}),e&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Approver Management"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("button",{onClick:z,className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",title:"Download Excel",children:[a.jsx(_n,{className:"h-4 w-4"}),a.jsx("span",{children:"Download Excel"})]}),a.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:Y,className:"hidden",id:"excel-upload"}),a.jsx("label",{htmlFor:"excel-upload",className:"cursor-pointer px-4 py-2 border border-primary text-primary rounded-md hover:bg-gray-50",children:"Choose Excel File"}),x&&!o&&a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-sm text-gray-600",children:x.name}),a.jsx("button",{onClick:()=>l(!0),className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90",children:"Upload"})]})]})]}),a.jsx("div",{className:"mb-6",children:a.jsxs("div",{className:"relative max-w-md",children:[a.jsx("input",{type:"text",placeholder:"Search by name, ID, or department...",value:c,onChange:U=>A(U.target.value),className:"w-full p-2 pl-8 border rounded-md"}),a.jsx(rn,{className:"absolute left-2 top-2.5 h-4 w-4 text-gray-400"})]})}),o&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white p-6 rounded-lg max-w-md w-full",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"CSV Format Requirements"}),a.jsx("p",{className:"mb-4",children:"Your CSV file must include the following columns:"}),a.jsxs("ul",{className:"list-disc ml-6 mb-4",children:[a.jsx("li",{children:"businessUnit"}),a.jsx("li",{children:"departments"}),a.jsx("li",{children:"approverId"}),a.jsx("li",{children:"approverName"}),a.jsx("li",{children:"approverEmail"})]}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{onClick:()=>{l(!1),m(null)},className:"px-4 py-2 border rounded-md",children:"Cancel"}),a.jsx("button",{onClick:R,disabled:g,className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 disabled:opacity-50",children:g?"Uploading...":"Confirm & Upload"})]})]})}),v&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white p-6 rounded-lg max-w-md w-full",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Confirm Deletion"}),a.jsx("p",{className:"mb-4",children:"Are you sure you want to delete this approver? This action cannot be undone."}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{onClick:()=>w(!1),className:"px-4 py-2 border rounded-md hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:S,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Delete"})]})]})}),a.jsxs("form",{onSubmit:ee,className:"grid grid-cols-6 gap-4 mb-6",children:[a.jsx("input",{type:"text",placeholder:"Business Unit",value:f.businessUnit,onChange:U=>h(Q=>({...Q,businessUnit:U.target.value})),className:"p-2 border rounded-md",required:!0}),a.jsx("input",{type:"text",placeholder:"Department",value:f.department,onChange:U=>h(Q=>({...Q,department:U.target.value})),className:"p-2 border rounded-md",required:!0}),a.jsx("input",{type:"text",placeholder:"Approver Name",value:f.approverName,onChange:U=>h(Q=>({...Q,approverName:U.target.value})),className:"p-2 border rounded-md",required:!0}),a.jsx("input",{type:"text",placeholder:"Approver ID",value:f.approverId,onChange:U=>h(Q=>({...Q,approverId:U.target.value})),className:"p-2 border rounded-md",required:!0}),a.jsx("input",{type:"email",placeholder:"Approver Email",value:f.approverEmail,onChange:U=>h(Q=>({...Q,approverEmail:U.target.value})),className:"p-2 border rounded-md",required:!0}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{type:"submit",className:"bg-primary text-white p-2 rounded-md hover:bg-primary/90",children:_?"Update ":"Add Approver"}),_&&a.jsx("button",{type:"button",onClick:I,className:"bg-gray-200 text-gray-800 p-2 rounded-md hover:bg-gray-300",children:"Cancel"})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-100",children:[a.jsx("th",{className:"p-3 text-left border",children:"S.No"}),a.jsx("th",{className:"p-3 text-left border",children:"Business Unit"}),a.jsx("th",{className:"p-3 text-left border",children:"Department"}),a.jsx("th",{className:"p-3 text-left border",children:"Approver Name"}),a.jsx("th",{className:"p-3 text-left border",children:"Approver ID"}),a.jsx("th",{className:"p-3 text-left border",children:"Approver Email"}),a.jsx("th",{className:"p-3 text-left border",children:"Actions"})]})}),a.jsx("tbody",{children:Z.map((U,Q)=>a.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[a.jsx("td",{className:"p-3 border",children:K+Q+1}),a.jsx("td",{className:"p-3 border",children:U.businessUnit}),a.jsx("td",{className:"p-3 border",children:U.departmentName}),a.jsx("td",{className:"p-3 border",children:U.approverName}),a.jsx("td",{className:"p-3 border",children:U.approverId}),a.jsx("td",{className:"p-3 border",children:U.approverEmail}),a.jsx("td",{className:"p-3 border",children:a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{onClick:()=>O(U.businessUnit,U.departmentName,U.approverId),className:"text-red-600 hover:text-red-800 px-2 py-1 rounded",children:"Delete"}),a.jsx("button",{onClick:()=>b(U),className:"text-blue-600 hover:text-blue-800 px-2 py-1 rounded",children:"Edit"})]})})]},`${U.approverId}-${Q}`))})]})}),a.jsxs("div",{className:"flex justify-between items-center mt-6",children:[a.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",K+1," to"," ",Math.min(ae,D.length)," of"," ",D.length," entries"]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>i(U=>Math.max(1,U-1)),disabled:s===1,className:"px-3 py-1 border rounded-md disabled:opacity-50 hover:bg-gray-50",children:"Previous"}),Array.from({length:G},(U,Q)=>Q+1).map(U=>U===1||U===G||U>=s-1&&U<=s+1?a.jsx("button",{onClick:()=>i(U),className:`px-3 py-1 border rounded-md ${s===U?"bg-primary text-white":"hover:bg-gray-50"}`,children:U},U):U===s-2&&U>2||U===s+2&&U<G-1?a.jsx("span",{className:"px-2",children:"..."},U):null),a.jsx("button",{onClick:()=>i(U=>Math.min(G,U+1)),disabled:s===G,className:"px-3 py-1 border rounded-md disabled:opacity-50 hover:bg-gray-50",children:"Next"})]})]})]})]})},Awe=({currentUsers:e,navigate:t,handleCopyReqId:r,handleOpenInNewTab:n,formatCurrency:s,renderActionColumn:i,searchTerm:o,dateFilters:l,startIndex:c})=>a.jsx("div",{className:"border border-gray-200 rounded-lg w-full",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsx("div",{className:"inline-block min-w-full align-middle",children:a.jsx("div",{className:"overflow-hidden",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-primary",children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[5%]",children:"SNo"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[10%]",children:"ReqId"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[15%]",children:"Business Unit"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[15%]",children:"Vendor"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[8%]",children:"Amount"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[10%]",children:"Status"}),a.jsx("th",{scope:"col",className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider w-[10%]",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(e==null?void 0:e.length)>0?e==null?void 0:e.map((A,d)=>{var u,f,h,x,m,g,p,v;return a.jsxs("tr",{className:"hover:bg-gray-100 cursor-pointer",onClick:()=>t(`/approval-request-list/preview-one-req/${A._id}`),children:[a.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:c+d+1}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"block font-medium",children:A.reqid}),a.jsxs("div",{className:"flex space-x-1",children:[a.jsx("button",{onClick:w=>r(A.reqid,w),className:"text-gray-400 hover:text-blue-500 transition-colors",title:"Copy Request ID",children:a.jsx(Gl,{className:"h-3 w-3 md:h-4 md:w-4"})}),a.jsx("button",{onClick:w=>n(A._id,w),className:"text-gray-400 hover:text-green-500 transition-colors",title:"Open in new tab",children:a.jsx(Xf,{className:"h-3 w-3 md:h-4 md:w-4"})})]})]}),a.jsx("span",{className:"block font-medium",children:A.userName||"Employee"}),a.jsx("span",{className:"block",children:(u=A.commercials)==null?void 0:u.department})]})}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:a.jsxs("div",{children:[a.jsx("span",{className:"block font-medium",children:((f=A.commercials)==null?void 0:f.businessUnit)||"NA"}),a.jsx("span",{className:"block font-medium",children:((h=A.commercials)==null?void 0:h.entity)||"NA"}),a.jsx("span",{className:"block",children:((x=A.commercials)==null?void 0:x.site)||"NA"})]})}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:a.jsxs("div",{children:[a.jsx("span",{className:"block font-medium",children:(m=A.procurements)==null?void 0:m.vendor}),a.jsx("span",{className:"block",children:(g=A.procurements)==null?void 0:g.vendorName})]})}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:s((p=A.supplies)==null?void 0:p.totalValue,(v=A.supplies)==null?void 0:v.selectedCurrency)}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:A.isCompleted?a.jsxs(a.Fragment,{children:[A.status!=="Approved"&&a.jsxs(a.Fragment,{children:[A.nextDepartment||A.cDepartment," ",a.jsx("br",{})," : "]}),A.status||"Pending"]}):a.jsx("span",{className:"text-red-500",children:"Draft"})}),i(A)]},A._id)}):a.jsx("tr",{children:a.jsx("td",{colSpan:"10",className:"px-6 py-4 text-center text-gray-500",children:o||l.fromDate||l.toDate?"No matching results found.":"No data available."})})})]})})})})}),dwe=()=>{const e=localStorage.getItem("capEmpId"),t=localStorage.getItem("role"),r=localStorage.getItem("multiRole"),n=Sr(),[s,i]=C.useState([]),[o,l]=C.useState([]),[c,A]=C.useState([]),[d,u]=C.useState(""),[f,h]=C.useState(!1),[x,m]=C.useState(1),[g,p]=C.useState(!0),[v,w]=C.useState(null),[B,T]=C.useState(!1),[_,j]=C.useState(null),[E,L]=C.useState(!1),[M,F]=C.useState(null),[D,G]=C.useState(""),[K,ae]=C.useState(""),[Z,oe]=C.useState([]),[Y,R]=C.useState(!1),[z,ee]=C.useState({fromDate:"",toDate:""}),[b,O]=C.useState([]),S=20,I=["Pending","Rejected","Hold"],U=(Te,Ne)=>I.includes(Te)?Ne.filter(Ce=>Ce.status===Te).map(Ce=>Ce.nextDepartment).filter(Ce=>Ce&&Ce.trim()!=="").filter((Ce,Be,Pe)=>Pe.indexOf(Ce)===Be).sort():[];C.useEffect(()=>{if(D&&I.includes(D)){const Te=U(D,s);oe(Te),K&&!Te.includes(K)&&ae("")}else oe([])},[D,s,K]),C.useEffect(()=>{(async()=>{const Ne=await mo();Ne.status===200&&O(Ne.data.data)})()},[]),C.useEffect(()=>{(async()=>{const Ne=await ev();Ne.status===200&&w(Ne.data.data)})()},[]);const Q=async(Te=!1)=>{p(!0);try{let Ne;Te?Ne=await E1(e,"All"):Ne=await aq(e,t),console.log("response",Ne),Ne.status===200&&(i(Ne.data.processedReqData||Ne.data.reqData),l(Ne.data.processedReqData||Ne.data.reqData))}catch(Ne){console.error("Error fetching requests:",Ne)}finally{setTimeout(()=>{p(!1)},500)}};C.useEffect(()=>{Q(E)},[e,t,E]),C.useEffect(()=>{(()=>{const Ne=s==null?void 0:s.filter(Se=>{var Vt,pr,$t,Qr,ir;const Ce=d.toLowerCase(),Be=(Vt=Se.reqid)==null?void 0:Vt.toLowerCase().includes(Ce),Pe=(pr=Se.userName)==null?void 0:pr.toLowerCase().includes(Ce),Bt=(Qr=($t=Se.commercials)==null?void 0:$t.department)==null?void 0:Qr.toLowerCase().includes(Ce),tt=(ir=Se.nextDepartment)==null?void 0:ir.toLowerCase().includes(Ce),Ot=!D||D==="Draft"&&!Se.isCompleted||D&&Se.status===D,vt=!K||!I.includes(D)||Se.nextDepartment===K;return console.log(`Filtering ${Se.reqid}:`,{statusFilter:D,departmentFilter:K,userStatus:Se.status,userNextDept:Se.nextDepartment,statusMatch:Ot,departmentMatch:vt}),(Be||Pe||Bt||tt)&&Ot&&vt}),et=Ne==null?void 0:Ne.filter(Se=>{if(!z.fromDate&&!z.toDate)return!0;const Ce=new Date(Se.createdAt),Be=z.fromDate?new Date(z.fromDate):null,Pe=z.toDate?new Date(z.toDate):null;return Be&&Pe?Ce>=Be&&Ce<=Pe:Be?Ce>=Be:Pe?Ce<=Pe:!0});console.log(`Final filtered results: ${(et==null?void 0:et.length)||0} records`),l(et)})()},[d,s,z,D,K]);const H=()=>{u(""),ee({fromDate:"",toDate:""}),G(""),ae(""),oe([]),R(!1),h(!1)},X=Te=>{const Ne=Te.target.value;G(Ne),ae(""),R(I.includes(Ne))},V=Te=>{ae(Te.target.value)},Ae=async(Te,Ne)=>{Ne.stopPropagation();try{await navigator.clipboard.writeText(Te),F(Te),setTimeout(()=>{F(null)},2e3)}catch(et){console.error("Failed to copy: ",et);const Se=document.createElement("textarea");Se.value=Te,document.body.appendChild(Se),Se.focus(),Se.select();try{document.execCommand("copy"),F(Te),setTimeout(()=>{F(null)},2e3)}catch(Ce){console.error("Fallback copy failed: ",Ce)}document.body.removeChild(Se)}},W=(Te,Ne)=>{Ne.stopPropagation();const et=`/approval-request-list/preview-one-req/${Te}`;window.open(et,"_blank")},J=(Te,Ne)=>{if(!Te)return"N/A";const et=b.find(Se=>Se.code===Ne);if(!et)return Te;try{return new Intl.NumberFormat(et.locale,{style:"currency",currency:et.code,minimumFractionDigits:2,maximumFractionDigits:2}).format(Te)}catch(Se){return console.error("Currency formatting error:",Se),Te}},ve=Te=>{u(Te.target.value)},de=Te=>{const{name:Ne,value:et}=Te.target;ee(Se=>({...Se,[Ne]:et}))},te=async(Te,Ne)=>{Te.stopPropagation(),n(`/req-list-table/edit-req/${Ne}`)},je=async Te=>{try{(await Zm(Te)).status===200&&(i(s.filter(et=>et._id!==Te)),T(!1))}catch(Ne){console.error("Error deleting request:",Ne)}},qe=Te=>{const Ne=Math.ceil((o==null?void 0:o.length)/S);Te>=1&&Te<=Ne&&(m(Te),A([]))},He=Te=>{L(Te),m(1),H()},Ze=Math.ceil((o==null?void 0:o.length)/S),xe=(x-1)*S,ue=xe+S,Fe=o==null?void 0:o.slice(xe,ue),ke=Te=>Te.status==="Approved"?a.jsx("td",{className:"text-sm text-gray-500 text-center md:px-6 md:py-4 px-2 py-2",children:a.jsx("span",{className:"text-xs text-gray-400",children:"No actions"})}):Te.isCompleted?t==="Admin"||t==="Head of Finance"||t==="HOD Department"||r==1?a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-sm text-gray-500",children:a.jsxs("div",{className:"flex justify-center items-center space-x-2",children:[a.jsx("button",{className:"text-blue-500 hover:text-blue-700",onClick:Ne=>te(Ne,Te._id),children:a.jsx(Us,{className:"h-4 w-4 md:h-5 md:w-5"})}),t==="Admin"&&a.jsx("button",{className:"text-red-500 hover:text-red-700",onClick:Ne=>{Ne.stopPropagation(),j(Te._id),T(!0)},children:a.jsx($r,{className:"h-4 w-4 md:h-5 md:w-5"})})]})}):a.jsx("td",{className:"text-sm text-gray-500 text-center md:px-6 md:py-4 px-2 py-2",children:a.jsx("button",{className:"px-2 py-1 bg-primary text-white rounded-md hover:bg-primary text-xs md:text-sm",onClick:Ne=>{Ne.stopPropagation()},children:"Request Edit"})}):a.jsx("td",{className:"px-2 py-2 md:px-6 md:py-4 text-sm text-gray-500",children:a.jsxs("div",{className:"flex justify-center items-center space-x-2",children:[a.jsx("button",{className:"text-blue-500 hover:text-blue-700",onClick:Ne=>te(Ne,Te._id),children:a.jsx(Us,{className:"h-4 w-4 md:h-5 md:w-5"})}),a.jsx("button",{className:"text-red-500 hover:text-red-700",onClick:Ne=>{Ne.stopPropagation(),j(Te._id),T(!0)},children:a.jsx($r,{className:"h-4 w-4 md:h-5 md:w-5"})})]})});return a.jsxs(a.Fragment,{children:[g&&a.jsx(Fd,{}),M&&a.jsx("div",{className:"fixed top-4 right-4 z-50",children:a.jsxs("div",{className:"bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg flex items-center space-x-2",children:[a.jsx(ho,{className:"h-4 w-4"}),a.jsxs("span",{className:"text-sm font-medium",children:['ReqID "',M,'" copied successfully!']})]})}),a.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-sm h-full",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:`${t} Approvals`}),a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-6",children:[a.jsxs("div",{className:"relative flex-1 min-w-[300px] max-w-md",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none",children:a.jsx(rn,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{type:"text",value:d,onChange:ve,placeholder:"Search by ID, name, department, or next department...",className:"w-full pl-11 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("button",{className:`px-4 py-2 rounded-lg text-sm font-medium ${E?"bg-gray-100 text-gray-700":"bg-primary text-white"}`,onClick:()=>He(!1),children:"Pending"}),a.jsx("button",{className:`px-4 py-2 rounded-lg text-sm font-medium ${E?"bg-primary text-white":"bg-gray-100 text-gray-700"}`,onClick:()=>He(!0),children:"All"}),a.jsxs("button",{className:"inline-flex items-center px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",onClick:()=>h(!f),children:[a.jsx(ti,{className:"h-4 w-4 mr-2"}),"Filter",f?a.jsx(bl,{className:"h-4 w-4 ml-1"}):a.jsx(vo,{className:"h-4 w-4 ml-1"})]}),v&&a.jsxs("a",{href:v,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2.5 border border-blue-300 rounded-lg text-sm font-medium text-blue-700 bg-blue-50 hover:bg-blue-100",children:[a.jsx(jr,{className:"h-4 w-4 mr-2"}),"View PO Policy"]}),a.jsxs("button",{className:"inline-flex items-center px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[a.jsx(_n,{className:"h-4 w-4 mr-2"}),"Export"]}),a.jsxs("button",{className:"inline-flex items-center px-4 py-2.5 bg-primary text-white rounded-lg text-sm font-medium hover:bg-primary/90",onClick:()=>n("/req-list-table/create-request"),children:[a.jsx(yn,{className:"h-4 w-4 mr-2"}),"Add Request"]})]})]}),f&&a.jsxs("div",{className:"mt-4 w-full md:w-80 p-4 bg-white rounded-lg shadow-lg border border-gray-200 absolute right-0 md:right-8 z-20",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:"Filters"}),a.jsx("button",{onClick:()=>h(!1),className:"text-gray-500 hover:text-gray-700",children:a.jsx(_r,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Status"}),a.jsxs("select",{value:D,onChange:X,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary",children:[a.jsx("option",{value:"",children:"All Statuses"}),a.jsx("option",{value:"Pending",children:"Pending"}),a.jsx("option",{value:"Hold",children:"Hold"}),a.jsx("option",{value:"Rejected",children:"Rejected"}),a.jsx("option",{value:"PO-Pending",children:"PO-Pending"}),a.jsx("option",{value:"Invoice-Pending",children:"Invoice-Pending"}),a.jsx("option",{value:"Approved",children:"Approved"})]})]}),I.includes(D)&&Z.length>0&&a.jsxs("div",{className:"mb-4",children:[a.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:["Next Department (",D,")"]}),a.jsxs("select",{value:K,onChange:V,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary",children:[a.jsx("option",{value:"",children:"All Departments"}),Z.map(Te=>a.jsx("option",{value:Te,children:Te},Te))]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Showing ",Z.length," departments for"," ",D," status"]})]}),I.includes(D)&&Z.length===0&&a.jsxs("div",{className:"mb-4",children:[a.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:["Next Department (",D,")"]}),a.jsxs("div",{className:"px-3 py-2 text-sm text-gray-500 bg-gray-50 rounded-md border",children:["No departments available for ",D," status"]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Date Range"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:"From"}),a.jsx("input",{type:"date",name:"fromDate",value:z.fromDate,onChange:de,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:"To"}),a.jsx("input",{type:"date",name:"toDate",value:z.toDate,onChange:de,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary"})]})]})]}),a.jsxs("div",{className:"flex justify-between pt-3 border-t border-gray-200",children:[a.jsx("button",{onClick:()=>h(!1),className:"px-3 py-1.5 text-sm text-gray-600 hover:text-gray-800 font-medium",children:"Close"}),a.jsx("button",{onClick:H,className:"px-4 py-1.5 bg-gray-100 text-gray-700 text-sm font-medium rounded-md hover:bg-gray-200",children:"Clear Filters"})]})]})]}),a.jsx(Awe,{currentUsers:Fe,navigate:n,handleCopyReqId:Ae,handleOpenInNewTab:W,formatCurrency:J,renderActionColumn:ke,searchTerm:d,dateFilters:z,startIndex:xe}),(o==null?void 0:o.length)>0&&a.jsx(tp,{currentPage:x,totalPages:Ze,handlePageChange:qe,itemsPerPage:S,totalItems:o==null?void 0:o.length}),B&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-auto",children:[a.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Do you really want to delete this request"}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx("button",{onClick:()=>T(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-100",children:"Cancel"}),a.jsx("button",{onClick:()=>je(_),className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary/90",children:"Yes Delete"})]})]})})]})]})},uwe=()=>{const e=JSON.parse(localStorage.getItem("user")||"{}"),t=localStorage.getItem("role")||"No role assigned",r=localStorage.getItem("department")||"No department";return a.jsxs("div",{className:"max-w-2xl mx-auto bg-white rounded-xl shadow-lg overflow-hidden",children:[a.jsx("div",{className:"bg-gradient-to-r from-primary to-primary h-32"}),a.jsx("div",{className:"p-6 relative",children:a.jsxs("div",{className:"flex flex-col lg:flex-row",children:[a.jsx("div",{className:"-mt-20 mb-4 lg:mb-0 flex justify-center lg:justify-start",children:e!=null&&e.picture?a.jsx("img",{src:e.picture,alt:"Profile",className:"w-32 h-32 rounded-full border-4 border-white object-cover shadow-md"}):a.jsx("div",{className:"w-32 h-32 rounded-full border-4 border-white bg-gray-100 flex items-center justify-center shadow-md",children:a.jsx(M_,{className:"w-20 h-20 text-gray-400"})})}),a.jsxs("div",{className:"lg:ml-6 flex-1 text-center lg:text-left",children:[a.jsx("h2",{className:"text-2xl lg:text-3xl font-bold text-gray-900 mb-1",children:(e==null?void 0:e.name)||"User"}),a.jsx("p",{className:"text-lg text-indigo-600 font-medium mb-4",children:t}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-6",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 flex items-start",children:[a.jsx($_,{className:"w-5 h-5 text-indigo-600 mt-0.5 mr-3 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Email"}),a.jsx("p",{className:"text-sm font-medium text-gray-800 break-all",children:(e==null?void 0:e.email)||"No email provided"})]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 flex items-start",children:[a.jsx(AH,{className:"w-5 h-5 text-indigo-600 mt-0.5 mr-3 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Role"}),a.jsx("p",{className:"text-sm font-medium text-gray-800",children:t})]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 flex items-start",children:[a.jsx(dH,{className:"w-5 h-5 text-indigo-600 mt-0.5 mr-3 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Department"}),a.jsx("p",{className:"text-sm font-medium text-gray-800",children:r})]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 flex items-start",children:[a.jsx(BH,{className:"w-5 h-5 text-indigo-600 mt-0.5 mr-3 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Phone"}),a.jsx("p",{className:"text-sm font-medium text-gray-800",children:(e==null?void 0:e.phone)||"No phone provided"})]})]})]})]})]})})]})},fwe=()=>{const[e,t]=C.useState([]),[r,n]=C.useState(!1);C.useEffect(()=>{(async()=>{try{n(!0);const o=await oq();console.log("Response",o),o.status===200?t(o.data.emailData):console.error("Failed to fetch email settings")}catch(o){console.error("Error fetching email settings:",o)}finally{n(!1)}})()},[]);const s=async i=>{const o=e.find(c=>c.emailId===i);if(!o){console.error("Email not found");return}const l={...o,emailStatus:!o.emailStatus};t(c=>c.map(A=>A.emailId===i?{...A,emailStatus:!A.emailStatus}:A));try{(await iq(l)).status!==200&&(console.error("Failed to update email status"),t(A=>A.map(d=>d.emailId===i?{...d,emailStatus:o.emailStatus}:d)))}catch(c){console.error("Error updating email status:",c),t(A=>A.map(d=>d.emailId===i?{...d,emailStatus:o.emailStatus}:d))}};return r?a.jsx("div",{className:"w-full p-6 text-center",children:"Loading email settings..."}):a.jsxs("div",{className:"w-full p-6 bg-white rounded-lg shadow-md",children:[a.jsx("h2",{className:"text-2xl font-bold mb-6 text-gray-800",children:"Email Notification Settings"}),e.length===0?a.jsx("div",{className:"text-center py-4",children:"No email settings found."}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-100",children:[a.jsx("th",{className:"p-3 text-left font-semibold text-gray-700 border-b-2 border-gray-200",children:"SNo"}),a.jsx("th",{className:"p-3 text-left font-semibold text-gray-700 border-b-2 border-gray-200",children:"Notification Name"}),a.jsx("th",{className:"p-3 text-left font-semibold text-gray-700 border-b-2 border-gray-200",children:"Status"}),a.jsx("th",{className:"p-3 text-left font-semibold text-gray-700 border-b-2 border-gray-200",children:"Action"})]})}),a.jsx("tbody",{children:e.map((i,o)=>a.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[a.jsx("td",{className:"p-3",children:o+1}),a.jsx("td",{className:"p-3",children:i.label}),a.jsx("td",{className:"p-3",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${i.emailStatus?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:i.emailStatus?"Enabled":"Disabled"})}),a.jsx("td",{className:"p-3",children:a.jsx("button",{onClick:()=>s(i.emailId),className:`px-3 py-1 rounded-md text-white font-medium transition-colors ${i.emailStatus?"bg-red-500 hover:bg-red-600":"bg-green-500 hover:bg-green-600"}`,children:i.emailStatus?"Disable":"Enable"})})]},i.emailId))})]})})]})},hwe=()=>{const e=localStorage.getItem("capEmpId"),t=Sr(),[r,n]=C.useState([]),[s,i]=C.useState(null),[o,l]=C.useState(1),[c,A]=C.useState(""),[d,u]=C.useState("all"),[f,h]=C.useState(!1),[x,m]=C.useState([]),[g,p]=C.useState(null),[v,w]=C.useState([]),B=C.useRef(null),T=10,[_,j]=C.useState(!0),[E,L]=C.useState(!1);C.useEffect(()=>{M()},[e]);const M=async()=>{var S;j(!0);try{const I=await eC(e);console.log(I),n(I.data.vendors||[]),((S=I.data.vendorPolicyFiles)==null?void 0:S.length)>0&&i(I.data.vendorPolicyFiles[0])}catch(I){Ie.error("Error fetching vendor data"),console.error("Error in fetching the vendor data",I)}finally{j(!1)}},F=S=>{const I=[],U=[{key:"Name",label:"Company Name"},{key:"Entity",label:"Entity"},{key:"Category",label:"Category"},{key:"Email",label:"Email"},{key:"Phone",label:"Phone Number"},{key:"Billing Address",label:"Address"},{key:"Tax Number",label:"PAN/Tax Registration"},{key:"Bank Account Number",label:"Bank Account Number"},{key:"IFSC/SWIFT Code",label:"IFSC/SWIFT CODE"},{key:"Bank Name",label:"Bank Name"},{key:"Has Agreement",label:"Has Agreement (yes/no)"},{key:"Nature of Service",label:"Nature of Service"}];return S.forEach((Q,H)=>{const X=H+2;if(U.forEach(V=>{(!Q[V.key]||String(Q[V.key]).trim()==="")&&I.push(`Row ${X}: Missing ${V.label}`)}),Q.Email&&(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(Q.Email).trim())||I.push(`Row ${X}: Invalid email format`)),Q.Phone&&String(Q.Phone).replace(/\D/g,"").length<10&&I.push(`Row ${X}: Invalid phone number (minimum 10 digits)`),Q["Has Agreement"]){const V=String(Q["Has Agreement"]).toLowerCase().trim();V!=="yes"&&V!=="no"&&I.push(`Row ${X}: Has Agreement must be "yes" or "no"`),V==="no"&&(!Q["Questionnaire Answer"]||String(Q["Questionnaire Answer"]).trim()==="")&&I.push(`Row ${X}: Questionnaire Answer is required when Has Agreement is "no"`)}Q["Bank Account Number"]&&String(Q["Bank Account Number"]).replace(/\D/g,"").length<9&&I.push(`Row ${X}: Invalid Bank Account Number (minimum 9 digits)`)}),I},D=()=>{const S=[{ID:"V001",Name:"Sample Vendor Ltd",Entity:"ABC Corporation Pvt. Ltd.",Category:"Supplier",Email:"vendor@example.com",Phone:"9876543210","Billing Address":"123 Main Street, City, State - 123456","Shipping Address":"456 Warehouse Road, City, State - 123456","Tax Number":"ABCDE1234F",GSTIN:"22ABCDE1234F1Z5",MSME:"MSME123456","Bank Account Number":"1234567890123456","IFSC/SWIFT Code":"ABCD0123456","Bank Name":"Sample Bank","Has Agreement":"yes","Agreement File":"(Upload separately after vendor creation)","Questionnaire Answer":"","Nature of Service":"Product Supply","Primary Subsidiary":"Main Office"},{ID:"V002",Name:"Example Services Inc",Entity:"XYZ Services Corp",Category:"Service Provider",Email:"contact@exampleservices.com",Phone:"9123456789","Billing Address":"789 Business Park, City, State - 654321","Shipping Address":"789 Business Park, City, State - 654321","Tax Number":"FGHIJ5678K",GSTIN:"27FGHIJ5678K1Z8",MSME:"MSME789012","Bank Account Number":"9876543210987654","IFSC/SWIFT Code":"EFGH0987654","Bank Name":"Example Bank","Has Agreement":"no","Agreement File":"","Questionnaire Answer":"We provide consulting services with 5+ years experience. Recurring monthly service with auto-renewal contract.","Nature of Service":"Consulting","Primary Subsidiary":"Branch Office"}],I=as.book_new(),U=as.json_to_sheet(S),Q=[{wch:10},{wch:25},{wch:25},{wch:15},{wch:25},{wch:15},{wch:40},{wch:40},{wch:15},{wch:18},{wch:15},{wch:20},{wch:18},{wch:20},{wch:15},{wch:45},{wch:50},{wch:20},{wch:20}];U["!cols"]=Q,as.book_append_sheet(I,U,"Vendor Template"),s0(I,"Vendor_Upload_Template.xlsx"),Ie.success("Sample template downloaded successfully!")},G=async S=>{const I=S.target.files[0];if(!I)return;const U=new FileReader;U.onload=async Q=>{try{const H=Fm(Q.target.result,{type:"array"}),X=H.SheetNames[0],V=H.Sheets[X],Ae=as.sheet_to_json(V);if(Ae.length===0){Ie.error("The uploaded file is empty. Please add vendor data.");return}console.log("Imported data:",Ae);const W=F(Ae);W.length>0?(w(W),Ie.error(`Found ${W.length} validation error(s). Please check the details.`),m(Ae)):(w([]),m(Ae),Ie.success(`${Ae.length} vendor(s) validated successfully! Click "Upload File" to proceed.`)),B.current&&(B.current.value="")}catch(H){console.error("Import Error:",H),Ie.error(`Error importing file: ${H.message}`)}},U.readAsArrayBuffer(I)},K=async()=>{var S,I;if(x.length===0){Ie.error("No vendors to upload. Please import a file first.");return}if(v.length>0){Ie.error("Please fix all validation errors before uploading.");return}try{L(!0);const U=x.map(H=>{const X=String(H["Has Agreement"]||"yes").toLowerCase().trim();return{vendorId:H.ID||"",vendorName:H.Name,entity:H.Entity,category:H.Category,email:H.Email,phone:String(H.Phone),billingAddress:H["Billing Address"],shippingAddress:H["Shipping Address"]||H["Billing Address"],taxNumber:H["Tax Number"],gstin:H.GSTIN||"",msme:H.MSME||"",bankAccountNumber:String(H["Bank Account Number"]),ifscSwiftCode:H["IFSC/SWIFT Code"],bankName:H["Bank Name"],hasAgreement:X,natureOfService:H["Nature of Service"],primarySubsidiary:H["Primary Subsidiary"]||"",empId:e,...X==="no"&&{questionnaireAnswer:H["Questionnaire Answer"]||"",isDeviation:!0}}});console.log("Uploading vendors:",U);const Q=await nC(U,e);Q.status===201?(Ie.success(`${U.length} vendor(s) uploaded successfully!`),await M(),m([]),w([]),h(!1)):Ie.error(Q.data.message||"Failed to upload vendors")}catch(U){console.error("Upload Error:",U),Ie.error(((I=(S=U.response)==null?void 0:S.data)==null?void 0:I.message)||"Error uploading vendors. Please try again.")}finally{L(!1)}},ae=C.useMemo(()=>r==null?void 0:r.filter(S=>{var H,X;const I=["vendorName","Name","email","phone","vendorId","ID","taxNumber","Tax Number"],U=c.trim()===""||I.some(V=>{const Ae=S[V];return Ae&&String(Ae).toLowerCase().includes(c.toLowerCase())}),Q=d==="all"?!0:d==="active"?((H=S.Inactive)==null?void 0:H.toLowerCase())==="no":((X=S.Inactive)==null?void 0:X.toLowerCase())==="yes";return U&&Q}),[r,c,d]),Z=Math.ceil(((ae==null?void 0:ae.length)||0)/T),oe=(o-1)*T,Y=oe+T,R=ae==null?void 0:ae.slice(oe,Y),z=S=>{l(S)},ee=async S=>{if(window.confirm("Are you sure you want to delete this vendor?"))try{const I=await rC(S);I.status===200?(n(r==null?void 0:r.filter(U=>(U==null?void 0:U._id)!==S)),Ie.success(I.data.message)):Ie.error(I.data.message)}catch{Ie.error("Error deleting vendor")}},b=(S,I)=>{I.stopPropagation(),p(g===S?null:S)},O=()=>f?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg p-4 sm:p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Import Vendors"}),a.jsx("button",{onClick:()=>{h(!1),m([]),w([])},className:"text-gray-500 hover:text-gray-700","aria-label":"Close modal",children:a.jsx(_r,{className:"h-5 w-5"})})]}),a.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsxs("h4",{className:"font-semibold text-blue-900 mb-3 flex items-center",children:[a.jsx(K4,{className:"h-5 w-5 mr-2"}),"Required Excel Format"]}),a.jsxs("div",{className:"text-sm text-blue-800 space-y-2",children:[a.jsx("p",{className:"font-medium",children:"Your Excel file must include these columns:"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 text-xs",children:[a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2 text-red-500",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Name"})," - Company Name (Required)"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2 text-red-500",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Entity"})," - Entity Type (Required)"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2 text-red-500",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Category"})," - Vendor Category (Required)"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2 text-red-500",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Email"})," - Email Address (Required)"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2 text-red-500",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Phone"})," - Phone Number (Required)"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2 text-red-500",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Billing Address"})," - Address (Required)"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2 text-red-500",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Tax Number"})," - PAN/Tax/W9 (Required)"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"GSTIN"})," - GST Number (Optional)"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"MSME"})," - MSME Number (Optional)"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2 text-red-500",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Bank Account Number"})," (Required)"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2 text-red-500",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"IFSC/SWIFT Code"})," (Required)"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2 text-red-500",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Bank Name"})," (Required)"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2 text-red-500",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Has Agreement"})," - yes/no (Required)"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2 text-red-500",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Nature of Service"})," (Required)"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"ID"})," - Vendor ID (Optional)"]})]})]}),a.jsxs("div",{className:"mt-3 pt-3 border-t border-blue-300",children:[a.jsx("p",{className:"text-xs text-blue-700",children:a.jsx("strong",{children:"Important Notes:"})}),a.jsxs("ul",{className:"text-xs text-blue-700 mt-1 space-y-1 ml-4",children:[a.jsxs("li",{children:[" Fields marked with ",a.jsx("span",{className:"text-red-500",children:"red"})," are mandatory"]}),a.jsx("li",{children:" Agreement files and document uploads must be done separately after vendor creation"}),a.jsx("li",{children:' If "Has Agreement" is "no", fill the "Questionnaire Answer" column'}),a.jsx("li",{children:" Email must be in valid format (e.g., name@company.com)"}),a.jsx("li",{children:" Phone number must be at least 10 digits"}),a.jsx("li",{children:" Bank Account Number must be at least 9 digits"})]})]})]})]}),a.jsx("div",{className:"mb-4",children:a.jsxs("button",{onClick:D,className:"w-full flex items-center justify-center px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium",children:[a.jsx(_n,{className:"h-5 w-5 mr-2"}),"Download Sample Template"]})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:[a.jsx("label",{htmlFor:"file-upload",className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload Your Excel File"}),a.jsx("input",{id:"file-upload",type:"file",ref:B,onChange:G,accept:".xlsx,.xls,.csv",className:"w-full text-sm file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-primary file:text-white hover:file:bg-primary/90"}),a.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Supported formats: .xlsx, .xls, .csv (Max size: 5MB)"}),x.length>0&&a.jsx("div",{className:`mt-3 p-3 border rounded ${v.length>0?"bg-red-50 border-red-200":"bg-green-50 border-green-200"}`,children:a.jsx("p",{className:`text-sm font-medium ${v.length>0?"text-red-700":"text-green-700"}`,children:v.length>0?a.jsxs("span",{children:[" ",x.length," vendor(s) imported with ",v.length," error(s)"]}):a.jsxs("span",{children:[" ",x.length," vendor(s) ready to upload"]})})})]}),v.length>0&&a.jsxs("div",{className:"max-h-48 overflow-y-auto bg-red-50 border border-red-200 rounded-lg p-3",children:[a.jsxs("h4",{className:"font-semibold text-red-900 mb-2 flex items-center",children:[a.jsx(_r,{className:"h-4 w-4 mr-2"}),"Validation Errors (",v.length,")"]}),a.jsxs("ul",{className:"text-xs text-red-700 space-y-1",children:[v.slice(0,10).map((S,I)=>a.jsxs("li",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsx("span",{children:S})]},I)),v.length>10&&a.jsxs("li",{className:"text-red-800 font-medium mt-2",children:["... and ",v.length-10," more error(s)"]})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-end space-y-2 sm:space-y-0 sm:space-x-3",children:[a.jsx("button",{onClick:()=>{h(!1),m([]),w([])},className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 order-2 sm:order-1",disabled:E,children:"Cancel"}),a.jsx("button",{onClick:K,disabled:x.length===0||v.length>0||E,className:`w-full sm:w-auto px-4 py-2 text-sm font-medium text-white rounded-lg order-1 sm:order-2 transition-colors flex items-center justify-center
                  ${x.length>0&&v.length===0&&!E?"bg-primary hover:bg-primary/90":"bg-gray-400 cursor-not-allowed"}`,children:E?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Uploading..."]}):"Upload File"})]})]})]})}):null;return a.jsxs("div",{className:"p-4 md:p-8 bg-white rounded-lg shadow-sm h-full",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-xl md:text-2xl font-bold text-gray-900 mb-4 md:mb-6",children:"My Added Vendors"}),a.jsxs("div",{className:"md:hidden space-y-3",children:[a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs("button",{className:"flex-1 inline-flex items-center justify-center px-4 py-2.5 bg-primary text-white rounded-lg text-sm font-medium hover:bg-primary/90",onClick:()=>t("/vendor-list-table/my-vendor-registration"),children:[a.jsx(yn,{className:"h-4 w-4 mr-2"}),"Add Vendor"]}),s&&a.jsxs("a",{href:s.policyFile,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center px-4 py-2.5 border border-blue-300 rounded-lg text-sm font-medium text-blue-700 bg-blue-50 hover:bg-blue-100",children:[a.jsx(jr,{className:"h-4 w-4 mr-2"}),"Policy"]})]}),a.jsx("div",{className:"flex gap-2 w-full",children:a.jsxs("div",{className:"relative flex-grow",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none",children:a.jsx(rn,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{type:"text",placeholder:"Search vendors...",value:c,onChange:S=>{A(S.target.value),l(1)},className:"w-full pl-11 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]})}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("select",{value:d,onChange:S=>{u(S.target.value),l(1)},className:"px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"active",children:"Active"}),a.jsx("option",{value:"inactive",children:"Inactive"})]}),a.jsxs("button",{onClick:()=>h(!0),className:"inline-flex items-center justify-center px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[a.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Import"]})]})]}),a.jsx("div",{className:"hidden md:block",children:a.jsxs("div",{className:"flex flex-wrap md:flex-nowrap gap-3 mb-4 justify-between",children:[a.jsxs("div",{className:"relative w-full md:w-96 lg:w-80",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none",children:a.jsx(rn,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{type:"text",placeholder:"Search vendors...",value:c,onChange:S=>{A(S.target.value),l(1)},className:"w-full pl-11 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),a.jsxs("div",{className:"flex flex-wrap gap-3 flex-shrink-0",children:[a.jsxs("select",{value:d,onChange:S=>{u(S.target.value),l(1)},className:"px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"active",children:"Active"}),a.jsx("option",{value:"inactive",children:"Inactive"})]}),a.jsxs("button",{onClick:()=>h(!0),className:"inline-flex items-center justify-center px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[a.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Import"]}),s&&a.jsxs("a",{href:s.policyFile,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center px-4 py-2.5 border border-blue-300 rounded-lg text-sm font-medium text-blue-700 bg-blue-50 hover:bg-blue-100",children:[a.jsx(jr,{className:"h-4 w-4 mr-2"}),"View Policy"]}),a.jsxs("button",{className:"inline-flex items-center justify-center px-4 py-2.5 bg-primary text-white rounded-lg text-sm font-medium hover:bg-primary/90",onClick:()=>t("/vendor-list-table/my-vendor-registration"),children:[a.jsx(yn,{className:"h-4 w-4 mr-2"}),"Add Vendor"]})]})]})})]}),_?a.jsx("div",{className:"flex justify-center items-center py-10",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary"})}):(ae==null?void 0:ae.length)===0?a.jsxs("div",{className:"text-center py-10 text-gray-500",children:[a.jsx("p",{className:"text-lg font-medium",children:"No vendors found"}),a.jsx("p",{className:"text-sm mt-2",children:"Try adjusting your search or filters"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"md:hidden space-y-3 mb-4",children:R==null?void 0:R.map((S,I)=>{var U;return a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-white hover:bg-gray-50",children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-xs text-gray-500",children:(S==null?void 0:S.vendorId)||S.ID}),a.jsx("h3",{className:"font-semibold text-gray-900",children:(S==null?void 0:S.vendorName)||S.Name})]}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{className:"text-primary hover:text-primary/80",onClick:Q=>{Q.stopPropagation(),t(`/vendor-list-table/edit-vendor/${S._id}`)},children:a.jsx(Us,{className:"h-4 w-4"})}),a.jsx("button",{className:"text-red-600 hover:text-red-800",onClick:Q=>{Q.stopPropagation(),ee(S==null?void 0:S._id)},children:a.jsx($r,{className:"h-4 w-4"})}),a.jsx("button",{className:"text-gray-500 hover:text-gray-700",onClick:Q=>b(S._id,Q),"aria-expanded":g===S._id,children:g===S._id?a.jsx(bl,{className:"h-4 w-4"}):a.jsx(vo,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{className:"text-xs text-gray-900 mb-1",children:["Tax ID: ",(S==null?void 0:S.taxNumber)||S["Tax Number"]]}),a.jsxs("div",{className:"text-xs text-gray-500 mb-1",children:["Phone: ",S==null?void 0:S.phone]}),g===S._id&&a.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 text-xs text-gray-500",children:[a.jsxs("div",{className:"mb-1",children:[a.jsx("span",{className:"font-medium",children:"Address:"})," ",(S==null?void 0:S.shippingAddress)||S["Shipping Address"]]}),a.jsxs("div",{className:"mb-1",children:[a.jsx("span",{className:"font-medium",children:"Status:"})," ",((U=S==null?void 0:S.Inactive)==null?void 0:U.toLowerCase())==="no"?"Active":"Inactive"]})]}),a.jsx("button",{className:"w-full mt-3 text-sm text-primary hover:text-primary/80 text-center",onClick:()=>t(`/vendor-list-table/get-vendor/${S._id}`),children:"View Details"})]},S._id)})}),a.jsx("div",{className:"hidden md:block border border-gray-200 rounded-lg overflow-hidden mb-4",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-primary",children:a.jsxs("tr",{children:[a.jsx("th",{className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Sno"}),a.jsx("th",{className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Vendor"}),a.jsx("th",{className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Phone"}),a.jsx("th",{className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Address"}),a.jsx("th",{className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:R==null?void 0:R.map((S,I)=>a.jsxs("tr",{onClick:()=>t(`/vendor-list-table/get-vendor/${S._id}`),className:"hover:bg-gray-50 cursor-pointer",children:[a.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:oe+I+1}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"block text-sm text-gray-500",children:(S==null?void 0:S.vendorId)||S.ID}),a.jsx("span",{className:"block font-semibold text-gray-900",children:(S==null?void 0:S.vendorName)||S.Name}),a.jsxs("span",{className:"block text-sm text-gray-900",children:["Tax ID: ",(S==null?void 0:S.taxNumber)||S["Tax Number"]]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:S==null?void 0:S.phone}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs lg:max-w-md break-words whitespace-normal",children:(S==null?void 0:S.shippingAddress)||S["Shipping Address"]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex space-x-4",children:[a.jsx("button",{className:"text-primary hover:text-primary/80",onClick:U=>{U.stopPropagation(),t(`/vendor-list-table/edit-vendor/${S._id}`)},children:a.jsx(Us,{className:"h-5 w-5"})}),a.jsx("button",{className:"text-red-600 hover:text-red-800",onClick:U=>{U.stopPropagation(),ee(S==null?void 0:S._id)},children:a.jsx($r,{className:"h-5 w-5"})})]})})]},S._id))})]})})})]}),a.jsx(cj,{currentPage:o,totalPages:Z,handlePageChange:z,itemsPerPage:T,totalItems:(ae==null?void 0:ae.length)||0}),a.jsx(O,{}),a.jsx(In,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,pauseOnFocusLoss:!0})]})},mwe=({formData:e,handleInputChange:t,currencies:r,monthlyEntries:n,updateMonthlyEntry:s,months:i,years:o,addMonthlyEntry:l,removeMonthlyEntry:c,setShowForm:A,setEditingId:d,resetForm:u,handleSubmit:f,editingId:h,searchMode:x,setSearchMode:m,searchQuery:g,setSearchQuery:p,onSearch:v,onAutoCalculate:w})=>a.jsxs("div",{className:"p-6 border-b border-gray-200 bg-gray-50",children:[a.jsx("h3",{className:"text-lg font-semibold mb-6",children:h?"Edit Entry":"Add New Entry"}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h4",{className:"text-md font-semibold text-gray-700 mb-4",children:"Basic Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["FY Start ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"date",name:"fyStart",value:e.fyStart,onChange:t,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["FY End ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"date",name:"fyEnd",value:e.fyEnd,onChange:t,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["PO Number ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"poNumber",value:e.poNumber,onChange:t,placeholder:"Enter PO Number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0}),a.jsxs("div",{className:"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Quick Search"}),a.jsxs("div",{className:"flex gap-2 mb-2",children:[a.jsx("button",{type:"button",onClick:()=>m("po"),className:`px-3 py-1.5 text-xs font-medium rounded-md transition-colors ${x==="po"?"bg-indigo-600 text-white shadow-sm":"bg-white text-gray-700 hover:bg-gray-100 border border-gray-300"}`,children:"PO Number"}),a.jsx("button",{type:"button",onClick:()=>m("req"),className:`px-3 py-1.5 text-xs font-medium rounded-md transition-colors ${x==="req"?"bg-indigo-600 text-white shadow-sm":"bg-white text-gray-700 hover:bg-gray-100 border border-gray-300"}`,children:"Request ID"}),a.jsx("button",{type:"button",onClick:()=>m("invoice"),className:`px-3 py-1.5 text-xs font-medium rounded-md transition-colors ${x==="invoice"?"bg-indigo-600 text-white shadow-sm":"bg-white text-gray-700 hover:bg-gray-100 border border-gray-300"}`,children:"Invoice Number"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx("input",{type:"text",value:g,onChange:B=>p(B.target.value),onKeyPress:B=>{B.key==="Enter"&&g.trim()&&v&&v(g,x)},placeholder:x==="po"?"Enter PO Number":x==="req"?"Enter Request ID":"Enter Invoice Number",className:"w-full pl-8 pr-3 py-1.5 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"}),a.jsx(rn,{className:"absolute left-2 top-2 w-4 h-4 text-gray-400"})]}),a.jsx("button",{type:"button",onClick:()=>v&&v(g,x),disabled:!g.trim(),className:"px-4 py-1.5 text-sm bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:"Search"})]})]})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Vendor Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"vendorName",value:e.vendorName,onChange:t,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency"}),a.jsx("select",{name:"currency",value:e.currency,onChange:t,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",children:r.map(B=>a.jsxs("option",{value:B.code,children:[B.symbol," ",B.code]},B.code))})]})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h4",{className:"text-md font-semibold text-gray-700 mb-4",children:"Additional Details"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"lg:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PO Description"}),a.jsx("input",{type:"text",name:"poDescription",value:e.poDescription,onChange:t,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Computation"}),a.jsx("input",{type:"text",name:"computation",value:e.computation,onChange:t,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PO Value"}),a.jsx("input",{type:"number",name:"poValue",value:e.poValue,onChange:t,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PO Start Date"}),a.jsx("input",{type:"date",name:"poStartDate",value:e.poStartDate,onChange:t,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PO End Date"}),a.jsx("input",{type:"date",name:"poEndDate",value:e.poEndDate,onChange:t,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h4",{className:"text-md font-semibold text-gray-700",children:"Monthly Amounts"}),a.jsx("button",{type:"button",onClick:()=>w&&w(),className:"px-4 py-2 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors shadow-sm",children:"Auto-calculate Monthly Amounts"})]}),a.jsx("div",{className:"space-y-3",children:n.map((B,T)=>a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3 items-end p-4 border border-gray-200 rounded-lg bg-white shadow-sm",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Month"}),a.jsxs("select",{value:B.month,onChange:_=>s(T,"month",_.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[a.jsx("option",{value:"",children:"Select Month"}),i.map(_=>a.jsx("option",{value:_.value,children:_.label},_.value))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Year"}),a.jsxs("select",{value:B.year,onChange:_=>s(T,"year",_.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[a.jsx("option",{value:"",children:"Select Year"}),o.map(_=>a.jsx("option",{value:_,children:_},_))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Amount"}),a.jsx("input",{type:"number",value:B.amount,onChange:_=>s(T,"amount",_.target.value),placeholder:"Enter amount",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Currency"}),a.jsx("select",{value:B.currency,onChange:_=>s(T,"currency",_.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",children:r.map(_=>a.jsxs("option",{value:_.code,children:[_.symbol," ",_.code]},_.code))})]}),a.jsx("div",{className:"flex gap-2",children:T===n.length-1?a.jsx("button",{type:"button",onClick:l,className:"px-4 py-2 bg-green-500 text-white text-sm rounded-lg hover:bg-green-600 transition-colors",children:"Add More"}):a.jsx("button",{type:"button",onClick:()=>c(T),disabled:n.length===1,className:"px-4 py-2 bg-red-500 text-white text-sm rounded-lg hover:bg-red-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:"Remove"})})]},B.id))})]}),a.jsxs("div",{className:"flex justify-end gap-4 pt-6 border-t border-gray-200",children:[a.jsx("button",{type:"button",onClick:()=>{A(!1),d(null),u()},className:"px-6 py-2.5 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors shadow-sm",children:"Cancel"}),a.jsx("button",{type:"button",onClick:f,className:"px-6 py-2.5 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors shadow-sm",children:h?"Update Entry":"Add Entry"})]})]}),pwe=({monthColumns:e,data:t,formatCurrency:r,calculateRowTotal:n,handleEdit:s,handleDeleteClick:i})=>a.jsxs("div",{className:"p-6",children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full border-collapse border border-gray-300",style:{minWidth:"1900px"},children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase w-24",children:"FY Start"}),a.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase w-24",children:"FY End"}),a.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase w-32",children:"PO Number"}),a.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase w-48",children:"Vendor Name"}),a.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase w-40",children:"PO Description"}),a.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase w-32",children:"Computation"}),a.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase w-28",children:"PO Value"}),a.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase w-20",children:"Currency"}),a.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase w-24",children:"Start Date"}),a.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase w-24",children:"End Date"}),e.map(o=>a.jsx("th",{className:"border border-gray-300 px-2 py-2 text-left text-xs font-medium text-gray-700 uppercase w-20",children:o.replace("-"," ").toUpperCase()},o)),a.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase w-24 bg-yellow-50",children:"Total"}),a.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase w-24",children:"Actions"})]})}),a.jsx("tbody",{children:t.map(o=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"border border-gray-300 px-3 py-2 text-sm",children:o.fyStart}),a.jsx("td",{className:"border border-gray-300 px-3 py-2 text-sm",children:o.fyEnd}),a.jsx("td",{className:"border border-gray-300 px-3 py-2 text-sm",children:o.poNumber}),a.jsx("td",{className:"border border-gray-300 px-3 py-2 text-sm",children:o.vendorName}),a.jsx("td",{className:"border border-gray-300 px-3 py-2 text-sm",children:o.poDescription}),a.jsx("td",{className:"border border-gray-300 px-3 py-2 text-sm",children:o.computation}),a.jsx("td",{className:"border border-gray-300 px-3 py-2 text-sm",children:o.poValue}),a.jsx("td",{className:"border border-gray-300 px-3 py-2 text-sm text-center",children:a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:o.currency})}),a.jsx("td",{className:"border border-gray-300 px-3 py-2 text-sm",children:o.poStartDate}),a.jsx("td",{className:"border border-gray-300 px-3 py-2 text-sm",children:o.poEndDate}),e.map(l=>{var u;const c=(u=o.monthlyData)==null?void 0:u[l],A=typeof c=="object"?c.amount:c,d=typeof c=="object"?c.currency:o.currency;return a.jsx("td",{className:"border border-gray-300 px-2 py-2 text-sm text-right",children:A&&A!=="0"?r(A,d):"-"},l)}),a.jsx("td",{className:"border border-gray-300 px-3 py-2 text-sm font-semibold text-right bg-yellow-50",children:r(n(o.monthlyData),o.currency)}),a.jsx("td",{className:"border border-gray-300 px-3 py-2 text-sm",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>s(o),className:"px-2 py-1 bg-indigo-500 text-white rounded text-xs hover:bg-indigo-600",children:"Edit"}),a.jsx("button",{onClick:()=>i(o),className:"px-2 py-1 bg-red-500 text-white rounded text-xs hover:bg-red-600",children:"Delete"})]})})]},o.id))})]})}),t.length===0&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx(jr,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500",children:"No data available. Add new entries to get started."})]})]});function xwe({deleteModal:e,setDeleteModal:t,confirmDelete:r}){return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[a.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[a.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:a.jsx(Trash2,{className:"w-5 h-5 text-red-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Delete Entry"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this entry? This action cannot be undone."})]})]}),e.item&&a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-4",children:[a.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["PO Number: ",e.item.poNumber]}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Vendor: ",e.item.vendorName]})]}),a.jsxs("div",{className:"flex justify-end gap-3",children:[a.jsx("button",{onClick:()=>t({show:!1,item:null}),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"}),a.jsx("button",{onClick:r,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Delete"})]})]})})}const gwe=()=>{const e=localStorage.getItem("capEmpId"),[t,r]=C.useState([]),[n,s]=C.useState(!0),[i,o]=C.useState(!1),[l,c]=C.useState(null),[A,d]=C.useState(""),[u,f]=C.useState(!1),[h,x]=C.useState({show:!1,message:"",type:""}),[m,g]=C.useState(!1),[p,v]=C.useState({show:!1,item:null}),w=C.useRef(null),[B,T]=C.useState("po"),[_,j]=C.useState(""),[E,L]=C.useState([]),[M,F]=C.useState({fyStart:"",fyEnd:"",poNumber:"",vendorName:"",poDescription:"",computation:"",poValue:"",poStartDate:"",poEndDate:"",currency:"INR"}),[D,G]=C.useState([{id:Date.now(),month:"",year:"",amount:"",currency:"INR"}]),K=["fyStart","fyEnd","poNumber","vendorName","poDescription","computation","poValue","currency","poStartDate","poEndDate"],ae=["jan-2024","feb-2024","mar-2024","apr-2024","may-2024","jun-2024","jul-2024","aug-2024","sep-2024","oct-2024","nov-2024","dec-2024","jan-2025","feb-2025","mar-2025","apr-2025","may-2025","jun-2025","jul-2025","aug-2025","sep-2025","oct-2025","nov-2025","dec-2025"],Z=(xe,ue="success")=>{x({show:!0,message:xe,type:ue}),setTimeout(()=>{x({show:!1,message:"",type:""})},4e3)},oe=async(xe,ue)=>{var Fe,ke,Te,Ne,et,Se,Ce;try{if(!xe||!xe.trim()){Z("Please enter a search value","error");return}if(f(!0),ue==="req"){const Be=await L$(xe.trim());if(Be.status===200){const Pe=Be.data.data,Bt=((Fe=Pe.poDocuments)==null?void 0:Fe.poNumber)||Pe.poNumber||Pe.PONumber||"",tt=((ke=Pe.procurements)==null?void 0:ke.vendor)||"",Ot=((Te=Pe.procurements)==null?void 0:Te.vendorName)||"",vt=((Ne=Pe.supplies)==null?void 0:Ne.totalValue)||Pe.totalValue||"",Vt=((et=Pe.supplies)==null?void 0:et.selectedCurrency)||Pe.currency||"INR";if(!Bt&&!tt&&!vt){Z("No relevant data found for this Request ID","error");return}F($t=>({...$t,poNumber:Bt||$t.poNumber,vendorName:tt&&Ot?`${tt} - ${Ot}`:tt||Ot||$t.vendorName,poValue:vt?vt.toString():$t.poValue,currency:Vt||$t.currency}));const pr=[];Bt&&pr.push("PO Number"),(tt||Ot)&&pr.push("Vendor"),vt&&pr.push("PO Value"),Z(`Successfully fetched: ${pr.join(", ")}`,"success")}else Z("Request not found or invalid response","error")}else ue==="po"?Z("PO Number search functionality coming soon","info"):ue==="invoice"&&Z("Invoice Number search functionality coming soon","info")}catch(Be){console.error("Search error:",Be),((Se=Be.response)==null?void 0:Se.status)===404?Z("Request ID not found","error"):((Ce=Be.response)==null?void 0:Ce.status)===500?Z("Server error. Please try again later","error"):Z(Be.message||"Search failed","error")}finally{f(!1)}},Y=(xe,ue)=>new Date(xe,ue+1,0).getDate(),R=xe=>{const[ue,Fe,ke]=xe.split("-").map(Te=>parseInt(Te,10));return{y:ue,m:Fe,day:ke}},z=xe=>["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"][xe],ee=()=>{const{poValue:xe,poStartDate:ue,poEndDate:Fe,currency:ke}=M,Te=parseFloat(xe);if(!Te||!ue||!Fe){Z("Provide PO Value, Start Date and End Date","error");return}const Ne=R(ue),et=R(Fe),Se=new Date(Ne.y,Ne.m-1,Ne.day);if(new Date(et.y,et.m-1,et.day)<=Se){Z("End date must be after start date","error");return}let Be=Ne.y,Pe=Ne.m-1,Bt=0;const tt=[];for(;Be<et.y||Be===et.y&&Pe<=et.m-1;){const Vt=Y(Be,Pe);let pr=1,$t=Vt;Be===Ne.y&&Pe===Ne.m-1&&(pr=Ne.day),Be===et.y&&Pe===et.m-1&&($t=et.day);const Qr=Math.max(0,$t-pr+1);Qr>0&&(tt.push({y:Be,m:Pe,days:Qr}),Bt+=Qr),Pe+=1,Pe>11&&(Pe=0,Be+=1)}if(Bt<=0){Z("Calculated duration is zero","error");return}const Ot=Te/Bt,vt=tt.map(({y:Vt,m:pr,days:$t})=>({id:Date.now()+Math.random(),month:z(pr),year:String(Vt),amount:(Ot*$t).toFixed(2),currency:ke||"INR"}));G(vt),Z("Monthly amounts auto-calculated")};C.useEffect(()=>{(async()=>{try{s(!0);const ue=await Cx();if(ue.status===200&&ue.data){const Fe=ue.data.map((ke,Te)=>{var Ne;return{id:ke._id||Te,fyStart:ke.fyStart,fyEnd:ke.fyEnd,poNumber:ke.poNumber,vendorName:ke.vendorName,poDescription:ke.poDescription,computation:ke.computation,poValue:((Ne=ke.poValue)==null?void 0:Ne.toString())||"",poStartDate:ke.poStartDate?new Date(ke.poStartDate).toISOString().split("T")[0]:"",poEndDate:ke.poEndDate?new Date(ke.poEndDate).toISOString().split("T")[0]:"",currency:ke.currency||"INR",monthlyData:ke.monthlyData||{}}});r(Fe),Z("Data loaded successfully")}else Z("Failed to load data","error")}catch(ue){console.error("Error fetching data:",ue),Z("Error loading data","error")}finally{s(!1)}})()},[]),C.useEffect(()=>{(async()=>{const ue=await mo();ue.status===200&&L(ue.data.data)})()},[]);const b=[{value:"jan",label:"January"},{value:"feb",label:"February"},{value:"mar",label:"March"},{value:"apr",label:"April"},{value:"may",label:"May"},{value:"jun",label:"June"},{value:"jul",label:"July"},{value:"aug",label:"August"},{value:"sep",label:"September"},{value:"oct",label:"October"},{value:"nov",label:"November"},{value:"dec",label:"December"}],O=["2024","2025","2026","2027","2028","2029","2030"],S=xe=>{const ue=xe.map(ke=>ke.trim().toLowerCase()),Fe=K.filter(ke=>!ue.includes(ke.toLowerCase()));if(Fe.length>0)throw new Error(`Missing required CSV fields: ${Fe.join(", ")}`);return!0},I=xe=>{const ue=xe.split(`
`).filter(Ne=>Ne.trim());if(ue.length<2)throw new Error("CSV file is empty or invalid");const Fe=ue[0].split(",").map(Ne=>Ne.trim());S(Fe);const ke=[],Te=Fe.filter(Ne=>!K.includes(Ne.trim().toLowerCase())&&Ne.trim()!=="total");for(let Ne=1;Ne<ue.length;Ne++){const et=ue[Ne].split(",").map(Pe=>Pe.trim());if(et.length<K.length)continue;const Se={};Te.forEach(Pe=>{const Bt=Fe.indexOf(Pe);if(Bt!==-1&&et[Bt]){const tt=et[Bt].replace(/[$.RpRM\s,]/g,"");if(tt&&tt!=="-"&&parseFloat(tt)>0){const Ot=Fe.findIndex(vt=>vt.toLowerCase()==="currency");Se[Pe.toLowerCase().replace(" ","-")]={amount:tt,currency:Ot!==-1?et[Ot]:"INR"}}}});const Ce=Pe=>{const Bt=Fe.findIndex(tt=>tt.toLowerCase()===Pe.toLowerCase());return Bt!==-1?et[Bt]:""},Be={fyStart:Ce("fyStart"),fyEnd:Ce("fyEnd"),poNumber:Ce("poNumber"),vendorName:Ce("vendorName"),poDescription:Ce("poDescription"),computation:Ce("computation"),poValue:Ce("poValue"),currency:Ce("currency")||"INR",poStartDate:Ce("poStartDate"),poEndDate:Ce("poEndDate"),monthlyData:Se};Be.poNumber&&ke.push(Be)}return ke},U=async xe=>{const ue=xe.target.files[0];if(ue){if(!ue.name.endsWith(".csv")){d("Please select a valid CSV file");return}f(!0),d("");try{const Fe=await new Promise((Ne,et)=>{const Se=new FileReader;Se.onload=Ce=>Ne(Ce.target.result),Se.onerror=Ce=>et(Ce),Se.readAsText(ue)}),ke=I(Fe);if(ke.length===0)throw new Error("No valid data found in CSV file");if((await aS(ke,e)).status===201){const Ne=await Cx();if(Ne.status===200){const et=Ne.data.map((Se,Ce)=>{var Be;return{id:Se._id||Ce,fyStart:Se.fyStart,fyEnd:Se.fyEnd,poNumber:Se.poNumber,vendorName:Se.vendorName,poDescription:Se.poDescription,computation:Se.computation,poValue:((Be=Se.poValue)==null?void 0:Be.toString())||"",poStartDate:Se.poStartDate?new Date(Se.poStartDate).toISOString().split("T")[0]:"",poEndDate:Se.poEndDate?new Date(Se.poEndDate).toISOString().split("T")[0]:"",currency:Se.currency||"INR",monthlyData:Se.monthlyData||{}}});r(et)}Z(`Successfully uploaded ${ke.length} entries from CSV`)}else throw new Error("Failed to upload CSV data")}catch(Fe){console.error("CSV upload error:",Fe),d(Fe.message||"Error processing CSV file. Please check the format and try again."),Z("CSV upload failed","error")}finally{f(!1),w.current&&(w.current.value="")}}},Q=(xe,ue)=>{if(!xe||xe==="0")return"-";const Fe=E.find(Te=>Te.code===ue);if(!Fe)return xe;const ke=parseFloat(xe);return isNaN(ke)?xe:`${Fe.symbol}${ke.toLocaleString(Fe.locale)}`},H=()=>{const xe=new Set;return t.forEach(ue=>{ue.monthlyData&&Object.keys(ue.monthlyData).forEach(Fe=>xe.add(Fe))}),Array.from(xe).sort()},X=xe=>xe?Object.values(xe).reduce((ue,Fe)=>{const ke=typeof Fe=="object"?Fe.amount:Fe,Te=parseFloat(ke)||0;return ue+Te},0):0,V=xe=>{const{name:ue,value:Fe}=xe.target;F(ke=>({...ke,[ue]:Fe}))},Ae=(xe,ue,Fe)=>{G(ke=>ke.map((Te,Ne)=>Ne===xe?{...Te,[ue]:Fe}:Te))},W=()=>{G(xe=>[...xe,{id:Date.now(),month:"",year:"",amount:"",currency:M.currency||"INR"}])},J=xe=>{D.length>1&&G(ue=>ue.filter((Fe,ke)=>ke!==xe))},ve=async()=>{try{if(!M.poNumber||!M.vendorName){Z("Please fill in required fields","error");return}const xe={};D.forEach(ke=>{if(ke.month&&ke.year&&ke.amount){const Te=`${ke.month}-${ke.year}`;xe[Te]={amount:parseFloat(ke.amount),currency:ke.currency}}});const ue={...M,poValue:parseFloat(M.poValue)||0,monthlyData:xe};let Fe;if(l){if(Fe=await Sq(l,ue,e),Fe&&Fe.status===200){const ke=await Cx();if(ke.status===200){const Te=ke.data.map((Ne,et)=>{var Se;return{id:Ne._id||et,fyStart:Ne.fyStart,fyEnd:Ne.fyEnd,poNumber:Ne.poNumber,vendorName:Ne.vendorName,poDescription:Ne.poDescription,computation:Ne.computation,poValue:((Se=Ne.poValue)==null?void 0:Se.toString())||"",poStartDate:Ne.poStartDate?new Date(Ne.poStartDate).toISOString().split("T")[0]:"",poEndDate:Ne.poEndDate?new Date(Ne.poEndDate).toISOString().split("T")[0]:"",currency:Ne.currency||"INR",monthlyData:Ne.monthlyData||{}}});r(Te)}Z("Entry updated successfully")}else throw new Error("Failed to update entry");c(null)}else if(Fe=await aS(ue,e),Fe.status===201){const ke=await Cx();if(ke.status===200){const Te=ke.data.map((Ne,et)=>{var Se;return{id:Ne._id||et,fyStart:Ne.fyStart,fyEnd:Ne.fyEnd,poNumber:Ne.poNumber,vendorName:Ne.vendorName,poDescription:Ne.poDescription,computation:Ne.computation,poValue:((Se=Ne.poValue)==null?void 0:Se.toString())||"",poStartDate:Ne.poStartDate?new Date(Ne.poStartDate).toISOString().split("T")[0]:"",poEndDate:Ne.poEndDate?new Date(Ne.poEndDate).toISOString().split("T")[0]:"",currency:Ne.currency||"INR",monthlyData:Ne.monthlyData||{}}});r(Te)}Z("Entry added successfully")}else throw new Error("Failed to add entry");de()}catch(xe){console.error("Submit error:",xe),Z(xe.message||"Operation failed","error")}},de=()=>{F({fyStart:"",fyEnd:"",poNumber:"",vendorName:"",poDescription:"",computation:"",poValue:"",poStartDate:"",poEndDate:"",currency:"INR"}),G([{id:Date.now(),month:"",year:"",amount:"",currency:"INR"}]),o(!1)},te=xe=>{const{monthlyData:ue,...Fe}=xe;F({...Fe,poStartDate:Fe.poStartDate||"",poEndDate:Fe.poEndDate||""});const ke=[];ue&&Object.entries(ue).forEach(([Te,Ne])=>{const et=typeof Ne=="object"?Ne.amount:Ne,Se=typeof Ne=="object"?Ne.currency:xe.currency||"INR";if(et&&et!=="0"){const[Ce,Be]=Te.split("-");ke.push({id:Date.now()+Math.random(),month:Ce,year:Be,amount:et.toString(),currency:Se})}}),ke.length===0&&ke.push({id:Date.now(),month:"",year:"",amount:"",currency:xe.currency||"INR"}),G(ke),c(xe.id),o(!0)},je=xe=>{v({show:!0,item:xe})},qe=async()=>{if(p.item)try{if((await Bq(p.item.id,e)).status===200)r(ue=>ue.filter(Fe=>Fe.id!==p.item.id)),Z("Entry deleted successfully");else throw new Error("Failed to delete entry")}catch(xe){console.error("Delete error:",xe),Z("Failed to delete entry","error")}finally{v({show:!1,item:null})}},He=()=>{const xe=H(),Fe=[["fyStart","fyEnd","poNumber","vendorName","poDescription","computation","poValue","currency","poStartDate","poEndDate",...xe,"total"].join(","),...t.map(et=>[et.fyStart,et.fyEnd,et.poNumber,et.vendorName,et.poDescription,et.computation,et.poValue,et.currency,et.poStartDate,et.poEndDate,...xe.map(Se=>{var Pe;const Ce=(Pe=et.monthlyData)==null?void 0:Pe[Se];return(typeof Ce=="object"?Ce.amount:Ce)||"0"}),X(et.monthlyData)].join(","))].join(`
`),ke=new Blob([Fe],{type:"text/csv"}),Te=window.URL.createObjectURL(ke),Ne=document.createElement("a");Ne.href=Te,Ne.download="financial_year_po_data.csv",Ne.click(),window.URL.revokeObjectURL(Te),Z("CSV exported successfully")},Ze=H();return n?a.jsx("div",{className:"flex justify-center items-center min-h-screen",children:a.jsx("div",{className:"text-lg",children:"Loading..."})}):a.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[h.show&&a.jsxs("div",{className:`fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg flex items-center gap-2 ${h.type==="error"?"bg-red-100 border border-red-400 text-red-700":"bg-green-100 border border-green-400 text-green-700"}`,children:[h.type==="error"?a.jsx(xA,{className:"w-5 h-5"}):a.jsx(ho,{className:"w-5 h-5"}),a.jsx("span",{children:h.message}),a.jsx("button",{onClick:()=>x({show:!1,message:"",type:""}),className:"ml-2 hover:opacity-70",children:a.jsx(_r,{className:"w-4 h-4"})})]}),p.show&&a.jsx(xwe,{deleteModal:p,setDeleteModal:v,confirmDelete:qe}),a.jsxs("div",{className:"max-w-full mx-auto bg-white rounded-lg shadow-lg",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Financial Year Purchase Order Manager"}),a.jsxs("div",{className:"flex flex-wrap gap-4",children:[!i&&a.jsxs("button",{onClick:()=>o(!0),className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:[a.jsx(yn,{className:"w-4 h-4"}),"Add New Entry"]}),a.jsx("input",{type:"file",ref:w,onChange:U,accept:".csv",className:"hidden"}),a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>{var xe;return(xe=w.current)==null?void 0:xe.click()},disabled:u,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:bg-gray-400",children:[a.jsx(Ds,{className:"w-4 h-4"}),u?"Uploading...":"Upload CSV"]}),a.jsx("button",{onClick:()=>g(!m),className:"absolute -top-1 -right-1 w-5 h-5 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs hover:bg-blue-600",children:a.jsx(Fi,{className:"w-3 h-3"})})]}),a.jsxs("button",{onClick:He,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:[a.jsx(_n,{className:"w-4 h-4"}),"Export CSV"]})]})]}),m&&a.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"CSV Upload Requirements:"}),a.jsxs("div",{className:"text-sm text-blue-800",children:[a.jsx("p",{className:"mb-2",children:a.jsx("strong",{children:"Required Fields (exact names):"})}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-2 mb-3",children:K.map(xe=>a.jsx("span",{className:"bg-blue-100 px-2 py-1 rounded text-xs font-mono",children:xe},xe))}),a.jsx("p",{className:"mb-2",children:a.jsx("strong",{children:"Optional Monthly Fields (examples):"})}),a.jsx("div",{className:"grid grid-cols-3 md:grid-cols-6 gap-2",children:ae.slice(0,12).map(xe=>a.jsx("span",{className:"bg-gray-100 px-2 py-1 rounded text-xs font-mono",children:xe},xe))}),a.jsx("p",{className:"mt-2 text-xs",children:"Note: Field names are case-sensitive and must match exactly."})]})]}),A&&a.jsxs("div",{className:"mt-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-md flex items-center gap-2",children:[a.jsx(xA,{className:"w-5 h-5"}),a.jsx("span",{children:A}),a.jsx("button",{onClick:()=>d(""),className:"ml-auto text-red-700 hover:text-red-900",children:a.jsx(_r,{className:"w-4 h-4"})})]})]}),i&&a.jsx(mwe,{formData:M,handleInputChange:V,currencies:E,monthlyEntries:D,updateMonthlyEntry:Ae,months:b,years:O,addMonthlyEntry:W,removeMonthlyEntry:J,setShowForm:o,setEditingId:c,resetForm:de,handleSubmit:ve,editingId:l,searchMode:B,setSearchMode:T,searchQuery:_,setSearchQuery:j,onSearch:oe,onAutoCalculate:ee}),a.jsx(pwe,{monthColumns:Ze,data:t,formatCurrency:Q,calculateRowTotal:X,handleEdit:te,handleDeleteClick:je})]})]})},ywe=()=>{localStorage.getItem("capEmpId");const[e,t]=C.useState([]),[r,n]=C.useState(!1),[s,i]=C.useState(!1),[o,l]=C.useState(null),[c,A]=C.useState(""),[d,u]=C.useState(!1),[f,h]=C.useState({show:!1,message:"",type:""}),[x,m]=C.useState(!1),[g,p]=C.useState({show:!1,item:null}),v=C.useRef(null),[w,B]=C.useState({rpNumber:"",glNumber:"",month:"",year:"",vendor:"",remarks:"",nsDocumentId:"",invoiceNoDate:"",invoiceAmount:"",remarksFromMonth:"",remarksFromYear:"",remarksToMonth:"",remarksToYear:"",startDate:"",endDate:"",numberOfDays:"",clBal:"",mar24:"",amtPerDay:"",openingBalance:"",monthlyData:{}}),[T,_]=C.useState([{id:Date.now(),month:"",year:"",openingBalance:"",addition:"",amortization:""}]),j=[{value:"01",label:"January"},{value:"02",label:"February"},{value:"03",label:"March"},{value:"04",label:"April"},{value:"05",label:"May"},{value:"06",label:"June"},{value:"07",label:"July"},{value:"08",label:"August"},{value:"09",label:"September"},{value:"10",label:"October"},{value:"11",label:"November"},{value:"12",label:"December"}],E=["2024","2025","2026","2027","2028"],L=["2024-04","2024-05","2024-06","2024-07","2024-08","2024-09","2024-10","2024-11","2024-12","2025-01","2025-02","2025-03","2025-04","2025-05","2025-06","2025-07","2025-08","2025-09","2025-10","2025-11","2025-12","2026-01","2026-02","2026-03"],M=V=>{var ve;if(!V)return"";const[Ae,W]=V.split("-");return`${((ve=j.find(de=>de.value===W))==null?void 0:ve.label)||W} ${Ae}`},F=["rpNumber","glNumber","month","year","vendor","remarks","nsDocumentId","invoiceNoDate","invoiceAmount","remarksFromMonth","remarksFromYear","remarksToMonth","remarksToYear","startDate","endDate","numberOfDays","clBal","mar24","amtPerDay","openingBalance"],D=(V,Ae="success")=>{h({show:!0,message:V,type:Ae}),setTimeout(()=>{h({show:!1,message:"",type:""})},4e3)},G=(V,Ae)=>{if(!V||!Ae)return 0;const W=new Date(V),ve=new Date(Ae).getTime()-W.getTime();return Math.ceil(ve/(1e3*3600*24))+1},K=(V,Ae)=>!V||!Ae||Ae===0?0:parseFloat(V)/parseInt(Ae),ae=(V,Ae,W)=>{const J=parseFloat(V)||0,ve=parseFloat(Ae)||0,de=parseFloat(W)||0;return J+ve-de};C.useEffect(()=>{if(w.startDate&&w.endDate){const V=G(w.startDate,w.endDate);B(Ae=>({...Ae,numberOfDays:V.toString()}))}},[w.startDate,w.endDate]),C.useEffect(()=>{if(w.invoiceAmount&&w.numberOfDays){const V=K(w.invoiceAmount,w.numberOfDays);B(Ae=>({...Ae,amtPerDay:V.toFixed(2)}))}},[w.invoiceAmount,w.numberOfDays]);const Z=V=>{const Ae=V.map(J=>J.trim().toLowerCase()),W=F.filter(J=>!Ae.includes(J.toLowerCase()));if(W.length>0)throw new Error(`Missing required CSV fields: ${W.join(", ")}`);return!0},oe=V=>{const Ae=V.split(`
`).filter(ve=>ve.trim());if(Ae.length<2)throw new Error("CSV file is empty or invalid");const W=Ae[0].split(",").map(ve=>ve.trim());Z(W);const J=[];for(let ve=1;ve<Ae.length;ve++){const de=Ae[ve].split(",").map(He=>He.trim());if(de.length<F.length)continue;const te=He=>{const Ze=W.findIndex(xe=>xe.toLowerCase()===He.toLowerCase());return Ze!==-1?de[Ze]:""},je={};L.forEach(He=>{const Ze=W.findIndex(xe=>xe.toLowerCase()===He.toLowerCase());if(Ze!==-1&&de[Ze]){const xe=de[Ze].replace(/[$.RpRM\s,]/g,"");xe&&xe!=="-"&&parseFloat(xe)>0&&(je[He]={openingBalance:0,addition:0,amortization:parseFloat(xe),closingBalance:0})}});const qe={id:Date.now()+Math.random(),rpNumber:te("rpNumber"),glNumber:te("glNumber"),month:te("month"),year:te("year"),vendor:te("vendor"),remarks:te("remarks"),nsDocumentId:te("nsDocumentId"),invoiceNoDate:te("invoiceNoDate"),invoiceAmount:te("invoiceAmount"),remarksFromMonth:te("remarksFromMonth"),remarksFromYear:te("remarksFromYear"),remarksToMonth:te("remarksToMonth"),remarksToYear:te("remarksToYear"),startDate:te("startDate"),endDate:te("endDate"),numberOfDays:te("numberOfDays"),clBal:te("clBal"),mar24:te("mar24"),amtPerDay:te("amtPerDay"),openingBalance:te("openingBalance"),monthlyData:je};(qe.rpNumber||qe.vendor)&&J.push(qe)}return J},Y=async V=>{const Ae=V.target.files[0];if(Ae){if(!Ae.name.endsWith(".csv")){A("Please select a valid CSV file");return}u(!0),A("");try{const W=await new Promise((ve,de)=>{const te=new FileReader;te.onload=je=>ve(je.target.result),te.onerror=je=>de(je),te.readAsText(Ae)}),J=oe(W);if(J.length===0)throw new Error("No valid data found in CSV file");t(ve=>[...ve,...J]),D(`Successfully uploaded ${J.length} entries from CSV`)}catch(W){console.error("CSV upload error:",W),A(W.message||"Error processing CSV file. Please check the format and try again."),D("CSV upload failed","error")}finally{u(!1),v.current&&(v.current.value="")}}},R=V=>{const{name:Ae,value:W}=V.target;B(J=>({...J,[Ae]:W}))},z=(V,Ae,W)=>{_(J=>J.map((ve,de)=>de===V?{...ve,[Ae]:W}:ve))},ee=()=>{_(V=>[...V,{id:Date.now()+Math.random(),month:"",year:"",openingBalance:"",addition:"",amortization:""}])},b=V=>{T.length>1&&_(Ae=>Ae.filter((W,J)=>J!==V))},O=async()=>{try{if(!w.vendor||!w.invoiceAmount){D("Please fill in required fields (Vendor and Invoice Amount)","error");return}const V={};T.forEach(W=>{if(W.month&&W.year){const J=`${W.year}-${W.month}`,ve=ae(W.openingBalance,W.addition,W.amortization);V[J]={openingBalance:parseFloat(W.openingBalance)||0,addition:parseFloat(W.addition)||0,amortization:parseFloat(W.amortization)||0,closingBalance:ve}}});const Ae={id:o||Date.now(),...w,monthlyData:V};o?(t(W=>W.map(J=>J.id===o?Ae:J)),D("Entry updated successfully"),l(null)):(t(W=>[...W,Ae]),D("Entry added successfully")),S()}catch(V){console.error("Submit error:",V),D(V.message||"Operation failed","error")}},S=()=>{B({rpNumber:"",glNumber:"",month:"",year:"",vendor:"",remarks:"",nsDocumentId:"",invoiceNoDate:"",invoiceAmount:"",remarksFromMonth:"",remarksFromYear:"",remarksToMonth:"",remarksToYear:"",startDate:"",endDate:"",numberOfDays:"",clBal:"",mar24:"",amtPerDay:"",openingBalance:"",monthlyData:{}}),_([{id:Date.now(),month:"",year:"",openingBalance:"",addition:"",amortization:""}]),i(!1)},I=V=>{B({rpNumber:V.rpNumber||"",glNumber:V.glNumber||"",month:V.month||"",year:V.year||"",vendor:V.vendor||"",remarks:V.remarks||"",nsDocumentId:V.nsDocumentId||"",invoiceNoDate:V.invoiceNoDate||"",invoiceAmount:V.invoiceAmount||"",remarksFromMonth:V.remarksFromMonth||"",remarksFromYear:V.remarksFromYear||"",remarksToMonth:V.remarksToMonth||"",remarksToYear:V.remarksToYear||"",startDate:V.startDate||"",endDate:V.endDate||"",numberOfDays:V.numberOfDays||"",clBal:V.clBal||"",mar24:V.mar24||"",amtPerDay:V.amtPerDay||"",openingBalance:V.openingBalance||"",monthlyData:V.monthlyData||{}});const Ae=Object.entries(V.monthlyData||{}).map(([W,J])=>{var te,je,qe;const[ve,de]=W.split("-");return{id:Date.now()+Math.random(),month:de,year:ve,openingBalance:((te=J.openingBalance)==null?void 0:te.toString())||"",addition:((je=J.addition)==null?void 0:je.toString())||"",amortization:((qe=J.amortization)==null?void 0:qe.toString())||""}});_(Ae.length>0?Ae:[{id:Date.now(),month:"",year:"",openingBalance:"",addition:"",amortization:""}]),l(V.id),i(!0)},U=V=>{p({show:!0,item:V})},Q=async()=>{if(g.item)try{t(V=>V.filter(Ae=>Ae.id!==g.item.id)),D("Entry deleted successfully")}catch(V){console.error("Delete error:",V),D("Failed to delete entry","error")}finally{p({show:!1,item:null})}},H=()=>{const Ae=[[...F,...L.map(de=>`${de}_opening_balance`),...L.map(de=>`${de}_addition`),...L.map(de=>`${de}_amortization`),...L.map(de=>`${de}_closing_balance`)].join(","),...e.map(de=>[de.rpNumber||"",de.glNumber||"",de.month||"",de.year||"",de.vendor||"",de.remarks||"",de.nsDocumentId||"",de.invoiceNoDate||"",de.invoiceAmount||"",de.remarksFromMonth||"",de.remarksFromYear||"",de.remarksToMonth||"",de.remarksToYear||"",de.startDate||"",de.endDate||"",de.numberOfDays||"",de.clBal||"",de.mar24||"",de.amtPerDay||"",de.openingBalance||"",...L.map(te=>{var je,qe;return((qe=(je=de.monthlyData)==null?void 0:je[te])==null?void 0:qe.openingBalance)||"0"}),...L.map(te=>{var je,qe;return((qe=(je=de.monthlyData)==null?void 0:je[te])==null?void 0:qe.addition)||"0"}),...L.map(te=>{var je,qe;return((qe=(je=de.monthlyData)==null?void 0:je[te])==null?void 0:qe.amortization)||"0"}),...L.map(te=>{var je,qe;return((qe=(je=de.monthlyData)==null?void 0:je[te])==null?void 0:qe.closingBalance)||"0"})].join(","))].join(`
`),W=new Blob([Ae],{type:"text/csv"}),J=window.URL.createObjectURL(W),ve=document.createElement("a");ve.href=J,ve.download="prepaid_expenses_data.csv",ve.click(),window.URL.revokeObjectURL(J),D("CSV exported successfully")},X=V=>{if(!V||V==="0")return"-";const Ae=parseFloat(V);return isNaN(Ae)?V:`${Ae.toLocaleString("en-IN")}`};return r?a.jsx("div",{className:"flex justify-center items-center min-h-screen",children:a.jsx("div",{className:"text-lg",children:"Loading..."})}):a.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[f.show&&a.jsxs("div",{className:`fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg flex items-center gap-2 ${f.type==="error"?"bg-red-100 border border-red-400 text-red-700":"bg-green-100 border border-green-400 text-green-700"}`,children:[f.type==="error"?a.jsx(xA,{className:"w-5 h-5"}):a.jsx(ho,{className:"w-5 h-5"}),a.jsx("span",{children:f.message}),a.jsx("button",{onClick:()=>h({show:!1,message:"",type:""}),className:"ml-2 hover:opacity-70",children:a.jsx(_r,{className:"w-4 h-4"})})]}),g.show&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[a.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[a.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:a.jsx($r,{className:"w-5 h-5 text-red-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Delete Entry"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this prepaid entry? This action cannot be undone."})]})]}),g.item&&a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-4",children:[a.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["RP#: ",g.item.rpNumber||"N/A"]}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Vendor: ",g.item.vendor]}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Amount: ",X(g.item.invoiceAmount)]})]}),a.jsxs("div",{className:"flex justify-end gap-3",children:[a.jsx("button",{onClick:()=>p({show:!1,item:null}),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"}),a.jsx("button",{onClick:Q,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Delete"})]})]})}),a.jsxs("div",{className:"max-w-full mx-auto bg-white rounded-lg shadow-lg",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Prepaid Expenses Management"}),a.jsxs("div",{className:"flex flex-wrap gap-4",children:[!s&&a.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:[a.jsx(yn,{className:"w-4 h-4"}),"Add New Entry"]}),a.jsx("input",{type:"file",ref:v,onChange:Y,accept:".csv",className:"hidden"}),a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>{var V;return(V=v.current)==null?void 0:V.click()},disabled:d,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:bg-gray-400",children:[a.jsx(Ds,{className:"w-4 h-4"}),d?"Uploading...":"Upload CSV"]}),a.jsx("button",{onClick:()=>m(!x),className:"absolute -top-1 -right-1 w-5 h-5 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs hover:bg-blue-600",children:a.jsx(Fi,{className:"w-3 h-3"})})]}),a.jsxs("button",{onClick:H,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:[a.jsx(_n,{className:"w-4 h-4"}),"Export CSV"]})]})]}),x&&a.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"CSV Upload Requirements:"}),a.jsxs("div",{className:"text-sm text-blue-800",children:[a.jsx("p",{className:"mb-2",children:a.jsx("strong",{children:"Required Fields (exact names):"})}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 mb-3",children:F.map(V=>a.jsx("span",{className:"bg-blue-100 px-2 py-1 rounded text-xs font-mono",children:V},V))}),a.jsx("p",{className:"mt-2 text-xs",children:"Note: Field names are case-sensitive and must match exactly."})]})]}),c&&a.jsxs("div",{className:"mt-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-md flex items-center gap-2",children:[a.jsx(xA,{className:"w-5 h-5"}),a.jsx("span",{children:c}),a.jsx("button",{onClick:()=>A(""),className:"ml-auto text-red-700 hover:text-red-900",children:a.jsx(_r,{className:"w-4 h-4"})})]})]}),s&&a.jsxs("div",{className:"p-6 border-b border-gray-200 bg-gray-50",children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[a.jsx(P3,{className:"w-5 h-5"}),o?"Edit Prepaid Entry":"Add New Prepaid Entry"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"RP Number"}),a.jsx("input",{type:"text",name:"rpNumber",value:w.rpNumber,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"RP001"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"GL Number"}),a.jsx("input",{type:"text",name:"glNumber",value:w.glNumber,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"GL001"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Month"}),a.jsxs("select",{name:"month",value:w.month,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[a.jsx("option",{value:"",children:"Select Month"}),j.map(V=>a.jsx("option",{value:V.value,children:V.label},V.value))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year"}),a.jsxs("select",{name:"year",value:w.year,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[a.jsx("option",{value:"",children:"Select Year"}),E.map(V=>a.jsx("option",{value:V,children:V},V))]})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vendor *"}),a.jsx("input",{type:"text",name:"vendor",value:w.vendor,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0,placeholder:"Vendor Name"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Remarks"}),a.jsx("input",{type:"text",name:"remarks",value:w.remarks,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Additional remarks"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"NS Document ID"}),a.jsx("input",{type:"text",name:"nsDocumentId",value:w.nsDocumentId,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"NS001"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice No/Date"}),a.jsx("input",{type:"text",name:"invoiceNoDate",value:w.invoiceNoDate,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"INV001/2024-04-01"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Amount *"}),a.jsx("input",{type:"number",name:"invoiceAmount",value:w.invoiceAmount,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0,placeholder:"100000"})]}),a.jsxs("div",{className:"md:col-span-3",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Remarks From To (Month/Year Range)"}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[a.jsx("div",{children:a.jsxs("select",{name:"remarksFromMonth",value:w.remarksFromMonth,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[a.jsx("option",{value:"",children:"From Month"}),j.map(V=>a.jsx("option",{value:V.value,children:V.label},V.value))]})}),a.jsx("div",{children:a.jsxs("select",{name:"remarksFromYear",value:w.remarksFromYear,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[a.jsx("option",{value:"",children:"From Year"}),E.map(V=>a.jsx("option",{value:V,children:V},V))]})}),a.jsx("div",{children:a.jsxs("select",{name:"remarksToMonth",value:w.remarksToMonth,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[a.jsx("option",{value:"",children:"To Month"}),j.map(V=>a.jsx("option",{value:V.value,children:V.label},V.value))]})}),a.jsx("div",{children:a.jsxs("select",{name:"remarksToYear",value:w.remarksToYear,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[a.jsx("option",{value:"",children:"To Year"}),E.map(V=>a.jsx("option",{value:V,children:V},V))]})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),a.jsx("input",{type:"date",name:"startDate",value:w.startDate,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),a.jsx("input",{type:"date",name:"endDate",value:w.endDate,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"No of Days (Auto-calculated)"}),a.jsx("input",{type:"number",name:"numberOfDays",value:w.numberOfDays,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-gray-50",placeholder:"365",readOnly:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CL Bal"}),a.jsx("input",{type:"text",name:"clBal",value:w.clBal,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Closing Balance"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mar'24"}),a.jsx("input",{type:"number",name:"mar24",value:w.mar24,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amt Per Day (Auto-calculated)"}),a.jsx("input",{type:"number",name:"amtPerDay",value:w.amtPerDay,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-gray-50",placeholder:"273.97",step:"0.01",readOnly:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Opening Balance"}),a.jsx("input",{type:"number",name:"openingBalance",value:w.openingBalance,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"0"})]})]}),a.jsxs("div",{className:"mt-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h4",{className:"text-lg font-semibold text-gray-700",children:"Monthly Data Entries"}),a.jsxs("button",{type:"button",onClick:ee,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[a.jsx(yn,{className:"w-4 h-4"}),"Add More Entry"]})]}),a.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:T.map((V,Ae)=>a.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsxs("h5",{className:"text-sm font-medium text-gray-700",children:["Entry ",Ae+1]}),T.length>1&&a.jsx("button",{type:"button",onClick:()=>b(Ae),className:"text-red-600 hover:text-red-800 p-1",children:a.jsx(_r,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Month *"}),a.jsxs("select",{value:V.month,onChange:W=>z(Ae,"month",W.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm",required:!0,children:[a.jsx("option",{value:"",children:"Select Month"}),j.map(W=>a.jsx("option",{value:W.value,children:W.label},W.value))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Year *"}),a.jsxs("select",{value:V.year,onChange:W=>z(Ae,"year",W.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm",required:!0,children:[a.jsx("option",{value:"",children:"Select Year"}),E.map(W=>a.jsx("option",{value:W,children:W},W))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Opening Balance"}),a.jsx("input",{type:"number",value:V.openingBalance,onChange:W=>z(Ae,"openingBalance",W.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm",placeholder:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Addition"}),a.jsx("input",{type:"number",value:V.addition,onChange:W=>z(Ae,"addition",W.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm",placeholder:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Amortization"}),a.jsx("input",{type:"number",value:V.amortization,onChange:W=>z(Ae,"amortization",W.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm",placeholder:"0"})]})]}),(V.openingBalance||V.addition||V.amortization)&&a.jsx("div",{className:"mt-3 p-2 bg-blue-50 border border-blue-200 rounded",children:a.jsxs("span",{className:"text-xs text-blue-800",children:[a.jsx("strong",{children:"Calculated Closing Balance: "}),"",ae(V.openingBalance,V.addition,V.amortization).toLocaleString("en-IN")]})})]},V.id))})]}),a.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:a.jsxs("p",{className:"text-sm text-blue-800 flex items-center gap-2",children:[a.jsx(P3,{className:"w-4 h-4"}),a.jsx("strong",{children:"Auto-calculations:"})," Number of Days = (End Date - Start Date + 1), Amount Per Day = Invoice Amount  Number of Days, Closing Balance = Opening Balance + Addition - Amortization"]})}),a.jsxs("div",{className:"flex justify-end gap-4 pt-6 border-t border-gray-200 mt-6",children:[a.jsx("button",{onClick:()=>{i(!1),l(null),S()},className:"px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"}),a.jsx("button",{onClick:O,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:o?"Update Entry":"Add Entry"})]})]}),a.jsxs("div",{className:"p-6",children:[a.jsx("div",{className:"overflow-auto border border-gray-300 rounded-lg",style:{maxHeight:"600px"},children:a.jsxs("table",{className:"w-full border-collapse bg-white sticky-header",style:{minWidth:"3000px"},children:[a.jsxs("thead",{className:"bg-gray-100 sticky top-0 z-10",children:[a.jsxs("tr",{children:[a.jsx("th",{className:"border border-gray-300 px-2 py-2 text-left text-xs font-medium text-gray-700 uppercase w-16 sticky left-0 bg-gray-100",children:"RP#"}),a.jsx("th",{className:"border border-gray-300 px-2 py-2 text-left text-xs font-medium text-gray-700 uppercase w-16",children:"GL#"}),a.jsx("th",{className:"border border-gray-300 px-2 py-2 text-left text-xs font-medium text-gray-700 uppercase w-20",children:"Month"}),a.jsx("th",{className:"border border-gray-300 px-2 py-2 text-left text-xs font-medium text-gray-700 uppercase w-16",children:"Year"}),a.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase w-32",children:"Vendor"}),a.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase w-32",children:"Remarks"}),a.jsx("th",{className:"border border-gray-300 px-2 py-2 text-left text-xs font-medium text-gray-700 uppercase w-20",children:"NS Doc ID"}),a.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase w-32",children:"Invoice No/Date"}),a.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase w-24",children:"Invoice Amount"}),a.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase w-32",children:"Remarks From To"}),a.jsx("th",{className:"border border-gray-300 px-2 py-2 text-left text-xs font-medium text-gray-700 uppercase w-20",children:"Start Date"}),a.jsx("th",{className:"border border-gray-300 px-2 py-2 text-left text-xs font-medium text-gray-700 uppercase w-20",children:"End Date"}),a.jsx("th",{className:"border border-gray-300 px-2 py-2 text-left text-xs font-medium text-gray-700 uppercase w-16",children:"No of Days"}),a.jsx("th",{className:"border border-gray-300 px-2 py-2 text-left text-xs font-medium text-gray-700 uppercase w-16",children:"CL Bal"}),a.jsx("th",{className:"border border-gray-300 px-2 py-2 text-left text-xs font-medium text-gray-700 uppercase w-16",children:"Mar'24"}),a.jsx("th",{className:"border border-gray-300 px-2 py-2 text-left text-xs font-medium text-gray-700 uppercase w-20",children:"Amt Per Day"}),a.jsx("th",{className:"border border-gray-300 px-2 py-2 text-left text-xs font-medium text-gray-700 uppercase w-20",children:"Opening Balance"}),L.map(V=>a.jsx("th",{className:"border border-gray-300 px-1 py-1 text-center text-xs font-medium text-gray-700 uppercase w-20",colSpan:3,children:M(V)},V)),a.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase w-24 sticky right-0 bg-gray-100",children:"Actions"})]}),a.jsxs("tr",{children:[a.jsx("th",{className:"border border-gray-300 px-2 py-1 text-xs font-medium text-gray-700 sticky left-0 bg-gray-100",children:""}),a.jsx("th",{className:"border border-gray-300 px-2 py-1 text-xs font-medium text-gray-700",children:""}),a.jsx("th",{className:"border border-gray-300 px-2 py-1 text-xs font-medium text-gray-700",children:""}),a.jsx("th",{className:"border border-gray-300 px-2 py-1 text-xs font-medium text-gray-700",children:""}),a.jsx("th",{className:"border border-gray-300 px-2 py-1 text-xs font-medium text-gray-700",children:""}),a.jsx("th",{className:"border border-gray-300 px-2 py-1 text-xs font-medium text-gray-700",children:""}),a.jsx("th",{className:"border border-gray-300 px-2 py-1 text-xs font-medium text-gray-700",children:""}),a.jsx("th",{className:"border border-gray-300 px-2 py-1 text-xs font-medium text-gray-700",children:""}),a.jsx("th",{className:"border border-gray-300 px-2 py-1 text-xs font-medium text-gray-700",children:""}),a.jsx("th",{className:"border border-gray-300 px-2 py-1 text-xs font-medium text-gray-700",children:""}),a.jsx("th",{className:"border border-gray-300 px-2 py-1 text-xs font-medium text-gray-700",children:""}),a.jsx("th",{className:"border border-gray-300 px-2 py-1 text-xs font-medium text-gray-700",children:""}),a.jsx("th",{className:"border border-gray-300 px-2 py-1 text-xs font-medium text-gray-700",children:""}),a.jsx("th",{className:"border border-gray-300 px-2 py-1 text-xs font-medium text-gray-700",children:""}),a.jsx("th",{className:"border border-gray-300 px-2 py-1 text-xs font-medium text-gray-700",children:""}),a.jsx("th",{className:"border border-gray-300 px-2 py-1 text-xs font-medium text-gray-700",children:""}),a.jsx("th",{className:"border border-gray-300 px-2 py-1 text-xs font-medium text-gray-700",children:""}),L.map(V=>a.jsxs(mr.Fragment,{children:[a.jsx("th",{className:"border border-gray-300 px-1 py-1 text-center text-xs font-medium text-gray-600 bg-blue-50 w-16",children:"Opening"}),a.jsx("th",{className:"border border-gray-300 px-1 py-1 text-center text-xs font-medium text-gray-600 bg-green-50 w-16",children:"Addition"}),a.jsx("th",{className:"border border-gray-300 px-1 py-1 text-center text-xs font-medium text-gray-600 bg-red-50 w-16",children:"Amortization"})]},`sub-${V}`)),a.jsx("th",{className:"border border-gray-300 px-2 py-1 text-xs font-medium text-gray-700 sticky right-0 bg-gray-100",children:""})]})]}),a.jsx("tbody",{children:e.map((V,Ae)=>{var W,J,ve;return a.jsxs("tr",{className:`hover:bg-gray-50 ${Ae%2===0?"bg-white":"bg-gray-25"}`,children:[a.jsx("td",{className:"border border-gray-300 px-2 py-2 text-xs sticky left-0 bg-inherit",children:V.rpNumber}),a.jsx("td",{className:"border border-gray-300 px-2 py-2 text-xs",children:V.glNumber}),a.jsx("td",{className:"border border-gray-300 px-2 py-2 text-xs",children:V.month?(W=j.find(de=>de.value===V.month))==null?void 0:W.label:""}),a.jsx("td",{className:"border border-gray-300 px-2 py-2 text-xs",children:V.year}),a.jsx("td",{className:"border border-gray-300 px-3 py-2 text-xs",children:V.vendor}),a.jsx("td",{className:"border border-gray-300 px-3 py-2 text-xs",children:V.remarks}),a.jsx("td",{className:"border border-gray-300 px-2 py-2 text-xs",children:V.nsDocumentId}),a.jsx("td",{className:"border border-gray-300 px-3 py-2 text-xs",children:V.invoiceNoDate}),a.jsx("td",{className:"border border-gray-300 px-3 py-2 text-xs text-right",children:X(V.invoiceAmount)}),a.jsx("td",{className:"border border-gray-300 px-3 py-2 text-xs",children:V.remarksFromMonth&&V.remarksFromYear&&V.remarksToMonth&&V.remarksToYear?`${(J=j.find(de=>de.value===V.remarksFromMonth))==null?void 0:J.label} ${V.remarksFromYear} - ${(ve=j.find(de=>de.value===V.remarksToMonth))==null?void 0:ve.label} ${V.remarksToYear}`:""}),a.jsx("td",{className:"border border-gray-300 px-2 py-2 text-xs",children:V.startDate}),a.jsx("td",{className:"border border-gray-300 px-2 py-2 text-xs",children:V.endDate}),a.jsx("td",{className:"border border-gray-300 px-2 py-2 text-xs text-center",children:V.numberOfDays}),a.jsx("td",{className:"border border-gray-300 px-2 py-2 text-xs",children:V.clBal}),a.jsx("td",{className:"border border-gray-300 px-2 py-2 text-xs text-right",children:X(V.mar24)}),a.jsx("td",{className:"border border-gray-300 px-2 py-2 text-xs text-right",children:X(V.amtPerDay)}),a.jsx("td",{className:"border border-gray-300 px-2 py-2 text-xs text-right",children:X(V.openingBalance)}),L.map(de=>{var je;const te=(je=V.monthlyData)==null?void 0:je[de];return a.jsxs(mr.Fragment,{children:[a.jsx("td",{className:"border border-gray-300 px-1 py-2 text-xs text-right bg-blue-25",children:te!=null&&te.openingBalance?X(te.openingBalance):"-"}),a.jsx("td",{className:"border border-gray-300 px-1 py-2 text-xs text-right bg-green-25",children:te!=null&&te.addition?X(te.addition):"-"}),a.jsx("td",{className:"border border-gray-300 px-1 py-2 text-xs text-right bg-red-25",children:te!=null&&te.amortization?X(te.amortization):"-"})]},`data-${de}`)}),a.jsx("td",{className:"border border-gray-300 px-3 py-2 text-xs sticky right-0 bg-inherit",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>I(V),className:"px-2 py-1 bg-indigo-500 text-white rounded text-xs hover:bg-indigo-600",children:"Edit"}),a.jsx("button",{onClick:()=>U(V),className:"px-2 py-1 bg-red-500 text-white rounded text-xs hover:bg-red-600",children:"Delete"})]})})]},V.id)})})]})}),e.length===0&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx(jr,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500",children:"No prepaid entries available. Add new entries to get started."})]}),e.length>0&&a.jsxs("div",{className:"mt-6 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"Monthly Summary"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(V=>Object.entries(V.monthlyData||{}).map(([Ae,W])=>a.jsxs("div",{className:"bg-white p-3 rounded border",children:[a.jsxs("div",{className:"text-sm font-medium text-gray-800",children:[M(Ae)," - ",V.vendor]}),a.jsxs("div",{className:"mt-2 space-y-1 text-xs",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Opening:"}),a.jsx("span",{children:X(W.openingBalance)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Addition:"}),a.jsx("span",{className:"text-green-600",children:X(W.addition)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Amortization:"}),a.jsx("span",{className:"text-red-600",children:X(W.amortization)})]}),a.jsxs("div",{className:"flex justify-between font-medium border-t pt-1",children:[a.jsx("span",{children:"Closing:"}),a.jsx("span",{children:X(W.closingBalance)})]})]})]},`${V.id}-${Ae}`)))})]})]})]})]})},vwe=()=>{const e=Sr(),{hodEmail:t,reqId:r}=yo();console.log(t,r);const[n,s]=C.useState(()=>({userId:localStorage.getItem("capEmpId"),role:localStorage.getItem("role"),department:localStorage.getItem("department"),email:localStorage.getItem("email")})),[i,o]=C.useState(!1);C.useEffect(()=>{let Ze=!0;return t?(async()=>{var ue,Fe,ke;try{const Te=await vI(t);if(Te.status===200&&Ze){const Ne=(ue=Te==null?void 0:Te.data)==null?void 0:ue.data;localStorage.setItem("userId",Ne==null?void 0:Ne._id),localStorage.setItem("role",Ne==null?void 0:Ne.role),localStorage.setItem("user",JSON.stringify(Ne)),localStorage.setItem("department",Ne==null?void 0:Ne.department),localStorage.setItem("empAccessToken",(Fe=Te==null?void 0:Te.data)==null?void 0:Fe.token),localStorage.setItem("capEmpId",Ne==null?void 0:Ne.employee_id),localStorage.setItem("multiRole",(ke=Te==null?void 0:Te.data)==null?void 0:ke.multiRole),localStorage.setItem("email",t),s({userId:Ne==null?void 0:Ne.employee_id,role:Ne==null?void 0:Ne.role,department:Ne==null?void 0:Ne.department,email:Ne==null?void 0:Ne.email}),o(!0)}}catch(Te){console.error("Error verifying user:",Te),Ie.error("Failed to verify user. Please try again.")}})():n.userId&&o(!0),()=>{Ze=!1}},[t]);const{request:l,currencies:c,reqLogs:A,isLoading:d,isDisabled:u,canApprove:f,formatCurrency:h,refreshRequestData:x,updateRequestStatus:m}=DD(r,i?n.userId:null,i?n.role:null),{isLoading:g,isUploading:p,isGeneratingPDF:v,isAnyActionInProgress:w,approveRequest:B,sendReminderNotification:T,uploadPODocument:_,uploadInvoiceDocument:j,setPDFGenerating:E,getLoadingMessage:L}=PD(i?n.userId:null,i?n.role:null,i?n.email:null,i?n.department:null),[M,F]=C.useState("preview"),[D,G]=C.useState(null),[K,ae]=C.useState(!1),[Z,oe]=C.useState(!1),[Y,R]=C.useState(),[z,ee]=C.useState(),[b,O]=C.useState(""),[S,I]=C.useState(!1),[U,Q]=C.useState({title:"",description:""});C.useState(""),C.useState("");const H=(Ze,xe)=>{Q({title:Ze,description:xe||"No additional information available for this question."}),I(!0)},X=()=>{I(!1)},{generateSectionHTML:V}=OD({request:l,currencies:c}),{handleGeneratePDF:Ae}=AO({request:l,generateSectionHTML:V}),W=async()=>{E(!0);try{await Ae()}finally{E(!1)}},J=Ze=>{R(Ze),ee(Ze==="Approve"?"Approved":Ze),oe(!0)},ve=async()=>{(await B(r,Y,b)).success&&(m(z),oe(!1),setTimeout(()=>{window.location.reload()},1e3)),oe(!1)},de=async()=>{(await T(l._id)).success&&ae(!1)},te=async Ze=>{(await _(r,l.reqid,D,Ze)).success&&e("/approval-request-list")},je=async Ze=>{(await j(r,l.reqid,D,Ze)).success&&e("/req-list-table")},qe=()=>{if(!l)return null;switch(M){case"preview":return a.jsx(uO,{request:l,extractDateAndTime:Ov,formatDateToDDMMYY:so,formatCurrency:h,openInfoModal:H,showFileUrl:Zy});case"chat":return a.jsx(hO,{reqId:r,reqid:l.reqid});case"logs":return a.jsx(pO,{createdAt:l.createdAt,logData:l.approvals,reqLogs:A});default:return null}};if(!i||d)return a.jsx(py,{isVisible:!0,message:"Loading request details..."});if(!l)return a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-lg text-gray-600 mb-4",children:"Request not found"}),a.jsx("button",{onClick:()=>e(-1),className:"px-4 py-2 bg-primary text-white rounded-lg",children:"Go Back"})]})});const He=["Hold","Reject"].includes(Y);return a.jsxs("div",{className:"flex flex-col bg-white min-h-screen",children:[a.jsx(py,{isVisible:w,message:L(),variant:v?"generating":p?"uploading":"processing"}),a.jsx("div",{className:"bg-primary text-white p-4 text-center shadow-md",children:a.jsx("h1",{className:"text-2xl font-bold",children:"Purchase Order Preview"})}),a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[a.jsx("div",{className:"m-8",children:a.jsx(dO,{activeSection:M,setActiveSection:F})}),a.jsxs("div",{className:"flex-1 overflow-y-auto px-4 pb-4",children:[a.jsx("div",{className:"mb-4",children:qe()}),a.jsx(xO,{request:l})]})]}),a.jsx("div",{className:"m-8",children:a.jsx(fO,{request:l,role:n.role,disable:u,isLoading:g,isUploading:p,isGeneratingPDF:v,selectedImage:D,setSelectedImage:G,setShowDialog:ae,handleStatus:J,handleUploadPo:te,handleUploadInvoice:je,handleGeneratePDF:W})}),K&&a.jsx(yO,{setShowDialog:ae,handleNotify:de}),Z&&a.jsx(vO,{approveStatus:Y,needsReason:He,setReason:O,setSubmissionDialog:oe,approveRequest:ve,reason:b,newStatus:z}),S&&a.jsx(gO,{closeModal:X,modalContent:U}),a.jsx(In,{position:"top-right",autoClose:5e3})]})},wwe=()=>{const e=Sr(),[t,r]=C.useState(null),[n,s]=C.useState(null),[i,o]=C.useState(!1),[l,c]=C.useState(!1),[A,d]=C.useState(!0);C.useEffect(()=>{u()},[]);const u=async()=>{var p;d(!0);try{const v=await Eq();console.log(v),v.status===200?s({name:"vendor-policy-document.pdf",url:v.data.policyFile}):s(null)}catch(v){((p=v.response)==null?void 0:p.status)===404?s(null):(console.error("Error fetching file:",v),Ie.error("Error loading existing policy"))}finally{d(!1)}},f=p=>{const v=p.target.files[0];if(v){if(v.type!=="application/pdf"){Ie.error("Please select a PDF file");return}if(v.size>10*1024*1024){Ie.error("File size should be less than 10MB");return}r(v)}},h=async()=>{if(!t){Ie.error("Please select a file first");return}o(!0);try{const p=await JA(t,"vendor-policy");if(console.log(p),p){const v=p.data.fileUrls[0];(await Fq(v)).status===200?(Ie.success("Vendor Policy uploaded successfully!"),r(null),await u()):Ie.error("Failed to save policy URL")}else Ie.error("Failed to upload file to S3")}catch(p){console.error("Upload error:",p),Ie.error("Failed to upload file. Please try again.")}finally{o(!1)}},x=async()=>{if(window.confirm("Are you sure you want to delete this policy document?")){c(!0);try{(await kq()).status===200&&(Ie.success("Vendor Policy deleted successfully!"),s(null))}catch(p){console.error("Delete error:",p),Ie.error("Failed to delete file. Please try again.")}finally{c(!1)}}},m=()=>{n!=null&&n.url&&window.open(n.url,"_blank")},g=()=>{if(n!=null&&n.url){const p=document.createElement("a");p.href=n.url,p.download=n.name,p.target="_blank",document.body.appendChild(p),p.click(),document.body.removeChild(p)}};return a.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("button",{onClick:()=>e("/settings"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(qy,{className:"w-5 h-5 text-gray-600"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Upload Vendor Policy"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your vendor management policy document"})]})]})})}),A?a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-8 mb-6",children:a.jsxs("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),a.jsx("span",{className:"ml-3 text-gray-600",children:"Loading..."})]})}):n?a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Current Policy Document"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx($a,{className:"w-5 h-5 text-green-600"}),a.jsx("span",{className:"text-sm text-green-600",children:"Active"})]})]}),a.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"bg-teal-100 p-3 rounded-lg",children:a.jsx(jr,{className:"w-6 h-6 text-teal-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:n.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Uploaded: ",n.uploadDate]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2 flex-wrap gap-2",children:[a.jsxs("button",{onClick:m,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm",children:[a.jsx(Po,{className:"w-4 h-4"}),a.jsx("span",{children:"View"})]}),a.jsxs("button",{onClick:g,className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm",children:[a.jsx(_n,{className:"w-4 h-4"}),a.jsx("span",{children:"Download"})]}),a.jsxs("button",{onClick:x,disabled:l,className:"flex items-center space-x-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:[a.jsx($r,{className:"w-4 h-4"}),a.jsx("span",{children:l?"Deleting...":"Delete"})]})]})]})})]}):a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:a.jsxs("div",{className:"flex items-center space-x-3 text-amber-600",children:[a.jsx(xA,{className:"w-5 h-5"}),a.jsx("p",{className:"text-sm font-medium",children:"No policy document uploaded yet"})]})}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:n?"Replace Policy Document":"Upload New Policy Document"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-primary transition-colors",children:[a.jsx("input",{type:"file",id:"fileInput",accept:".pdf,application/pdf",onChange:f,className:"hidden"}),a.jsxs("label",{htmlFor:"fileInput",className:"cursor-pointer flex flex-col items-center",children:[a.jsx("div",{className:"bg-primary/10 p-4 rounded-full mb-4",children:a.jsx(Ds,{className:"w-8 h-8 text-primary"})}),a.jsx("p",{className:"text-gray-700 font-medium mb-1",children:"Click to upload or drag and drop"}),a.jsx("p",{className:"text-sm text-gray-500",children:"PDF files only (Max 10MB)"})]})]}),t&&a.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(jr,{className:"w-5 h-5 text-blue-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:t.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:[(t.size/1024/1024).toFixed(2)," MB"]})]})]}),a.jsx("button",{onClick:()=>r(null),className:"text-red-600 hover:text-red-700",children:a.jsx($r,{className:"w-5 h-5"})})]})}),a.jsx("button",{onClick:h,disabled:!t||i,className:"w-full flex items-center justify-center space-x-2 px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:i?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),a.jsx("span",{children:"Uploading..."})]}):a.jsxs(a.Fragment,{children:[a.jsx(Ds,{className:"w-5 h-5"}),a.jsx("span",{children:"Upload Policy Document"})]})})]}),a.jsxs("div",{className:"mt-6 bg-gray-50 rounded-lg p-4",children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Guidelines:"}),a.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[a.jsx("li",{children:" Only PDF files are accepted"}),a.jsx("li",{children:" Maximum file size is 10MB"}),a.jsx("li",{children:" Uploading a new file will replace the existing one"}),a.jsx("li",{children:" Make sure the document is properly formatted and readable"})]})]})]})]}),a.jsx(In,{position:"top-right",autoClose:3e3})]})},bwe=()=>{const e=Sr(),[t,r]=C.useState(null),[n,s]=C.useState(null),[i,o]=C.useState(!1),[l,c]=C.useState(!1),[A,d]=C.useState(!0);C.useEffect(()=>{u()},[]);const u=async()=>{var p;d(!0);try{const v=await _q();console.log(v),v.status===200?s({name:"po-policy-document.pdf",url:v.data.policyFile}):s(null)}catch(v){((p=v.response)==null?void 0:p.status)===404?s(null):(console.error("Error fetching file:",v),Ie.error("Error loading existing policy"))}finally{d(!1)}},f=p=>{const v=p.target.files[0];if(v){if(v.type!=="application/pdf"){Ie.error("Please select a PDF file");return}if(v.size>10*1024*1024){Ie.error("File size should be less than 10MB");return}r(v)}},h=async()=>{if(!t){Ie.error("Please select a file first");return}o(!0);try{const p=await JA(t,"po-policy");if(console.log(p),p){const v=p.data.fileUrls[0];(await Tq(v)).status===200?(Ie.success("PO Policy uploaded successfully!"),r(null),await u()):Ie.error("Failed to save policy URL")}else Ie.error("Failed to upload file to S3")}catch(p){console.error("Upload error:",p),Ie.error("Failed to upload file. Please try again.")}finally{o(!1)}},x=async()=>{if(window.confirm("Are you sure you want to delete this policy document?")){c(!0);try{(await Iq()).status===200&&(Ie.success("PO Policy deleted successfully!"),s(null))}catch(p){console.error("Delete error:",p),Ie.error("Failed to delete file. Please try again.")}finally{c(!1)}}},m=()=>{n!=null&&n.url&&window.open(n.url,"_blank")},g=()=>{if(n!=null&&n.url){const p=document.createElement("a");p.href=n.url,p.download=n.name,p.target="_blank",document.body.appendChild(p),p.click(),document.body.removeChild(p)}};return a.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("button",{onClick:()=>e("/settings"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(qy,{className:"w-5 h-5 text-gray-600"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Upload PO Policy"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your purchase order policy document"})]})]})})}),A?a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-8 mb-6",children:a.jsxs("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),a.jsx("span",{className:"ml-3 text-gray-600",children:"Loading..."})]})}):n?a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Current Policy Document"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx($a,{className:"w-5 h-5 text-green-600"}),a.jsx("span",{className:"text-sm text-green-600",children:"Active"})]})]}),a.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"bg-rose-100 p-3 rounded-lg",children:a.jsx(jr,{className:"w-6 h-6 text-rose-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:n.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Uploaded: ",n.uploadDate]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2 flex-wrap gap-2",children:[a.jsxs("button",{onClick:m,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm",children:[a.jsx(Po,{className:"w-4 h-4"}),a.jsx("span",{children:"View"})]}),a.jsxs("button",{onClick:g,className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm",children:[a.jsx(_n,{className:"w-4 h-4"}),a.jsx("span",{children:"Download"})]}),a.jsxs("button",{onClick:x,disabled:l,className:"flex items-center space-x-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:[a.jsx($r,{className:"w-4 h-4"}),a.jsx("span",{children:l?"Deleting...":"Delete"})]})]})]})})]}):a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:a.jsxs("div",{className:"flex items-center space-x-3 text-amber-600",children:[a.jsx(xA,{className:"w-5 h-5"}),a.jsx("p",{className:"text-sm font-medium",children:"No policy document uploaded yet"})]})}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:n?"Replace Policy Document":"Upload New Policy Document"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-primary transition-colors",children:[a.jsx("input",{type:"file",id:"fileInput",accept:".pdf,application/pdf",onChange:f,className:"hidden"}),a.jsxs("label",{htmlFor:"fileInput",className:"cursor-pointer flex flex-col items-center",children:[a.jsx("div",{className:"bg-primary/10 p-4 rounded-full mb-4",children:a.jsx(Ds,{className:"w-8 h-8 text-primary"})}),a.jsx("p",{className:"text-gray-700 font-medium mb-1",children:"Click to upload or drag and drop"}),a.jsx("p",{className:"text-sm text-gray-500",children:"PDF files only (Max 10MB)"})]})]}),t&&a.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(jr,{className:"w-5 h-5 text-blue-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:t.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:[(t.size/1024/1024).toFixed(2)," MB"]})]})]}),a.jsx("button",{onClick:()=>r(null),className:"text-red-600 hover:text-red-700",children:a.jsx($r,{className:"w-5 h-5"})})]})}),a.jsx("button",{onClick:h,disabled:!t||i,className:"w-full flex items-center justify-center space-x-2 px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:i?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),a.jsx("span",{children:"Uploading..."})]}):a.jsxs(a.Fragment,{children:[a.jsx(Ds,{className:"w-5 h-5"}),a.jsx("span",{children:"Upload Policy Document"})]})})]}),a.jsxs("div",{className:"mt-6 bg-gray-50 rounded-lg p-4",children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Guidelines:"}),a.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[a.jsx("li",{children:" Only PDF files are accepted"}),a.jsx("li",{children:" Maximum file size is 10MB"}),a.jsx("li",{children:" Uploading a new file will replace the existing one"}),a.jsx("li",{children:" Make sure the document is properly formatted and readable"})]})]})]})]}),a.jsx(In,{position:"top-right",autoClose:3e3})]})},Nwe=ri({vendorId:St().nullable(),entity:St().required("Entity is required"),category:St().required("Category is required"),vendorName:St().required("Company Name is required"),email:St().email("Invalid email format").required("Email is required"),phone:St().required("Phone Number is required"),billingAddress:St().required("Address is required"),taxNumber:St().required("PAN/TAX Registration is required"),gstin:St().nullable(),msme:St().nullable(),bankAccountNumber:St().required("Bank Account Number is required"),ifscSwiftCode:St().required("IFSC/SWIFT CODE is required"),bankName:St().required("Bank Name is required"),hasAgreement:St().required("Agreement/EL selection is required"),natureOfService:St().required("Nature of Service is required"),agreementFile:fl().when("hasAgreement",{is:"yes",then:e=>e.required("Agreement file is required"),otherwise:e=>e.nullable()}),questionnaireData:ri().when("hasAgreement",([e],t)=>e==="no"?t.shape({counterpartyRequired:St().required("Please select an option"),agreementType:St().required("Please select an option"),serviceType:St().required("Please select an option"),paymentType:St().required("Please select an option")}):t.nullable()),panTaxFile:fl().required("PAN/TAX Registration file is required"),gstFile:fl().nullable(),msmeFile:fl().nullable(),bankProofFile:fl().required("Bank account proof is required")}),Cwe=()=>{var m,g,p,v,w,B,T,_;const e=Sr(),t=localStorage.getItem("capEmpId"),[r,n]=C.useState(!1),[s,i]=C.useState(!1),[o,l]=C.useState(!1),[c,A]=C.useState([]),[d,u]=C.useState(!0),f=up({initialValues:{vendorId:"",entity:"",category:"",vendorName:"",email:"",phone:"",billingAddress:"",shippingAddress:"",taxNumber:"",gstin:"",msme:"",bankAccountNumber:"",ifscSwiftCode:"",bankName:"",hasAgreement:"",agreementFile:null,agreementFileUrl:"",agreementFileName:"",questionnaireData:{counterpartyRequired:"",agreementType:"",serviceType:"",paymentType:""},natureOfService:"",empId:t,panTaxFile:null,panTaxFileUrl:"",panTaxFileName:"",gstFile:null,gstFileUrl:"",gstFileName:"",msmeFile:null,msmeFileUrl:"",msmeFileName:"",bankProofFile:null,bankProofFileUrl:"",bankProofFileName:""},validationSchema:Nwe,onSubmit:async j=>{var E,L;try{n(!0);let M="",F="",D="",G="",K="",ae="",Z="",oe="",Y="",R="";Ie.info("Uploading files to S3...");try{if(j.hasAgreement==="yes"&&j.agreementFile){const b=await JA(j.agreementFile,"agreement");b.status===200&&b.data.fileUrls&&(M=b.data.fileUrls[0],F=j.agreementFile.name)}if(j.panTaxFile){const b=await JA(j.panTaxFile,"pan_tax");b.status===200&&b.data.fileUrls&&(D=b.data.fileUrls[0],G=j.panTaxFile.name)}if(j.gstFile){const b=await JA(j.gstFile,"gst");b.status===200&&b.data.fileUrls&&(K=b.data.fileUrls[0],ae=j.gstFile.name)}if(j.msmeFile){const b=await JA(j.msmeFile,"msme");b.status===200&&b.data.fileUrls&&(Z=b.data.fileUrls[0],oe=j.msmeFile.name)}if(j.bankProofFile){const b=await JA(j.bankProofFile,"bank_proof");b.status===200&&b.data.fileUrls&&(Y=b.data.fileUrls[0],R=j.bankProofFile.name)}Ie.success("Files uploaded successfully!")}catch(b){console.error("File upload failed:",b),Ie.error("Failed to upload files. Please try again."),n(!1);return}const z={vendorId:j.vendorId,entity:j.entity,category:j.category,vendorName:j.vendorName,email:j.email,phone:j.phone,billingAddress:j.billingAddress,shippingAddress:j.shippingAddress,taxNumber:j.taxNumber,gstin:j.gstin,msme:j.msme,bankAccountNumber:j.bankAccountNumber,ifscSwiftCode:j.ifscSwiftCode,bankName:j.bankName,hasAgreement:j.hasAgreement,agreementFileUrl:M,agreementFileName:F,natureOfService:j.natureOfService,empId:j.empId,panTaxFileUrl:D,panTaxFileName:G,gstFileUrl:K,gstFileName:ae,msmeFileUrl:Z,msmeFileName:oe,bankProofFileUrl:Y,bankProofFileName:R,...j.hasAgreement==="no"&&{questionnaireData:j.questionnaireData,isDeviation:!0}};console.log("Submitting vendor data:",z);const ee=await CI(z);ee.status===201&&(Ie.success(ee.data.message||"Vendor registered successfully!"),setTimeout(()=>{e("/vendor/my-added-vendors")},1500))}catch(M){console.error("Registration failed:",M),Ie.error(((L=(E=M.response)==null?void 0:E.data)==null?void 0:L.message)||"Registration failed. Please try again.")}finally{n(!1)}}});C.useEffect(()=>{const j=L=>L?L.toLowerCase().split(" ").map(M=>M.charAt(0).toUpperCase()+M.slice(1)).join(" "):"";(async()=>{try{const M=((await Zf(t)).data.entities||[]).map(F=>({...F,displayName:j(F.entityName),originalName:F.entityName})).sort((F,D)=>F.displayName.localeCompare(D.displayName));A(M),u(!1)}catch(L){console.error("Failed to fetch entities:",L),u(!1)}})()},[t]);const h=j=>{const E=j.target.files[0];if(E){if(E.size>10485760){Ie.error("File size should not exceed 10MB"),j.target.value="";return}if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(E.type)){Ie.error("Only PDF, DOC, and DOCX files are allowed"),j.target.value="";return}f.setFieldValue("agreementFile",E)}},x=(j,E)=>{const L=j.target.files[0];if(L){if(L.size>10485760){Ie.error("File size should not exceed 10MB"),j.target.value="";return}if(!["application/pdf","image/jpeg","image/jpg","image/png","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(L.type)){Ie.error("Only PDF, DOC, DOCX, JPG, JPEG, and PNG files are allowed"),j.target.value="";return}f.setFieldValue(E,L)}};return a.jsxs("form",{onSubmit:f.handleSubmit,className:"max-w-6xl bg-white mx-auto p-6 space-y-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Vendor Registration"}),a.jsx("div",{className:"p-4 border rounded-lg border-primary",children:a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:o,onChange:()=>l(!o),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Add Vendor ID (Optional)"}),a.jsxs("div",{className:"ml-2 relative",onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),children:[a.jsx(Fi,{className:"h-4 w-4 text-gray-400 cursor-help"}),s&&a.jsx("div",{className:"absolute z-10 left-0 mt-2 w-64 p-2 bg-gray-800 text-white text-xs rounded shadow-lg",children:"Toggle to add a Vendor ID if available. This field is optional. Please enter the Vendor ID as per NetSuite records."})]})]}),o&&a.jsxs("div",{className:"mt-2",children:[a.jsx("input",{type:"text",name:"vendorId",value:f.values.vendorId,onChange:f.handleChange,onBlur:f.handleBlur,className:`mt-1 block w-full px-3 py-2 border ${f.touched.vendorId&&f.errors.vendorId?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm`,placeholder:"Enter Vendor ID as per NetSuite"}),f.touched.vendorId&&f.errors.vendorId&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:f.errors.vendorId})]})]})}),a.jsxs("div",{className:"p-4 border rounded-lg border-primary",children:[a.jsx("h3",{className:"text-lg font-semibold text-primary mb-4",children:"Basic Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"entity",className:"block mb-2 font-medium",children:["Entity ",a.jsx("span",{className:"text-red-500",children:"*"})]}),d?a.jsx("select",{className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary text-gray-500",disabled:!0,children:a.jsx("option",{children:"Loading entities..."})}):a.jsxs("select",{name:"entity",value:f.values.entity,onChange:f.handleChange,onBlur:f.handleBlur,className:`w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary ${f.touched.entity&&f.errors.entity?"border-red-500":"border-gray-300"}`,children:[a.jsx("option",{value:"",children:"Select an entity"}),c.map(j=>a.jsx("option",{value:j.originalName,children:j.displayName},j._id||j.entityId))]}),f.touched.entity&&f.errors.entity&&a.jsx("span",{className:"text-red-500 text-sm",children:f.errors.entity})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"category",className:"block mb-2 font-medium",children:["Category ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"category",placeholder:"Enter Category",value:f.values.category,onChange:f.handleChange,onBlur:f.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),f.touched.category&&f.errors.category&&a.jsx("span",{className:"text-red-500 text-sm",children:f.errors.category})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"vendorName",className:"block mb-2 font-medium",children:["Company Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"vendorName",placeholder:"Enter Company Name",value:f.values.vendorName,onChange:f.handleChange,onBlur:f.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),f.touched.vendorName&&f.errors.vendorName&&a.jsx("span",{className:"text-red-500 text-sm",children:f.errors.vendorName})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"email",className:"block mb-2 font-medium",children:["Email-ID ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"email",name:"email",placeholder:"Enter Email",value:f.values.email,onChange:f.handleChange,onBlur:f.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),f.touched.email&&f.errors.email&&a.jsx("span",{className:"text-red-500 text-sm",children:f.errors.email})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"phone",className:"block mb-2 font-medium",children:["Phone Number ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"tel",name:"phone",placeholder:"Enter Phone Number",value:f.values.phone,onChange:f.handleChange,onBlur:f.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),f.touched.phone&&f.errors.phone&&a.jsx("span",{className:"text-red-500 text-sm",children:f.errors.phone})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"natureOfService",className:"block mb-2 font-medium",children:["Nature of Service ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"natureOfService",placeholder:"Enter Nature of Service",value:f.values.natureOfService,onChange:f.handleChange,onBlur:f.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),f.touched.natureOfService&&f.errors.natureOfService&&a.jsx("span",{className:"text-red-500 text-sm",children:f.errors.natureOfService})]})]})]}),a.jsxs("div",{className:"p-4 border rounded-lg border-primary",children:[a.jsx("h3",{className:"text-lg font-semibold text-primary mb-4",children:"Address Details"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"billingAddress",className:"block mb-2 font-medium",children:["Address ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{name:"billingAddress",placeholder:"Enter Address",value:f.values.billingAddress,onChange:f.handleChange,onBlur:f.handleBlur,rows:"3",className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),f.touched.billingAddress&&f.errors.billingAddress&&a.jsx("span",{className:"text-red-500 text-sm",children:f.errors.billingAddress})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"shippingAddress",className:"block mb-2 font-medium",children:"Shipping Address"}),a.jsx("textarea",{name:"shippingAddress",placeholder:"Enter Shipping Address",value:f.values.shippingAddress,onChange:f.handleChange,rows:"3",className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"})]})]})]}),a.jsxs("div",{className:"p-4 border rounded-lg border-primary",children:[a.jsx("h3",{className:"text-lg font-semibold text-primary mb-4",children:"Tax & Registration Details"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["PAN/TAX Registration ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"taxNumber",placeholder:"Enter PAN/TAX Registration",value:f.values.taxNumber,onChange:f.handleChange,onBlur:f.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),f.touched.taxNumber&&f.errors.taxNumber&&a.jsx("span",{className:"text-red-500 text-sm",children:f.errors.taxNumber})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"GST"}),a.jsx("input",{type:"text",name:"gstin",placeholder:"Enter GST Number",value:f.values.gstin,onChange:f.handleChange,onBlur:f.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),f.touched.gstin&&f.errors.gstin&&a.jsx("span",{className:"text-red-500 text-sm",children:f.errors.gstin})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"MSME"}),a.jsx("input",{type:"text",name:"msme",placeholder:"Enter MSME Number",value:f.values.msme,onChange:f.handleChange,onBlur:f.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),f.touched.msme&&f.errors.msme&&a.jsx("span",{className:"text-red-500 text-sm",children:f.errors.msme})]})]})]}),a.jsxs("div",{className:"p-4 border rounded-lg border-primary",children:[a.jsx("h3",{className:"text-lg font-semibold text-primary mb-4",children:"Document Uploads"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["PAN/TAX Registration File/W9 ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"file",name:"panTaxFile",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:j=>x(j,"panTaxFile"),onBlur:f.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),f.values.panTaxFile&&a.jsxs("p",{className:"text-sm text-green-600 mt-1",children:[" Selected: ",f.values.panTaxFile.name]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Supported formats: PDF, DOC, DOCX, JPG, PNG (Max: 10MB)"}),f.touched.panTaxFile&&f.errors.panTaxFile&&a.jsx("span",{className:"text-red-500 text-sm",children:f.errors.panTaxFile})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"gstFile",className:"block mb-2 font-medium",children:"Upload GST file"}),a.jsx("input",{type:"file",name:"gstFile",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:j=>x(j,"gstFile"),onBlur:f.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),f.values.gstFile&&a.jsxs("p",{className:"text-sm text-green-600 mt-1",children:[" Selected: ",f.values.gstFile.name]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Supported formats: PDF, DOC, DOCX, JPG, PNG (Max: 10MB)"}),f.touched.gstFile&&f.errors.gstFile&&a.jsx("span",{className:"text-red-500 text-sm",children:f.errors.gstFile})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"msmeFile",className:"block mb-2 font-medium",children:"Upload MSME file"}),a.jsx("input",{type:"file",name:"msmeFile",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:j=>x(j,"msmeFile"),onBlur:f.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),f.values.msmeFile&&a.jsxs("p",{className:"text-sm text-green-600 mt-1",children:[" Selected: ",f.values.msmeFile.name]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Supported formats: PDF, DOC, DOCX, JPG, PNG (Max: 10MB)"}),f.touched.msmeFile&&f.errors.msmeFile&&a.jsx("span",{className:"text-red-500 text-sm",children:f.errors.msmeFile})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"bankProofFile",className:"block mb-2 font-medium",children:["Upload bank account proof ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"file",name:"bankProofFile",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:j=>x(j,"bankProofFile"),onBlur:f.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),f.values.bankProofFile&&a.jsxs("p",{className:"text-sm text-green-600 mt-1",children:[" Selected: ",f.values.bankProofFile.name]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Supported formats: PDF, DOC, DOCX, JPG, PNG (Max: 10MB)"}),f.touched.bankProofFile&&f.errors.bankProofFile&&a.jsx("span",{className:"text-red-500 text-sm",children:f.errors.bankProofFile})]})]})]}),a.jsxs("div",{className:"p-4 border rounded-lg border-primary",children:[a.jsx("h3",{className:"text-lg font-semibold text-primary mb-4",children:"Bank Details"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"bankAccountNumber",className:"block mb-2 font-medium",children:["Bank Account Number ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"bankAccountNumber",placeholder:"Enter Bank Account Number",value:f.values.bankAccountNumber,onChange:f.handleChange,onBlur:f.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),f.touched.bankAccountNumber&&f.errors.bankAccountNumber&&a.jsx("span",{className:"text-red-500 text-sm",children:f.errors.bankAccountNumber})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"ifscSwiftCode",className:"block mb-2 font-medium",children:["IFSC/SWIFT CODE ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"ifscSwiftCode",placeholder:"Enter IFSC/SWIFT CODE",value:f.values.ifscSwiftCode,onChange:f.handleChange,onBlur:f.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),f.touched.ifscSwiftCode&&f.errors.ifscSwiftCode&&a.jsx("span",{className:"text-red-500 text-sm",children:f.errors.ifscSwiftCode})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"bankName",className:"block mb-2 font-medium",children:["Bank Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"bankName",placeholder:"Enter Bank Name",value:f.values.bankName,onChange:f.handleChange,onBlur:f.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),f.touched.bankName&&f.errors.bankName&&a.jsx("span",{className:"text-red-500 text-sm",children:f.errors.bankName})]})]})]}),a.jsxs("div",{className:"p-4 border rounded-lg border-primary",children:[a.jsx("h3",{className:"text-lg font-semibold text-primary mb-4",children:"Agreement/EL"}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("label",{className:"block mb-2 font-medium",children:["Do you have an Agreement/EL? ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"flex gap-6",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"hasAgreement",value:"yes",checked:f.values.hasAgreement==="yes",onChange:f.handleChange,onBlur:f.handleBlur,className:"mr-2"}),"Yes"]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"hasAgreement",value:"no",checked:f.values.hasAgreement==="no",onChange:f.handleChange,onBlur:f.handleBlur,className:"mr-2"}),"No"]})]}),f.touched.hasAgreement&&f.errors.hasAgreement&&a.jsx("span",{className:"text-red-500 text-sm",children:f.errors.hasAgreement})]}),f.values.hasAgreement==="yes"&&a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"agreementFile",className:"block mb-2 font-medium",children:["Upload Agreement File ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"file",name:"agreementFile",accept:".pdf,.doc,.docx",onChange:h,onBlur:f.handleBlur,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"}),f.values.agreementFile&&a.jsxs("p",{className:"text-sm text-green-600 mt-1",children:[" Selected: ",f.values.agreementFile.name]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Supported formats: PDF, DOC, DOCX (Max size: 10MB)"}),f.touched.agreementFile&&f.errors.agreementFile&&a.jsx("span",{className:"text-red-500 text-sm",children:f.errors.agreementFile})]}),f.values.hasAgreement==="no"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("p",{className:"block mb-2 font-medium",children:["1. Is the agreement required by the counterparty? ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:"flex gap-6",children:["Yes","No"].map(j=>{var E;return a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"questionnaireData.counterpartyRequired",value:j,checked:((E=f.values.questionnaireData)==null?void 0:E.counterpartyRequired)===j,onChange:()=>{f.setFieldValue("questionnaireData.counterpartyRequired",j),f.setFieldTouched("questionnaireData.counterpartyRequired",!0,!1)},onBlur:f.handleBlur,className:"mr-2"}),j]},j)})}),((m=f.touched.questionnaireData)==null?void 0:m.counterpartyRequired)&&((g=f.errors.questionnaireData)==null?void 0:g.counterpartyRequired)&&a.jsx("span",{className:"text-red-500 text-sm",children:f.errors.questionnaireData.counterpartyRequired})]}),a.jsxs("div",{children:[a.jsxs("p",{className:"block mb-2 font-medium",children:["2. Does the agreement have an auto-renewal clause or a fixed tenure? ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:"flex gap-6",children:["Auto-renewal","Fixed tenure"].map(j=>{var E;return a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"questionnaireData.agreementType",value:j,checked:((E=f.values.questionnaireData)==null?void 0:E.agreementType)===j,onChange:()=>{f.setFieldValue("questionnaireData.agreementType",j),f.setFieldTouched("questionnaireData.agreementType",!0,!1)},onBlur:f.handleBlur,className:"mr-2"}),j]},j)})}),((p=f.touched.questionnaireData)==null?void 0:p.agreementType)&&((v=f.errors.questionnaireData)==null?void 0:v.agreementType)&&a.jsx("span",{className:"text-red-500 text-sm",children:f.errors.questionnaireData.agreementType})]}),a.jsxs("div",{children:[a.jsxs("p",{className:"block mb-2 font-medium",children:["3. Is this a one-time or recurring service? ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:"flex gap-6",children:["One-time","Recurring"].map(j=>{var E;return a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"questionnaireData.serviceType",value:j,checked:((E=f.values.questionnaireData)==null?void 0:E.serviceType)===j,onChange:()=>{f.setFieldValue("questionnaireData.serviceType",j),f.setFieldTouched("questionnaireData.serviceType",!0,!1)},onBlur:f.handleBlur,className:"mr-2"}),j]},j)})}),((w=f.touched.questionnaireData)==null?void 0:w.serviceType)&&((B=f.errors.questionnaireData)==null?void 0:B.serviceType)&&a.jsx("span",{className:"text-red-500 text-sm",children:f.errors.questionnaireData.serviceType})]}),a.jsxs("div",{children:[a.jsxs("p",{className:"block mb-2 font-medium",children:["4. Is the payment a one-time transaction or a recurring payment? ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:"flex gap-6",children:["One-time","Recurring"].map(j=>{var E;return a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"questionnaireData.paymentType",value:j,checked:((E=f.values.questionnaireData)==null?void 0:E.paymentType)===j,onChange:()=>{f.setFieldValue("questionnaireData.paymentType",j),f.setFieldTouched("questionnaireData.paymentType",!0,!1)},onBlur:f.handleBlur,className:"mr-2"}),j]},j)})}),((T=f.touched.questionnaireData)==null?void 0:T.paymentType)&&((_=f.errors.questionnaireData)==null?void 0:_.paymentType)&&a.jsx("span",{className:"text-red-500 text-sm",children:f.errors.questionnaireData.paymentType})]})]})]}),a.jsx("div",{className:"p-4 text-end",children:a.jsx("button",{type:"submit",className:"px-6 py-2 bg-primary text-white rounded hover:bg-primary-dark disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",disabled:f.isSubmitting||!f.isValid||r,children:r?"Uploading File...":f.isSubmitting?"Registering...":"Register Vendor"})}),a.jsx(In,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,pauseOnFocusLoss:!0})]})},jwe=()=>{const e=localStorage.getItem("capEmpId"),t=localStorage.getItem("role"),r=Sr(),[n,s]=C.useState([]),[i,o]=C.useState(""),[l,c]=C.useState("all"),[A,d]=C.useState(!1),[u,f]=C.useState(!1),[h,x]=C.useState(""),[m,g]=C.useState(null),[p,v]=C.useState(null),[w,B]=C.useState(!1),[T,_]=C.useState([]),[j,E]=C.useState(null),L=C.useRef(null),M=C.useRef(null),F=10,[D,G]=C.useState(!0);C.useEffect(()=>{(async()=>{G(!0);try{const ve=await A$();console.log("Vendor data:",ve),s(ve.data.vendorDeviationData||[]),ve.data.vendorPolicyFiles&&ve.data.vendorPolicyFiles.length>0&&E(ve.data.vendorPolicyFiles[0])}catch(ve){Ie.error("Error fetching vendor data"),console.error("Error in fetching the vendor data",ve)}finally{G(!1)}})()},[]),C.useEffect(()=>{A&&M.current&&setTimeout(()=>{M.current.focus()},100)},[A]);const K=C.useMemo(()=>n.filter(J=>{var te,je,qe;const ve=((te=J==null?void 0:J.vendorName)==null?void 0:te.toLowerCase().includes(i.toLowerCase()))||((je=J==null?void 0:J.vendorId)==null?void 0:je.toLowerCase().includes(i.toLowerCase()))||((qe=J==null?void 0:J.category)==null?void 0:qe.toLowerCase().includes(i.toLowerCase())),de=l==="all"||(J==null?void 0:J.status)===l;return ve&&de}),[n,i,l]),[ae,Z]=C.useState(1),oe=Math.ceil(K.length/F),Y=(ae-1)*F,R=Y+F,z=K.slice(Y,R),ee=J=>{Z(J)},b=J=>{r(`/vendor-list-table/get-vendor/${J}`)},O=async J=>{try{const ve=await rC(J);ve.status===200?(s(n.filter(de=>de._id!==J)),Ie.success(ve.data.message)):Ie.error(ve.data.message)}catch{Ie.error("Error deleting vendor")}},S=async()=>{try{(await bI(m,e,"Approved by Legal Team")).status===200?(s(n.map(ve=>ve._id===m?{...ve,isLegalTeamVerified:!0}:ve)),Ie.success("Legal team verification completed successfully"),U()):Ie.error("Failed to complete verification")}catch{Ie.error("Error completing verification")}},I=async()=>{if(!h.trim()){Ie.error("Please provide a reason for rejection");return}try{const J=await NI(m,e,h);J.status===200?(s(n.map(ve=>ve._id===m?{...ve,isLegalTeamVerified:!1}:ve)),Ie.success(J.data.message),Q()):Ie.error("Failed to complete rejection")}catch{Ie.error("Error completing rejection")}},U=()=>{f(!1),g(null)},Q=()=>{d(!1),g(null),x("")},H=()=>{const J=[{ID:"V001",Name:"Sample Vendor Ltd",Entity:"Private Limited",Category:"Supplier",Email:"vendor@example.com",Phone:"9876543210","Billing Address":"123 Main Street, City, State - 123456","Shipping Address":"456 Warehouse Road, City, State - 123456","Tax Number":"PAN123456",GSTIN:"GST123456",MSME:"MSME123456","Bank Account Number":"1234567890","IFSC/SWIFT Code":"IFSC001","Bank Name":"Sample Bank","Has Agreement":"yes","Nature of Service":"Software Development"}],ve=as.json_to_sheet(J),de=as.book_new();as.book_append_sheet(de,ve,"Vendors"),s0(de,"vendor_template.xlsx")},X=async()=>{if(T.length===0){Ie.error("No vendors to upload");return}try{const J=await nC(T);if(J.status===201){Ie.success("Vendors uploaded successfully");const ve=await eC();s(ve.data.data||[]),_([]),B(!1)}else Ie.error(J.data.message||"Failed to upload vendors")}catch(J){console.error("Upload Error:",J),Ie.error("Error uploading vendors")}},V=async J=>{const ve=J.target.files[0];if(ve){const de=new FileReader;de.onload=async te=>{try{const je=Fm(te.target.result,{type:"array"}),qe=je.SheetNames[0],He=je.Sheets[qe],Ze=as.sheet_to_json(He);console.log("Imported data:",Ze),_(Ze),Ie.info('File imported. Click "Upload File" to proceed.'),L.current&&(L.current.value="")}catch(je){console.error("Complete Import Error:",je),Ie.error(`Error importing file: ${je.message}`)}},de.readAsArrayBuffer(ve)}},Ae=()=>w?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg p-4 sm:p-6 w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Import Vendors"}),a.jsx("button",{onClick:()=>B(!1),className:"text-gray-500 hover:text-gray-700","aria-label":"Close modal",children:a.jsx(_r,{className:"h-5 w-5"})})]}),a.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsxs("h4",{className:"font-semibold text-blue-900 mb-3 flex items-center",children:[a.jsx(K4,{className:"h-5 w-5 mr-2"}),"Required Excel Format"]}),a.jsxs("div",{className:"text-sm text-blue-800 space-y-2",children:[a.jsx("p",{className:"font-medium",children:"Your Excel file must include these columns:"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 text-xs",children:[a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"ID"})," - Vendor ID"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Name"})," - Company Name"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Entity"})," - Entity Type"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Category"})," - Vendor Category"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Email"})," - Email Address"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Phone"})," - Phone Number"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Billing Address"})," - Address"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Tax Number"})," - PAN/Tax/W9"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"GSTIN"})," - GST Number"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"MSME"})," - MSME Number"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsx("span",{children:a.jsx("strong",{children:"Bank Account Number"})})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsx("span",{children:a.jsx("strong",{children:"IFSC/SWIFT Code"})})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsx("span",{children:a.jsx("strong",{children:"Bank Name"})})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Has Agreement"})," (yes/no)"]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"mr-2",children:""}),a.jsx("span",{children:a.jsx("strong",{children:"Nature of Service"})})]})]}),a.jsx("div",{className:"mt-3 pt-3 border-t border-blue-300",children:a.jsxs("p",{className:"text-xs text-blue-700",children:[a.jsx("strong",{children:"Note:"}),' Agreement files must be uploaded separately after vendor creation. If "Has Agreement" is "no", fill the "Questionnaire Answer" column.']})})]})]}),a.jsx("div",{className:"mb-4",children:a.jsxs("button",{onClick:H,className:"w-full flex items-center justify-center px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium",children:[a.jsx(_n,{className:"h-5 w-5 mr-2"}),"Download Sample Template"]})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:[a.jsx("label",{htmlFor:"file-upload",className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload Your Excel File"}),a.jsx("input",{id:"file-upload",type:"file",ref:L,onChange:V,accept:".xlsx,.xls,.csv",className:"w-full text-sm file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-primary file:text-white hover:file:bg-primary/90"}),a.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Supported formats: .xlsx, .xls, .csv"}),T.length>0&&a.jsx("div",{className:"mt-3 p-2 bg-green-50 border border-green-200 rounded",children:a.jsxs("p",{className:"text-sm text-green-700 font-medium",children:[" ",T.length," vendor",T.length>1?"s":""," ready to upload"]})})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-end space-y-2 sm:space-y-0 sm:space-x-3",children:[a.jsx("button",{onClick:()=>{B(!1),_([])},className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 order-2 sm:order-1",children:"Cancel"}),a.jsx("button",{onClick:X,disabled:T.length===0,className:`w-full sm:w-auto px-4 py-2 text-sm font-medium text-white rounded-lg order-1 sm:order-2 transition-colors
                                    ${T.length>0?"bg-primary hover:bg-primary/90":"bg-gray-400 cursor-not-allowed"}`,children:"Upload File"})]})]})]})}):null,W=()=>u?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Approve Vendor"}),a.jsx("button",{onClick:U,className:"text-gray-500 hover:text-gray-700","aria-label":"Close modal",children:a.jsx(_r,{className:"h-5 w-5"})})]}),a.jsx("div",{className:"mb-6",children:a.jsx("p",{className:"text-gray-600",children:"Are you sure you want to approve this vendor? This action will confirm the vendor's registration and they will be added to the approved vendor list."})}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{onClick:U,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),a.jsx("button",{onClick:S,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-lg",children:"Approve"})]})]})}):null;return a.jsxs("div",{className:"p-4 md:p-8 bg-white rounded-lg shadow-sm h-full",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-xl md:text-2xl font-bold text-gray-900 mb-4 md:mb-6",children:"Vendor Information"}),a.jsxs("div",{className:"md:hidden space-y-3",children:[a.jsxs("div",{className:"relative w-full",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none",children:a.jsx(rn,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{type:"text",placeholder:"Search vendors...",value:i,onChange:J=>{o(J.target.value),Z(1)},className:"w-full pl-11 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:a.jsxs("select",{value:l,onChange:J=>{c(J.target.value),Z(1)},className:"px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"active",children:"Active"}),a.jsx("option",{value:"inactive",children:"Inactive"})]})})]}),a.jsx("div",{className:"hidden md:block",children:a.jsxs("div",{className:"flex flex-wrap md:flex-nowrap gap-3 mb-4",children:[a.jsxs("div",{className:"relative flex-grow",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none",children:a.jsx(rn,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{type:"text",placeholder:"Search vendors...",value:i,onChange:J=>{o(J.target.value),Z(1)},className:"w-full pl-11 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),a.jsxs("select",{value:l,onChange:J=>{c(J.target.value),Z(1)},className:"px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"active",children:"Active"}),a.jsx("option",{value:"inactive",children:"Inactive"})]}),j&&a.jsxs("a",{href:j.policyFile,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center px-4 py-2.5 border border-blue-300 rounded-lg text-sm font-medium text-blue-700 bg-blue-50 hover:bg-blue-100",children:[a.jsx(jr,{className:"h-4 w-4 mr-2"}),"View Vendor Policy"]})]})})]}),D?a.jsx("div",{className:"flex justify-center items-center py-10",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary"})}):(K==null?void 0:K.length)===0?a.jsxs("div",{className:"text-center py-10 text-gray-500",children:[a.jsx("p",{className:"text-lg font-medium",children:"No vendors found"}),a.jsx("p",{className:"text-sm mt-2",children:"Try adjusting your search or filters"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"md:hidden space-y-3 mb-4",children:z==null?void 0:z.map((J,ve)=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-white hover:bg-gray-50",children:[a.jsx("div",{className:"flex justify-between items-start mb-2",children:a.jsxs("div",{children:[a.jsx("span",{className:"text-xs text-gray-500",children:(J==null?void 0:J.vendorId)||J.ID}),a.jsx("h3",{className:"font-semibold text-gray-900",children:(J==null?void 0:J.vendorName)||J.Name})]})}),a.jsx("div",{className:"text-xs text-gray-900 mb-1",children:(J==null?void 0:J.category)||J.Category}),a.jsxs("div",{className:"text-xs text-gray-500 mb-1",children:["Email: ",J==null?void 0:J.email]}),a.jsxs("div",{className:"text-xs text-gray-500 mb-1",children:["Phone: ",J==null?void 0:J.phone]}),p===J._id&&a.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 text-xs text-gray-500",children:[a.jsxs("div",{className:"mb-1",children:[a.jsx("span",{className:"font-medium",children:"Address:"})," ",(J==null?void 0:J.billingAddress)||J["Billing Address"]]}),a.jsxs("div",{className:"mb-1",children:[a.jsx("span",{className:"font-medium",children:"Status:"})," ",(J==null?void 0:J.status)||"Active"]})]}),a.jsx("button",{className:"w-full mt-3 text-sm text-primary hover:text-primary/80 text-center",onClick:()=>r(`/vendor-list-table/get-vendor/${J._id}`),children:"View Details"})]},J._id))}),a.jsx("div",{className:"hidden md:block border border-gray-200 rounded-lg overflow-hidden mb-4",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-primary",children:a.jsxs("tr",{children:[a.jsx("th",{className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Sno"}),a.jsx("th",{className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Vendor"}),a.jsx("th",{className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Category"}),a.jsx("th",{className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Email"}),a.jsx("th",{className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Phone"}),a.jsx("th",{className:"sticky top-0 px-6 py-4 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:z==null?void 0:z.map((J,ve)=>a.jsxs("tr",{onClick:()=>r(`/vendor-list-table/get-vendor/${J._id}`),className:"hover:bg-gray-50 cursor-pointer",children:[a.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:Y+ve+1}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"block text-sm text-gray-500",children:(J==null?void 0:J.vendorId)||J.ID}),a.jsx("span",{className:"block font-semibold text-gray-900",children:(J==null?void 0:J.vendorName)||J.Name})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(J==null?void 0:J.category)||J.Category}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:J==null?void 0:J.email}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:J==null?void 0:J.phone}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"flex space-x-2",children:t==="Legal Team"?a.jsx("button",{className:"text-primary hover:text-primary/80",onClick:de=>{de.stopPropagation(),b(J._id)},title:"View More",children:a.jsx(Po,{className:"h-5 w-5"})}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"text-primary hover:text-primary/80",onClick:de=>{de.stopPropagation(),r(`/vendor-list-table/edit-vendor/${J._id}`)},children:a.jsx(Us,{className:"h-5 w-5"})}),a.jsx("button",{className:"text-red-600 hover:text-red-800",onClick:de=>{de.stopPropagation(),O(J==null?void 0:J._id)},children:a.jsx($r,{className:"h-5 w-5"})})]})})})]},J._id))})]})})})]}),a.jsx(cj,{currentPage:ae,totalPages:oe,handlePageChange:ee,itemsPerPage:F,totalItems:(K==null?void 0:K.length)||0}),a.jsx(Ae,{}),A&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Reject Vendor"}),a.jsx("button",{onClick:Q,className:"text-gray-500 hover:text-gray-700","aria-label":"Close modal",children:a.jsx(_r,{className:"h-5 w-5"})})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Reason for Rejection ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{ref:M,value:h,onChange:J=>x(J.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",rows:4,placeholder:"Please provide a detailed reason for rejecting this vendor..."})]}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{onClick:Q,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),a.jsx("button",{onClick:I,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg",children:"Reject"})]})]})}),a.jsx(W,{})]})};function Bwe(){return a.jsxs(X9,{children:[a.jsxs(j9,{children:[a.jsx(Xt,{path:"/req-list-table/hod-approve-request/:hodEmail/:reqId",element:a.jsx(vwe,{})}),a.jsx(Xt,{path:"*",element:a.jsx(L2e,{})}),a.jsx(Xt,{path:"/",element:a.jsx(Jq,{})}),a.jsxs(Xt,{path:"/",element:a.jsx(rK,{}),children:[a.jsx(Xt,{path:"/dashboard",element:a.jsx(Lq,{})}),a.jsx(Xt,{path:"/employee-profile",element:a.jsx(uwe,{})}),a.jsx(Xt,{path:"/req-list-table",element:a.jsx(Cae,{})}),a.jsx(Xt,{path:"/req-list-table/create-request",element:a.jsx(gS,{})}),a.jsx(Xt,{path:"/req-list-table/create-request/:id",element:a.jsx(gS,{})}),a.jsx(Xt,{path:"/req-list-table/invoice/:id",element:a.jsx(kE,{})}),a.jsx(Xt,{path:"/req-list-table/preview-one-req/:id",element:a.jsx(eT,{})}),a.jsx(Xt,{path:"/req-list-table/edit-req/:id",element:a.jsx(O1e,{})}),a.jsx(Xt,{path:"/approval-request-list",element:a.jsx(k1e,{})}),a.jsx(Xt,{path:"/role-based-approvals-list",element:a.jsx(dwe,{})}),a.jsx(Xt,{path:"/req-list-table/show-request-statistcs/:action",element:a.jsx(W2e,{})}),a.jsx(Xt,{path:"/approval-request-list/show-request-statistcs/:action/:fromDate/:toDate",element:a.jsx(P2e,{})}),a.jsx(Xt,{path:"/approval-request-list/preview-one-req/:id",element:a.jsx(eT,{})}),a.jsx(Xt,{path:"/panel-members-table/add-panel-members",element:a.jsx(O2e,{})}),a.jsx(Xt,{path:"/panel-members-table",element:a.jsx(M2e,{})}),a.jsx(Xt,{path:"/panel-members-table/edit-panel-members/:id",element:a.jsx(H2e,{})}),a.jsx(Xt,{path:"/questions",element:a.jsx(T2e,{})}),a.jsx(Xt,{path:"/users/list",element:a.jsx(aK,{})}),a.jsx(Xt,{path:"/create-user",element:a.jsx(sK,{})}),a.jsx(Xt,{path:"/users/adduser",element:a.jsx(iK,{})}),a.jsx(Xt,{path:"/users/edituser",element:a.jsx(oK,{})}),a.jsx(Xt,{path:"/entity-list-table",element:a.jsx(qfe,{})}),a.jsx(Xt,{path:"/entity-list-table/entities",element:a.jsx(Hfe,{})}),a.jsx(Xt,{path:"/entity-list-table/edit-entities/:id",element:a.jsx(Kfe,{})}),a.jsx(Xt,{path:"/vendor-list-table",element:a.jsx(Gce,{})}),a.jsx(Xt,{path:"/vendor-list-table/vendor-registration",element:a.jsx(zce,{})}),a.jsx(Xt,{path:"/vendor-list-table/my-vendor-registration",element:a.jsx(Cwe,{})}),a.jsx(Xt,{path:"/vendor-list-table/edit-vendor/:id",element:a.jsx(Yfe,{})}),a.jsx(Xt,{path:"/vendor-list-table/get-vendor/:vendorId",element:a.jsx(I2e,{})}),a.jsx(Xt,{path:"/vendor/my-added-vendors",element:a.jsx(hwe,{})}),a.jsx(Xt,{path:"/vendor/pending-vendor-list-table",element:a.jsx(jwe,{})}),a.jsx(Xt,{path:"/employee-list-table",element:a.jsx(Gfe,{})}),a.jsx(Xt,{path:"/employee-list-table/employee-reg",element:a.jsx(Yce,{})}),a.jsx(Xt,{path:"/employee-list-table/edit-employee/:id",element:a.jsx(Wfe,{})}),a.jsx(Xt,{path:"/support",element:a.jsx(Xce,{})}),a.jsx(Xt,{path:"/invoice",element:a.jsx(kE,{})}),a.jsx(Xt,{path:"/admin/domain",element:a.jsx(lK,{})}),a.jsx(Xt,{path:"/admin/domain-table",element:a.jsx(cK,{})}),a.jsx(Xt,{path:"/genarate-report-page",element:a.jsx(z2e,{})}),a.jsx(Xt,{path:"/settings",element:a.jsx(X2e,{})}),a.jsx(Xt,{path:"/settings/google-sso",element:a.jsx(Y2e,{})}),a.jsx(Xt,{path:"/settings/smtp",element:a.jsx(J2e,{})}),a.jsx(Xt,{path:"/settings/create-rest-api",element:a.jsx(ewe,{})}),a.jsx(Xt,{path:"/settings/email-notification",element:a.jsx(fwe,{})}),a.jsx(Xt,{path:"/settings/approval-flow",element:a.jsx(twe,{})}),a.jsx(Xt,{path:"/settings/approver-type",element:a.jsx(cwe,{})}),a.jsx(Xt,{path:"/settings/all-listed-currency",element:a.jsx(iwe,{})}),a.jsx(Xt,{path:"/settings/payment-terms",element:a.jsx(owe,{})}),a.jsx(Xt,{path:"/settings/payment-type",element:a.jsx(lwe,{})}),a.jsx(Xt,{path:"/provision-table",element:a.jsx(gwe,{})}),a.jsx(Xt,{path:"/prepaid-table",element:a.jsx(ywe,{})}),a.jsx(Xt,{path:"/settings/upload-vendor-policy",element:a.jsx(wwe,{})}),a.jsx(Xt,{path:"/settings/upload-po-policy",element:a.jsx(bwe,{})})]})]}),a.jsx(V2e,{})]})}const Swe="852861297423-0oi62t2b835sshrvcjurg6an4q3q35k6.apps.googleusercontent.com";Nb.createRoot(document.getElementById("root")).render(a.jsx(Dq,{clientId:Swe,children:a.jsx(Bwe,{})}));export{hh as _,Fwe as c,M5 as g};
